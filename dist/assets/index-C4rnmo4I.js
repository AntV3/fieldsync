function DE(t,e){for(var r=0;r<e.length;r++){const a=e[r];if(typeof a!="string"&&!Array.isArray(a)){for(const n in a)if(n!=="default"&&!(n in t)){const s=Object.getOwnPropertyDescriptor(a,n);s&&Object.defineProperty(t,n,s.get?s:{enumerable:!0,get:()=>a[n]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();var A$=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Gx(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function FE(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var r=function a(){var n=!1;try{n=this instanceof a}catch{}return n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(a){var n=Object.getOwnPropertyDescriptor(t,a);Object.defineProperty(r,a,n.get?n:{enumerable:!0,get:function(){return t[a]}})}),r}var $g={exports:{}},r0={};var gb;function LE(){if(gb)return r0;gb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(a,n,s){var l=null;if(s!==void 0&&(l=""+s),n.key!==void 0&&(l=""+n.key),"key"in n){s={};for(var c in n)c!=="key"&&(s[c]=n[c])}else s=n;return n=s.ref,{$$typeof:t,type:a,key:l,ref:n!==void 0?n:null,props:s}}return r0.Fragment=e,r0.jsx=r,r0.jsxs=r,r0}var vb;function PE(){return vb||(vb=1,$g.exports=LE()),$g.exports}var o=PE(),Wg={exports:{}},Ar={};var xb;function ME(){if(xb)return Ar;xb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),x=Symbol.iterator;function g(U){return U===null||typeof U!="object"?null:(U=x&&U[x]||U["@@iterator"],typeof U=="function"?U:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,w={};function E(U,j,F){this.props=U,this.context=j,this.refs=w,this.updater=F||b}E.prototype.isReactComponent={},E.prototype.setState=function(U,j){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,j,"setState")},E.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function C(){}C.prototype=E.prototype;function A(U,j,F){this.props=U,this.context=j,this.refs=w,this.updater=F||b}var T=A.prototype=new C;T.constructor=A,_(T,E.prototype),T.isPureReactComponent=!0;var G=Array.isArray;function W(){}var B={H:null,A:null,T:null,S:null},q=Object.prototype.hasOwnProperty;function L(U,j,F){var I=F.ref;return{$$typeof:t,type:U,key:j,ref:I!==void 0?I:null,props:F}}function J(U,j){return L(U.type,j,U.props)}function D(U){return typeof U=="object"&&U!==null&&U.$$typeof===t}function O(U){var j={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(F){return j[F]})}var M=/\/+/g;function V(U,j){return typeof U=="object"&&U!==null&&U.key!=null?O(""+U.key):j.toString(36)}function ie(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(W,W):(U.status="pending",U.then(function(j){U.status==="pending"&&(U.status="fulfilled",U.value=j)},function(j){U.status==="pending"&&(U.status="rejected",U.reason=j)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function X(U,j,F,I,z){var ne=typeof U;(ne==="undefined"||ne==="boolean")&&(U=null);var se=!1;if(U===null)se=!0;else switch(ne){case"bigint":case"string":case"number":se=!0;break;case"object":switch(U.$$typeof){case t:case e:se=!0;break;case m:return se=U._init,X(se(U._payload),j,F,I,z)}}if(se)return z=z(U),se=I===""?"."+V(U,0):I,G(z)?(F="",se!=null&&(F=se.replace(M,"$&/")+"/"),X(z,j,F,"",function(_e){return _e})):z!=null&&(D(z)&&(z=J(z,F+(z.key==null||U&&U.key===z.key?"":(""+z.key).replace(M,"$&/")+"/")+se)),j.push(z)),1;se=0;var pe=I===""?".":I+":";if(G(U))for(var ye=0;ye<U.length;ye++)I=U[ye],ne=pe+V(I,ye),se+=X(I,j,F,ne,z);else if(ye=g(U),typeof ye=="function")for(U=ye.call(U),ye=0;!(I=U.next()).done;)I=I.value,ne=pe+V(I,ye++),se+=X(I,j,F,ne,z);else if(ne==="object"){if(typeof U.then=="function")return X(ie(U),j,F,I,z);throw j=String(U),Error("Objects are not valid as a React child (found: "+(j==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":j)+"). If you meant to render a collection of children, use an array instead.")}return se}function Z(U,j,F){if(U==null)return U;var I=[],z=0;return X(U,I,"","",function(ne){return j.call(F,ne,z++)}),I}function K(U){if(U._status===-1){var j=U._result;j=j(),j.then(function(F){(U._status===0||U._status===-1)&&(U._status=1,U._result=F)},function(F){(U._status===0||U._status===-1)&&(U._status=2,U._result=F)}),U._status===-1&&(U._status=0,U._result=j)}if(U._status===1)return U._result.default;throw U._result}var ae=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var j=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(j))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)},fe={map:Z,forEach:function(U,j,F){Z(U,function(){j.apply(this,arguments)},F)},count:function(U){var j=0;return Z(U,function(){j++}),j},toArray:function(U){return Z(U,function(j){return j})||[]},only:function(U){if(!D(U))throw Error("React.Children.only expected to receive a single React element child.");return U}};return Ar.Activity=v,Ar.Children=fe,Ar.Component=E,Ar.Fragment=r,Ar.Profiler=n,Ar.PureComponent=A,Ar.StrictMode=a,Ar.Suspense=f,Ar.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=B,Ar.__COMPILER_RUNTIME={__proto__:null,c:function(U){return B.H.useMemoCache(U)}},Ar.cache=function(U){return function(){return U.apply(null,arguments)}},Ar.cacheSignal=function(){return null},Ar.cloneElement=function(U,j,F){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var I=_({},U.props),z=U.key;if(j!=null)for(ne in j.key!==void 0&&(z=""+j.key),j)!q.call(j,ne)||ne==="key"||ne==="__self"||ne==="__source"||ne==="ref"&&j.ref===void 0||(I[ne]=j[ne]);var ne=arguments.length-2;if(ne===1)I.children=F;else if(1<ne){for(var se=Array(ne),pe=0;pe<ne;pe++)se[pe]=arguments[pe+2];I.children=se}return L(U.type,z,I)},Ar.createContext=function(U){return U={$$typeof:l,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:s,_context:U},U},Ar.createElement=function(U,j,F){var I,z={},ne=null;if(j!=null)for(I in j.key!==void 0&&(ne=""+j.key),j)q.call(j,I)&&I!=="key"&&I!=="__self"&&I!=="__source"&&(z[I]=j[I]);var se=arguments.length-2;if(se===1)z.children=F;else if(1<se){for(var pe=Array(se),ye=0;ye<se;ye++)pe[ye]=arguments[ye+2];z.children=pe}if(U&&U.defaultProps)for(I in se=U.defaultProps,se)z[I]===void 0&&(z[I]=se[I]);return L(U,ne,z)},Ar.createRef=function(){return{current:null}},Ar.forwardRef=function(U){return{$$typeof:c,render:U}},Ar.isValidElement=D,Ar.lazy=function(U){return{$$typeof:m,_payload:{_status:-1,_result:U},_init:K}},Ar.memo=function(U,j){return{$$typeof:d,type:U,compare:j===void 0?null:j}},Ar.startTransition=function(U){var j=B.T,F={};B.T=F;try{var I=U(),z=B.S;z!==null&&z(F,I),typeof I=="object"&&I!==null&&typeof I.then=="function"&&I.then(W,ae)}catch(ne){ae(ne)}finally{j!==null&&F.types!==null&&(j.types=F.types),B.T=j}},Ar.unstable_useCacheRefresh=function(){return B.H.useCacheRefresh()},Ar.use=function(U){return B.H.use(U)},Ar.useActionState=function(U,j,F){return B.H.useActionState(U,j,F)},Ar.useCallback=function(U,j){return B.H.useCallback(U,j)},Ar.useContext=function(U){return B.H.useContext(U)},Ar.useDebugValue=function(){},Ar.useDeferredValue=function(U,j){return B.H.useDeferredValue(U,j)},Ar.useEffect=function(U,j){return B.H.useEffect(U,j)},Ar.useEffectEvent=function(U){return B.H.useEffectEvent(U)},Ar.useId=function(){return B.H.useId()},Ar.useImperativeHandle=function(U,j,F){return B.H.useImperativeHandle(U,j,F)},Ar.useInsertionEffect=function(U,j){return B.H.useInsertionEffect(U,j)},Ar.useLayoutEffect=function(U,j){return B.H.useLayoutEffect(U,j)},Ar.useMemo=function(U,j){return B.H.useMemo(U,j)},Ar.useOptimistic=function(U,j){return B.H.useOptimistic(U,j)},Ar.useReducer=function(U,j,F){return B.H.useReducer(U,j,F)},Ar.useRef=function(U){return B.H.useRef(U)},Ar.useState=function(U){return B.H.useState(U)},Ar.useSyncExternalStore=function(U,j,F){return B.H.useSyncExternalStore(U,j,F)},Ar.useTransition=function(){return B.H.useTransition()},Ar.version="19.2.0",Ar}var yb;function Yx(){return yb||(yb=1,Wg.exports=ME()),Wg.exports}var ee=Yx();const IE=Gx(ee);var Vg={exports:{}},a0={},Gg={exports:{}},Yg={};var _b;function BE(){return _b||(_b=1,(function(t){function e(X,Z){var K=X.length;X.push(Z);e:for(;0<K;){var ae=K-1>>>1,fe=X[ae];if(0<n(fe,Z))X[ae]=Z,X[K]=fe,K=ae;else break e}}function r(X){return X.length===0?null:X[0]}function a(X){if(X.length===0)return null;var Z=X[0],K=X.pop();if(K!==Z){X[0]=K;e:for(var ae=0,fe=X.length,U=fe>>>1;ae<U;){var j=2*(ae+1)-1,F=X[j],I=j+1,z=X[I];if(0>n(F,K))I<fe&&0>n(z,F)?(X[ae]=z,X[I]=K,ae=I):(X[ae]=F,X[j]=K,ae=j);else if(I<fe&&0>n(z,K))X[ae]=z,X[I]=K,ae=I;else break e}}return Z}function n(X,Z){var K=X.sortIndex-Z.sortIndex;return K!==0?K:X.id-Z.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var l=Date,c=l.now();t.unstable_now=function(){return l.now()-c}}var f=[],d=[],m=1,v=null,x=3,g=!1,b=!1,_=!1,w=!1,E=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;function T(X){for(var Z=r(d);Z!==null;){if(Z.callback===null)a(d);else if(Z.startTime<=X)a(d),Z.sortIndex=Z.expirationTime,e(f,Z);else break;Z=r(d)}}function G(X){if(_=!1,T(X),!b)if(r(f)!==null)b=!0,W||(W=!0,O());else{var Z=r(d);Z!==null&&ie(G,Z.startTime-X)}}var W=!1,B=-1,q=5,L=-1;function J(){return w?!0:!(t.unstable_now()-L<q)}function D(){if(w=!1,W){var X=t.unstable_now();L=X;var Z=!0;try{e:{b=!1,_&&(_=!1,C(B),B=-1),g=!0;var K=x;try{t:{for(T(X),v=r(f);v!==null&&!(v.expirationTime>X&&J());){var ae=v.callback;if(typeof ae=="function"){v.callback=null,x=v.priorityLevel;var fe=ae(v.expirationTime<=X);if(X=t.unstable_now(),typeof fe=="function"){v.callback=fe,T(X),Z=!0;break t}v===r(f)&&a(f),T(X)}else a(f);v=r(f)}if(v!==null)Z=!0;else{var U=r(d);U!==null&&ie(G,U.startTime-X),Z=!1}}break e}finally{v=null,x=K,g=!1}Z=void 0}}finally{Z?O():W=!1}}}var O;if(typeof A=="function")O=function(){A(D)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,V=M.port2;M.port1.onmessage=D,O=function(){V.postMessage(null)}}else O=function(){E(D,0)};function ie(X,Z){B=E(function(){X(t.unstable_now())},Z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(X){X.callback=null},t.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<X?Math.floor(1e3/X):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_next=function(X){switch(x){case 1:case 2:case 3:var Z=3;break;default:Z=x}var K=x;x=Z;try{return X()}finally{x=K}},t.unstable_requestPaint=function(){w=!0},t.unstable_runWithPriority=function(X,Z){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var K=x;x=X;try{return Z()}finally{x=K}},t.unstable_scheduleCallback=function(X,Z,K){var ae=t.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?ae+K:ae):K=ae,X){case 1:var fe=-1;break;case 2:fe=250;break;case 5:fe=1073741823;break;case 4:fe=1e4;break;default:fe=5e3}return fe=K+fe,X={id:m++,callback:Z,priorityLevel:X,startTime:K,expirationTime:fe,sortIndex:-1},K>ae?(X.sortIndex=K,e(d,X),r(f)===null&&X===r(d)&&(_?(C(B),B=-1):_=!0,ie(G,K-ae))):(X.sortIndex=fe,e(f,X),b||g||(b=!0,W||(W=!0,O()))),X},t.unstable_shouldYield=J,t.unstable_wrapCallback=function(X){var Z=x;return function(){var K=x;x=Z;try{return X.apply(this,arguments)}finally{x=K}}}})(Yg)),Yg}var bb;function UE(){return bb||(bb=1,Gg.exports=BE()),Gg.exports}var Xg={exports:{}},Ns={};var wb;function qE(){if(wb)return Ns;wb=1;var t=Yx();function e(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var a={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},n=Symbol.for("react.portal");function s(f,d,m){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:v==null?null:""+v,children:f,containerInfo:d,implementation:m}}var l=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Ns.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,Ns.createPortal=function(f,d){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return s(f,d,null,m)},Ns.flushSync=function(f){var d=l.T,m=a.p;try{if(l.T=null,a.p=2,f)return f()}finally{l.T=d,a.p=m,a.d.f()}},Ns.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,a.d.C(f,d))},Ns.prefetchDNS=function(f){typeof f=="string"&&a.d.D(f)},Ns.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var m=d.as,v=c(m,d.crossOrigin),x=typeof d.integrity=="string"?d.integrity:void 0,g=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;m==="style"?a.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:v,integrity:x,fetchPriority:g}):m==="script"&&a.d.X(f,{crossOrigin:v,integrity:x,fetchPriority:g,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Ns.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var m=c(d.as,d.crossOrigin);a.d.M(f,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&a.d.M(f)},Ns.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var m=d.as,v=c(m,d.crossOrigin);a.d.L(f,m,{crossOrigin:v,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Ns.preloadModule=function(f,d){if(typeof f=="string")if(d){var m=c(d.as,d.crossOrigin);a.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else a.d.m(f)},Ns.requestFormReset=function(f){a.d.r(f)},Ns.unstable_batchedUpdates=function(f,d){return f(d)},Ns.useFormState=function(f,d,m){return l.H.useFormState(f,d,m)},Ns.useFormStatus=function(){return l.H.useHostTransitionStatus()},Ns.version="19.2.0",Ns}var Sb;function zE(){if(Sb)return Xg.exports;Sb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Xg.exports=qE(),Xg.exports}var Nb;function HE(){if(Nb)return a0;Nb=1;var t=UE(),e=Yx(),r=zE();function a(i){var u="https://react.dev/errors/"+i;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)u+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+i+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function s(i){var u=i,h=i;if(i.alternate)for(;u.return;)u=u.return;else{i=u;do u=i,(u.flags&4098)!==0&&(h=u.return),i=u.return;while(i)}return u.tag===3?h:null}function l(i){if(i.tag===13){var u=i.memoizedState;if(u===null&&(i=i.alternate,i!==null&&(u=i.memoizedState)),u!==null)return u.dehydrated}return null}function c(i){if(i.tag===31){var u=i.memoizedState;if(u===null&&(i=i.alternate,i!==null&&(u=i.memoizedState)),u!==null)return u.dehydrated}return null}function f(i){if(s(i)!==i)throw Error(a(188))}function d(i){var u=i.alternate;if(!u){if(u=s(i),u===null)throw Error(a(188));return u!==i?null:i}for(var h=i,p=u;;){var S=h.return;if(S===null)break;var k=S.alternate;if(k===null){if(p=S.return,p!==null){h=p;continue}break}if(S.child===k.child){for(k=S.child;k;){if(k===h)return f(S),i;if(k===p)return f(S),u;k=k.sibling}throw Error(a(188))}if(h.return!==p.return)h=S,p=k;else{for(var Y=!1,ce=S.child;ce;){if(ce===h){Y=!0,h=S,p=k;break}if(ce===p){Y=!0,p=S,h=k;break}ce=ce.sibling}if(!Y){for(ce=k.child;ce;){if(ce===h){Y=!0,h=k,p=S;break}if(ce===p){Y=!0,p=k,h=S;break}ce=ce.sibling}if(!Y)throw Error(a(189))}}if(h.alternate!==p)throw Error(a(190))}if(h.tag!==3)throw Error(a(188));return h.stateNode.current===h?i:u}function m(i){var u=i.tag;if(u===5||u===26||u===27||u===6)return i;for(i=i.child;i!==null;){if(u=m(i),u!==null)return u;i=i.sibling}return null}var v=Object.assign,x=Symbol.for("react.element"),g=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),A=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),G=Symbol.for("react.suspense"),W=Symbol.for("react.suspense_list"),B=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),J=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function O(i){return i===null||typeof i!="object"?null:(i=D&&i[D]||i["@@iterator"],typeof i=="function"?i:null)}var M=Symbol.for("react.client.reference");function V(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===M?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case _:return"Fragment";case E:return"Profiler";case w:return"StrictMode";case G:return"Suspense";case W:return"SuspenseList";case L:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case b:return"Portal";case A:return i.displayName||"Context";case C:return(i._context.displayName||"Context")+".Consumer";case T:var u=i.render;return i=i.displayName,i||(i=u.displayName||u.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case B:return u=i.displayName||null,u!==null?u:V(i.type)||"Memo";case q:u=i._payload,i=i._init;try{return V(i(u))}catch{}}return null}var ie=Array.isArray,X=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K={pending:!1,data:null,method:null,action:null},ae=[],fe=-1;function U(i){return{current:i}}function j(i){0>fe||(i.current=ae[fe],ae[fe]=null,fe--)}function F(i,u){fe++,ae[fe]=i.current,i.current=u}var I=U(null),z=U(null),ne=U(null),se=U(null);function pe(i,u){switch(F(ne,u),F(z,i),F(I,null),u.nodeType){case 9:case 11:i=(i=u.documentElement)&&(i=i.namespaceURI)?B_(i):0;break;default:if(i=u.tagName,u=u.namespaceURI)u=B_(u),i=U_(u,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}j(I),F(I,i)}function ye(){j(I),j(z),j(ne)}function _e(i){i.memoizedState!==null&&F(se,i);var u=I.current,h=U_(u,i.type);u!==h&&(F(z,i),F(I,h))}function Le(i){z.current===i&&(j(I),j(z)),se.current===i&&(j(se),Zh._currentValue=K)}var ue,at;function ht(i){if(ue===void 0)try{throw Error()}catch(h){var u=h.stack.trim().match(/\n( *(at )?)/);ue=u&&u[1]||"",at=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ue+i+at}var de=!1;function it(i,u){if(!i||de)return"";de=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(u){var xt=function(){throw Error()};if(Object.defineProperty(xt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xt,[])}catch(nt){var rt=nt}Reflect.construct(i,[],xt)}else{try{xt.call()}catch(nt){rt=nt}i.call(xt.prototype)}}else{try{throw Error()}catch(nt){rt=nt}(xt=i())&&typeof xt.catch=="function"&&xt.catch(function(){})}}catch(nt){if(nt&&rt&&typeof nt.stack=="string")return[nt.stack,rt.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var k=p.DetermineComponentFrameRoot(),Y=k[0],ce=k[1];if(Y&&ce){var Te=Y.split(`
`),tt=ce.split(`
`);for(S=p=0;p<Te.length&&!Te[p].includes("DetermineComponentFrameRoot");)p++;for(;S<tt.length&&!tt[S].includes("DetermineComponentFrameRoot");)S++;if(p===Te.length||S===tt.length)for(p=Te.length-1,S=tt.length-1;1<=p&&0<=S&&Te[p]!==tt[S];)S--;for(;1<=p&&0<=S;p--,S--)if(Te[p]!==tt[S]){if(p!==1||S!==1)do if(p--,S--,0>S||Te[p]!==tt[S]){var dt=`
`+Te[p].replace(" at new "," at ");return i.displayName&&dt.includes("<anonymous>")&&(dt=dt.replace("<anonymous>",i.displayName)),dt}while(1<=p&&0<=S);break}}}finally{de=!1,Error.prepareStackTrace=h}return(h=i?i.displayName||i.name:"")?ht(h):""}function Se(i,u){switch(i.tag){case 26:case 27:case 5:return ht(i.type);case 16:return ht("Lazy");case 13:return i.child!==u&&u!==null?ht("Suspense Fallback"):ht("Suspense");case 19:return ht("SuspenseList");case 0:case 15:return it(i.type,!1);case 11:return it(i.type.render,!1);case 1:return it(i.type,!0);case 31:return ht("Activity");default:return""}}function ve(i){try{var u="",h=null;do u+=Se(i,h),h=i,i=i.return;while(i);return u}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var Ie=Object.prototype.hasOwnProperty,wt=t.unstable_scheduleCallback,Xe=t.unstable_cancelCallback,ct=t.unstable_shouldYield,jt=t.unstable_requestPaint,Lt=t.unstable_now,Vt=t.unstable_getCurrentPriorityLevel,$t=t.unstable_ImmediatePriority,Wt=t.unstable_UserBlockingPriority,Ot=t.unstable_NormalPriority,kt=t.unstable_LowPriority,qe=t.unstable_IdlePriority,Ye=t.log,Pt=t.unstable_setDisableYieldValue,Et=null,Dt=null;function Ce(i){if(typeof Ye=="function"&&Pt(i),Dt&&typeof Dt.setStrictMode=="function")try{Dt.setStrictMode(Et,i)}catch{}}var $e=Math.clz32?Math.clz32:Pe,xe=Math.log,Be=Math.LN2;function Pe(i){return i>>>=0,i===0?32:31-(xe(i)/Be|0)|0}var Ct=256,gt=262144,Rt=4194304;function It(i){var u=i&42;if(u!==0)return u;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function pr(i,u,h){var p=i.pendingLanes;if(p===0)return 0;var S=0,k=i.suspendedLanes,Y=i.pingedLanes;i=i.warmLanes;var ce=p&134217727;return ce!==0?(p=ce&~k,p!==0?S=It(p):(Y&=ce,Y!==0?S=It(Y):h||(h=ce&~i,h!==0&&(S=It(h))))):(ce=p&~k,ce!==0?S=It(ce):Y!==0?S=It(Y):h||(h=p&~i,h!==0&&(S=It(h)))),S===0?0:u!==0&&u!==S&&(u&k)===0&&(k=S&-S,h=u&-u,k>=h||k===32&&(h&4194048)!==0)?u:S}function sa(i,u){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&u)===0}function fa(i,u){switch(i){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nt(){var i=Rt;return Rt<<=1,(Rt&62914560)===0&&(Rt=4194304),i}function Ea(i){for(var u=[],h=0;31>h;h++)u.push(i);return u}function rr(i,u){i.pendingLanes|=u,u!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function ya(i,u,h,p,S,k){var Y=i.pendingLanes;i.pendingLanes=h,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=h,i.entangledLanes&=h,i.errorRecoveryDisabledLanes&=h,i.shellSuspendCounter=0;var ce=i.entanglements,Te=i.expirationTimes,tt=i.hiddenUpdates;for(h=Y&~h;0<h;){var dt=31-$e(h),xt=1<<dt;ce[dt]=0,Te[dt]=-1;var rt=tt[dt];if(rt!==null)for(tt[dt]=null,dt=0;dt<rt.length;dt++){var nt=rt[dt];nt!==null&&(nt.lane&=-536870913)}h&=~xt}p!==0&&vn(i,p,0),k!==0&&S===0&&i.tag!==0&&(i.suspendedLanes|=k&~(Y&~u))}function vn(i,u,h){i.pendingLanes|=u,i.suspendedLanes&=~u;var p=31-$e(u);i.entangledLanes|=u,i.entanglements[p]=i.entanglements[p]|1073741824|h&261930}function Da(i,u){var h=i.entangledLanes|=u;for(i=i.entanglements;h;){var p=31-$e(h),S=1<<p;S&u|i[p]&u&&(i[p]|=u),h&=~S}}function an(i,u){var h=u&-u;return h=(h&42)!==0?1:qt(h),(h&(i.suspendedLanes|u))!==0?0:h}function qt(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Kt(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function re(){var i=Z.p;return i!==0?i:(i=window.event,i===void 0?32:cb(i.type))}function Ne(i,u){var h=Z.p;try{return Z.p=i,u()}finally{Z.p=h}}var me=Math.random().toString(36).slice(2),ge="__reactFiber$"+me,we="__reactProps$"+me,je="__reactContainer$"+me,We="__reactEvents$"+me,st="__reactListeners$"+me,Ke="__reactHandles$"+me,Je="__reactResources$"+me,Qe="__reactMarker$"+me;function St(i){delete i[ge],delete i[we],delete i[We],delete i[st],delete i[Ke]}function Ft(i){var u=i[ge];if(u)return u;for(var h=i.parentNode;h;){if(u=h[je]||h[ge]){if(h=u.alternate,u.child!==null||h!==null&&h.child!==null)for(i=G_(i);i!==null;){if(h=i[ge])return h;i=G_(i)}return u}i=h,h=i.parentNode}return null}function Ht(i){if(i=i[ge]||i[je]){var u=i.tag;if(u===5||u===6||u===13||u===31||u===26||u===27||u===3)return i}return null}function Tt(i){var u=i.tag;if(u===5||u===26||u===27||u===6)return i.stateNode;throw Error(a(33))}function Bt(i){var u=i[Je];return u||(u=i[Je]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function Jt(i){i[Qe]=!0}var ia=new Set,Lr={};function ua(i,u){ls(i,u),ls(i+"Capture",u)}function ls(i,u){for(Lr[i]=u,i=0;i<u.length;i++)ia.add(u[i])}var gi=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),vi={},Is={};function el(i){return Ie.call(Is,i)?!0:Ie.call(vi,i)?!1:gi.test(i)?Is[i]=!0:(vi[i]=!0,!1)}function Fa(i,u,h){if(el(u))if(h===null)i.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":i.removeAttribute(u);return;case"boolean":var p=u.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){i.removeAttribute(u);return}}i.setAttribute(u,""+h)}}function po(i,u,h){if(h===null)i.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(u);return}i.setAttribute(u,""+h)}}function xi(i,u,h,p){if(p===null)i.removeAttribute(h);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(h);return}i.setAttributeNS(u,h,""+p)}}function Jr(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function ku(i){var u=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function zi(i,u,h){var p=Object.getOwnPropertyDescriptor(i.constructor.prototype,u);if(!i.hasOwnProperty(u)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var S=p.get,k=p.set;return Object.defineProperty(i,u,{configurable:!0,get:function(){return S.call(this)},set:function(Y){h=""+Y,k.call(this,Y)}}),Object.defineProperty(i,u,{enumerable:p.enumerable}),{getValue:function(){return h},setValue:function(Y){h=""+Y},stopTracking:function(){i._valueTracker=null,delete i[u]}}}}function tl(i){if(!i._valueTracker){var u=ku(i)?"checked":"value";i._valueTracker=zi(i,u,""+i[u])}}function Eu(i){if(!i)return!1;var u=i._valueTracker;if(!u)return!0;var h=u.getValue(),p="";return i&&(p=ku(i)?i.checked?"true":"false":i.value),i=p,i!==h?(u.setValue(i),!0):!1}function cs(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var xn=/[\n"\\]/g;function nn(i){return i.replace(xn,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function Sc(i,u,h,p,S,k,Y,ce){i.name="",Y!=null&&typeof Y!="function"&&typeof Y!="symbol"&&typeof Y!="boolean"?i.type=Y:i.removeAttribute("type"),u!=null?Y==="number"?(u===0&&i.value===""||i.value!=u)&&(i.value=""+Jr(u)):i.value!==""+Jr(u)&&(i.value=""+Jr(u)):Y!=="submit"&&Y!=="reset"||i.removeAttribute("value"),u!=null?Au(i,Y,Jr(u)):h!=null?Au(i,Y,Jr(h)):p!=null&&i.removeAttribute("value"),S==null&&k!=null&&(i.defaultChecked=!!k),S!=null&&(i.checked=S&&typeof S!="function"&&typeof S!="symbol"),ce!=null&&typeof ce!="function"&&typeof ce!="symbol"&&typeof ce!="boolean"?i.name=""+Jr(ce):i.removeAttribute("name")}function qf(i,u,h,p,S,k,Y,ce){if(k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(i.type=k),u!=null||h!=null){if(!(k!=="submit"&&k!=="reset"||u!=null)){tl(i);return}h=h!=null?""+Jr(h):"",u=u!=null?""+Jr(u):h,ce||u===i.value||(i.value=u),i.defaultValue=u}p=p??S,p=typeof p!="function"&&typeof p!="symbol"&&!!p,i.checked=ce?i.checked:!!p,i.defaultChecked=!!p,Y!=null&&typeof Y!="function"&&typeof Y!="symbol"&&typeof Y!="boolean"&&(i.name=Y),tl(i)}function Au(i,u,h){u==="number"&&cs(i.ownerDocument)===i||i.defaultValue===""+h||(i.defaultValue=""+h)}function us(i,u,h,p){if(i=i.options,u){u={};for(var S=0;S<h.length;S++)u["$"+h[S]]=!0;for(h=0;h<i.length;h++)S=u.hasOwnProperty("$"+i[h].value),i[h].selected!==S&&(i[h].selected=S),S&&p&&(i[h].defaultSelected=!0)}else{for(h=""+Jr(h),u=null,S=0;S<i.length;S++){if(i[S].value===h){i[S].selected=!0,p&&(i[S].defaultSelected=!0);return}u!==null||i[S].disabled||(u=i[S])}u!==null&&(u.selected=!0)}}function Cu(i,u,h){if(u!=null&&(u=""+Jr(u),u!==i.value&&(i.value=u),h==null)){i.defaultValue!==u&&(i.defaultValue=u);return}i.defaultValue=h!=null?""+Jr(h):""}function Tu(i,u,h,p){if(u==null){if(p!=null){if(h!=null)throw Error(a(92));if(ie(p)){if(1<p.length)throw Error(a(93));p=p[0]}h=p}h==null&&(h=""),u=h}h=Jr(u),i.defaultValue=h,p=i.textContent,p===h&&p!==""&&p!==null&&(i.value=p),tl(i)}function yi(i,u){if(u){var h=i.firstChild;if(h&&h===i.lastChild&&h.nodeType===3){h.nodeValue=u;return}}i.textContent=u}var Ol=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function zf(i,u,h){var p=u.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?p?i.setProperty(u,""):u==="float"?i.cssFloat="":i[u]="":p?i.setProperty(u,h):typeof h!="number"||h===0||Ol.has(u)?u==="float"?i.cssFloat=h:i[u]=(""+h).trim():i[u]=h+"px"}function Hf(i,u,h){if(u!=null&&typeof u!="object")throw Error(a(62));if(i=i.style,h!=null){for(var p in h)!h.hasOwnProperty(p)||u!=null&&u.hasOwnProperty(p)||(p.indexOf("--")===0?i.setProperty(p,""):p==="float"?i.cssFloat="":i[p]="");for(var S in u)p=u[S],u.hasOwnProperty(S)&&h[S]!==p&&zf(i,S,p)}else for(var k in u)u.hasOwnProperty(k)&&zf(i,k,u[k])}function Ou(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ru=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),$f=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function bs(i){return $f.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function _i(){}var go=null;function Rl(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var rl=null,gr=null;function Wf(i){var u=Ht(i);if(u&&(i=u.stateNode)){var h=i[we]||null;e:switch(i=u.stateNode,u.type){case"input":if(Sc(i,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),u=h.name,h.type==="radio"&&u!=null){for(h=i;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+nn(""+u)+'"][type="radio"]'),u=0;u<h.length;u++){var p=h[u];if(p!==i&&p.form===i.form){var S=p[we]||null;if(!S)throw Error(a(90));Sc(p,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(u=0;u<h.length;u++)p=h[u],p.form===i.form&&Eu(p)}break e;case"textarea":Cu(i,h.value,h.defaultValue);break e;case"select":u=h.value,u!=null&&us(i,!!h.multiple,u,!1)}}}var Du=!1;function Vf(i,u,h){if(Du)return i(u,h);Du=!0;try{var p=i(u);return p}finally{if(Du=!1,(rl!==null||gr!==null)&&(Dm(),rl&&(u=rl,i=gr,gr=rl=null,Wf(u),i)))for(u=0;u<i.length;u++)Wf(i[u])}}function Bs(i,u){var h=i.stateNode;if(h===null)return null;var p=h[we]||null;if(p===null)return null;h=p[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(h&&typeof h!="function")throw Error(a(231,u,typeof h));return h}var Bn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Fu=!1;if(Bn)try{var Dl={};Object.defineProperty(Dl,"passive",{get:function(){Fu=!0}}),window.addEventListener("test",Dl,Dl),window.removeEventListener("test",Dl,Dl)}catch{Fu=!1}var Us=null,Fl=null,Hi=null;function Gf(){if(Hi)return Hi;var i,u=Fl,h=u.length,p,S="value"in Us?Us.value:Us.textContent,k=S.length;for(i=0;i<h&&u[i]===S[i];i++);var Y=h-i;for(p=1;p<=Y&&u[h-p]===S[k-p];p++);return Hi=S.slice(i,1<p?1-p:void 0)}function Xs(i){var u=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&u===13&&(i=13)):i=u,i===10&&(i=13),32<=i||i===13?i:0}function Nc(){return!0}function jc(){return!1}function Tn(i){function u(h,p,S,k,Y){this._reactName=h,this._targetInst=S,this.type=p,this.nativeEvent=k,this.target=Y,this.currentTarget=null;for(var ce in i)i.hasOwnProperty(ce)&&(h=i[ce],this[ce]=h?h(k):k[ce]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?Nc:jc,this.isPropagationStopped=jc,this}return v(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Nc)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Nc)},persist:function(){},isPersistent:Nc}),u}var $i={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ks=Tn($i),vo=v({},$i,{view:0,detail:0}),kc=Tn(vo),Ll,xo,yo,Pl=v({},vo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yr,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==yo&&(yo&&i.type==="mousemove"?(Ll=i.screenX-yo.screenX,xo=i.screenY-yo.screenY):xo=Ll=0,yo=i),Ll)},movementY:function(i){return"movementY"in i?i.movementY:xo}}),Lu=Tn(Pl),_o=v({},Pl,{dataTransfer:0}),bo=Tn(_o),Yf=v({},vo,{relatedTarget:0}),wo=Tn(Yf),Xf=v({},$i,{animationName:0,elapsedTime:0,pseudoElement:0}),R=Tn(Xf),Q=v({},$i,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Ae=Tn(Q),Oe=v({},$i,{data:0}),ze=Tn(Oe),mt={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_t={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Qt={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function sr(i){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(i):(i=Qt[i])?!!u[i]:!1}function yr(){return sr}var kr=v({},vo,{key:function(i){if(i.key){var u=mt[i.key]||i.key;if(u!=="Unidentified")return u}return i.type==="keypress"?(i=Xs(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?_t[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yr,charCode:function(i){return i.type==="keypress"?Xs(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Xs(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),$r=Tn(kr),La=v({},Pl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xa=Tn(La),_a=v({},vo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yr}),yn=Tn(_a),sn=v({},$i,{propertyName:0,elapsedTime:0,pseudoElement:0}),Un=Tn(sn),So=v({},Pl,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),bi=Tn(So),No=v({},$i,{newState:0,oldState:0}),Pu=Tn(No),Ec=[9,13,27,32],Wi=Bn&&"CompositionEvent"in window,wi=null;Bn&&"documentMode"in document&&(wi=document.documentMode);var Ml=Bn&&"TextEvent"in window&&!wi,jo=Bn&&(!Wi||wi&&8<wi&&11>=wi),On=" ",al=!1;function nl(i,u){switch(i){case"keyup":return Ec.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ac(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Vi=!1;function fs(i,u){switch(i){case"compositionend":return Ac(u);case"keypress":return u.which!==32?null:(al=!0,On);case"textInput":return i=u.data,i===On&&al?null:i;default:return null}}function ko(i,u){if(Vi)return i==="compositionend"||!Wi&&nl(i,u)?(i=Gf(),Hi=Fl=Us=null,Vi=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return jo&&u.locale!=="ko"?null:u.data;default:return null}}var Cc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mu(i){var u=i&&i.nodeName&&i.nodeName.toLowerCase();return u==="input"?!!Cc[i.type]:u==="textarea"}function qs(i,u,h,p){rl?gr?gr.push(p):gr=[p]:rl=p,u=Um(u,"onChange"),0<u.length&&(h=new Ks("onChange","change",null,h,p),i.push({event:h,listeners:u}))}var Si=null,Eo=null;function Iu(i){D_(i,0)}function Ni(i){var u=Tt(i);if(Eu(u))return i}function sl(i,u){if(i==="change")return u}var ws=!1;if(Bn){var ds;if(Bn){var Gi="oninput"in document;if(!Gi){var Yi=document.createElement("div");Yi.setAttribute("oninput","return;"),Gi=typeof Yi.oninput=="function"}ds=Gi}else ds=!1;ws=ds&&(!document.documentMode||9<document.documentMode)}function Ao(){Si&&(Si.detachEvent("onpropertychange",Tc),Eo=Si=null)}function Tc(i){if(i.propertyName==="value"&&Ni(Eo)){var u=[];qs(u,Eo,i,Rl(i)),Vf(Iu,u)}}function Oc(i,u,h){i==="focusin"?(Ao(),Si=u,Eo=h,Si.attachEvent("onpropertychange",Tc)):i==="focusout"&&Ao()}function Ka(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Ni(Eo)}function Kf(i,u){if(i==="click")return Ni(u)}function Xi(i,u){if(i==="input"||i==="change")return Ni(u)}function Ki(i,u){return i===u&&(i!==0||1/i===1/u)||i!==i&&u!==u}var qn=typeof Object.is=="function"?Object.is:Ki;function Co(i,u){if(qn(i,u))return!0;if(typeof i!="object"||i===null||typeof u!="object"||u===null)return!1;var h=Object.keys(i),p=Object.keys(u);if(h.length!==p.length)return!1;for(p=0;p<h.length;p++){var S=h[p];if(!Ie.call(u,S)||!qn(i[S],u[S]))return!1}return!0}function Rc(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Dc(i,u){var h=Rc(i);i=0;for(var p;h;){if(h.nodeType===3){if(p=i+h.textContent.length,i<=u&&p>=u)return{node:h,offset:u-i};i=p}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=Rc(h)}}function To(i,u){return i&&u?i===u?!0:i&&i.nodeType===3?!1:u&&u.nodeType===3?To(i,u.parentNode):"contains"in i?i.contains(u):i.compareDocumentPosition?!!(i.compareDocumentPosition(u)&16):!1:!1}function Oo(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var u=cs(i.document);u instanceof i.HTMLIFrameElement;){try{var h=typeof u.contentWindow.location.href=="string"}catch{h=!1}if(h)i=u.contentWindow;else break;u=cs(i.document)}return u}function Ji(i){var u=i&&i.nodeName&&i.nodeName.toLowerCase();return u&&(u==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||u==="textarea"||i.contentEditable==="true")}var Il=Bn&&"documentMode"in document&&11>=document.documentMode,zs=null,Ro=null,Zn=null,Js=!1;function Zr(i,u,h){var p=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Js||zs==null||zs!==cs(p)||(p=zs,"selectionStart"in p&&Ji(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Zn&&Co(Zn,p)||(Zn=p,p=Um(Ro,"onSelect"),0<p.length&&(u=new Ks("onSelect","select",null,u,h),i.push({event:u,listeners:p}),u.target=zs)))}function Wr(i,u){var h={};return h[i.toLowerCase()]=u.toLowerCase(),h["Webkit"+i]="webkit"+u,h["Moz"+i]="moz"+u,h}var ba={animationend:Wr("Animation","AnimationEnd"),animationiteration:Wr("Animation","AnimationIteration"),animationstart:Wr("Animation","AnimationStart"),transitionrun:Wr("Transition","TransitionRun"),transitionstart:Wr("Transition","TransitionStart"),transitioncancel:Wr("Transition","TransitionCancel"),transitionend:Wr("Transition","TransitionEnd")},Ja={},Zi={};Bn&&(Zi=document.createElement("div").style,"AnimationEvent"in window||(delete ba.animationend.animation,delete ba.animationiteration.animation,delete ba.animationstart.animation),"TransitionEvent"in window||delete ba.transitionend.transition);function ji(i){if(Ja[i])return Ja[i];if(!ba[i])return i;var u=ba[i],h;for(h in u)if(u.hasOwnProperty(h)&&h in Zi)return Ja[i]=u[h];return i}var Bl=ji("animationend"),Bu=ji("animationiteration"),bh=ji("animationstart"),cm=ji("transitionrun"),um=ji("transitionstart"),fm=ji("transitioncancel"),wh=ji("transitionend"),Sh=new Map,Ul="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ul.push("scrollEnd");function Zs(i,u){Sh.set(i,u),ua(u,[i])}var Uu=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Hs=[],ql=0,Jf=0;function qu(){for(var i=ql,u=Jf=ql=0;u<i;){var h=Hs[u];Hs[u++]=null;var p=Hs[u];Hs[u++]=null;var S=Hs[u];Hs[u++]=null;var k=Hs[u];if(Hs[u++]=null,p!==null&&S!==null){var Y=p.pending;Y===null?S.next=S:(S.next=Y.next,Y.next=S),p.pending=S}k!==0&&Hu(h,S,k)}}function zu(i,u,h,p){Hs[ql++]=i,Hs[ql++]=u,Hs[ql++]=h,Hs[ql++]=p,Jf|=p,i.lanes|=p,i=i.alternate,i!==null&&(i.lanes|=p)}function Zf(i,u,h,p){return zu(i,u,h,p),Qn(i)}function Do(i,u){return zu(i,null,null,u),Qn(i)}function Hu(i,u,h){i.lanes|=h;var p=i.alternate;p!==null&&(p.lanes|=h);for(var S=!1,k=i.return;k!==null;)k.childLanes|=h,p=k.alternate,p!==null&&(p.childLanes|=h),k.tag===22&&(i=k.stateNode,i===null||i._visibility&1||(S=!0)),i=k,k=k.return;return i.tag===3?(k=i.stateNode,S&&u!==null&&(S=31-$e(h),i=k.hiddenUpdates,p=i[S],p===null?i[S]=[u]:p.push(u),u.lane=h|536870912),k):null}function Qn(i){if(50<Wh)throw Wh=0,mg=null,Error(a(185));for(var u=i.return;u!==null;)i=u,u=i.return;return i.tag===3?i.stateNode:null}var zn={};function Qf(i,u,h,p){this.tag=i,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function es(i,u,h,p){return new Qf(i,u,h,p)}function ed(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Qs(i,u){var h=i.alternate;return h===null?(h=es(i.tag,u,i.key,i.mode),h.elementType=i.elementType,h.type=i.type,h.stateNode=i.stateNode,h.alternate=i,i.alternate=h):(h.pendingProps=u,h.type=i.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=i.flags&65011712,h.childLanes=i.childLanes,h.lanes=i.lanes,h.child=i.child,h.memoizedProps=i.memoizedProps,h.memoizedState=i.memoizedState,h.updateQueue=i.updateQueue,u=i.dependencies,h.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},h.sibling=i.sibling,h.index=i.index,h.ref=i.ref,h.refCleanup=i.refCleanup,h}function $u(i,u){i.flags&=65011714;var h=i.alternate;return h===null?(i.childLanes=0,i.lanes=u,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=h.childLanes,i.lanes=h.lanes,i.child=h.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=h.memoizedProps,i.memoizedState=h.memoizedState,i.updateQueue=h.updateQueue,i.type=h.type,u=h.dependencies,i.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),i}function Fc(i,u,h,p,S,k){var Y=0;if(p=i,typeof i=="function")ed(i)&&(Y=1);else if(typeof i=="string")Y=bE(i,h,I.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case L:return i=es(31,h,u,S),i.elementType=L,i.lanes=k,i;case _:return il(h.children,S,k,u);case w:Y=8,S|=24;break;case E:return i=es(12,h,u,S|2),i.elementType=E,i.lanes=k,i;case G:return i=es(13,h,u,S),i.elementType=G,i.lanes=k,i;case W:return i=es(19,h,u,S),i.elementType=W,i.lanes=k,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case A:Y=10;break e;case C:Y=9;break e;case T:Y=11;break e;case B:Y=14;break e;case q:Y=16,p=null;break e}Y=29,h=Error(a(130,i===null?"null":typeof i,"")),p=null}return u=es(Y,h,u,S),u.elementType=i,u.type=p,u.lanes=k,u}function il(i,u,h,p){return i=es(7,i,p,u),i.lanes=h,i}function Wu(i,u,h){return i=es(6,i,null,u),i.lanes=h,i}function td(i){var u=es(18,null,null,0);return u.stateNode=i,u}function Lc(i,u,h){return u=es(4,i.children!==null?i.children:[],i.key,u),u.lanes=h,u.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},u}var rd=new WeakMap;function ei(i,u){if(typeof i=="object"&&i!==null){var h=rd.get(i);return h!==void 0?h:(u={value:i,source:u,stack:ve(u)},rd.set(i,u),u)}return{value:i,source:u,stack:ve(u)}}var Pc=[],zl=0,ad=null,Vu=0,ti=[],ri=0,ol=null,ai=1,ni="";function $s(i,u){Pc[zl++]=Vu,Pc[zl++]=ad,ad=i,Vu=u}function dm(i,u,h){ti[ri++]=ai,ti[ri++]=ni,ti[ri++]=ol,ol=i;var p=ai;i=ni;var S=32-$e(p)-1;p&=~(1<<S),h+=1;var k=32-$e(u)+S;if(30<k){var Y=S-S%5;k=(p&(1<<Y)-1).toString(32),p>>=Y,S-=Y,ai=1<<32-$e(u)+S|h<<S|p,ni=k+i}else ai=1<<k|h<<S|p,ni=i}function Nh(i){i.return!==null&&($s(i,1),dm(i,1,0))}function nd(i){for(;i===ad;)ad=Pc[--zl],Pc[zl]=null,Vu=Pc[--zl],Pc[zl]=null;for(;i===ol;)ol=ti[--ri],ti[ri]=null,ni=ti[--ri],ti[ri]=null,ai=ti[--ri],ti[ri]=null}function hm(i,u){ti[ri++]=ai,ti[ri++]=ni,ti[ri++]=ol,ai=u.id,ni=u.overflow,ol=i}var Hn=null,Aa=null,Br=!1,hs=null,$a=!1,ki=Error(a(519));function ll(i){var u=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Mc(ei(u,i)),ki}function jh(i){var u=i.stateNode,h=i.type,p=i.memoizedProps;switch(u[ge]=i,u[we]=p,h){case"dialog":qr("cancel",u),qr("close",u);break;case"iframe":case"object":case"embed":qr("load",u);break;case"video":case"audio":for(h=0;h<Gh.length;h++)qr(Gh[h],u);break;case"source":qr("error",u);break;case"img":case"image":case"link":qr("error",u),qr("load",u);break;case"details":qr("toggle",u);break;case"input":qr("invalid",u),qf(u,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":qr("invalid",u);break;case"textarea":qr("invalid",u),Tu(u,p.value,p.defaultValue,p.children)}h=p.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||u.textContent===""+h||p.suppressHydrationWarning===!0||M_(u.textContent,h)?(p.popover!=null&&(qr("beforetoggle",u),qr("toggle",u)),p.onScroll!=null&&qr("scroll",u),p.onScrollEnd!=null&&qr("scrollend",u),p.onClick!=null&&(u.onclick=_i),u=!0):u=!1,u||ll(i,!0)}function Fo(i){for(Hn=i.return;Hn;)switch(Hn.tag){case 5:case 31:case 13:$a=!1;return;case 27:case 3:$a=!0;return;default:Hn=Hn.return}}function $n(i){if(i!==Hn)return!1;if(!Br)return Fo(i),Br=!0,!1;var u=i.tag,h;if((h=u!==3&&u!==27)&&((h=u===5)&&(h=i.type,h=!(h!=="form"&&h!=="button")||Cg(i.type,i.memoizedProps)),h=!h),h&&Aa&&ll(i),Fo(i),u===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));Aa=V_(i)}else if(u===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));Aa=V_(i)}else u===27?(u=Aa,Jc(i.type)?(i=Fg,Fg=null,Aa=i):Aa=u):Aa=Hn?ro(i.stateNode.nextSibling):null;return!0}function Hl(){Aa=Hn=null,Br=!1}function kh(){var i=hs;return i!==null&&(ui===null?ui=i:ui.push.apply(ui,i),hs=null),i}function Mc(i){hs===null?hs=[i]:hs.push(i)}var sd=U(null),cl=null,Qi=null;function ul(i,u,h){F(sd,u._currentValue),u._currentValue=h}function si(i){i._currentValue=sd.current,j(sd)}function Ic(i,u,h){for(;i!==null;){var p=i.alternate;if((i.childLanes&u)!==u?(i.childLanes|=u,p!==null&&(p.childLanes|=u)):p!==null&&(p.childLanes&u)!==u&&(p.childLanes|=u),i===h)break;i=i.return}}function $l(i,u,h,p){var S=i.child;for(S!==null&&(S.return=i);S!==null;){var k=S.dependencies;if(k!==null){var Y=S.child;k=k.firstContext;e:for(;k!==null;){var ce=k;k=S;for(var Te=0;Te<u.length;Te++)if(ce.context===u[Te]){k.lanes|=h,ce=k.alternate,ce!==null&&(ce.lanes|=h),Ic(k.return,h,i),p||(Y=null);break e}k=ce.next}}else if(S.tag===18){if(Y=S.return,Y===null)throw Error(a(341));Y.lanes|=h,k=Y.alternate,k!==null&&(k.lanes|=h),Ic(Y,h,i),Y=null}else Y=S.child;if(Y!==null)Y.return=S;else for(Y=S;Y!==null;){if(Y===i){Y=null;break}if(S=Y.sibling,S!==null){S.return=Y.return,Y=S;break}Y=Y.return}S=Y}}function fl(i,u,h,p){i=null;for(var S=u,k=!1;S!==null;){if(!k){if((S.flags&524288)!==0)k=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var Y=S.alternate;if(Y===null)throw Error(a(387));if(Y=Y.memoizedProps,Y!==null){var ce=S.type;qn(S.pendingProps.value,Y.value)||(i!==null?i.push(ce):i=[ce])}}else if(S===se.current){if(Y=S.alternate,Y===null)throw Error(a(387));Y.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(i!==null?i.push(Zh):i=[Zh])}S=S.return}i!==null&&$l(u,i,h,p),u.flags|=262144}function id(i){for(i=i.firstContext;i!==null;){if(!qn(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function dl(i){cl=i,Qi=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Wn(i){return mm(cl,i)}function od(i,u){return cl===null&&dl(i),mm(i,u)}function mm(i,u){var h=u._currentValue;if(u={context:u,memoizedValue:h,next:null},Qi===null){if(i===null)throw Error(a(308));Qi=u,i.dependencies={lanes:0,firstContext:u},i.flags|=524288}else Qi=Qi.next=u;return h}var D1=typeof AbortController<"u"?AbortController:function(){var i=[],u=this.signal={aborted:!1,addEventListener:function(h,p){i.push(p)}};this.abort=function(){u.aborted=!0,i.forEach(function(h){return h()})}},F1=t.unstable_scheduleCallback,L1=t.unstable_NormalPriority,Za={$$typeof:A,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Bc(){return{controller:new D1,data:new Map,refCount:0}}function Gu(i){i.refCount--,i.refCount===0&&F1(L1,function(){i.controller.abort()})}var Yu=null,ld=0,y=0,N=null;function P(i,u){if(Yu===null){var h=Yu=[];ld=0,y=_g(),N={status:"pending",value:void 0,then:function(p){h.push(p)}}}return ld++,u.then(H,H),u}function H(){if(--ld===0&&Yu!==null){N!==null&&(N.status="fulfilled");var i=Yu;Yu=null,y=0,N=null;for(var u=0;u<i.length;u++)(0,i[u])()}}function te(i,u){var h=[],p={status:"pending",value:null,reason:null,then:function(S){h.push(S)}};return i.then(function(){p.status="fulfilled",p.value=u;for(var S=0;S<h.length;S++)(0,h[S])(u)},function(S){for(p.status="rejected",p.reason=S,S=0;S<h.length;S++)(0,h[S])(void 0)}),p}var oe=X.S;X.S=function(i,u){o_=Lt(),typeof u=="object"&&u!==null&&typeof u.then=="function"&&P(i,u),oe!==null&&oe(i,u)};var le=U(null);function he(){var i=le.current;return i!==null?i:Ta.pooledCache}function be(i,u){u===null?F(le,le.current):F(le,u.pool)}function Ee(){var i=he();return i===null?null:{parent:Za._currentValue,pool:i}}var De=Error(a(460)),Ze=Error(a(474)),ke=Error(a(542)),Me={then:function(){}};function Ve(i){return i=i.status,i==="fulfilled"||i==="rejected"}function ut(i,u,h){switch(h=i[h],h===void 0?i.push(u):h!==u&&(u.then(_i,_i),u=h),u.status){case"fulfilled":return u.value;case"rejected":throw i=u.reason,At(i),i;default:if(typeof u.status=="string")u.then(_i,_i);else{if(i=Ta,i!==null&&100<i.shellSuspendCounter)throw Error(a(482));i=u,i.status="pending",i.then(function(p){if(u.status==="pending"){var S=u;S.status="fulfilled",S.value=p}},function(p){if(u.status==="pending"){var S=u;S.status="rejected",S.reason=p}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw i=u.reason,At(i),i}throw lt=u,De}}function Ge(i){try{var u=i._init;return u(i._payload)}catch(h){throw h!==null&&typeof h=="object"&&typeof h.then=="function"?(lt=h,De):h}}var lt=null;function pt(){if(lt===null)throw Error(a(459));var i=lt;return lt=null,i}function At(i){if(i===De||i===ke)throw Error(a(483))}var yt=null,ar=0;function Gt(i){var u=ar;return ar+=1,yt===null&&(yt=[]),ut(yt,i,u)}function Nr(i,u){u=u.props.ref,i.ref=u!==void 0?u:null}function Zt(i,u){throw u.$$typeof===x?Error(a(525)):(i=Object.prototype.toString.call(u),Error(a(31,i==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":i)))}function Mr(i){function u(He,Fe){if(i){var et=He.deletions;et===null?(He.deletions=[Fe],He.flags|=16):et.push(Fe)}}function h(He,Fe){if(!i)return null;for(;Fe!==null;)u(He,Fe),Fe=Fe.sibling;return null}function p(He){for(var Fe=new Map;He!==null;)He.key!==null?Fe.set(He.key,He):Fe.set(He.index,He),He=He.sibling;return Fe}function S(He,Fe){return He=Qs(He,Fe),He.index=0,He.sibling=null,He}function k(He,Fe,et){return He.index=et,i?(et=He.alternate,et!==null?(et=et.index,et<Fe?(He.flags|=67108866,Fe):et):(He.flags|=67108866,Fe)):(He.flags|=1048576,Fe)}function Y(He){return i&&He.alternate===null&&(He.flags|=67108866),He}function ce(He,Fe,et,vt){return Fe===null||Fe.tag!==6?(Fe=Wu(et,He.mode,vt),Fe.return=He,Fe):(Fe=S(Fe,et),Fe.return=He,Fe)}function Te(He,Fe,et,vt){var dr=et.type;return dr===_?dt(He,Fe,et.props.children,vt,et.key):Fe!==null&&(Fe.elementType===dr||typeof dr=="object"&&dr!==null&&dr.$$typeof===q&&Ge(dr)===Fe.type)?(Fe=S(Fe,et.props),Nr(Fe,et),Fe.return=He,Fe):(Fe=Fc(et.type,et.key,et.props,null,He.mode,vt),Nr(Fe,et),Fe.return=He,Fe)}function tt(He,Fe,et,vt){return Fe===null||Fe.tag!==4||Fe.stateNode.containerInfo!==et.containerInfo||Fe.stateNode.implementation!==et.implementation?(Fe=Lc(et,He.mode,vt),Fe.return=He,Fe):(Fe=S(Fe,et.children||[]),Fe.return=He,Fe)}function dt(He,Fe,et,vt,dr){return Fe===null||Fe.tag!==7?(Fe=il(et,He.mode,vt,dr),Fe.return=He,Fe):(Fe=S(Fe,et),Fe.return=He,Fe)}function xt(He,Fe,et){if(typeof Fe=="string"&&Fe!==""||typeof Fe=="number"||typeof Fe=="bigint")return Fe=Wu(""+Fe,He.mode,et),Fe.return=He,Fe;if(typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case g:return et=Fc(Fe.type,Fe.key,Fe.props,null,He.mode,et),Nr(et,Fe),et.return=He,et;case b:return Fe=Lc(Fe,He.mode,et),Fe.return=He,Fe;case q:return Fe=Ge(Fe),xt(He,Fe,et)}if(ie(Fe)||O(Fe))return Fe=il(Fe,He.mode,et,null),Fe.return=He,Fe;if(typeof Fe.then=="function")return xt(He,Gt(Fe),et);if(Fe.$$typeof===A)return xt(He,od(He,Fe),et);Zt(He,Fe)}return null}function rt(He,Fe,et,vt){var dr=Fe!==null?Fe.key:null;if(typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint")return dr!==null?null:ce(He,Fe,""+et,vt);if(typeof et=="object"&&et!==null){switch(et.$$typeof){case g:return et.key===dr?Te(He,Fe,et,vt):null;case b:return et.key===dr?tt(He,Fe,et,vt):null;case q:return et=Ge(et),rt(He,Fe,et,vt)}if(ie(et)||O(et))return dr!==null?null:dt(He,Fe,et,vt,null);if(typeof et.then=="function")return rt(He,Fe,Gt(et),vt);if(et.$$typeof===A)return rt(He,Fe,od(He,et),vt);Zt(He,et)}return null}function nt(He,Fe,et,vt,dr){if(typeof vt=="string"&&vt!==""||typeof vt=="number"||typeof vt=="bigint")return He=He.get(et)||null,ce(Fe,He,""+vt,dr);if(typeof vt=="object"&&vt!==null){switch(vt.$$typeof){case g:return He=He.get(vt.key===null?et:vt.key)||null,Te(Fe,He,vt,dr);case b:return He=He.get(vt.key===null?et:vt.key)||null,tt(Fe,He,vt,dr);case q:return vt=Ge(vt),nt(He,Fe,et,vt,dr)}if(ie(vt)||O(vt))return He=He.get(et)||null,dt(Fe,He,vt,dr,null);if(typeof vt.then=="function")return nt(He,Fe,et,Gt(vt),dr);if(vt.$$typeof===A)return nt(He,Fe,et,od(Fe,vt),dr);Zt(Fe,vt)}return null}function er(He,Fe,et,vt){for(var dr=null,ra=null,ir=Fe,Rr=Fe=0,Hr=null;ir!==null&&Rr<et.length;Rr++){ir.index>Rr?(Hr=ir,ir=null):Hr=ir.sibling;var aa=rt(He,ir,et[Rr],vt);if(aa===null){ir===null&&(ir=Hr);break}i&&ir&&aa.alternate===null&&u(He,ir),Fe=k(aa,Fe,Rr),ra===null?dr=aa:ra.sibling=aa,ra=aa,ir=Hr}if(Rr===et.length)return h(He,ir),Br&&$s(He,Rr),dr;if(ir===null){for(;Rr<et.length;Rr++)ir=xt(He,et[Rr],vt),ir!==null&&(Fe=k(ir,Fe,Rr),ra===null?dr=ir:ra.sibling=ir,ra=ir);return Br&&$s(He,Rr),dr}for(ir=p(ir);Rr<et.length;Rr++)Hr=nt(ir,He,Rr,et[Rr],vt),Hr!==null&&(i&&Hr.alternate!==null&&ir.delete(Hr.key===null?Rr:Hr.key),Fe=k(Hr,Fe,Rr),ra===null?dr=Hr:ra.sibling=Hr,ra=Hr);return i&&ir.forEach(function(ru){return u(He,ru)}),Br&&$s(He,Rr),dr}function xr(He,Fe,et,vt){if(et==null)throw Error(a(151));for(var dr=null,ra=null,ir=Fe,Rr=Fe=0,Hr=null,aa=et.next();ir!==null&&!aa.done;Rr++,aa=et.next()){ir.index>Rr?(Hr=ir,ir=null):Hr=ir.sibling;var ru=rt(He,ir,aa.value,vt);if(ru===null){ir===null&&(ir=Hr);break}i&&ir&&ru.alternate===null&&u(He,ir),Fe=k(ru,Fe,Rr),ra===null?dr=ru:ra.sibling=ru,ra=ru,ir=Hr}if(aa.done)return h(He,ir),Br&&$s(He,Rr),dr;if(ir===null){for(;!aa.done;Rr++,aa=et.next())aa=xt(He,aa.value,vt),aa!==null&&(Fe=k(aa,Fe,Rr),ra===null?dr=aa:ra.sibling=aa,ra=aa);return Br&&$s(He,Rr),dr}for(ir=p(ir);!aa.done;Rr++,aa=et.next())aa=nt(ir,He,Rr,aa.value,vt),aa!==null&&(i&&aa.alternate!==null&&ir.delete(aa.key===null?Rr:aa.key),Fe=k(aa,Fe,Rr),ra===null?dr=aa:ra.sibling=aa,ra=aa);return i&&ir.forEach(function(RE){return u(He,RE)}),Br&&$s(He,Rr),dr}function ja(He,Fe,et,vt){if(typeof et=="object"&&et!==null&&et.type===_&&et.key===null&&(et=et.props.children),typeof et=="object"&&et!==null){switch(et.$$typeof){case g:e:{for(var dr=et.key;Fe!==null;){if(Fe.key===dr){if(dr=et.type,dr===_){if(Fe.tag===7){h(He,Fe.sibling),vt=S(Fe,et.props.children),vt.return=He,He=vt;break e}}else if(Fe.elementType===dr||typeof dr=="object"&&dr!==null&&dr.$$typeof===q&&Ge(dr)===Fe.type){h(He,Fe.sibling),vt=S(Fe,et.props),Nr(vt,et),vt.return=He,He=vt;break e}h(He,Fe);break}else u(He,Fe);Fe=Fe.sibling}et.type===_?(vt=il(et.props.children,He.mode,vt,et.key),vt.return=He,He=vt):(vt=Fc(et.type,et.key,et.props,null,He.mode,vt),Nr(vt,et),vt.return=He,He=vt)}return Y(He);case b:e:{for(dr=et.key;Fe!==null;){if(Fe.key===dr)if(Fe.tag===4&&Fe.stateNode.containerInfo===et.containerInfo&&Fe.stateNode.implementation===et.implementation){h(He,Fe.sibling),vt=S(Fe,et.children||[]),vt.return=He,He=vt;break e}else{h(He,Fe);break}else u(He,Fe);Fe=Fe.sibling}vt=Lc(et,He.mode,vt),vt.return=He,He=vt}return Y(He);case q:return et=Ge(et),ja(He,Fe,et,vt)}if(ie(et))return er(He,Fe,et,vt);if(O(et)){if(dr=O(et),typeof dr!="function")throw Error(a(150));return et=dr.call(et),xr(He,Fe,et,vt)}if(typeof et.then=="function")return ja(He,Fe,Gt(et),vt);if(et.$$typeof===A)return ja(He,Fe,od(He,et),vt);Zt(He,et)}return typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint"?(et=""+et,Fe!==null&&Fe.tag===6?(h(He,Fe.sibling),vt=S(Fe,et),vt.return=He,He=vt):(h(He,Fe),vt=Wu(et,He.mode,vt),vt.return=He,He=vt),Y(He)):h(He,Fe)}return function(He,Fe,et,vt){try{ar=0;var dr=ja(He,Fe,et,vt);return yt=null,dr}catch(ir){if(ir===De||ir===ke)throw ir;var ra=es(29,ir,null,He.mode);return ra.lanes=vt,ra.return=He,ra}finally{}}}var Ca=Mr(!0),Er=Mr(!1),Yt=!1;function zt(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Pa(i,u){i=i.updateQueue,u.updateQueue===i&&(u.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function vr(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Tr(i,u,h){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(ca&2)!==0){var S=p.pending;return S===null?u.next=u:(u.next=S.next,S.next=u),p.pending=u,u=Qn(i),Hu(i,null,h),u}return zu(i,p,u,h),Qn(i)}function oa(i,u,h){if(u=u.updateQueue,u!==null&&(u=u.shared,(h&4194048)!==0)){var p=u.lanes;p&=i.pendingLanes,h|=p,u.lanes=h,Da(i,h)}}function _n(i,u){var h=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,h===p)){var S=null,k=null;if(h=h.firstBaseUpdate,h!==null){do{var Y={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};k===null?S=k=Y:k=k.next=Y,h=h.next}while(h!==null);k===null?S=k=u:k=k.next=u}else S=k=u;h={baseState:p.baseState,firstBaseUpdate:S,lastBaseUpdate:k,shared:p.shared,callbacks:p.callbacks},i.updateQueue=h;return}i=h.lastBaseUpdate,i===null?h.firstBaseUpdate=u:i.next=u,h.lastBaseUpdate=u}var Vn=!1;function wa(){if(Vn){var i=N;if(i!==null)throw i}}function on(i,u,h,p){Vn=!1;var S=i.updateQueue;Yt=!1;var k=S.firstBaseUpdate,Y=S.lastBaseUpdate,ce=S.shared.pending;if(ce!==null){S.shared.pending=null;var Te=ce,tt=Te.next;Te.next=null,Y===null?k=tt:Y.next=tt,Y=Te;var dt=i.alternate;dt!==null&&(dt=dt.updateQueue,ce=dt.lastBaseUpdate,ce!==Y&&(ce===null?dt.firstBaseUpdate=tt:ce.next=tt,dt.lastBaseUpdate=Te))}if(k!==null){var xt=S.baseState;Y=0,dt=tt=Te=null,ce=k;do{var rt=ce.lane&-536870913,nt=rt!==ce.lane;if(nt?(zr&rt)===rt:(p&rt)===rt){rt!==0&&rt===y&&(Vn=!0),dt!==null&&(dt=dt.next={lane:0,tag:ce.tag,payload:ce.payload,callback:null,next:null});e:{var er=i,xr=ce;rt=u;var ja=h;switch(xr.tag){case 1:if(er=xr.payload,typeof er=="function"){xt=er.call(ja,xt,rt);break e}xt=er;break e;case 3:er.flags=er.flags&-65537|128;case 0:if(er=xr.payload,rt=typeof er=="function"?er.call(ja,xt,rt):er,rt==null)break e;xt=v({},xt,rt);break e;case 2:Yt=!0}}rt=ce.callback,rt!==null&&(i.flags|=64,nt&&(i.flags|=8192),nt=S.callbacks,nt===null?S.callbacks=[rt]:nt.push(rt))}else nt={lane:rt,tag:ce.tag,payload:ce.payload,callback:ce.callback,next:null},dt===null?(tt=dt=nt,Te=xt):dt=dt.next=nt,Y|=rt;if(ce=ce.next,ce===null){if(ce=S.shared.pending,ce===null)break;nt=ce,ce=nt.next,nt.next=null,S.lastBaseUpdate=nt,S.shared.pending=null}}while(!0);dt===null&&(Te=xt),S.baseState=Te,S.firstBaseUpdate=tt,S.lastBaseUpdate=dt,k===null&&(S.shared.lanes=0),Vc|=Y,i.lanes=Y,i.memoizedState=xt}}function ts(i,u){if(typeof i!="function")throw Error(a(191,i));i.call(u)}function ln(i,u){var h=i.callbacks;if(h!==null)for(i.callbacks=null,i=0;i<h.length;i++)ts(h[i],u)}var Fr=U(null),Yr=U(0);function Ma(i,u){i=ec,F(Yr,i),F(Fr,u),ec=i|u.baseLanes}function Qr(){F(Yr,ec),F(Fr,Fr.current)}function bn(){ec=Yr.current,j(Fr),j(Yr)}var Ia=U(null),Xr=null;function Qa(i){var u=i.alternate;F(Vr,Vr.current&1),F(Ia,i),Xr===null&&(u===null||Fr.current!==null||u.memoizedState!==null)&&(Xr=i)}function la(i){F(Vr,Vr.current),F(Ia,i),Xr===null&&(Xr=i)}function cn(i){i.tag===22?(F(Vr,Vr.current),F(Ia,i),Xr===null&&(Xr=i)):un()}function un(){F(Vr,Vr.current),F(Ia,Ia.current)}function da(i){j(Ia),Xr===i&&(Xr=null),j(Vr)}var Vr=U(0);function rs(i){for(var u=i;u!==null;){if(u.tag===13){var h=u.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||Rg(h)||Dg(h)))return u}else if(u.tag===19&&(u.memoizedProps.revealOrder==="forwards"||u.memoizedProps.revealOrder==="backwards"||u.memoizedProps.revealOrder==="unstable_legacy-backwards"||u.memoizedProps.revealOrder==="together")){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===i)break;for(;u.sibling===null;){if(u.return===null||u.return===i)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var Wa=0,ur=null,fr=null,Kr=null,Ss=!1,ii=!1,ms=!1,fn=0,hl=0,ml=null,cd=0;function Sa(){throw Error(a(321))}function Eh(i,u){if(u===null)return!1;for(var h=0;h<u.length&&h<i.length;h++)if(!qn(i[h],u[h]))return!1;return!0}function Ah(i,u,h,p,S,k){return Wa=k,ur=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,X.H=i===null||i.memoizedState===null?xy:H1,ms=!1,k=h(p,S),ms=!1,ii&&(k=Lo(u,h,p,S)),ud(i),k}function ud(i){X.H=Ph;var u=fr!==null&&fr.next!==null;if(Wa=0,Kr=fr=ur=null,Ss=!1,hl=0,ml=null,u)throw Error(a(300));i===null||Dn||(i=i.dependencies,i!==null&&id(i)&&(Dn=!0))}function Lo(i,u,h,p){ur=i;var S=0;do{if(ii&&(ml=null),hl=0,ii=!1,25<=S)throw Error(a(301));if(S+=1,Kr=fr=null,i.updateQueue!=null){var k=i.updateQueue;k.lastEffect=null,k.events=null,k.stores=null,k.memoCache!=null&&(k.memoCache.index=0)}X.H=yy,k=u(h,p)}while(ii);return k}function P1(){var i=X.H,u=i.useState()[0];return u=typeof u.then=="function"?pl(u):u,i=i.useState()[0],(fr!==null?fr.memoizedState:null)!==i&&(ur.flags|=1024),u}function Ch(){var i=fn!==0;return fn=0,i}function Th(i,u,h){u.updateQueue=i.updateQueue,u.flags&=-2053,i.lanes&=~h}function fd(i){if(Ss){for(i=i.memoizedState;i!==null;){var u=i.queue;u!==null&&(u.pending=null),i=i.next}Ss=!1}Wa=0,Kr=fr=ur=null,ii=!1,hl=fn=0,ml=null}function Rn(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kr===null?ur.memoizedState=Kr=i:Kr=Kr.next=i,Kr}function Va(){if(fr===null){var i=ur.alternate;i=i!==null?i.memoizedState:null}else i=fr.next;var u=Kr===null?ur.memoizedState:Kr.next;if(u!==null)Kr=u,fr=i;else{if(i===null)throw ur.alternate===null?Error(a(467)):Error(a(310));fr=i,i={memoizedState:fr.memoizedState,baseState:fr.baseState,baseQueue:fr.baseQueue,queue:fr.queue,next:null},Kr===null?ur.memoizedState=Kr=i:Kr=Kr.next=i}return Kr}function Xu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function pl(i){var u=hl;return hl+=1,ml===null&&(ml=[]),i=ut(ml,i,u),u=ur,(Kr===null?u.memoizedState:Kr.next)===null&&(u=u.alternate,X.H=u===null||u.memoizedState===null?xy:H1),i}function Uc(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return pl(i);if(i.$$typeof===A)return Wn(i)}throw Error(a(438,String(i)))}function Wl(i){var u=null,h=ur.updateQueue;if(h!==null&&(u=h.memoCache),u==null){var p=ur.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(u={data:p.data.map(function(S){return S.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),h===null&&(h=Xu(),ur.updateQueue=h),h.memoCache=u,h=u.data[u.index],h===void 0)for(h=u.data[u.index]=Array(i),p=0;p<i;p++)h[p]=J;return u.index++,h}function eo(i,u){return typeof u=="function"?u(i):u}function dd(i){var u=Va();return qc(u,fr,i)}function qc(i,u,h){var p=i.queue;if(p===null)throw Error(a(311));p.lastRenderedReducer=h;var S=i.baseQueue,k=p.pending;if(k!==null){if(S!==null){var Y=S.next;S.next=k.next,k.next=Y}u.baseQueue=S=k,p.pending=null}if(k=i.baseState,S===null)i.memoizedState=k;else{u=S.next;var ce=Y=null,Te=null,tt=u,dt=!1;do{var xt=tt.lane&-536870913;if(xt!==tt.lane?(zr&xt)===xt:(Wa&xt)===xt){var rt=tt.revertLane;if(rt===0)Te!==null&&(Te=Te.next={lane:0,revertLane:0,gesture:null,action:tt.action,hasEagerState:tt.hasEagerState,eagerState:tt.eagerState,next:null}),xt===y&&(dt=!0);else if((Wa&rt)===rt){tt=tt.next,rt===y&&(dt=!0);continue}else xt={lane:0,revertLane:tt.revertLane,gesture:null,action:tt.action,hasEagerState:tt.hasEagerState,eagerState:tt.eagerState,next:null},Te===null?(ce=Te=xt,Y=k):Te=Te.next=xt,ur.lanes|=rt,Vc|=rt;xt=tt.action,ms&&h(k,xt),k=tt.hasEagerState?tt.eagerState:h(k,xt)}else rt={lane:xt,revertLane:tt.revertLane,gesture:tt.gesture,action:tt.action,hasEagerState:tt.hasEagerState,eagerState:tt.eagerState,next:null},Te===null?(ce=Te=rt,Y=k):Te=Te.next=rt,ur.lanes|=xt,Vc|=xt;tt=tt.next}while(tt!==null&&tt!==u);if(Te===null?Y=k:Te.next=ce,!qn(k,i.memoizedState)&&(Dn=!0,dt&&(h=N,h!==null)))throw h;i.memoizedState=k,i.baseState=Y,i.baseQueue=Te,p.lastRenderedState=k}return S===null&&(p.lanes=0),[i.memoizedState,p.dispatch]}function hd(i){var u=Va(),h=u.queue;if(h===null)throw Error(a(311));h.lastRenderedReducer=i;var p=h.dispatch,S=h.pending,k=u.memoizedState;if(S!==null){h.pending=null;var Y=S=S.next;do k=i(k,Y.action),Y=Y.next;while(Y!==S);qn(k,u.memoizedState)||(Dn=!0),u.memoizedState=k,u.baseQueue===null&&(u.baseState=k),h.lastRenderedState=k}return[k,p]}function md(i,u,h){var p=ur,S=Va(),k=Br;if(k){if(h===void 0)throw Error(a(407));h=h()}else h=u();var Y=!qn((fr||S).memoizedState,h);if(Y&&(S.memoizedState=h,Dn=!0),S=S.queue,M1(Rh.bind(null,p,S,i),[i]),S.getSnapshot!==u||Y||Kr!==null&&Kr.memoizedState.tag&1){if(p.flags|=2048,Gl(9,{destroy:void 0},Oh.bind(null,p,S,h,u),null),Ta===null)throw Error(a(349));k||(Wa&127)!==0||Po(p,u,h)}return h}function Po(i,u,h){i.flags|=16384,i={getSnapshot:u,value:h},u=ur.updateQueue,u===null?(u=Xu(),ur.updateQueue=u,u.stores=[i]):(h=u.stores,h===null?u.stores=[i]:h.push(i))}function Oh(i,u,h,p){u.value=h,u.getSnapshot=p,pm(u)&&Dh(i)}function Rh(i,u,h){return h(function(){pm(u)&&Dh(i)})}function pm(i){var u=i.getSnapshot;i=i.value;try{var h=u();return!qn(i,h)}catch{return!0}}function Dh(i){var u=Do(i,2);u!==null&&fi(u,i,2)}function gl(i){var u=Rn();if(typeof i=="function"){var h=i;if(i=h(),ms){Ce(!0);try{h()}finally{Ce(!1)}}}return u.memoizedState=u.baseState=i,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:eo,lastRenderedState:i},u}function gm(i,u,h,p){return i.baseState=h,qc(i,fr,typeof p=="function"?p:eo)}function vm(i,u,h,p,S){if(bm(i))throw Error(a(485));if(i=u.action,i!==null){var k={payload:S,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Y){k.listeners.push(Y)}};X.T!==null?h(!0):k.isTransition=!1,p(k),h=u.pending,h===null?(k.next=u.pending=k,xm(u,k)):(k.next=h.next,u.pending=h.next=k)}}function xm(i,u){var h=u.action,p=u.payload,S=i.state;if(u.isTransition){var k=X.T,Y={};X.T=Y;try{var ce=h(S,p),Te=X.S;Te!==null&&Te(Y,ce),Fh(i,u,ce)}catch(tt){Vl(i,u,tt)}finally{k!==null&&Y.types!==null&&(k.types=Y.types),X.T=k}}else try{k=h(S,p),Fh(i,u,k)}catch(tt){Vl(i,u,tt)}}function Fh(i,u,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(p){ym(i,u,p)},function(p){return Vl(i,u,p)}):ym(i,u,h)}function ym(i,u,h){u.status="fulfilled",u.value=h,pd(u),i.state=h,u=i.pending,u!==null&&(h=u.next,h===u?i.pending=null:(h=h.next,u.next=h,xm(i,h)))}function Vl(i,u,h){var p=i.pending;if(i.pending=null,p!==null){p=p.next;do u.status="rejected",u.reason=h,pd(u),u=u.next;while(u!==p)}i.action=null}function pd(i){i=i.listeners;for(var u=0;u<i.length;u++)(0,i[u])()}function Ku(i,u){return u}function to(i,u){if(Br){var h=Ta.formState;if(h!==null){e:{var p=ur;if(Br){if(Aa){t:{for(var S=Aa,k=$a;S.nodeType!==8;){if(!k){S=null;break t}if(S=ro(S.nextSibling),S===null){S=null;break t}}k=S.data,S=k==="F!"||k==="F"?S:null}if(S){Aa=ro(S.nextSibling),p=S.data==="F!";break e}}ll(p)}p=!1}p&&(u=h[0])}}return h=Rn(),h.memoizedState=h.baseState=u,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ku,lastRenderedState:u},h.queue=p,h=py.bind(null,ur,p),p.dispatch=h,p=gl(!1),k=z1.bind(null,ur,!1,p.queue),p=Rn(),S={state:u,dispatch:null,action:i,pending:null},p.queue=S,h=vm.bind(null,ur,S,k,h),S.dispatch=h,p.memoizedState=i,[u,h,!1]}function Mo(i){var u=Va();return Io(u,fr,i)}function Io(i,u,h){if(u=qc(i,u,Ku)[0],i=dd(eo)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var p=pl(u)}catch(Y){throw Y===De?ke:Y}else p=u;u=Va();var S=u.queue,k=S.dispatch;return h!==u.memoizedState&&(ur.flags|=2048,Gl(9,{destroy:void 0},gd.bind(null,S,h),null)),[p,k,i]}function gd(i,u){i.action=u}function vd(i){var u=Va(),h=fr;if(h!==null)return Io(u,h,i);Va(),u=u.memoizedState,h=Va();var p=h.queue.dispatch;return h.memoizedState=i,[u,p,!1]}function Gl(i,u,h,p){return i={tag:i,create:h,deps:p,inst:u,next:null},u=ur.updateQueue,u===null&&(u=Xu(),ur.updateQueue=u),h=u.lastEffect,h===null?u.lastEffect=i.next=i:(p=h.next,h.next=i,i.next=p,u.lastEffect=i),i}function _m(){return Va().memoizedState}function zc(i,u,h,p){var S=Rn();ur.flags|=i,S.memoizedState=Gl(1|u,{destroy:void 0},h,p===void 0?null:p)}function Hc(i,u,h,p){var S=Va();p=p===void 0?null:p;var k=S.memoizedState.inst;fr!==null&&p!==null&&Eh(p,fr.memoizedState.deps)?S.memoizedState=Gl(u,k,h,p):(ur.flags|=i,S.memoizedState=Gl(1|u,k,h,p))}function ty(i,u){zc(8390656,8,i,u)}function M1(i,u){Hc(2048,8,i,u)}function kk(i){ur.flags|=4;var u=ur.updateQueue;if(u===null)u=Xu(),ur.updateQueue=u,u.events=[i];else{var h=u.events;h===null?u.events=[i]:h.push(i)}}function ry(i){var u=Va().memoizedState;return kk({ref:u,nextImpl:i}),function(){if((ca&2)!==0)throw Error(a(440));return u.impl.apply(void 0,arguments)}}function ay(i,u){return Hc(4,2,i,u)}function ny(i,u){return Hc(4,4,i,u)}function sy(i,u){if(typeof u=="function"){i=i();var h=u(i);return function(){typeof h=="function"?h():u(null)}}if(u!=null)return i=i(),u.current=i,function(){u.current=null}}function iy(i,u,h){h=h!=null?h.concat([i]):null,Hc(4,4,sy.bind(null,u,i),h)}function I1(){}function oy(i,u){var h=Va();u=u===void 0?null:u;var p=h.memoizedState;return u!==null&&Eh(u,p[1])?p[0]:(h.memoizedState=[i,u],i)}function ly(i,u){var h=Va();u=u===void 0?null:u;var p=h.memoizedState;if(u!==null&&Eh(u,p[1]))return p[0];if(p=i(),ms){Ce(!0);try{i()}finally{Ce(!1)}}return h.memoizedState=[p,u],p}function B1(i,u,h){return h===void 0||(Wa&1073741824)!==0&&(zr&261930)===0?i.memoizedState=u:(i.memoizedState=h,i=c_(),ur.lanes|=i,Vc|=i,h)}function cy(i,u,h,p){return qn(h,u)?h:Fr.current!==null?(i=B1(i,h,p),qn(i,u)||(Dn=!0),i):(Wa&42)===0||(Wa&1073741824)!==0&&(zr&261930)===0?(Dn=!0,i.memoizedState=h):(i=c_(),ur.lanes|=i,Vc|=i,u)}function uy(i,u,h,p,S){var k=Z.p;Z.p=k!==0&&8>k?k:8;var Y=X.T,ce={};X.T=ce,z1(i,!1,u,h);try{var Te=S(),tt=X.S;if(tt!==null&&tt(ce,Te),Te!==null&&typeof Te=="object"&&typeof Te.then=="function"){var dt=te(Te,p);Lh(i,u,dt,Ci(i))}else Lh(i,u,p,Ci(i))}catch(xt){Lh(i,u,{then:function(){},status:"rejected",reason:xt},Ci())}finally{Z.p=k,Y!==null&&ce.types!==null&&(Y.types=ce.types),X.T=Y}}function Ek(){}function U1(i,u,h,p){if(i.tag!==5)throw Error(a(476));var S=fy(i).queue;uy(i,S,u,K,h===null?Ek:function(){return dy(i),h(p)})}function fy(i){var u=i.memoizedState;if(u!==null)return u;u={memoizedState:K,baseState:K,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:eo,lastRenderedState:K},next:null};var h={};return u.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:eo,lastRenderedState:h},next:null},i.memoizedState=u,i=i.alternate,i!==null&&(i.memoizedState=u),u}function dy(i){var u=fy(i);u.next===null&&(u=i.alternate.memoizedState),Lh(i,u.next.queue,{},Ci())}function q1(){return Wn(Zh)}function hy(){return Va().memoizedState}function my(){return Va().memoizedState}function Ak(i){for(var u=i.return;u!==null;){switch(u.tag){case 24:case 3:var h=Ci();i=vr(h);var p=Tr(u,i,h);p!==null&&(fi(p,u,h),oa(p,u,h)),u={cache:Bc()},i.payload=u;return}u=u.return}}function Ck(i,u,h){var p=Ci();h={lane:p,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},bm(i)?gy(u,h):(h=Zf(i,u,h,p),h!==null&&(fi(h,i,p),vy(h,u,p)))}function py(i,u,h){var p=Ci();Lh(i,u,h,p)}function Lh(i,u,h,p){var S={lane:p,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null};if(bm(i))gy(u,S);else{var k=i.alternate;if(i.lanes===0&&(k===null||k.lanes===0)&&(k=u.lastRenderedReducer,k!==null))try{var Y=u.lastRenderedState,ce=k(Y,h);if(S.hasEagerState=!0,S.eagerState=ce,qn(ce,Y))return zu(i,u,S,0),Ta===null&&qu(),!1}catch{}finally{}if(h=Zf(i,u,S,p),h!==null)return fi(h,i,p),vy(h,u,p),!0}return!1}function z1(i,u,h,p){if(p={lane:2,revertLane:_g(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},bm(i)){if(u)throw Error(a(479))}else u=Zf(i,h,p,2),u!==null&&fi(u,i,2)}function bm(i){var u=i.alternate;return i===ur||u!==null&&u===ur}function gy(i,u){ii=Ss=!0;var h=i.pending;h===null?u.next=u:(u.next=h.next,h.next=u),i.pending=u}function vy(i,u,h){if((h&4194048)!==0){var p=u.lanes;p&=i.pendingLanes,h|=p,u.lanes=h,Da(i,h)}}var Ph={readContext:Wn,use:Uc,useCallback:Sa,useContext:Sa,useEffect:Sa,useImperativeHandle:Sa,useLayoutEffect:Sa,useInsertionEffect:Sa,useMemo:Sa,useReducer:Sa,useRef:Sa,useState:Sa,useDebugValue:Sa,useDeferredValue:Sa,useTransition:Sa,useSyncExternalStore:Sa,useId:Sa,useHostTransitionStatus:Sa,useFormState:Sa,useActionState:Sa,useOptimistic:Sa,useMemoCache:Sa,useCacheRefresh:Sa};Ph.useEffectEvent=Sa;var xy={readContext:Wn,use:Uc,useCallback:function(i,u){return Rn().memoizedState=[i,u===void 0?null:u],i},useContext:Wn,useEffect:ty,useImperativeHandle:function(i,u,h){h=h!=null?h.concat([i]):null,zc(4194308,4,sy.bind(null,u,i),h)},useLayoutEffect:function(i,u){return zc(4194308,4,i,u)},useInsertionEffect:function(i,u){zc(4,2,i,u)},useMemo:function(i,u){var h=Rn();u=u===void 0?null:u;var p=i();if(ms){Ce(!0);try{i()}finally{Ce(!1)}}return h.memoizedState=[p,u],p},useReducer:function(i,u,h){var p=Rn();if(h!==void 0){var S=h(u);if(ms){Ce(!0);try{h(u)}finally{Ce(!1)}}}else S=u;return p.memoizedState=p.baseState=S,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:S},p.queue=i,i=i.dispatch=Ck.bind(null,ur,i),[p.memoizedState,i]},useRef:function(i){var u=Rn();return i={current:i},u.memoizedState=i},useState:function(i){i=gl(i);var u=i.queue,h=py.bind(null,ur,u);return u.dispatch=h,[i.memoizedState,h]},useDebugValue:I1,useDeferredValue:function(i,u){var h=Rn();return B1(h,i,u)},useTransition:function(){var i=gl(!1);return i=uy.bind(null,ur,i.queue,!0,!1),Rn().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,u,h){var p=ur,S=Rn();if(Br){if(h===void 0)throw Error(a(407));h=h()}else{if(h=u(),Ta===null)throw Error(a(349));(zr&127)!==0||Po(p,u,h)}S.memoizedState=h;var k={value:h,getSnapshot:u};return S.queue=k,ty(Rh.bind(null,p,k,i),[i]),p.flags|=2048,Gl(9,{destroy:void 0},Oh.bind(null,p,k,h,u),null),h},useId:function(){var i=Rn(),u=Ta.identifierPrefix;if(Br){var h=ni,p=ai;h=(p&~(1<<32-$e(p)-1)).toString(32)+h,u="_"+u+"R_"+h,h=fn++,0<h&&(u+="H"+h.toString(32)),u+="_"}else h=cd++,u="_"+u+"r_"+h.toString(32)+"_";return i.memoizedState=u},useHostTransitionStatus:q1,useFormState:to,useActionState:to,useOptimistic:function(i){var u=Rn();u.memoizedState=u.baseState=i;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=h,u=z1.bind(null,ur,!0,h),h.dispatch=u,[i,u]},useMemoCache:Wl,useCacheRefresh:function(){return Rn().memoizedState=Ak.bind(null,ur)},useEffectEvent:function(i){var u=Rn(),h={impl:i};return u.memoizedState=h,function(){if((ca&2)!==0)throw Error(a(440));return h.impl.apply(void 0,arguments)}}},H1={readContext:Wn,use:Uc,useCallback:oy,useContext:Wn,useEffect:M1,useImperativeHandle:iy,useInsertionEffect:ay,useLayoutEffect:ny,useMemo:ly,useReducer:dd,useRef:_m,useState:function(){return dd(eo)},useDebugValue:I1,useDeferredValue:function(i,u){var h=Va();return cy(h,fr.memoizedState,i,u)},useTransition:function(){var i=dd(eo)[0],u=Va().memoizedState;return[typeof i=="boolean"?i:pl(i),u]},useSyncExternalStore:md,useId:hy,useHostTransitionStatus:q1,useFormState:Mo,useActionState:Mo,useOptimistic:function(i,u){var h=Va();return gm(h,fr,i,u)},useMemoCache:Wl,useCacheRefresh:my};H1.useEffectEvent=ry;var yy={readContext:Wn,use:Uc,useCallback:oy,useContext:Wn,useEffect:M1,useImperativeHandle:iy,useInsertionEffect:ay,useLayoutEffect:ny,useMemo:ly,useReducer:hd,useRef:_m,useState:function(){return hd(eo)},useDebugValue:I1,useDeferredValue:function(i,u){var h=Va();return fr===null?B1(h,i,u):cy(h,fr.memoizedState,i,u)},useTransition:function(){var i=hd(eo)[0],u=Va().memoizedState;return[typeof i=="boolean"?i:pl(i),u]},useSyncExternalStore:md,useId:hy,useHostTransitionStatus:q1,useFormState:vd,useActionState:vd,useOptimistic:function(i,u){var h=Va();return fr!==null?gm(h,fr,i,u):(h.baseState=i,[i,h.queue.dispatch])},useMemoCache:Wl,useCacheRefresh:my};yy.useEffectEvent=ry;function $1(i,u,h,p){u=i.memoizedState,h=h(p,u),h=h==null?u:v({},u,h),i.memoizedState=h,i.lanes===0&&(i.updateQueue.baseState=h)}var W1={enqueueSetState:function(i,u,h){i=i._reactInternals;var p=Ci(),S=vr(p);S.payload=u,h!=null&&(S.callback=h),u=Tr(i,S,p),u!==null&&(fi(u,i,p),oa(u,i,p))},enqueueReplaceState:function(i,u,h){i=i._reactInternals;var p=Ci(),S=vr(p);S.tag=1,S.payload=u,h!=null&&(S.callback=h),u=Tr(i,S,p),u!==null&&(fi(u,i,p),oa(u,i,p))},enqueueForceUpdate:function(i,u){i=i._reactInternals;var h=Ci(),p=vr(h);p.tag=2,u!=null&&(p.callback=u),u=Tr(i,p,h),u!==null&&(fi(u,i,h),oa(u,i,h))}};function _y(i,u,h,p,S,k,Y){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,k,Y):u.prototype&&u.prototype.isPureReactComponent?!Co(h,p)||!Co(S,k):!0}function by(i,u,h,p){i=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(h,p),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(h,p),u.state!==i&&W1.enqueueReplaceState(u,u.state,null)}function Ju(i,u){var h=u;if("ref"in u){h={};for(var p in u)p!=="ref"&&(h[p]=u[p])}if(i=i.defaultProps){h===u&&(h=v({},h));for(var S in i)h[S]===void 0&&(h[S]=i[S])}return h}function wy(i){Uu(i)}function Sy(i){console.error(i)}function Ny(i){Uu(i)}function wm(i,u){try{var h=i.onUncaughtError;h(u.value,{componentStack:u.stack})}catch(p){setTimeout(function(){throw p})}}function jy(i,u,h){try{var p=i.onCaughtError;p(h.value,{componentStack:h.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function V1(i,u,h){return h=vr(h),h.tag=3,h.payload={element:null},h.callback=function(){wm(i,u)},h}function ky(i){return i=vr(i),i.tag=3,i}function Ey(i,u,h,p){var S=h.type.getDerivedStateFromError;if(typeof S=="function"){var k=p.value;i.payload=function(){return S(k)},i.callback=function(){jy(u,h,p)}}var Y=h.stateNode;Y!==null&&typeof Y.componentDidCatch=="function"&&(i.callback=function(){jy(u,h,p),typeof S!="function"&&(Gc===null?Gc=new Set([this]):Gc.add(this));var ce=p.stack;this.componentDidCatch(p.value,{componentStack:ce!==null?ce:""})})}function Tk(i,u,h,p,S){if(h.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(u=h.alternate,u!==null&&fl(u,h,S,!0),h=Ia.current,h!==null){switch(h.tag){case 31:case 13:return Xr===null?Fm():h.alternate===null&&dn===0&&(dn=3),h.flags&=-257,h.flags|=65536,h.lanes=S,p===Me?h.flags|=16384:(u=h.updateQueue,u===null?h.updateQueue=new Set([p]):u.add(p),vg(i,p,S)),!1;case 22:return h.flags|=65536,p===Me?h.flags|=16384:(u=h.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([p])},h.updateQueue=u):(h=u.retryQueue,h===null?u.retryQueue=new Set([p]):h.add(p)),vg(i,p,S)),!1}throw Error(a(435,h.tag))}return vg(i,p,S),Fm(),!1}if(Br)return u=Ia.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=S,p!==ki&&(i=Error(a(422),{cause:p}),Mc(ei(i,h)))):(p!==ki&&(u=Error(a(423),{cause:p}),Mc(ei(u,h))),i=i.current.alternate,i.flags|=65536,S&=-S,i.lanes|=S,p=ei(p,h),S=V1(i.stateNode,p,S),_n(i,S),dn!==4&&(dn=2)),!1;var k=Error(a(520),{cause:p});if(k=ei(k,h),$h===null?$h=[k]:$h.push(k),dn!==4&&(dn=2),u===null)return!0;p=ei(p,h),h=u;do{switch(h.tag){case 3:return h.flags|=65536,i=S&-S,h.lanes|=i,i=V1(h.stateNode,p,i),_n(h,i),!1;case 1:if(u=h.type,k=h.stateNode,(h.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Gc===null||!Gc.has(k))))return h.flags|=65536,S&=-S,h.lanes|=S,S=ky(S),Ey(S,i,h,p),_n(h,S),!1}h=h.return}while(h!==null);return!1}var G1=Error(a(461)),Dn=!1;function ps(i,u,h,p){u.child=i===null?Er(u,null,h,p):Ca(u,i.child,h,p)}function Ay(i,u,h,p,S){h=h.render;var k=u.ref;if("ref"in p){var Y={};for(var ce in p)ce!=="ref"&&(Y[ce]=p[ce])}else Y=p;return dl(u),p=Ah(i,u,h,Y,k,S),ce=Ch(),i!==null&&!Dn?(Th(i,u,S),Yl(i,u,S)):(Br&&ce&&Nh(u),u.flags|=1,ps(i,u,p,S),u.child)}function Cy(i,u,h,p,S){if(i===null){var k=h.type;return typeof k=="function"&&!ed(k)&&k.defaultProps===void 0&&h.compare===null?(u.tag=15,u.type=k,Ty(i,u,k,p,S)):(i=Fc(h.type,null,p,u,u.mode,S),i.ref=u.ref,i.return=u,u.child=i)}if(k=i.child,!tg(i,S)){var Y=k.memoizedProps;if(h=h.compare,h=h!==null?h:Co,h(Y,p)&&i.ref===u.ref)return Yl(i,u,S)}return u.flags|=1,i=Qs(k,p),i.ref=u.ref,i.return=u,u.child=i}function Ty(i,u,h,p,S){if(i!==null){var k=i.memoizedProps;if(Co(k,p)&&i.ref===u.ref)if(Dn=!1,u.pendingProps=p=k,tg(i,S))(i.flags&131072)!==0&&(Dn=!0);else return u.lanes=i.lanes,Yl(i,u,S)}return Y1(i,u,h,p,S)}function Oy(i,u,h,p){var S=p.children,k=i!==null?i.memoizedState:null;if(i===null&&u.stateNode===null&&(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((u.flags&128)!==0){if(k=k!==null?k.baseLanes|h:h,i!==null){for(p=u.child=i.child,S=0;p!==null;)S=S|p.lanes|p.childLanes,p=p.sibling;p=S&~k}else p=0,u.child=null;return Ry(i,u,k,h,p)}if((h&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},i!==null&&be(u,k!==null?k.cachePool:null),k!==null?Ma(u,k):Qr(),cn(u);else return p=u.lanes=536870912,Ry(i,u,k!==null?k.baseLanes|h:h,h,p)}else k!==null?(be(u,k.cachePool),Ma(u,k),un(),u.memoizedState=null):(i!==null&&be(u,null),Qr(),un());return ps(i,u,S,h),u.child}function Mh(i,u){return i!==null&&i.tag===22||u.stateNode!==null||(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.sibling}function Ry(i,u,h,p,S){var k=he();return k=k===null?null:{parent:Za._currentValue,pool:k},u.memoizedState={baseLanes:h,cachePool:k},i!==null&&be(u,null),Qr(),cn(u),i!==null&&fl(i,u,p,!0),u.childLanes=S,null}function Sm(i,u){return u=jm({mode:u.mode,children:u.children},i.mode),u.ref=i.ref,i.child=u,u.return=i,u}function Dy(i,u,h){return Ca(u,i.child,null,h),i=Sm(u,u.pendingProps),i.flags|=2,da(u),u.memoizedState=null,i}function Ok(i,u,h){var p=u.pendingProps,S=(u.flags&128)!==0;if(u.flags&=-129,i===null){if(Br){if(p.mode==="hidden")return i=Sm(u,p),u.lanes=536870912,Mh(null,i);if(la(u),(i=Aa)?(i=W_(i,$a),i=i!==null&&i.data==="&"?i:null,i!==null&&(u.memoizedState={dehydrated:i,treeContext:ol!==null?{id:ai,overflow:ni}:null,retryLane:536870912,hydrationErrors:null},h=td(i),h.return=u,u.child=h,Hn=u,Aa=null)):i=null,i===null)throw ll(u);return u.lanes=536870912,null}return Sm(u,p)}var k=i.memoizedState;if(k!==null){var Y=k.dehydrated;if(la(u),S)if(u.flags&256)u.flags&=-257,u=Dy(i,u,h);else if(u.memoizedState!==null)u.child=i.child,u.flags|=128,u=null;else throw Error(a(558));else if(Dn||fl(i,u,h,!1),S=(h&i.childLanes)!==0,Dn||S){if(p=Ta,p!==null&&(Y=an(p,h),Y!==0&&Y!==k.retryLane))throw k.retryLane=Y,Do(i,Y),fi(p,i,Y),G1;Fm(),u=Dy(i,u,h)}else i=k.treeContext,Aa=ro(Y.nextSibling),Hn=u,Br=!0,hs=null,$a=!1,i!==null&&hm(u,i),u=Sm(u,p),u.flags|=4096;return u}return i=Qs(i.child,{mode:p.mode,children:p.children}),i.ref=u.ref,u.child=i,i.return=u,i}function Nm(i,u){var h=u.ref;if(h===null)i!==null&&i.ref!==null&&(u.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(a(284));(i===null||i.ref!==h)&&(u.flags|=4194816)}}function Y1(i,u,h,p,S){return dl(u),h=Ah(i,u,h,p,void 0,S),p=Ch(),i!==null&&!Dn?(Th(i,u,S),Yl(i,u,S)):(Br&&p&&Nh(u),u.flags|=1,ps(i,u,h,S),u.child)}function Fy(i,u,h,p,S,k){return dl(u),u.updateQueue=null,h=Lo(u,p,h,S),ud(i),p=Ch(),i!==null&&!Dn?(Th(i,u,k),Yl(i,u,k)):(Br&&p&&Nh(u),u.flags|=1,ps(i,u,h,k),u.child)}function Ly(i,u,h,p,S){if(dl(u),u.stateNode===null){var k=zn,Y=h.contextType;typeof Y=="object"&&Y!==null&&(k=Wn(Y)),k=new h(p,k),u.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,k.updater=W1,u.stateNode=k,k._reactInternals=u,k=u.stateNode,k.props=p,k.state=u.memoizedState,k.refs={},zt(u),Y=h.contextType,k.context=typeof Y=="object"&&Y!==null?Wn(Y):zn,k.state=u.memoizedState,Y=h.getDerivedStateFromProps,typeof Y=="function"&&($1(u,h,Y,p),k.state=u.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(Y=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),Y!==k.state&&W1.enqueueReplaceState(k,k.state,null),on(u,p,k,S),wa(),k.state=u.memoizedState),typeof k.componentDidMount=="function"&&(u.flags|=4194308),p=!0}else if(i===null){k=u.stateNode;var ce=u.memoizedProps,Te=Ju(h,ce);k.props=Te;var tt=k.context,dt=h.contextType;Y=zn,typeof dt=="object"&&dt!==null&&(Y=Wn(dt));var xt=h.getDerivedStateFromProps;dt=typeof xt=="function"||typeof k.getSnapshotBeforeUpdate=="function",ce=u.pendingProps!==ce,dt||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(ce||tt!==Y)&&by(u,k,p,Y),Yt=!1;var rt=u.memoizedState;k.state=rt,on(u,p,k,S),wa(),tt=u.memoizedState,ce||rt!==tt||Yt?(typeof xt=="function"&&($1(u,h,xt,p),tt=u.memoizedState),(Te=Yt||_y(u,h,Te,p,rt,tt,Y))?(dt||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(u.flags|=4194308)):(typeof k.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=p,u.memoizedState=tt),k.props=p,k.state=tt,k.context=Y,p=Te):(typeof k.componentDidMount=="function"&&(u.flags|=4194308),p=!1)}else{k=u.stateNode,Pa(i,u),Y=u.memoizedProps,dt=Ju(h,Y),k.props=dt,xt=u.pendingProps,rt=k.context,tt=h.contextType,Te=zn,typeof tt=="object"&&tt!==null&&(Te=Wn(tt)),ce=h.getDerivedStateFromProps,(tt=typeof ce=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(Y!==xt||rt!==Te)&&by(u,k,p,Te),Yt=!1,rt=u.memoizedState,k.state=rt,on(u,p,k,S),wa();var nt=u.memoizedState;Y!==xt||rt!==nt||Yt||i!==null&&i.dependencies!==null&&id(i.dependencies)?(typeof ce=="function"&&($1(u,h,ce,p),nt=u.memoizedState),(dt=Yt||_y(u,h,dt,p,rt,nt,Te)||i!==null&&i.dependencies!==null&&id(i.dependencies))?(tt||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(p,nt,Te),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(p,nt,Te)),typeof k.componentDidUpdate=="function"&&(u.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof k.componentDidUpdate!="function"||Y===i.memoizedProps&&rt===i.memoizedState||(u.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||Y===i.memoizedProps&&rt===i.memoizedState||(u.flags|=1024),u.memoizedProps=p,u.memoizedState=nt),k.props=p,k.state=nt,k.context=Te,p=dt):(typeof k.componentDidUpdate!="function"||Y===i.memoizedProps&&rt===i.memoizedState||(u.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||Y===i.memoizedProps&&rt===i.memoizedState||(u.flags|=1024),p=!1)}return k=p,Nm(i,u),p=(u.flags&128)!==0,k||p?(k=u.stateNode,h=p&&typeof h.getDerivedStateFromError!="function"?null:k.render(),u.flags|=1,i!==null&&p?(u.child=Ca(u,i.child,null,S),u.child=Ca(u,null,h,S)):ps(i,u,h,S),u.memoizedState=k.state,i=u.child):i=Yl(i,u,S),i}function Py(i,u,h,p){return Hl(),u.flags|=256,ps(i,u,h,p),u.child}var X1={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function K1(i){return{baseLanes:i,cachePool:Ee()}}function J1(i,u,h){return i=i!==null?i.childLanes&~h:0,u&&(i|=Ai),i}function My(i,u,h){var p=u.pendingProps,S=!1,k=(u.flags&128)!==0,Y;if((Y=k)||(Y=i!==null&&i.memoizedState===null?!1:(Vr.current&2)!==0),Y&&(S=!0,u.flags&=-129),Y=(u.flags&32)!==0,u.flags&=-33,i===null){if(Br){if(S?Qa(u):un(),(i=Aa)?(i=W_(i,$a),i=i!==null&&i.data!=="&"?i:null,i!==null&&(u.memoizedState={dehydrated:i,treeContext:ol!==null?{id:ai,overflow:ni}:null,retryLane:536870912,hydrationErrors:null},h=td(i),h.return=u,u.child=h,Hn=u,Aa=null)):i=null,i===null)throw ll(u);return Dg(i)?u.lanes=32:u.lanes=536870912,null}var ce=p.children;return p=p.fallback,S?(un(),S=u.mode,ce=jm({mode:"hidden",children:ce},S),p=il(p,S,h,null),ce.return=u,p.return=u,ce.sibling=p,u.child=ce,p=u.child,p.memoizedState=K1(h),p.childLanes=J1(i,Y,h),u.memoizedState=X1,Mh(null,p)):(Qa(u),Z1(u,ce))}var Te=i.memoizedState;if(Te!==null&&(ce=Te.dehydrated,ce!==null)){if(k)u.flags&256?(Qa(u),u.flags&=-257,u=Q1(i,u,h)):u.memoizedState!==null?(un(),u.child=i.child,u.flags|=128,u=null):(un(),ce=p.fallback,S=u.mode,p=jm({mode:"visible",children:p.children},S),ce=il(ce,S,h,null),ce.flags|=2,p.return=u,ce.return=u,p.sibling=ce,u.child=p,Ca(u,i.child,null,h),p=u.child,p.memoizedState=K1(h),p.childLanes=J1(i,Y,h),u.memoizedState=X1,u=Mh(null,p));else if(Qa(u),Dg(ce)){if(Y=ce.nextSibling&&ce.nextSibling.dataset,Y)var tt=Y.dgst;Y=tt,p=Error(a(419)),p.stack="",p.digest=Y,Mc({value:p,source:null,stack:null}),u=Q1(i,u,h)}else if(Dn||fl(i,u,h,!1),Y=(h&i.childLanes)!==0,Dn||Y){if(Y=Ta,Y!==null&&(p=an(Y,h),p!==0&&p!==Te.retryLane))throw Te.retryLane=p,Do(i,p),fi(Y,i,p),G1;Rg(ce)||Fm(),u=Q1(i,u,h)}else Rg(ce)?(u.flags|=192,u.child=i.child,u=null):(i=Te.treeContext,Aa=ro(ce.nextSibling),Hn=u,Br=!0,hs=null,$a=!1,i!==null&&hm(u,i),u=Z1(u,p.children),u.flags|=4096);return u}return S?(un(),ce=p.fallback,S=u.mode,Te=i.child,tt=Te.sibling,p=Qs(Te,{mode:"hidden",children:p.children}),p.subtreeFlags=Te.subtreeFlags&65011712,tt!==null?ce=Qs(tt,ce):(ce=il(ce,S,h,null),ce.flags|=2),ce.return=u,p.return=u,p.sibling=ce,u.child=p,Mh(null,p),p=u.child,ce=i.child.memoizedState,ce===null?ce=K1(h):(S=ce.cachePool,S!==null?(Te=Za._currentValue,S=S.parent!==Te?{parent:Te,pool:Te}:S):S=Ee(),ce={baseLanes:ce.baseLanes|h,cachePool:S}),p.memoizedState=ce,p.childLanes=J1(i,Y,h),u.memoizedState=X1,Mh(i.child,p)):(Qa(u),h=i.child,i=h.sibling,h=Qs(h,{mode:"visible",children:p.children}),h.return=u,h.sibling=null,i!==null&&(Y=u.deletions,Y===null?(u.deletions=[i],u.flags|=16):Y.push(i)),u.child=h,u.memoizedState=null,h)}function Z1(i,u){return u=jm({mode:"visible",children:u},i.mode),u.return=i,i.child=u}function jm(i,u){return i=es(22,i,null,u),i.lanes=0,i}function Q1(i,u,h){return Ca(u,i.child,null,h),i=Z1(u,u.pendingProps.children),i.flags|=2,u.memoizedState=null,i}function Iy(i,u,h){i.lanes|=u;var p=i.alternate;p!==null&&(p.lanes|=u),Ic(i.return,u,h)}function eg(i,u,h,p,S,k){var Y=i.memoizedState;Y===null?i.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:p,tail:h,tailMode:S,treeForkCount:k}:(Y.isBackwards=u,Y.rendering=null,Y.renderingStartTime=0,Y.last=p,Y.tail=h,Y.tailMode=S,Y.treeForkCount=k)}function By(i,u,h){var p=u.pendingProps,S=p.revealOrder,k=p.tail;p=p.children;var Y=Vr.current,ce=(Y&2)!==0;if(ce?(Y=Y&1|2,u.flags|=128):Y&=1,F(Vr,Y),ps(i,u,p,h),p=Br?Vu:0,!ce&&i!==null&&(i.flags&128)!==0)e:for(i=u.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Iy(i,h,u);else if(i.tag===19)Iy(i,h,u);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===u)break e;for(;i.sibling===null;){if(i.return===null||i.return===u)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(S){case"forwards":for(h=u.child,S=null;h!==null;)i=h.alternate,i!==null&&rs(i)===null&&(S=h),h=h.sibling;h=S,h===null?(S=u.child,u.child=null):(S=h.sibling,h.sibling=null),eg(u,!1,S,h,k,p);break;case"backwards":case"unstable_legacy-backwards":for(h=null,S=u.child,u.child=null;S!==null;){if(i=S.alternate,i!==null&&rs(i)===null){u.child=S;break}i=S.sibling,S.sibling=h,h=S,S=i}eg(u,!0,h,null,k,p);break;case"together":eg(u,!1,null,null,void 0,p);break;default:u.memoizedState=null}return u.child}function Yl(i,u,h){if(i!==null&&(u.dependencies=i.dependencies),Vc|=u.lanes,(h&u.childLanes)===0)if(i!==null){if(fl(i,u,h,!1),(h&u.childLanes)===0)return null}else return null;if(i!==null&&u.child!==i.child)throw Error(a(153));if(u.child!==null){for(i=u.child,h=Qs(i,i.pendingProps),u.child=h,h.return=u;i.sibling!==null;)i=i.sibling,h=h.sibling=Qs(i,i.pendingProps),h.return=u;h.sibling=null}return u.child}function tg(i,u){return(i.lanes&u)!==0?!0:(i=i.dependencies,!!(i!==null&&id(i)))}function Rk(i,u,h){switch(u.tag){case 3:pe(u,u.stateNode.containerInfo),ul(u,Za,i.memoizedState.cache),Hl();break;case 27:case 5:_e(u);break;case 4:pe(u,u.stateNode.containerInfo);break;case 10:ul(u,u.type,u.memoizedProps.value);break;case 31:if(u.memoizedState!==null)return u.flags|=128,la(u),null;break;case 13:var p=u.memoizedState;if(p!==null)return p.dehydrated!==null?(Qa(u),u.flags|=128,null):(h&u.child.childLanes)!==0?My(i,u,h):(Qa(u),i=Yl(i,u,h),i!==null?i.sibling:null);Qa(u);break;case 19:var S=(i.flags&128)!==0;if(p=(h&u.childLanes)!==0,p||(fl(i,u,h,!1),p=(h&u.childLanes)!==0),S){if(p)return By(i,u,h);u.flags|=128}if(S=u.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),F(Vr,Vr.current),p)break;return null;case 22:return u.lanes=0,Oy(i,u,h,u.pendingProps);case 24:ul(u,Za,i.memoizedState.cache)}return Yl(i,u,h)}function Uy(i,u,h){if(i!==null)if(i.memoizedProps!==u.pendingProps)Dn=!0;else{if(!tg(i,h)&&(u.flags&128)===0)return Dn=!1,Rk(i,u,h);Dn=(i.flags&131072)!==0}else Dn=!1,Br&&(u.flags&1048576)!==0&&dm(u,Vu,u.index);switch(u.lanes=0,u.tag){case 16:e:{var p=u.pendingProps;if(i=Ge(u.elementType),u.type=i,typeof i=="function")ed(i)?(p=Ju(i,p),u.tag=1,u=Ly(null,u,i,p,h)):(u.tag=0,u=Y1(null,u,i,p,h));else{if(i!=null){var S=i.$$typeof;if(S===T){u.tag=11,u=Ay(null,u,i,p,h);break e}else if(S===B){u.tag=14,u=Cy(null,u,i,p,h);break e}}throw u=V(i)||i,Error(a(306,u,""))}}return u;case 0:return Y1(i,u,u.type,u.pendingProps,h);case 1:return p=u.type,S=Ju(p,u.pendingProps),Ly(i,u,p,S,h);case 3:e:{if(pe(u,u.stateNode.containerInfo),i===null)throw Error(a(387));p=u.pendingProps;var k=u.memoizedState;S=k.element,Pa(i,u),on(u,p,null,h);var Y=u.memoizedState;if(p=Y.cache,ul(u,Za,p),p!==k.cache&&$l(u,[Za],h,!0),wa(),p=Y.element,k.isDehydrated)if(k={element:p,isDehydrated:!1,cache:Y.cache},u.updateQueue.baseState=k,u.memoizedState=k,u.flags&256){u=Py(i,u,p,h);break e}else if(p!==S){S=ei(Error(a(424)),u),Mc(S),u=Py(i,u,p,h);break e}else{switch(i=u.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(Aa=ro(i.firstChild),Hn=u,Br=!0,hs=null,$a=!0,h=Er(u,null,p,h),u.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(Hl(),p===S){u=Yl(i,u,h);break e}ps(i,u,p,h)}u=u.child}return u;case 26:return Nm(i,u),i===null?(h=J_(u.type,null,u.pendingProps,null))?u.memoizedState=h:Br||(h=u.type,i=u.pendingProps,p=qm(ne.current).createElement(h),p[ge]=u,p[we]=i,gs(p,h,i),Jt(p),u.stateNode=p):u.memoizedState=J_(u.type,i.memoizedProps,u.pendingProps,i.memoizedState),null;case 27:return _e(u),i===null&&Br&&(p=u.stateNode=Y_(u.type,u.pendingProps,ne.current),Hn=u,$a=!0,S=Aa,Jc(u.type)?(Fg=S,Aa=ro(p.firstChild)):Aa=S),ps(i,u,u.pendingProps.children,h),Nm(i,u),i===null&&(u.flags|=4194304),u.child;case 5:return i===null&&Br&&((S=p=Aa)&&(p=lE(p,u.type,u.pendingProps,$a),p!==null?(u.stateNode=p,Hn=u,Aa=ro(p.firstChild),$a=!1,S=!0):S=!1),S||ll(u)),_e(u),S=u.type,k=u.pendingProps,Y=i!==null?i.memoizedProps:null,p=k.children,Cg(S,k)?p=null:Y!==null&&Cg(S,Y)&&(u.flags|=32),u.memoizedState!==null&&(S=Ah(i,u,P1,null,null,h),Zh._currentValue=S),Nm(i,u),ps(i,u,p,h),u.child;case 6:return i===null&&Br&&((i=h=Aa)&&(h=cE(h,u.pendingProps,$a),h!==null?(u.stateNode=h,Hn=u,Aa=null,i=!0):i=!1),i||ll(u)),null;case 13:return My(i,u,h);case 4:return pe(u,u.stateNode.containerInfo),p=u.pendingProps,i===null?u.child=Ca(u,null,p,h):ps(i,u,p,h),u.child;case 11:return Ay(i,u,u.type,u.pendingProps,h);case 7:return ps(i,u,u.pendingProps,h),u.child;case 8:return ps(i,u,u.pendingProps.children,h),u.child;case 12:return ps(i,u,u.pendingProps.children,h),u.child;case 10:return p=u.pendingProps,ul(u,u.type,p.value),ps(i,u,p.children,h),u.child;case 9:return S=u.type._context,p=u.pendingProps.children,dl(u),S=Wn(S),p=p(S),u.flags|=1,ps(i,u,p,h),u.child;case 14:return Cy(i,u,u.type,u.pendingProps,h);case 15:return Ty(i,u,u.type,u.pendingProps,h);case 19:return By(i,u,h);case 31:return Ok(i,u,h);case 22:return Oy(i,u,h,u.pendingProps);case 24:return dl(u),p=Wn(Za),i===null?(S=he(),S===null&&(S=Ta,k=Bc(),S.pooledCache=k,k.refCount++,k!==null&&(S.pooledCacheLanes|=h),S=k),u.memoizedState={parent:p,cache:S},zt(u),ul(u,Za,S)):((i.lanes&h)!==0&&(Pa(i,u),on(u,null,null,h),wa()),S=i.memoizedState,k=u.memoizedState,S.parent!==p?(S={parent:p,cache:p},u.memoizedState=S,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=S),ul(u,Za,p)):(p=k.cache,ul(u,Za,p),p!==S.cache&&$l(u,[Za],h,!0))),ps(i,u,u.pendingProps.children,h),u.child;case 29:throw u.pendingProps}throw Error(a(156,u.tag))}function Xl(i){i.flags|=4}function rg(i,u,h,p,S){if((u=(i.mode&32)!==0)&&(u=!1),u){if(i.flags|=16777216,(S&335544128)===S)if(i.stateNode.complete)i.flags|=8192;else if(h_())i.flags|=8192;else throw lt=Me,Ze}else i.flags&=-16777217}function qy(i,u){if(u.type!=="stylesheet"||(u.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!rb(u))if(h_())i.flags|=8192;else throw lt=Me,Ze}function km(i,u){u!==null&&(i.flags|=4),i.flags&16384&&(u=i.tag!==22?Nt():536870912,i.lanes|=u,bd|=u)}function Ih(i,u){if(!Br)switch(i.tailMode){case"hidden":u=i.tail;for(var h=null;u!==null;)u.alternate!==null&&(h=u),u=u.sibling;h===null?i.tail=null:h.sibling=null;break;case"collapsed":h=i.tail;for(var p=null;h!==null;)h.alternate!==null&&(p=h),h=h.sibling;p===null?u||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function Ba(i){var u=i.alternate!==null&&i.alternate.child===i.child,h=0,p=0;if(u)for(var S=i.child;S!==null;)h|=S.lanes|S.childLanes,p|=S.subtreeFlags&65011712,p|=S.flags&65011712,S.return=i,S=S.sibling;else for(S=i.child;S!==null;)h|=S.lanes|S.childLanes,p|=S.subtreeFlags,p|=S.flags,S.return=i,S=S.sibling;return i.subtreeFlags|=p,i.childLanes=h,u}function Dk(i,u,h){var p=u.pendingProps;switch(nd(u),u.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ba(u),null;case 1:return Ba(u),null;case 3:return h=u.stateNode,p=null,i!==null&&(p=i.memoizedState.cache),u.memoizedState.cache!==p&&(u.flags|=2048),si(Za),ye(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(i===null||i.child===null)&&($n(u)?Xl(u):i===null||i.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,kh())),Ba(u),null;case 26:var S=u.type,k=u.memoizedState;return i===null?(Xl(u),k!==null?(Ba(u),qy(u,k)):(Ba(u),rg(u,S,null,p,h))):k?k!==i.memoizedState?(Xl(u),Ba(u),qy(u,k)):(Ba(u),u.flags&=-16777217):(i=i.memoizedProps,i!==p&&Xl(u),Ba(u),rg(u,S,i,p,h)),null;case 27:if(Le(u),h=ne.current,S=u.type,i!==null&&u.stateNode!=null)i.memoizedProps!==p&&Xl(u);else{if(!p){if(u.stateNode===null)throw Error(a(166));return Ba(u),null}i=I.current,$n(u)?jh(u):(i=Y_(S,p,h),u.stateNode=i,Xl(u))}return Ba(u),null;case 5:if(Le(u),S=u.type,i!==null&&u.stateNode!=null)i.memoizedProps!==p&&Xl(u);else{if(!p){if(u.stateNode===null)throw Error(a(166));return Ba(u),null}if(k=I.current,$n(u))jh(u);else{var Y=qm(ne.current);switch(k){case 1:k=Y.createElementNS("http://www.w3.org/2000/svg",S);break;case 2:k=Y.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;default:switch(S){case"svg":k=Y.createElementNS("http://www.w3.org/2000/svg",S);break;case"math":k=Y.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;case"script":k=Y.createElement("div"),k.innerHTML="<script><\/script>",k=k.removeChild(k.firstChild);break;case"select":k=typeof p.is=="string"?Y.createElement("select",{is:p.is}):Y.createElement("select"),p.multiple?k.multiple=!0:p.size&&(k.size=p.size);break;default:k=typeof p.is=="string"?Y.createElement(S,{is:p.is}):Y.createElement(S)}}k[ge]=u,k[we]=p;e:for(Y=u.child;Y!==null;){if(Y.tag===5||Y.tag===6)k.appendChild(Y.stateNode);else if(Y.tag!==4&&Y.tag!==27&&Y.child!==null){Y.child.return=Y,Y=Y.child;continue}if(Y===u)break e;for(;Y.sibling===null;){if(Y.return===null||Y.return===u)break e;Y=Y.return}Y.sibling.return=Y.return,Y=Y.sibling}u.stateNode=k;e:switch(gs(k,S,p),S){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&Xl(u)}}return Ba(u),rg(u,u.type,i===null?null:i.memoizedProps,u.pendingProps,h),null;case 6:if(i&&u.stateNode!=null)i.memoizedProps!==p&&Xl(u);else{if(typeof p!="string"&&u.stateNode===null)throw Error(a(166));if(i=ne.current,$n(u)){if(i=u.stateNode,h=u.memoizedProps,p=null,S=Hn,S!==null)switch(S.tag){case 27:case 5:p=S.memoizedProps}i[ge]=u,i=!!(i.nodeValue===h||p!==null&&p.suppressHydrationWarning===!0||M_(i.nodeValue,h)),i||ll(u,!0)}else i=qm(i).createTextNode(p),i[ge]=u,u.stateNode=i}return Ba(u),null;case 31:if(h=u.memoizedState,i===null||i.memoizedState!==null){if(p=$n(u),h!==null){if(i===null){if(!p)throw Error(a(318));if(i=u.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(557));i[ge]=u}else Hl(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;Ba(u),i=!1}else h=kh(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=h),i=!0;if(!i)return u.flags&256?(da(u),u):(da(u),null);if((u.flags&128)!==0)throw Error(a(558))}return Ba(u),null;case 13:if(p=u.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(S=$n(u),p!==null&&p.dehydrated!==null){if(i===null){if(!S)throw Error(a(318));if(S=u.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(a(317));S[ge]=u}else Hl(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;Ba(u),S=!1}else S=kh(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=S),S=!0;if(!S)return u.flags&256?(da(u),u):(da(u),null)}return da(u),(u.flags&128)!==0?(u.lanes=h,u):(h=p!==null,i=i!==null&&i.memoizedState!==null,h&&(p=u.child,S=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(S=p.alternate.memoizedState.cachePool.pool),k=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(k=p.memoizedState.cachePool.pool),k!==S&&(p.flags|=2048)),h!==i&&h&&(u.child.flags|=8192),km(u,u.updateQueue),Ba(u),null);case 4:return ye(),i===null&&Ng(u.stateNode.containerInfo),Ba(u),null;case 10:return si(u.type),Ba(u),null;case 19:if(j(Vr),p=u.memoizedState,p===null)return Ba(u),null;if(S=(u.flags&128)!==0,k=p.rendering,k===null)if(S)Ih(p,!1);else{if(dn!==0||i!==null&&(i.flags&128)!==0)for(i=u.child;i!==null;){if(k=rs(i),k!==null){for(u.flags|=128,Ih(p,!1),i=k.updateQueue,u.updateQueue=i,km(u,i),u.subtreeFlags=0,i=h,h=u.child;h!==null;)$u(h,i),h=h.sibling;return F(Vr,Vr.current&1|2),Br&&$s(u,p.treeForkCount),u.child}i=i.sibling}p.tail!==null&&Lt()>Om&&(u.flags|=128,S=!0,Ih(p,!1),u.lanes=4194304)}else{if(!S)if(i=rs(k),i!==null){if(u.flags|=128,S=!0,i=i.updateQueue,u.updateQueue=i,km(u,i),Ih(p,!0),p.tail===null&&p.tailMode==="hidden"&&!k.alternate&&!Br)return Ba(u),null}else 2*Lt()-p.renderingStartTime>Om&&h!==536870912&&(u.flags|=128,S=!0,Ih(p,!1),u.lanes=4194304);p.isBackwards?(k.sibling=u.child,u.child=k):(i=p.last,i!==null?i.sibling=k:u.child=k,p.last=k)}return p.tail!==null?(i=p.tail,p.rendering=i,p.tail=i.sibling,p.renderingStartTime=Lt(),i.sibling=null,h=Vr.current,F(Vr,S?h&1|2:h&1),Br&&$s(u,p.treeForkCount),i):(Ba(u),null);case 22:case 23:return da(u),bn(),p=u.memoizedState!==null,i!==null?i.memoizedState!==null!==p&&(u.flags|=8192):p&&(u.flags|=8192),p?(h&536870912)!==0&&(u.flags&128)===0&&(Ba(u),u.subtreeFlags&6&&(u.flags|=8192)):Ba(u),h=u.updateQueue,h!==null&&km(u,h.retryQueue),h=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(h=i.memoizedState.cachePool.pool),p=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(p=u.memoizedState.cachePool.pool),p!==h&&(u.flags|=2048),i!==null&&j(le),null;case 24:return h=null,i!==null&&(h=i.memoizedState.cache),u.memoizedState.cache!==h&&(u.flags|=2048),si(Za),Ba(u),null;case 25:return null;case 30:return null}throw Error(a(156,u.tag))}function Fk(i,u){switch(nd(u),u.tag){case 1:return i=u.flags,i&65536?(u.flags=i&-65537|128,u):null;case 3:return si(Za),ye(),i=u.flags,(i&65536)!==0&&(i&128)===0?(u.flags=i&-65537|128,u):null;case 26:case 27:case 5:return Le(u),null;case 31:if(u.memoizedState!==null){if(da(u),u.alternate===null)throw Error(a(340));Hl()}return i=u.flags,i&65536?(u.flags=i&-65537|128,u):null;case 13:if(da(u),i=u.memoizedState,i!==null&&i.dehydrated!==null){if(u.alternate===null)throw Error(a(340));Hl()}return i=u.flags,i&65536?(u.flags=i&-65537|128,u):null;case 19:return j(Vr),null;case 4:return ye(),null;case 10:return si(u.type),null;case 22:case 23:return da(u),bn(),i!==null&&j(le),i=u.flags,i&65536?(u.flags=i&-65537|128,u):null;case 24:return si(Za),null;case 25:return null;default:return null}}function zy(i,u){switch(nd(u),u.tag){case 3:si(Za),ye();break;case 26:case 27:case 5:Le(u);break;case 4:ye();break;case 31:u.memoizedState!==null&&da(u);break;case 13:da(u);break;case 19:j(Vr);break;case 10:si(u.type);break;case 22:case 23:da(u),bn(),i!==null&&j(le);break;case 24:si(Za)}}function Bh(i,u){try{var h=u.updateQueue,p=h!==null?h.lastEffect:null;if(p!==null){var S=p.next;h=S;do{if((h.tag&i)===i){p=void 0;var k=h.create,Y=h.inst;p=k(),Y.destroy=p}h=h.next}while(h!==S)}}catch(ce){ma(u,u.return,ce)}}function $c(i,u,h){try{var p=u.updateQueue,S=p!==null?p.lastEffect:null;if(S!==null){var k=S.next;p=k;do{if((p.tag&i)===i){var Y=p.inst,ce=Y.destroy;if(ce!==void 0){Y.destroy=void 0,S=u;var Te=h,tt=ce;try{tt()}catch(dt){ma(S,Te,dt)}}}p=p.next}while(p!==k)}}catch(dt){ma(u,u.return,dt)}}function Hy(i){var u=i.updateQueue;if(u!==null){var h=i.stateNode;try{ln(u,h)}catch(p){ma(i,i.return,p)}}}function $y(i,u,h){h.props=Ju(i.type,i.memoizedProps),h.state=i.memoizedState;try{h.componentWillUnmount()}catch(p){ma(i,u,p)}}function Uh(i,u){try{var h=i.ref;if(h!==null){switch(i.tag){case 26:case 27:case 5:var p=i.stateNode;break;case 30:p=i.stateNode;break;default:p=i.stateNode}typeof h=="function"?i.refCleanup=h(p):h.current=p}}catch(S){ma(i,u,S)}}function vl(i,u){var h=i.ref,p=i.refCleanup;if(h!==null)if(typeof p=="function")try{p()}catch(S){ma(i,u,S)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(S){ma(i,u,S)}else h.current=null}function Wy(i){var u=i.type,h=i.memoizedProps,p=i.stateNode;try{e:switch(u){case"button":case"input":case"select":case"textarea":h.autoFocus&&p.focus();break e;case"img":h.src?p.src=h.src:h.srcSet&&(p.srcset=h.srcSet)}}catch(S){ma(i,i.return,S)}}function ag(i,u,h){try{var p=i.stateNode;rE(p,i.type,h,u),p[we]=u}catch(S){ma(i,i.return,S)}}function Vy(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Jc(i.type)||i.tag===4}function ng(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Vy(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Jc(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function sg(i,u,h){var p=i.tag;if(p===5||p===6)i=i.stateNode,u?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(i,u):(u=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,u.appendChild(i),h=h._reactRootContainer,h!=null||u.onclick!==null||(u.onclick=_i));else if(p!==4&&(p===27&&Jc(i.type)&&(h=i.stateNode,u=null),i=i.child,i!==null))for(sg(i,u,h),i=i.sibling;i!==null;)sg(i,u,h),i=i.sibling}function Em(i,u,h){var p=i.tag;if(p===5||p===6)i=i.stateNode,u?h.insertBefore(i,u):h.appendChild(i);else if(p!==4&&(p===27&&Jc(i.type)&&(h=i.stateNode),i=i.child,i!==null))for(Em(i,u,h),i=i.sibling;i!==null;)Em(i,u,h),i=i.sibling}function Gy(i){var u=i.stateNode,h=i.memoizedProps;try{for(var p=i.type,S=u.attributes;S.length;)u.removeAttributeNode(S[0]);gs(u,p,h),u[ge]=i,u[we]=h}catch(k){ma(i,i.return,k)}}var Kl=!1,Fn=!1,ig=!1,Yy=typeof WeakSet=="function"?WeakSet:Set,as=null;function Lk(i,u){if(i=i.containerInfo,Eg=Ym,i=Oo(i),Ji(i)){if("selectionStart"in i)var h={start:i.selectionStart,end:i.selectionEnd};else e:{h=(h=i.ownerDocument)&&h.defaultView||window;var p=h.getSelection&&h.getSelection();if(p&&p.rangeCount!==0){h=p.anchorNode;var S=p.anchorOffset,k=p.focusNode;p=p.focusOffset;try{h.nodeType,k.nodeType}catch{h=null;break e}var Y=0,ce=-1,Te=-1,tt=0,dt=0,xt=i,rt=null;t:for(;;){for(var nt;xt!==h||S!==0&&xt.nodeType!==3||(ce=Y+S),xt!==k||p!==0&&xt.nodeType!==3||(Te=Y+p),xt.nodeType===3&&(Y+=xt.nodeValue.length),(nt=xt.firstChild)!==null;)rt=xt,xt=nt;for(;;){if(xt===i)break t;if(rt===h&&++tt===S&&(ce=Y),rt===k&&++dt===p&&(Te=Y),(nt=xt.nextSibling)!==null)break;xt=rt,rt=xt.parentNode}xt=nt}h=ce===-1||Te===-1?null:{start:ce,end:Te}}else h=null}h=h||{start:0,end:0}}else h=null;for(Ag={focusedElem:i,selectionRange:h},Ym=!1,as=u;as!==null;)if(u=as,i=u.child,(u.subtreeFlags&1028)!==0&&i!==null)i.return=u,as=i;else for(;as!==null;){switch(u=as,k=u.alternate,i=u.flags,u.tag){case 0:if((i&4)!==0&&(i=u.updateQueue,i=i!==null?i.events:null,i!==null))for(h=0;h<i.length;h++)S=i[h],S.ref.impl=S.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&k!==null){i=void 0,h=u,S=k.memoizedProps,k=k.memoizedState,p=h.stateNode;try{var er=Ju(h.type,S);i=p.getSnapshotBeforeUpdate(er,k),p.__reactInternalSnapshotBeforeUpdate=i}catch(xr){ma(h,h.return,xr)}}break;case 3:if((i&1024)!==0){if(i=u.stateNode.containerInfo,h=i.nodeType,h===9)Og(i);else if(h===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Og(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(a(163))}if(i=u.sibling,i!==null){i.return=u.return,as=i;break}as=u.return}}function Xy(i,u,h){var p=h.flags;switch(h.tag){case 0:case 11:case 15:Zl(i,h),p&4&&Bh(5,h);break;case 1:if(Zl(i,h),p&4)if(i=h.stateNode,u===null)try{i.componentDidMount()}catch(Y){ma(h,h.return,Y)}else{var S=Ju(h.type,u.memoizedProps);u=u.memoizedState;try{i.componentDidUpdate(S,u,i.__reactInternalSnapshotBeforeUpdate)}catch(Y){ma(h,h.return,Y)}}p&64&&Hy(h),p&512&&Uh(h,h.return);break;case 3:if(Zl(i,h),p&64&&(i=h.updateQueue,i!==null)){if(u=null,h.child!==null)switch(h.child.tag){case 27:case 5:u=h.child.stateNode;break;case 1:u=h.child.stateNode}try{ln(i,u)}catch(Y){ma(h,h.return,Y)}}break;case 27:u===null&&p&4&&Gy(h);case 26:case 5:Zl(i,h),u===null&&p&4&&Wy(h),p&512&&Uh(h,h.return);break;case 12:Zl(i,h);break;case 31:Zl(i,h),p&4&&Zy(i,h);break;case 13:Zl(i,h),p&4&&Qy(i,h),p&64&&(i=h.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(h=$k.bind(null,h),uE(i,h))));break;case 22:if(p=h.memoizedState!==null||Kl,!p){u=u!==null&&u.memoizedState!==null||Fn,S=Kl;var k=Fn;Kl=p,(Fn=u)&&!k?Ql(i,h,(h.subtreeFlags&8772)!==0):Zl(i,h),Kl=S,Fn=k}break;case 30:break;default:Zl(i,h)}}function Ky(i){var u=i.alternate;u!==null&&(i.alternate=null,Ky(u)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(u=i.stateNode,u!==null&&St(u)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Ga=null,oi=!1;function Jl(i,u,h){for(h=h.child;h!==null;)Jy(i,u,h),h=h.sibling}function Jy(i,u,h){if(Dt&&typeof Dt.onCommitFiberUnmount=="function")try{Dt.onCommitFiberUnmount(Et,h)}catch{}switch(h.tag){case 26:Fn||vl(h,u),Jl(i,u,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:Fn||vl(h,u);var p=Ga,S=oi;Jc(h.type)&&(Ga=h.stateNode,oi=!1),Jl(i,u,h),Xh(h.stateNode),Ga=p,oi=S;break;case 5:Fn||vl(h,u);case 6:if(p=Ga,S=oi,Ga=null,Jl(i,u,h),Ga=p,oi=S,Ga!==null)if(oi)try{(Ga.nodeType===9?Ga.body:Ga.nodeName==="HTML"?Ga.ownerDocument.body:Ga).removeChild(h.stateNode)}catch(k){ma(h,u,k)}else try{Ga.removeChild(h.stateNode)}catch(k){ma(h,u,k)}break;case 18:Ga!==null&&(oi?(i=Ga,H_(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,h.stateNode),Cd(i)):H_(Ga,h.stateNode));break;case 4:p=Ga,S=oi,Ga=h.stateNode.containerInfo,oi=!0,Jl(i,u,h),Ga=p,oi=S;break;case 0:case 11:case 14:case 15:$c(2,h,u),Fn||$c(4,h,u),Jl(i,u,h);break;case 1:Fn||(vl(h,u),p=h.stateNode,typeof p.componentWillUnmount=="function"&&$y(h,u,p)),Jl(i,u,h);break;case 21:Jl(i,u,h);break;case 22:Fn=(p=Fn)||h.memoizedState!==null,Jl(i,u,h),Fn=p;break;default:Jl(i,u,h)}}function Zy(i,u){if(u.memoizedState===null&&(i=u.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Cd(i)}catch(h){ma(u,u.return,h)}}}function Qy(i,u){if(u.memoizedState===null&&(i=u.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Cd(i)}catch(h){ma(u,u.return,h)}}function Pk(i){switch(i.tag){case 31:case 13:case 19:var u=i.stateNode;return u===null&&(u=i.stateNode=new Yy),u;case 22:return i=i.stateNode,u=i._retryCache,u===null&&(u=i._retryCache=new Yy),u;default:throw Error(a(435,i.tag))}}function Am(i,u){var h=Pk(i);u.forEach(function(p){if(!h.has(p)){h.add(p);var S=Wk.bind(null,i,p);p.then(S,S)}})}function li(i,u){var h=u.deletions;if(h!==null)for(var p=0;p<h.length;p++){var S=h[p],k=i,Y=u,ce=Y;e:for(;ce!==null;){switch(ce.tag){case 27:if(Jc(ce.type)){Ga=ce.stateNode,oi=!1;break e}break;case 5:Ga=ce.stateNode,oi=!1;break e;case 3:case 4:Ga=ce.stateNode.containerInfo,oi=!0;break e}ce=ce.return}if(Ga===null)throw Error(a(160));Jy(k,Y,S),Ga=null,oi=!1,k=S.alternate,k!==null&&(k.return=null),S.return=null}if(u.subtreeFlags&13886)for(u=u.child;u!==null;)e_(u,i),u=u.sibling}var Bo=null;function e_(i,u){var h=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:li(u,i),ci(i),p&4&&($c(3,i,i.return),Bh(3,i),$c(5,i,i.return));break;case 1:li(u,i),ci(i),p&512&&(Fn||h===null||vl(h,h.return)),p&64&&Kl&&(i=i.updateQueue,i!==null&&(p=i.callbacks,p!==null&&(h=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=h===null?p:h.concat(p))));break;case 26:var S=Bo;if(li(u,i),ci(i),p&512&&(Fn||h===null||vl(h,h.return)),p&4){var k=h!==null?h.memoizedState:null;if(p=i.memoizedState,h===null)if(p===null)if(i.stateNode===null){e:{p=i.type,h=i.memoizedProps,S=S.ownerDocument||S;t:switch(p){case"title":k=S.getElementsByTagName("title")[0],(!k||k[Qe]||k[ge]||k.namespaceURI==="http://www.w3.org/2000/svg"||k.hasAttribute("itemprop"))&&(k=S.createElement(p),S.head.insertBefore(k,S.querySelector("head > title"))),gs(k,p,h),k[ge]=i,Jt(k),p=k;break e;case"link":var Y=eb("link","href",S).get(p+(h.href||""));if(Y){for(var ce=0;ce<Y.length;ce++)if(k=Y[ce],k.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&k.getAttribute("rel")===(h.rel==null?null:h.rel)&&k.getAttribute("title")===(h.title==null?null:h.title)&&k.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){Y.splice(ce,1);break t}}k=S.createElement(p),gs(k,p,h),S.head.appendChild(k);break;case"meta":if(Y=eb("meta","content",S).get(p+(h.content||""))){for(ce=0;ce<Y.length;ce++)if(k=Y[ce],k.getAttribute("content")===(h.content==null?null:""+h.content)&&k.getAttribute("name")===(h.name==null?null:h.name)&&k.getAttribute("property")===(h.property==null?null:h.property)&&k.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&k.getAttribute("charset")===(h.charSet==null?null:h.charSet)){Y.splice(ce,1);break t}}k=S.createElement(p),gs(k,p,h),S.head.appendChild(k);break;default:throw Error(a(468,p))}k[ge]=i,Jt(k),p=k}i.stateNode=p}else tb(S,i.type,i.stateNode);else i.stateNode=Q_(S,p,i.memoizedProps);else k!==p?(k===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):k.count--,p===null?tb(S,i.type,i.stateNode):Q_(S,p,i.memoizedProps)):p===null&&i.stateNode!==null&&ag(i,i.memoizedProps,h.memoizedProps)}break;case 27:li(u,i),ci(i),p&512&&(Fn||h===null||vl(h,h.return)),h!==null&&p&4&&ag(i,i.memoizedProps,h.memoizedProps);break;case 5:if(li(u,i),ci(i),p&512&&(Fn||h===null||vl(h,h.return)),i.flags&32){S=i.stateNode;try{yi(S,"")}catch(er){ma(i,i.return,er)}}p&4&&i.stateNode!=null&&(S=i.memoizedProps,ag(i,S,h!==null?h.memoizedProps:S)),p&1024&&(ig=!0);break;case 6:if(li(u,i),ci(i),p&4){if(i.stateNode===null)throw Error(a(162));p=i.memoizedProps,h=i.stateNode;try{h.nodeValue=p}catch(er){ma(i,i.return,er)}}break;case 3:if($m=null,S=Bo,Bo=zm(u.containerInfo),li(u,i),Bo=S,ci(i),p&4&&h!==null&&h.memoizedState.isDehydrated)try{Cd(u.containerInfo)}catch(er){ma(i,i.return,er)}ig&&(ig=!1,t_(i));break;case 4:p=Bo,Bo=zm(i.stateNode.containerInfo),li(u,i),ci(i),Bo=p;break;case 12:li(u,i),ci(i);break;case 31:li(u,i),ci(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,Am(i,p)));break;case 13:li(u,i),ci(i),i.child.flags&8192&&i.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(Tm=Lt()),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,Am(i,p)));break;case 22:S=i.memoizedState!==null;var Te=h!==null&&h.memoizedState!==null,tt=Kl,dt=Fn;if(Kl=tt||S,Fn=dt||Te,li(u,i),Fn=dt,Kl=tt,ci(i),p&8192)e:for(u=i.stateNode,u._visibility=S?u._visibility&-2:u._visibility|1,S&&(h===null||Te||Kl||Fn||Zu(i)),h=null,u=i;;){if(u.tag===5||u.tag===26){if(h===null){Te=h=u;try{if(k=Te.stateNode,S)Y=k.style,typeof Y.setProperty=="function"?Y.setProperty("display","none","important"):Y.display="none";else{ce=Te.stateNode;var xt=Te.memoizedProps.style,rt=xt!=null&&xt.hasOwnProperty("display")?xt.display:null;ce.style.display=rt==null||typeof rt=="boolean"?"":(""+rt).trim()}}catch(er){ma(Te,Te.return,er)}}}else if(u.tag===6){if(h===null){Te=u;try{Te.stateNode.nodeValue=S?"":Te.memoizedProps}catch(er){ma(Te,Te.return,er)}}}else if(u.tag===18){if(h===null){Te=u;try{var nt=Te.stateNode;S?$_(nt,!0):$_(Te.stateNode,!1)}catch(er){ma(Te,Te.return,er)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===i)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===i)break e;for(;u.sibling===null;){if(u.return===null||u.return===i)break e;h===u&&(h=null),u=u.return}h===u&&(h=null),u.sibling.return=u.return,u=u.sibling}p&4&&(p=i.updateQueue,p!==null&&(h=p.retryQueue,h!==null&&(p.retryQueue=null,Am(i,h))));break;case 19:li(u,i),ci(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,Am(i,p)));break;case 30:break;case 21:break;default:li(u,i),ci(i)}}function ci(i){var u=i.flags;if(u&2){try{for(var h,p=i.return;p!==null;){if(Vy(p)){h=p;break}p=p.return}if(h==null)throw Error(a(160));switch(h.tag){case 27:var S=h.stateNode,k=ng(i);Em(i,k,S);break;case 5:var Y=h.stateNode;h.flags&32&&(yi(Y,""),h.flags&=-33);var ce=ng(i);Em(i,ce,Y);break;case 3:case 4:var Te=h.stateNode.containerInfo,tt=ng(i);sg(i,tt,Te);break;default:throw Error(a(161))}}catch(dt){ma(i,i.return,dt)}i.flags&=-3}u&4096&&(i.flags&=-4097)}function t_(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var u=i;t_(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),i=i.sibling}}function Zl(i,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)Xy(i,u.alternate,u),u=u.sibling}function Zu(i){for(i=i.child;i!==null;){var u=i;switch(u.tag){case 0:case 11:case 14:case 15:$c(4,u,u.return),Zu(u);break;case 1:vl(u,u.return);var h=u.stateNode;typeof h.componentWillUnmount=="function"&&$y(u,u.return,h),Zu(u);break;case 27:Xh(u.stateNode);case 26:case 5:vl(u,u.return),Zu(u);break;case 22:u.memoizedState===null&&Zu(u);break;case 30:Zu(u);break;default:Zu(u)}i=i.sibling}}function Ql(i,u,h){for(h=h&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var p=u.alternate,S=i,k=u,Y=k.flags;switch(k.tag){case 0:case 11:case 15:Ql(S,k,h),Bh(4,k);break;case 1:if(Ql(S,k,h),p=k,S=p.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(tt){ma(p,p.return,tt)}if(p=k,S=p.updateQueue,S!==null){var ce=p.stateNode;try{var Te=S.shared.hiddenCallbacks;if(Te!==null)for(S.shared.hiddenCallbacks=null,S=0;S<Te.length;S++)ts(Te[S],ce)}catch(tt){ma(p,p.return,tt)}}h&&Y&64&&Hy(k),Uh(k,k.return);break;case 27:Gy(k);case 26:case 5:Ql(S,k,h),h&&p===null&&Y&4&&Wy(k),Uh(k,k.return);break;case 12:Ql(S,k,h);break;case 31:Ql(S,k,h),h&&Y&4&&Zy(S,k);break;case 13:Ql(S,k,h),h&&Y&4&&Qy(S,k);break;case 22:k.memoizedState===null&&Ql(S,k,h),Uh(k,k.return);break;case 30:break;default:Ql(S,k,h)}u=u.sibling}}function og(i,u){var h=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(h=i.memoizedState.cachePool.pool),i=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(i=u.memoizedState.cachePool.pool),i!==h&&(i!=null&&i.refCount++,h!=null&&Gu(h))}function lg(i,u){i=null,u.alternate!==null&&(i=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==i&&(u.refCount++,i!=null&&Gu(i))}function Uo(i,u,h,p){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)r_(i,u,h,p),u=u.sibling}function r_(i,u,h,p){var S=u.flags;switch(u.tag){case 0:case 11:case 15:Uo(i,u,h,p),S&2048&&Bh(9,u);break;case 1:Uo(i,u,h,p);break;case 3:Uo(i,u,h,p),S&2048&&(i=null,u.alternate!==null&&(i=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==i&&(u.refCount++,i!=null&&Gu(i)));break;case 12:if(S&2048){Uo(i,u,h,p),i=u.stateNode;try{var k=u.memoizedProps,Y=k.id,ce=k.onPostCommit;typeof ce=="function"&&ce(Y,u.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(Te){ma(u,u.return,Te)}}else Uo(i,u,h,p);break;case 31:Uo(i,u,h,p);break;case 13:Uo(i,u,h,p);break;case 23:break;case 22:k=u.stateNode,Y=u.alternate,u.memoizedState!==null?k._visibility&2?Uo(i,u,h,p):qh(i,u):k._visibility&2?Uo(i,u,h,p):(k._visibility|=2,xd(i,u,h,p,(u.subtreeFlags&10256)!==0||!1)),S&2048&&og(Y,u);break;case 24:Uo(i,u,h,p),S&2048&&lg(u.alternate,u);break;default:Uo(i,u,h,p)}}function xd(i,u,h,p,S){for(S=S&&((u.subtreeFlags&10256)!==0||!1),u=u.child;u!==null;){var k=i,Y=u,ce=h,Te=p,tt=Y.flags;switch(Y.tag){case 0:case 11:case 15:xd(k,Y,ce,Te,S),Bh(8,Y);break;case 23:break;case 22:var dt=Y.stateNode;Y.memoizedState!==null?dt._visibility&2?xd(k,Y,ce,Te,S):qh(k,Y):(dt._visibility|=2,xd(k,Y,ce,Te,S)),S&&tt&2048&&og(Y.alternate,Y);break;case 24:xd(k,Y,ce,Te,S),S&&tt&2048&&lg(Y.alternate,Y);break;default:xd(k,Y,ce,Te,S)}u=u.sibling}}function qh(i,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var h=i,p=u,S=p.flags;switch(p.tag){case 22:qh(h,p),S&2048&&og(p.alternate,p);break;case 24:qh(h,p),S&2048&&lg(p.alternate,p);break;default:qh(h,p)}u=u.sibling}}var zh=8192;function yd(i,u,h){if(i.subtreeFlags&zh)for(i=i.child;i!==null;)a_(i,u,h),i=i.sibling}function a_(i,u,h){switch(i.tag){case 26:yd(i,u,h),i.flags&zh&&i.memoizedState!==null&&wE(h,Bo,i.memoizedState,i.memoizedProps);break;case 5:yd(i,u,h);break;case 3:case 4:var p=Bo;Bo=zm(i.stateNode.containerInfo),yd(i,u,h),Bo=p;break;case 22:i.memoizedState===null&&(p=i.alternate,p!==null&&p.memoizedState!==null?(p=zh,zh=16777216,yd(i,u,h),zh=p):yd(i,u,h));break;default:yd(i,u,h)}}function n_(i){var u=i.alternate;if(u!==null&&(i=u.child,i!==null)){u.child=null;do u=i.sibling,i.sibling=null,i=u;while(i!==null)}}function Hh(i){var u=i.deletions;if((i.flags&16)!==0){if(u!==null)for(var h=0;h<u.length;h++){var p=u[h];as=p,i_(p,i)}n_(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)s_(i),i=i.sibling}function s_(i){switch(i.tag){case 0:case 11:case 15:Hh(i),i.flags&2048&&$c(9,i,i.return);break;case 3:Hh(i);break;case 12:Hh(i);break;case 22:var u=i.stateNode;i.memoizedState!==null&&u._visibility&2&&(i.return===null||i.return.tag!==13)?(u._visibility&=-3,Cm(i)):Hh(i);break;default:Hh(i)}}function Cm(i){var u=i.deletions;if((i.flags&16)!==0){if(u!==null)for(var h=0;h<u.length;h++){var p=u[h];as=p,i_(p,i)}n_(i)}for(i=i.child;i!==null;){switch(u=i,u.tag){case 0:case 11:case 15:$c(8,u,u.return),Cm(u);break;case 22:h=u.stateNode,h._visibility&2&&(h._visibility&=-3,Cm(u));break;default:Cm(u)}i=i.sibling}}function i_(i,u){for(;as!==null;){var h=as;switch(h.tag){case 0:case 11:case 15:$c(8,h,u);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var p=h.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:Gu(h.memoizedState.cache)}if(p=h.child,p!==null)p.return=h,as=p;else e:for(h=i;as!==null;){p=as;var S=p.sibling,k=p.return;if(Ky(p),p===h){as=null;break e}if(S!==null){S.return=k,as=S;break e}as=k}}}var Mk={getCacheForType:function(i){var u=Wn(Za),h=u.data.get(i);return h===void 0&&(h=i(),u.data.set(i,h)),h},cacheSignal:function(){return Wn(Za).controller.signal}},Ik=typeof WeakMap=="function"?WeakMap:Map,ca=0,Ta=null,Ur=null,zr=0,ha=0,Ei=null,Wc=!1,_d=!1,cg=!1,ec=0,dn=0,Vc=0,Qu=0,ug=0,Ai=0,bd=0,$h=null,ui=null,fg=!1,Tm=0,o_=0,Om=1/0,Rm=null,Gc=null,Gn=0,Yc=null,wd=null,tc=0,dg=0,hg=null,l_=null,Wh=0,mg=null;function Ci(){return(ca&2)!==0&&zr!==0?zr&-zr:X.T!==null?_g():re()}function c_(){if(Ai===0)if((zr&536870912)===0||Br){var i=gt;gt<<=1,(gt&3932160)===0&&(gt=262144),Ai=i}else Ai=536870912;return i=Ia.current,i!==null&&(i.flags|=32),Ai}function fi(i,u,h){(i===Ta&&(ha===2||ha===9)||i.cancelPendingCommit!==null)&&(Sd(i,0),Xc(i,zr,Ai,!1)),rr(i,h),((ca&2)===0||i!==Ta)&&(i===Ta&&((ca&2)===0&&(Qu|=h),dn===4&&Xc(i,zr,Ai,!1)),xl(i))}function u_(i,u,h){if((ca&6)!==0)throw Error(a(327));var p=!h&&(u&127)===0&&(u&i.expiredLanes)===0||sa(i,u),S=p?qk(i,u):gg(i,u,!0),k=p;do{if(S===0){_d&&!p&&Xc(i,u,0,!1);break}else{if(h=i.current.alternate,k&&!Bk(h)){S=gg(i,u,!1),k=!1;continue}if(S===2){if(k=u,i.errorRecoveryDisabledLanes&k)var Y=0;else Y=i.pendingLanes&-536870913,Y=Y!==0?Y:Y&536870912?536870912:0;if(Y!==0){u=Y;e:{var ce=i;S=$h;var Te=ce.current.memoizedState.isDehydrated;if(Te&&(Sd(ce,Y).flags|=256),Y=gg(ce,Y,!1),Y!==2){if(cg&&!Te){ce.errorRecoveryDisabledLanes|=k,Qu|=k,S=4;break e}k=ui,ui=S,k!==null&&(ui===null?ui=k:ui.push.apply(ui,k))}S=Y}if(k=!1,S!==2)continue}}if(S===1){Sd(i,0),Xc(i,u,0,!0);break}e:{switch(p=i,k=S,k){case 0:case 1:throw Error(a(345));case 4:if((u&4194048)!==u)break;case 6:Xc(p,u,Ai,!Wc);break e;case 2:ui=null;break;case 3:case 5:break;default:throw Error(a(329))}if((u&62914560)===u&&(S=Tm+300-Lt(),10<S)){if(Xc(p,u,Ai,!Wc),pr(p,0,!0)!==0)break e;tc=u,p.timeoutHandle=q_(f_.bind(null,p,h,ui,Rm,fg,u,Ai,Qu,bd,Wc,k,"Throttled",-0,0),S);break e}f_(p,h,ui,Rm,fg,u,Ai,Qu,bd,Wc,k,null,-0,0)}}break}while(!0);xl(i)}function f_(i,u,h,p,S,k,Y,ce,Te,tt,dt,xt,rt,nt){if(i.timeoutHandle=-1,xt=u.subtreeFlags,xt&8192||(xt&16785408)===16785408){xt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:_i},a_(u,k,xt);var er=(k&62914560)===k?Tm-Lt():(k&4194048)===k?o_-Lt():0;if(er=SE(xt,er),er!==null){tc=k,i.cancelPendingCommit=er(y_.bind(null,i,u,k,h,p,S,Y,ce,Te,dt,xt,null,rt,nt)),Xc(i,k,Y,!tt);return}}y_(i,u,k,h,p,S,Y,ce,Te)}function Bk(i){for(var u=i;;){var h=u.tag;if((h===0||h===11||h===15)&&u.flags&16384&&(h=u.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var p=0;p<h.length;p++){var S=h[p],k=S.getSnapshot;S=S.value;try{if(!qn(k(),S))return!1}catch{return!1}}if(h=u.child,u.subtreeFlags&16384&&h!==null)h.return=u,u=h;else{if(u===i)break;for(;u.sibling===null;){if(u.return===null||u.return===i)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Xc(i,u,h,p){u&=~ug,u&=~Qu,i.suspendedLanes|=u,i.pingedLanes&=~u,p&&(i.warmLanes|=u),p=i.expirationTimes;for(var S=u;0<S;){var k=31-$e(S),Y=1<<k;p[k]=-1,S&=~Y}h!==0&&vn(i,h,u)}function Dm(){return(ca&6)===0?(Vh(0),!1):!0}function pg(){if(Ur!==null){if(ha===0)var i=Ur.return;else i=Ur,Qi=cl=null,fd(i),yt=null,ar=0,i=Ur;for(;i!==null;)zy(i.alternate,i),i=i.return;Ur=null}}function Sd(i,u){var h=i.timeoutHandle;h!==-1&&(i.timeoutHandle=-1,sE(h)),h=i.cancelPendingCommit,h!==null&&(i.cancelPendingCommit=null,h()),tc=0,pg(),Ta=i,Ur=h=Qs(i.current,null),zr=u,ha=0,Ei=null,Wc=!1,_d=sa(i,u),cg=!1,bd=Ai=ug=Qu=Vc=dn=0,ui=$h=null,fg=!1,(u&8)!==0&&(u|=u&32);var p=i.entangledLanes;if(p!==0)for(i=i.entanglements,p&=u;0<p;){var S=31-$e(p),k=1<<S;u|=i[S],p&=~k}return ec=u,qu(),h}function d_(i,u){ur=null,X.H=Ph,u===De||u===ke?(u=pt(),ha=3):u===Ze?(u=pt(),ha=4):ha=u===G1?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,Ei=u,Ur===null&&(dn=1,wm(i,ei(u,i.current)))}function h_(){var i=Ia.current;return i===null?!0:(zr&4194048)===zr?Xr===null:(zr&62914560)===zr||(zr&536870912)!==0?i===Xr:!1}function m_(){var i=X.H;return X.H=Ph,i===null?Ph:i}function p_(){var i=X.A;return X.A=Mk,i}function Fm(){dn=4,Wc||(zr&4194048)!==zr&&Ia.current!==null||(_d=!0),(Vc&134217727)===0&&(Qu&134217727)===0||Ta===null||Xc(Ta,zr,Ai,!1)}function gg(i,u,h){var p=ca;ca|=2;var S=m_(),k=p_();(Ta!==i||zr!==u)&&(Rm=null,Sd(i,u)),u=!1;var Y=dn;e:do try{if(ha!==0&&Ur!==null){var ce=Ur,Te=Ei;switch(ha){case 8:pg(),Y=6;break e;case 3:case 2:case 9:case 6:Ia.current===null&&(u=!0);var tt=ha;if(ha=0,Ei=null,Nd(i,ce,Te,tt),h&&_d){Y=0;break e}break;default:tt=ha,ha=0,Ei=null,Nd(i,ce,Te,tt)}}Uk(),Y=dn;break}catch(dt){d_(i,dt)}while(!0);return u&&i.shellSuspendCounter++,Qi=cl=null,ca=p,X.H=S,X.A=k,Ur===null&&(Ta=null,zr=0,qu()),Y}function Uk(){for(;Ur!==null;)g_(Ur)}function qk(i,u){var h=ca;ca|=2;var p=m_(),S=p_();Ta!==i||zr!==u?(Rm=null,Om=Lt()+500,Sd(i,u)):_d=sa(i,u);e:do try{if(ha!==0&&Ur!==null){u=Ur;var k=Ei;t:switch(ha){case 1:ha=0,Ei=null,Nd(i,u,k,1);break;case 2:case 9:if(Ve(k)){ha=0,Ei=null,v_(u);break}u=function(){ha!==2&&ha!==9||Ta!==i||(ha=7),xl(i)},k.then(u,u);break e;case 3:ha=7;break e;case 4:ha=5;break e;case 7:Ve(k)?(ha=0,Ei=null,v_(u)):(ha=0,Ei=null,Nd(i,u,k,7));break;case 5:var Y=null;switch(Ur.tag){case 26:Y=Ur.memoizedState;case 5:case 27:var ce=Ur;if(Y?rb(Y):ce.stateNode.complete){ha=0,Ei=null;var Te=ce.sibling;if(Te!==null)Ur=Te;else{var tt=ce.return;tt!==null?(Ur=tt,Lm(tt)):Ur=null}break t}}ha=0,Ei=null,Nd(i,u,k,5);break;case 6:ha=0,Ei=null,Nd(i,u,k,6);break;case 8:pg(),dn=6;break e;default:throw Error(a(462))}}zk();break}catch(dt){d_(i,dt)}while(!0);return Qi=cl=null,X.H=p,X.A=S,ca=h,Ur!==null?0:(Ta=null,zr=0,qu(),dn)}function zk(){for(;Ur!==null&&!ct();)g_(Ur)}function g_(i){var u=Uy(i.alternate,i,ec);i.memoizedProps=i.pendingProps,u===null?Lm(i):Ur=u}function v_(i){var u=i,h=u.alternate;switch(u.tag){case 15:case 0:u=Fy(h,u,u.pendingProps,u.type,void 0,zr);break;case 11:u=Fy(h,u,u.pendingProps,u.type.render,u.ref,zr);break;case 5:fd(u);default:zy(h,u),u=Ur=$u(u,ec),u=Uy(h,u,ec)}i.memoizedProps=i.pendingProps,u===null?Lm(i):Ur=u}function Nd(i,u,h,p){Qi=cl=null,fd(u),yt=null,ar=0;var S=u.return;try{if(Tk(i,S,u,h,zr)){dn=1,wm(i,ei(h,i.current)),Ur=null;return}}catch(k){if(S!==null)throw Ur=S,k;dn=1,wm(i,ei(h,i.current)),Ur=null;return}u.flags&32768?(Br||p===1?i=!0:_d||(zr&536870912)!==0?i=!1:(Wc=i=!0,(p===2||p===9||p===3||p===6)&&(p=Ia.current,p!==null&&p.tag===13&&(p.flags|=16384))),x_(u,i)):Lm(u)}function Lm(i){var u=i;do{if((u.flags&32768)!==0){x_(u,Wc);return}i=u.return;var h=Dk(u.alternate,u,ec);if(h!==null){Ur=h;return}if(u=u.sibling,u!==null){Ur=u;return}Ur=u=i}while(u!==null);dn===0&&(dn=5)}function x_(i,u){do{var h=Fk(i.alternate,i);if(h!==null){h.flags&=32767,Ur=h;return}if(h=i.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!u&&(i=i.sibling,i!==null)){Ur=i;return}Ur=i=h}while(i!==null);dn=6,Ur=null}function y_(i,u,h,p,S,k,Y,ce,Te){i.cancelPendingCommit=null;do Pm();while(Gn!==0);if((ca&6)!==0)throw Error(a(327));if(u!==null){if(u===i.current)throw Error(a(177));if(k=u.lanes|u.childLanes,k|=Jf,ya(i,h,k,Y,ce,Te),i===Ta&&(Ur=Ta=null,zr=0),wd=u,Yc=i,tc=h,dg=k,hg=S,l_=p,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,Vk(Ot,function(){return N_(),null})):(i.callbackNode=null,i.callbackPriority=0),p=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||p){p=X.T,X.T=null,S=Z.p,Z.p=2,Y=ca,ca|=4;try{Lk(i,u,h)}finally{ca=Y,Z.p=S,X.T=p}}Gn=1,__(),b_(),w_()}}function __(){if(Gn===1){Gn=0;var i=Yc,u=wd,h=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||h){h=X.T,X.T=null;var p=Z.p;Z.p=2;var S=ca;ca|=4;try{e_(u,i);var k=Ag,Y=Oo(i.containerInfo),ce=k.focusedElem,Te=k.selectionRange;if(Y!==ce&&ce&&ce.ownerDocument&&To(ce.ownerDocument.documentElement,ce)){if(Te!==null&&Ji(ce)){var tt=Te.start,dt=Te.end;if(dt===void 0&&(dt=tt),"selectionStart"in ce)ce.selectionStart=tt,ce.selectionEnd=Math.min(dt,ce.value.length);else{var xt=ce.ownerDocument||document,rt=xt&&xt.defaultView||window;if(rt.getSelection){var nt=rt.getSelection(),er=ce.textContent.length,xr=Math.min(Te.start,er),ja=Te.end===void 0?xr:Math.min(Te.end,er);!nt.extend&&xr>ja&&(Y=ja,ja=xr,xr=Y);var He=Dc(ce,xr),Fe=Dc(ce,ja);if(He&&Fe&&(nt.rangeCount!==1||nt.anchorNode!==He.node||nt.anchorOffset!==He.offset||nt.focusNode!==Fe.node||nt.focusOffset!==Fe.offset)){var et=xt.createRange();et.setStart(He.node,He.offset),nt.removeAllRanges(),xr>ja?(nt.addRange(et),nt.extend(Fe.node,Fe.offset)):(et.setEnd(Fe.node,Fe.offset),nt.addRange(et))}}}}for(xt=[],nt=ce;nt=nt.parentNode;)nt.nodeType===1&&xt.push({element:nt,left:nt.scrollLeft,top:nt.scrollTop});for(typeof ce.focus=="function"&&ce.focus(),ce=0;ce<xt.length;ce++){var vt=xt[ce];vt.element.scrollLeft=vt.left,vt.element.scrollTop=vt.top}}Ym=!!Eg,Ag=Eg=null}finally{ca=S,Z.p=p,X.T=h}}i.current=u,Gn=2}}function b_(){if(Gn===2){Gn=0;var i=Yc,u=wd,h=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||h){h=X.T,X.T=null;var p=Z.p;Z.p=2;var S=ca;ca|=4;try{Xy(i,u.alternate,u)}finally{ca=S,Z.p=p,X.T=h}}Gn=3}}function w_(){if(Gn===4||Gn===3){Gn=0,jt();var i=Yc,u=wd,h=tc,p=l_;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?Gn=5:(Gn=0,wd=Yc=null,S_(i,i.pendingLanes));var S=i.pendingLanes;if(S===0&&(Gc=null),Kt(h),u=u.stateNode,Dt&&typeof Dt.onCommitFiberRoot=="function")try{Dt.onCommitFiberRoot(Et,u,void 0,(u.current.flags&128)===128)}catch{}if(p!==null){u=X.T,S=Z.p,Z.p=2,X.T=null;try{for(var k=i.onRecoverableError,Y=0;Y<p.length;Y++){var ce=p[Y];k(ce.value,{componentStack:ce.stack})}}finally{X.T=u,Z.p=S}}(tc&3)!==0&&Pm(),xl(i),S=i.pendingLanes,(h&261930)!==0&&(S&42)!==0?i===mg?Wh++:(Wh=0,mg=i):Wh=0,Vh(0)}}function S_(i,u){(i.pooledCacheLanes&=u)===0&&(u=i.pooledCache,u!=null&&(i.pooledCache=null,Gu(u)))}function Pm(){return __(),b_(),w_(),N_()}function N_(){if(Gn!==5)return!1;var i=Yc,u=dg;dg=0;var h=Kt(tc),p=X.T,S=Z.p;try{Z.p=32>h?32:h,X.T=null,h=hg,hg=null;var k=Yc,Y=tc;if(Gn=0,wd=Yc=null,tc=0,(ca&6)!==0)throw Error(a(331));var ce=ca;if(ca|=4,s_(k.current),r_(k,k.current,Y,h),ca=ce,Vh(0,!1),Dt&&typeof Dt.onPostCommitFiberRoot=="function")try{Dt.onPostCommitFiberRoot(Et,k)}catch{}return!0}finally{Z.p=S,X.T=p,S_(i,u)}}function j_(i,u,h){u=ei(h,u),u=V1(i.stateNode,u,2),i=Tr(i,u,2),i!==null&&(rr(i,2),xl(i))}function ma(i,u,h){if(i.tag===3)j_(i,i,h);else for(;u!==null;){if(u.tag===3){j_(u,i,h);break}else if(u.tag===1){var p=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Gc===null||!Gc.has(p))){i=ei(h,i),h=ky(2),p=Tr(u,h,2),p!==null&&(Ey(h,p,u,i),rr(p,2),xl(p));break}}u=u.return}}function vg(i,u,h){var p=i.pingCache;if(p===null){p=i.pingCache=new Ik;var S=new Set;p.set(u,S)}else S=p.get(u),S===void 0&&(S=new Set,p.set(u,S));S.has(h)||(cg=!0,S.add(h),i=Hk.bind(null,i,u,h),u.then(i,i))}function Hk(i,u,h){var p=i.pingCache;p!==null&&p.delete(u),i.pingedLanes|=i.suspendedLanes&h,i.warmLanes&=~h,Ta===i&&(zr&h)===h&&(dn===4||dn===3&&(zr&62914560)===zr&&300>Lt()-Tm?(ca&2)===0&&Sd(i,0):ug|=h,bd===zr&&(bd=0)),xl(i)}function k_(i,u){u===0&&(u=Nt()),i=Do(i,u),i!==null&&(rr(i,u),xl(i))}function $k(i){var u=i.memoizedState,h=0;u!==null&&(h=u.retryLane),k_(i,h)}function Wk(i,u){var h=0;switch(i.tag){case 31:case 13:var p=i.stateNode,S=i.memoizedState;S!==null&&(h=S.retryLane);break;case 19:p=i.stateNode;break;case 22:p=i.stateNode._retryCache;break;default:throw Error(a(314))}p!==null&&p.delete(u),k_(i,h)}function Vk(i,u){return wt(i,u)}var Mm=null,jd=null,xg=!1,Im=!1,yg=!1,Kc=0;function xl(i){i!==jd&&i.next===null&&(jd===null?Mm=jd=i:jd=jd.next=i),Im=!0,xg||(xg=!0,Yk())}function Vh(i,u){if(!yg&&Im){yg=!0;do for(var h=!1,p=Mm;p!==null;){if(i!==0){var S=p.pendingLanes;if(S===0)var k=0;else{var Y=p.suspendedLanes,ce=p.pingedLanes;k=(1<<31-$e(42|i)+1)-1,k&=S&~(Y&~ce),k=k&201326741?k&201326741|1:k?k|2:0}k!==0&&(h=!0,T_(p,k))}else k=zr,k=pr(p,p===Ta?k:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(k&3)===0||sa(p,k)||(h=!0,T_(p,k));p=p.next}while(h);yg=!1}}function Gk(){E_()}function E_(){Im=xg=!1;var i=0;Kc!==0&&nE()&&(i=Kc);for(var u=Lt(),h=null,p=Mm;p!==null;){var S=p.next,k=A_(p,u);k===0?(p.next=null,h===null?Mm=S:h.next=S,S===null&&(jd=h)):(h=p,(i!==0||(k&3)!==0)&&(Im=!0)),p=S}Gn!==0&&Gn!==5||Vh(i),Kc!==0&&(Kc=0)}function A_(i,u){for(var h=i.suspendedLanes,p=i.pingedLanes,S=i.expirationTimes,k=i.pendingLanes&-62914561;0<k;){var Y=31-$e(k),ce=1<<Y,Te=S[Y];Te===-1?((ce&h)===0||(ce&p)!==0)&&(S[Y]=fa(ce,u)):Te<=u&&(i.expiredLanes|=ce),k&=~ce}if(u=Ta,h=zr,h=pr(i,i===u?h:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p=i.callbackNode,h===0||i===u&&(ha===2||ha===9)||i.cancelPendingCommit!==null)return p!==null&&p!==null&&Xe(p),i.callbackNode=null,i.callbackPriority=0;if((h&3)===0||sa(i,h)){if(u=h&-h,u===i.callbackPriority)return u;switch(p!==null&&Xe(p),Kt(h)){case 2:case 8:h=Wt;break;case 32:h=Ot;break;case 268435456:h=qe;break;default:h=Ot}return p=C_.bind(null,i),h=wt(h,p),i.callbackPriority=u,i.callbackNode=h,u}return p!==null&&p!==null&&Xe(p),i.callbackPriority=2,i.callbackNode=null,2}function C_(i,u){if(Gn!==0&&Gn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var h=i.callbackNode;if(Pm()&&i.callbackNode!==h)return null;var p=zr;return p=pr(i,i===Ta?p:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p===0?null:(u_(i,p,u),A_(i,Lt()),i.callbackNode!=null&&i.callbackNode===h?C_.bind(null,i):null)}function T_(i,u){if(Pm())return null;u_(i,u,!0)}function Yk(){iE(function(){(ca&6)!==0?wt($t,Gk):E_()})}function _g(){if(Kc===0){var i=y;i===0&&(i=Ct,Ct<<=1,(Ct&261888)===0&&(Ct=256)),Kc=i}return Kc}function O_(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:bs(""+i)}function R_(i,u){var h=u.ownerDocument.createElement("input");return h.name=u.name,h.value=u.value,i.id&&h.setAttribute("form",i.id),u.parentNode.insertBefore(h,u),i=new FormData(i),h.parentNode.removeChild(h),i}function Xk(i,u,h,p,S){if(u==="submit"&&h&&h.stateNode===S){var k=O_((S[we]||null).action),Y=p.submitter;Y&&(u=(u=Y[we]||null)?O_(u.formAction):Y.getAttribute("formAction"),u!==null&&(k=u,Y=null));var ce=new Ks("action","action",null,p,S);i.push({event:ce,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(Kc!==0){var Te=Y?R_(S,Y):new FormData(S);U1(h,{pending:!0,data:Te,method:S.method,action:k},null,Te)}}else typeof k=="function"&&(ce.preventDefault(),Te=Y?R_(S,Y):new FormData(S),U1(h,{pending:!0,data:Te,method:S.method,action:k},k,Te))},currentTarget:S}]})}}for(var bg=0;bg<Ul.length;bg++){var wg=Ul[bg],Kk=wg.toLowerCase(),Jk=wg[0].toUpperCase()+wg.slice(1);Zs(Kk,"on"+Jk)}Zs(Bl,"onAnimationEnd"),Zs(Bu,"onAnimationIteration"),Zs(bh,"onAnimationStart"),Zs("dblclick","onDoubleClick"),Zs("focusin","onFocus"),Zs("focusout","onBlur"),Zs(cm,"onTransitionRun"),Zs(um,"onTransitionStart"),Zs(fm,"onTransitionCancel"),Zs(wh,"onTransitionEnd"),ls("onMouseEnter",["mouseout","mouseover"]),ls("onMouseLeave",["mouseout","mouseover"]),ls("onPointerEnter",["pointerout","pointerover"]),ls("onPointerLeave",["pointerout","pointerover"]),ua("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ua("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ua("onBeforeInput",["compositionend","keypress","textInput","paste"]),ua("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ua("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ua("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Zk=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Gh));function D_(i,u){u=(u&4)!==0;for(var h=0;h<i.length;h++){var p=i[h],S=p.event;p=p.listeners;e:{var k=void 0;if(u)for(var Y=p.length-1;0<=Y;Y--){var ce=p[Y],Te=ce.instance,tt=ce.currentTarget;if(ce=ce.listener,Te!==k&&S.isPropagationStopped())break e;k=ce,S.currentTarget=tt;try{k(S)}catch(dt){Uu(dt)}S.currentTarget=null,k=Te}else for(Y=0;Y<p.length;Y++){if(ce=p[Y],Te=ce.instance,tt=ce.currentTarget,ce=ce.listener,Te!==k&&S.isPropagationStopped())break e;k=ce,S.currentTarget=tt;try{k(S)}catch(dt){Uu(dt)}S.currentTarget=null,k=Te}}}}function qr(i,u){var h=u[We];h===void 0&&(h=u[We]=new Set);var p=i+"__bubble";h.has(p)||(F_(u,i,2,!1),h.add(p))}function Sg(i,u,h){var p=0;u&&(p|=4),F_(h,i,p,u)}var Bm="_reactListening"+Math.random().toString(36).slice(2);function Ng(i){if(!i[Bm]){i[Bm]=!0,ia.forEach(function(h){h!=="selectionchange"&&(Zk.has(h)||Sg(h,!1,i),Sg(h,!0,i))});var u=i.nodeType===9?i:i.ownerDocument;u===null||u[Bm]||(u[Bm]=!0,Sg("selectionchange",!1,u))}}function F_(i,u,h,p){switch(cb(u)){case 2:var S=kE;break;case 8:S=EE;break;default:S=Bg}h=S.bind(null,u,h,i),S=void 0,!Fu||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(S=!0),p?S!==void 0?i.addEventListener(u,h,{capture:!0,passive:S}):i.addEventListener(u,h,!0):S!==void 0?i.addEventListener(u,h,{passive:S}):i.addEventListener(u,h,!1)}function jg(i,u,h,p,S){var k=p;if((u&1)===0&&(u&2)===0&&p!==null)e:for(;;){if(p===null)return;var Y=p.tag;if(Y===3||Y===4){var ce=p.stateNode.containerInfo;if(ce===S)break;if(Y===4)for(Y=p.return;Y!==null;){var Te=Y.tag;if((Te===3||Te===4)&&Y.stateNode.containerInfo===S)return;Y=Y.return}for(;ce!==null;){if(Y=Ft(ce),Y===null)return;if(Te=Y.tag,Te===5||Te===6||Te===26||Te===27){p=k=Y;continue e}ce=ce.parentNode}}p=p.return}Vf(function(){var tt=k,dt=Rl(h),xt=[];e:{var rt=Sh.get(i);if(rt!==void 0){var nt=Ks,er=i;switch(i){case"keypress":if(Xs(h)===0)break e;case"keydown":case"keyup":nt=$r;break;case"focusin":er="focus",nt=wo;break;case"focusout":er="blur",nt=wo;break;case"beforeblur":case"afterblur":nt=wo;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":nt=Lu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":nt=bo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":nt=yn;break;case Bl:case Bu:case bh:nt=R;break;case wh:nt=Un;break;case"scroll":case"scrollend":nt=kc;break;case"wheel":nt=bi;break;case"copy":case"cut":case"paste":nt=Ae;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":nt=Xa;break;case"toggle":case"beforetoggle":nt=Pu}var xr=(u&4)!==0,ja=!xr&&(i==="scroll"||i==="scrollend"),He=xr?rt!==null?rt+"Capture":null:rt;xr=[];for(var Fe=tt,et;Fe!==null;){var vt=Fe;if(et=vt.stateNode,vt=vt.tag,vt!==5&&vt!==26&&vt!==27||et===null||He===null||(vt=Bs(Fe,He),vt!=null&&xr.push(Yh(Fe,vt,et))),ja)break;Fe=Fe.return}0<xr.length&&(rt=new nt(rt,er,null,h,dt),xt.push({event:rt,listeners:xr}))}}if((u&7)===0){e:{if(rt=i==="mouseover"||i==="pointerover",nt=i==="mouseout"||i==="pointerout",rt&&h!==go&&(er=h.relatedTarget||h.fromElement)&&(Ft(er)||er[je]))break e;if((nt||rt)&&(rt=dt.window===dt?dt:(rt=dt.ownerDocument)?rt.defaultView||rt.parentWindow:window,nt?(er=h.relatedTarget||h.toElement,nt=tt,er=er?Ft(er):null,er!==null&&(ja=s(er),xr=er.tag,er!==ja||xr!==5&&xr!==27&&xr!==6)&&(er=null)):(nt=null,er=tt),nt!==er)){if(xr=Lu,vt="onMouseLeave",He="onMouseEnter",Fe="mouse",(i==="pointerout"||i==="pointerover")&&(xr=Xa,vt="onPointerLeave",He="onPointerEnter",Fe="pointer"),ja=nt==null?rt:Tt(nt),et=er==null?rt:Tt(er),rt=new xr(vt,Fe+"leave",nt,h,dt),rt.target=ja,rt.relatedTarget=et,vt=null,Ft(dt)===tt&&(xr=new xr(He,Fe+"enter",er,h,dt),xr.target=et,xr.relatedTarget=ja,vt=xr),ja=vt,nt&&er)t:{for(xr=Qk,He=nt,Fe=er,et=0,vt=He;vt;vt=xr(vt))et++;vt=0;for(var dr=Fe;dr;dr=xr(dr))vt++;for(;0<et-vt;)He=xr(He),et--;for(;0<vt-et;)Fe=xr(Fe),vt--;for(;et--;){if(He===Fe||Fe!==null&&He===Fe.alternate){xr=He;break t}He=xr(He),Fe=xr(Fe)}xr=null}else xr=null;nt!==null&&L_(xt,rt,nt,xr,!1),er!==null&&ja!==null&&L_(xt,ja,er,xr,!0)}}e:{if(rt=tt?Tt(tt):window,nt=rt.nodeName&&rt.nodeName.toLowerCase(),nt==="select"||nt==="input"&&rt.type==="file")var ra=sl;else if(Mu(rt))if(ws)ra=Xi;else{ra=Ka;var ir=Oc}else nt=rt.nodeName,!nt||nt.toLowerCase()!=="input"||rt.type!=="checkbox"&&rt.type!=="radio"?tt&&Ou(tt.elementType)&&(ra=sl):ra=Kf;if(ra&&(ra=ra(i,tt))){qs(xt,ra,h,dt);break e}ir&&ir(i,rt,tt),i==="focusout"&&tt&&rt.type==="number"&&tt.memoizedProps.value!=null&&Au(rt,"number",rt.value)}switch(ir=tt?Tt(tt):window,i){case"focusin":(Mu(ir)||ir.contentEditable==="true")&&(zs=ir,Ro=tt,Zn=null);break;case"focusout":Zn=Ro=zs=null;break;case"mousedown":Js=!0;break;case"contextmenu":case"mouseup":case"dragend":Js=!1,Zr(xt,h,dt);break;case"selectionchange":if(Il)break;case"keydown":case"keyup":Zr(xt,h,dt)}var Rr;if(Wi)e:{switch(i){case"compositionstart":var Hr="onCompositionStart";break e;case"compositionend":Hr="onCompositionEnd";break e;case"compositionupdate":Hr="onCompositionUpdate";break e}Hr=void 0}else Vi?nl(i,h)&&(Hr="onCompositionEnd"):i==="keydown"&&h.keyCode===229&&(Hr="onCompositionStart");Hr&&(jo&&h.locale!=="ko"&&(Vi||Hr!=="onCompositionStart"?Hr==="onCompositionEnd"&&Vi&&(Rr=Gf()):(Us=dt,Fl="value"in Us?Us.value:Us.textContent,Vi=!0)),ir=Um(tt,Hr),0<ir.length&&(Hr=new ze(Hr,i,null,h,dt),xt.push({event:Hr,listeners:ir}),Rr?Hr.data=Rr:(Rr=Ac(h),Rr!==null&&(Hr.data=Rr)))),(Rr=Ml?fs(i,h):ko(i,h))&&(Hr=Um(tt,"onBeforeInput"),0<Hr.length&&(ir=new ze("onBeforeInput","beforeinput",null,h,dt),xt.push({event:ir,listeners:Hr}),ir.data=Rr)),Xk(xt,i,tt,h,dt)}D_(xt,u)})}function Yh(i,u,h){return{instance:i,listener:u,currentTarget:h}}function Um(i,u){for(var h=u+"Capture",p=[];i!==null;){var S=i,k=S.stateNode;if(S=S.tag,S!==5&&S!==26&&S!==27||k===null||(S=Bs(i,h),S!=null&&p.unshift(Yh(i,S,k)),S=Bs(i,u),S!=null&&p.push(Yh(i,S,k))),i.tag===3)return p;i=i.return}return[]}function Qk(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function L_(i,u,h,p,S){for(var k=u._reactName,Y=[];h!==null&&h!==p;){var ce=h,Te=ce.alternate,tt=ce.stateNode;if(ce=ce.tag,Te!==null&&Te===p)break;ce!==5&&ce!==26&&ce!==27||tt===null||(Te=tt,S?(tt=Bs(h,k),tt!=null&&Y.unshift(Yh(h,tt,Te))):S||(tt=Bs(h,k),tt!=null&&Y.push(Yh(h,tt,Te)))),h=h.return}Y.length!==0&&i.push({event:u,listeners:Y})}var eE=/\r\n?/g,tE=/\u0000|\uFFFD/g;function P_(i){return(typeof i=="string"?i:""+i).replace(eE,`
`).replace(tE,"")}function M_(i,u){return u=P_(u),P_(i)===u}function Na(i,u,h,p,S,k){switch(h){case"children":typeof p=="string"?u==="body"||u==="textarea"&&p===""||yi(i,p):(typeof p=="number"||typeof p=="bigint")&&u!=="body"&&yi(i,""+p);break;case"className":po(i,"class",p);break;case"tabIndex":po(i,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":po(i,h,p);break;case"style":Hf(i,p,k);break;case"data":if(u!=="object"){po(i,"data",p);break}case"src":case"href":if(p===""&&(u!=="a"||h!=="href")){i.removeAttribute(h);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(h);break}p=bs(""+p),i.setAttribute(h,p);break;case"action":case"formAction":if(typeof p=="function"){i.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof k=="function"&&(h==="formAction"?(u!=="input"&&Na(i,u,"name",S.name,S,null),Na(i,u,"formEncType",S.formEncType,S,null),Na(i,u,"formMethod",S.formMethod,S,null),Na(i,u,"formTarget",S.formTarget,S,null)):(Na(i,u,"encType",S.encType,S,null),Na(i,u,"method",S.method,S,null),Na(i,u,"target",S.target,S,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(h);break}p=bs(""+p),i.setAttribute(h,p);break;case"onClick":p!=null&&(i.onclick=_i);break;case"onScroll":p!=null&&qr("scroll",i);break;case"onScrollEnd":p!=null&&qr("scrollend",i);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(a(61));if(h=p.__html,h!=null){if(S.children!=null)throw Error(a(60));i.innerHTML=h}}break;case"multiple":i.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":i.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){i.removeAttribute("xlink:href");break}h=bs(""+p),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(h,""+p):i.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(h,""):i.removeAttribute(h);break;case"capture":case"download":p===!0?i.setAttribute(h,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(h,p):i.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?i.setAttribute(h,p):i.removeAttribute(h);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?i.removeAttribute(h):i.setAttribute(h,p);break;case"popover":qr("beforetoggle",i),qr("toggle",i),Fa(i,"popover",p);break;case"xlinkActuate":xi(i,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":xi(i,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":xi(i,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":xi(i,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":xi(i,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":xi(i,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":xi(i,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":xi(i,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":xi(i,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Fa(i,"is",p);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=Ru.get(h)||h,Fa(i,h,p))}}function kg(i,u,h,p,S,k){switch(h){case"style":Hf(i,p,k);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(a(61));if(h=p.__html,h!=null){if(S.children!=null)throw Error(a(60));i.innerHTML=h}}break;case"children":typeof p=="string"?yi(i,p):(typeof p=="number"||typeof p=="bigint")&&yi(i,""+p);break;case"onScroll":p!=null&&qr("scroll",i);break;case"onScrollEnd":p!=null&&qr("scrollend",i);break;case"onClick":p!=null&&(i.onclick=_i);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Lr.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(S=h.endsWith("Capture"),u=h.slice(2,S?h.length-7:void 0),k=i[we]||null,k=k!=null?k[h]:null,typeof k=="function"&&i.removeEventListener(u,k,S),typeof p=="function")){typeof k!="function"&&k!==null&&(h in i?i[h]=null:i.hasAttribute(h)&&i.removeAttribute(h)),i.addEventListener(u,p,S);break e}h in i?i[h]=p:p===!0?i.setAttribute(h,""):Fa(i,h,p)}}}function gs(i,u,h){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":qr("error",i),qr("load",i);var p=!1,S=!1,k;for(k in h)if(h.hasOwnProperty(k)){var Y=h[k];if(Y!=null)switch(k){case"src":p=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,u));default:Na(i,u,k,Y,h,null)}}S&&Na(i,u,"srcSet",h.srcSet,h,null),p&&Na(i,u,"src",h.src,h,null);return;case"input":qr("invalid",i);var ce=k=Y=S=null,Te=null,tt=null;for(p in h)if(h.hasOwnProperty(p)){var dt=h[p];if(dt!=null)switch(p){case"name":S=dt;break;case"type":Y=dt;break;case"checked":Te=dt;break;case"defaultChecked":tt=dt;break;case"value":k=dt;break;case"defaultValue":ce=dt;break;case"children":case"dangerouslySetInnerHTML":if(dt!=null)throw Error(a(137,u));break;default:Na(i,u,p,dt,h,null)}}qf(i,k,ce,Te,tt,Y,S,!1);return;case"select":qr("invalid",i),p=Y=k=null;for(S in h)if(h.hasOwnProperty(S)&&(ce=h[S],ce!=null))switch(S){case"value":k=ce;break;case"defaultValue":Y=ce;break;case"multiple":p=ce;default:Na(i,u,S,ce,h,null)}u=k,h=Y,i.multiple=!!p,u!=null?us(i,!!p,u,!1):h!=null&&us(i,!!p,h,!0);return;case"textarea":qr("invalid",i),k=S=p=null;for(Y in h)if(h.hasOwnProperty(Y)&&(ce=h[Y],ce!=null))switch(Y){case"value":p=ce;break;case"defaultValue":S=ce;break;case"children":k=ce;break;case"dangerouslySetInnerHTML":if(ce!=null)throw Error(a(91));break;default:Na(i,u,Y,ce,h,null)}Tu(i,p,S,k);return;case"option":for(Te in h)if(h.hasOwnProperty(Te)&&(p=h[Te],p!=null))switch(Te){case"selected":i.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:Na(i,u,Te,p,h,null)}return;case"dialog":qr("beforetoggle",i),qr("toggle",i),qr("cancel",i),qr("close",i);break;case"iframe":case"object":qr("load",i);break;case"video":case"audio":for(p=0;p<Gh.length;p++)qr(Gh[p],i);break;case"image":qr("error",i),qr("load",i);break;case"details":qr("toggle",i);break;case"embed":case"source":case"link":qr("error",i),qr("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(tt in h)if(h.hasOwnProperty(tt)&&(p=h[tt],p!=null))switch(tt){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,u));default:Na(i,u,tt,p,h,null)}return;default:if(Ou(u)){for(dt in h)h.hasOwnProperty(dt)&&(p=h[dt],p!==void 0&&kg(i,u,dt,p,h,void 0));return}}for(ce in h)h.hasOwnProperty(ce)&&(p=h[ce],p!=null&&Na(i,u,ce,p,h,null))}function rE(i,u,h,p){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,k=null,Y=null,ce=null,Te=null,tt=null,dt=null;for(nt in h){var xt=h[nt];if(h.hasOwnProperty(nt)&&xt!=null)switch(nt){case"checked":break;case"value":break;case"defaultValue":Te=xt;default:p.hasOwnProperty(nt)||Na(i,u,nt,null,p,xt)}}for(var rt in p){var nt=p[rt];if(xt=h[rt],p.hasOwnProperty(rt)&&(nt!=null||xt!=null))switch(rt){case"type":k=nt;break;case"name":S=nt;break;case"checked":tt=nt;break;case"defaultChecked":dt=nt;break;case"value":Y=nt;break;case"defaultValue":ce=nt;break;case"children":case"dangerouslySetInnerHTML":if(nt!=null)throw Error(a(137,u));break;default:nt!==xt&&Na(i,u,rt,nt,p,xt)}}Sc(i,Y,ce,Te,tt,dt,k,S);return;case"select":nt=Y=ce=rt=null;for(k in h)if(Te=h[k],h.hasOwnProperty(k)&&Te!=null)switch(k){case"value":break;case"multiple":nt=Te;default:p.hasOwnProperty(k)||Na(i,u,k,null,p,Te)}for(S in p)if(k=p[S],Te=h[S],p.hasOwnProperty(S)&&(k!=null||Te!=null))switch(S){case"value":rt=k;break;case"defaultValue":ce=k;break;case"multiple":Y=k;default:k!==Te&&Na(i,u,S,k,p,Te)}u=ce,h=Y,p=nt,rt!=null?us(i,!!h,rt,!1):!!p!=!!h&&(u!=null?us(i,!!h,u,!0):us(i,!!h,h?[]:"",!1));return;case"textarea":nt=rt=null;for(ce in h)if(S=h[ce],h.hasOwnProperty(ce)&&S!=null&&!p.hasOwnProperty(ce))switch(ce){case"value":break;case"children":break;default:Na(i,u,ce,null,p,S)}for(Y in p)if(S=p[Y],k=h[Y],p.hasOwnProperty(Y)&&(S!=null||k!=null))switch(Y){case"value":rt=S;break;case"defaultValue":nt=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(a(91));break;default:S!==k&&Na(i,u,Y,S,p,k)}Cu(i,rt,nt);return;case"option":for(var er in h)if(rt=h[er],h.hasOwnProperty(er)&&rt!=null&&!p.hasOwnProperty(er))switch(er){case"selected":i.selected=!1;break;default:Na(i,u,er,null,p,rt)}for(Te in p)if(rt=p[Te],nt=h[Te],p.hasOwnProperty(Te)&&rt!==nt&&(rt!=null||nt!=null))switch(Te){case"selected":i.selected=rt&&typeof rt!="function"&&typeof rt!="symbol";break;default:Na(i,u,Te,rt,p,nt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var xr in h)rt=h[xr],h.hasOwnProperty(xr)&&rt!=null&&!p.hasOwnProperty(xr)&&Na(i,u,xr,null,p,rt);for(tt in p)if(rt=p[tt],nt=h[tt],p.hasOwnProperty(tt)&&rt!==nt&&(rt!=null||nt!=null))switch(tt){case"children":case"dangerouslySetInnerHTML":if(rt!=null)throw Error(a(137,u));break;default:Na(i,u,tt,rt,p,nt)}return;default:if(Ou(u)){for(var ja in h)rt=h[ja],h.hasOwnProperty(ja)&&rt!==void 0&&!p.hasOwnProperty(ja)&&kg(i,u,ja,void 0,p,rt);for(dt in p)rt=p[dt],nt=h[dt],!p.hasOwnProperty(dt)||rt===nt||rt===void 0&&nt===void 0||kg(i,u,dt,rt,p,nt);return}}for(var He in h)rt=h[He],h.hasOwnProperty(He)&&rt!=null&&!p.hasOwnProperty(He)&&Na(i,u,He,null,p,rt);for(xt in p)rt=p[xt],nt=h[xt],!p.hasOwnProperty(xt)||rt===nt||rt==null&&nt==null||Na(i,u,xt,rt,p,nt)}function I_(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function aE(){if(typeof performance.getEntriesByType=="function"){for(var i=0,u=0,h=performance.getEntriesByType("resource"),p=0;p<h.length;p++){var S=h[p],k=S.transferSize,Y=S.initiatorType,ce=S.duration;if(k&&ce&&I_(Y)){for(Y=0,ce=S.responseEnd,p+=1;p<h.length;p++){var Te=h[p],tt=Te.startTime;if(tt>ce)break;var dt=Te.transferSize,xt=Te.initiatorType;dt&&I_(xt)&&(Te=Te.responseEnd,Y+=dt*(Te<ce?1:(ce-tt)/(Te-tt)))}if(--p,u+=8*(k+Y)/(S.duration/1e3),i++,10<i)break}}if(0<i)return u/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var Eg=null,Ag=null;function qm(i){return i.nodeType===9?i:i.ownerDocument}function B_(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function U_(i,u){if(i===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&u==="foreignObject"?0:i}function Cg(i,u){return i==="textarea"||i==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var Tg=null;function nE(){var i=window.event;return i&&i.type==="popstate"?i===Tg?!1:(Tg=i,!0):(Tg=null,!1)}var q_=typeof setTimeout=="function"?setTimeout:void 0,sE=typeof clearTimeout=="function"?clearTimeout:void 0,z_=typeof Promise=="function"?Promise:void 0,iE=typeof queueMicrotask=="function"?queueMicrotask:typeof z_<"u"?function(i){return z_.resolve(null).then(i).catch(oE)}:q_;function oE(i){setTimeout(function(){throw i})}function Jc(i){return i==="head"}function H_(i,u){var h=u,p=0;do{var S=h.nextSibling;if(i.removeChild(h),S&&S.nodeType===8)if(h=S.data,h==="/$"||h==="/&"){if(p===0){i.removeChild(S),Cd(u);return}p--}else if(h==="$"||h==="$?"||h==="$~"||h==="$!"||h==="&")p++;else if(h==="html")Xh(i.ownerDocument.documentElement);else if(h==="head"){h=i.ownerDocument.head,Xh(h);for(var k=h.firstChild;k;){var Y=k.nextSibling,ce=k.nodeName;k[Qe]||ce==="SCRIPT"||ce==="STYLE"||ce==="LINK"&&k.rel.toLowerCase()==="stylesheet"||h.removeChild(k),k=Y}}else h==="body"&&Xh(i.ownerDocument.body);h=S}while(h);Cd(u)}function $_(i,u){var h=i;i=0;do{var p=h.nextSibling;if(h.nodeType===1?u?(h._stashedDisplay=h.style.display,h.style.display="none"):(h.style.display=h._stashedDisplay||"",h.getAttribute("style")===""&&h.removeAttribute("style")):h.nodeType===3&&(u?(h._stashedText=h.nodeValue,h.nodeValue=""):h.nodeValue=h._stashedText||""),p&&p.nodeType===8)if(h=p.data,h==="/$"){if(i===0)break;i--}else h!=="$"&&h!=="$?"&&h!=="$~"&&h!=="$!"||i++;h=p}while(h)}function Og(i){var u=i.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var h=u;switch(u=u.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":Og(h),St(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}i.removeChild(h)}}function lE(i,u,h,p){for(;i.nodeType===1;){var S=h;if(i.nodeName.toLowerCase()!==u.toLowerCase()){if(!p&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(p){if(!i[Qe])switch(u){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(k=i.getAttribute("rel"),k==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(k!==S.rel||i.getAttribute("href")!==(S.href==null||S.href===""?null:S.href)||i.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||i.getAttribute("title")!==(S.title==null?null:S.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(k=i.getAttribute("src"),(k!==(S.src==null?null:S.src)||i.getAttribute("type")!==(S.type==null?null:S.type)||i.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&k&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(u==="input"&&i.type==="hidden"){var k=S.name==null?null:""+S.name;if(S.type==="hidden"&&i.getAttribute("name")===k)return i}else return i;if(i=ro(i.nextSibling),i===null)break}return null}function cE(i,u,h){if(u==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!h||(i=ro(i.nextSibling),i===null))return null;return i}function W_(i,u){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!u||(i=ro(i.nextSibling),i===null))return null;return i}function Rg(i){return i.data==="$?"||i.data==="$~"}function Dg(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function uE(i,u){var h=i.ownerDocument;if(i.data==="$~")i._reactRetry=u;else if(i.data!=="$?"||h.readyState!=="loading")u();else{var p=function(){u(),h.removeEventListener("DOMContentLoaded",p)};h.addEventListener("DOMContentLoaded",p),i._reactRetry=p}}function ro(i){for(;i!=null;i=i.nextSibling){var u=i.nodeType;if(u===1||u===3)break;if(u===8){if(u=i.data,u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"||u==="F!"||u==="F")break;if(u==="/$"||u==="/&")return null}}return i}var Fg=null;function V_(i){i=i.nextSibling;for(var u=0;i;){if(i.nodeType===8){var h=i.data;if(h==="/$"||h==="/&"){if(u===0)return ro(i.nextSibling);u--}else h!=="$"&&h!=="$!"&&h!=="$?"&&h!=="$~"&&h!=="&"||u++}i=i.nextSibling}return null}function G_(i){i=i.previousSibling;for(var u=0;i;){if(i.nodeType===8){var h=i.data;if(h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"){if(u===0)return i;u--}else h!=="/$"&&h!=="/&"||u++}i=i.previousSibling}return null}function Y_(i,u,h){switch(u=qm(h),i){case"html":if(i=u.documentElement,!i)throw Error(a(452));return i;case"head":if(i=u.head,!i)throw Error(a(453));return i;case"body":if(i=u.body,!i)throw Error(a(454));return i;default:throw Error(a(451))}}function Xh(i){for(var u=i.attributes;u.length;)i.removeAttributeNode(u[0]);St(i)}var ao=new Map,X_=new Set;function zm(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var rc=Z.d;Z.d={f:fE,r:dE,D:hE,C:mE,L:pE,m:gE,X:xE,S:vE,M:yE};function fE(){var i=rc.f(),u=Dm();return i||u}function dE(i){var u=Ht(i);u!==null&&u.tag===5&&u.type==="form"?dy(u):rc.r(i)}var kd=typeof document>"u"?null:document;function K_(i,u,h){var p=kd;if(p&&typeof u=="string"&&u){var S=nn(u);S='link[rel="'+i+'"][href="'+S+'"]',typeof h=="string"&&(S+='[crossorigin="'+h+'"]'),X_.has(S)||(X_.add(S),i={rel:i,crossOrigin:h,href:u},p.querySelector(S)===null&&(u=p.createElement("link"),gs(u,"link",i),Jt(u),p.head.appendChild(u)))}}function hE(i){rc.D(i),K_("dns-prefetch",i,null)}function mE(i,u){rc.C(i,u),K_("preconnect",i,u)}function pE(i,u,h){rc.L(i,u,h);var p=kd;if(p&&i&&u){var S='link[rel="preload"][as="'+nn(u)+'"]';u==="image"&&h&&h.imageSrcSet?(S+='[imagesrcset="'+nn(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(S+='[imagesizes="'+nn(h.imageSizes)+'"]')):S+='[href="'+nn(i)+'"]';var k=S;switch(u){case"style":k=Ed(i);break;case"script":k=Ad(i)}ao.has(k)||(i=v({rel:"preload",href:u==="image"&&h&&h.imageSrcSet?void 0:i,as:u},h),ao.set(k,i),p.querySelector(S)!==null||u==="style"&&p.querySelector(Kh(k))||u==="script"&&p.querySelector(Jh(k))||(u=p.createElement("link"),gs(u,"link",i),Jt(u),p.head.appendChild(u)))}}function gE(i,u){rc.m(i,u);var h=kd;if(h&&i){var p=u&&typeof u.as=="string"?u.as:"script",S='link[rel="modulepreload"][as="'+nn(p)+'"][href="'+nn(i)+'"]',k=S;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":k=Ad(i)}if(!ao.has(k)&&(i=v({rel:"modulepreload",href:i},u),ao.set(k,i),h.querySelector(S)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Jh(k)))return}p=h.createElement("link"),gs(p,"link",i),Jt(p),h.head.appendChild(p)}}}function vE(i,u,h){rc.S(i,u,h);var p=kd;if(p&&i){var S=Bt(p).hoistableStyles,k=Ed(i);u=u||"default";var Y=S.get(k);if(!Y){var ce={loading:0,preload:null};if(Y=p.querySelector(Kh(k)))ce.loading=5;else{i=v({rel:"stylesheet",href:i,"data-precedence":u},h),(h=ao.get(k))&&Lg(i,h);var Te=Y=p.createElement("link");Jt(Te),gs(Te,"link",i),Te._p=new Promise(function(tt,dt){Te.onload=tt,Te.onerror=dt}),Te.addEventListener("load",function(){ce.loading|=1}),Te.addEventListener("error",function(){ce.loading|=2}),ce.loading|=4,Hm(Y,u,p)}Y={type:"stylesheet",instance:Y,count:1,state:ce},S.set(k,Y)}}}function xE(i,u){rc.X(i,u);var h=kd;if(h&&i){var p=Bt(h).hoistableScripts,S=Ad(i),k=p.get(S);k||(k=h.querySelector(Jh(S)),k||(i=v({src:i,async:!0},u),(u=ao.get(S))&&Pg(i,u),k=h.createElement("script"),Jt(k),gs(k,"link",i),h.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},p.set(S,k))}}function yE(i,u){rc.M(i,u);var h=kd;if(h&&i){var p=Bt(h).hoistableScripts,S=Ad(i),k=p.get(S);k||(k=h.querySelector(Jh(S)),k||(i=v({src:i,async:!0,type:"module"},u),(u=ao.get(S))&&Pg(i,u),k=h.createElement("script"),Jt(k),gs(k,"link",i),h.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},p.set(S,k))}}function J_(i,u,h,p){var S=(S=ne.current)?zm(S):null;if(!S)throw Error(a(446));switch(i){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(u=Ed(h.href),h=Bt(S).hoistableStyles,p=h.get(u),p||(p={type:"style",instance:null,count:0,state:null},h.set(u,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){i=Ed(h.href);var k=Bt(S).hoistableStyles,Y=k.get(i);if(Y||(S=S.ownerDocument||S,Y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},k.set(i,Y),(k=S.querySelector(Kh(i)))&&!k._p&&(Y.instance=k,Y.state.loading=5),ao.has(i)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},ao.set(i,h),k||_E(S,i,h,Y.state))),u&&p===null)throw Error(a(528,""));return Y}if(u&&p!==null)throw Error(a(529,""));return null;case"script":return u=h.async,h=h.src,typeof h=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=Ad(h),h=Bt(S).hoistableScripts,p=h.get(u),p||(p={type:"script",instance:null,count:0,state:null},h.set(u,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,i))}}function Ed(i){return'href="'+nn(i)+'"'}function Kh(i){return'link[rel="stylesheet"]['+i+"]"}function Z_(i){return v({},i,{"data-precedence":i.precedence,precedence:null})}function _E(i,u,h,p){i.querySelector('link[rel="preload"][as="style"]['+u+"]")?p.loading=1:(u=i.createElement("link"),p.preload=u,u.addEventListener("load",function(){return p.loading|=1}),u.addEventListener("error",function(){return p.loading|=2}),gs(u,"link",h),Jt(u),i.head.appendChild(u))}function Ad(i){return'[src="'+nn(i)+'"]'}function Jh(i){return"script[async]"+i}function Q_(i,u,h){if(u.count++,u.instance===null)switch(u.type){case"style":var p=i.querySelector('style[data-href~="'+nn(h.href)+'"]');if(p)return u.instance=p,Jt(p),p;var S=v({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return p=(i.ownerDocument||i).createElement("style"),Jt(p),gs(p,"style",S),Hm(p,h.precedence,i),u.instance=p;case"stylesheet":S=Ed(h.href);var k=i.querySelector(Kh(S));if(k)return u.state.loading|=4,u.instance=k,Jt(k),k;p=Z_(h),(S=ao.get(S))&&Lg(p,S),k=(i.ownerDocument||i).createElement("link"),Jt(k);var Y=k;return Y._p=new Promise(function(ce,Te){Y.onload=ce,Y.onerror=Te}),gs(k,"link",p),u.state.loading|=4,Hm(k,h.precedence,i),u.instance=k;case"script":return k=Ad(h.src),(S=i.querySelector(Jh(k)))?(u.instance=S,Jt(S),S):(p=h,(S=ao.get(k))&&(p=v({},h),Pg(p,S)),i=i.ownerDocument||i,S=i.createElement("script"),Jt(S),gs(S,"link",p),i.head.appendChild(S),u.instance=S);case"void":return null;default:throw Error(a(443,u.type))}else u.type==="stylesheet"&&(u.state.loading&4)===0&&(p=u.instance,u.state.loading|=4,Hm(p,h.precedence,i));return u.instance}function Hm(i,u,h){for(var p=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=p.length?p[p.length-1]:null,k=S,Y=0;Y<p.length;Y++){var ce=p[Y];if(ce.dataset.precedence===u)k=ce;else if(k!==S)break}k?k.parentNode.insertBefore(i,k.nextSibling):(u=h.nodeType===9?h.head:h,u.insertBefore(i,u.firstChild))}function Lg(i,u){i.crossOrigin==null&&(i.crossOrigin=u.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=u.referrerPolicy),i.title==null&&(i.title=u.title)}function Pg(i,u){i.crossOrigin==null&&(i.crossOrigin=u.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=u.referrerPolicy),i.integrity==null&&(i.integrity=u.integrity)}var $m=null;function eb(i,u,h){if($m===null){var p=new Map,S=$m=new Map;S.set(h,p)}else S=$m,p=S.get(h),p||(p=new Map,S.set(h,p));if(p.has(i))return p;for(p.set(i,null),h=h.getElementsByTagName(i),S=0;S<h.length;S++){var k=h[S];if(!(k[Qe]||k[ge]||i==="link"&&k.getAttribute("rel")==="stylesheet")&&k.namespaceURI!=="http://www.w3.org/2000/svg"){var Y=k.getAttribute(u)||"";Y=i+Y;var ce=p.get(Y);ce?ce.push(k):p.set(Y,[k])}}return p}function tb(i,u,h){i=i.ownerDocument||i,i.head.insertBefore(h,u==="title"?i.querySelector("head > title"):null)}function bE(i,u,h){if(h===1||u.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;switch(u.rel){case"stylesheet":return i=u.disabled,typeof u.precedence=="string"&&i==null;default:return!0}case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function rb(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function wE(i,u,h,p){if(h.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var S=Ed(p.href),k=u.querySelector(Kh(S));if(k){u=k._p,u!==null&&typeof u=="object"&&typeof u.then=="function"&&(i.count++,i=Wm.bind(i),u.then(i,i)),h.state.loading|=4,h.instance=k,Jt(k);return}k=u.ownerDocument||u,p=Z_(p),(S=ao.get(S))&&Lg(p,S),k=k.createElement("link"),Jt(k);var Y=k;Y._p=new Promise(function(ce,Te){Y.onload=ce,Y.onerror=Te}),gs(k,"link",p),h.instance=k}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(h,u),(u=h.state.preload)&&(h.state.loading&3)===0&&(i.count++,h=Wm.bind(i),u.addEventListener("load",h),u.addEventListener("error",h))}}var Mg=0;function SE(i,u){return i.stylesheets&&i.count===0&&Gm(i,i.stylesheets),0<i.count||0<i.imgCount?function(h){var p=setTimeout(function(){if(i.stylesheets&&Gm(i,i.stylesheets),i.unsuspend){var k=i.unsuspend;i.unsuspend=null,k()}},6e4+u);0<i.imgBytes&&Mg===0&&(Mg=62500*aE());var S=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Gm(i,i.stylesheets),i.unsuspend)){var k=i.unsuspend;i.unsuspend=null,k()}},(i.imgBytes>Mg?50:800)+u);return i.unsuspend=h,function(){i.unsuspend=null,clearTimeout(p),clearTimeout(S)}}:null}function Wm(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Gm(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Vm=null;function Gm(i,u){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Vm=new Map,u.forEach(NE,i),Vm=null,Wm.call(i))}function NE(i,u){if(!(u.state.loading&4)){var h=Vm.get(i);if(h)var p=h.get(null);else{h=new Map,Vm.set(i,h);for(var S=i.querySelectorAll("link[data-precedence],style[data-precedence]"),k=0;k<S.length;k++){var Y=S[k];(Y.nodeName==="LINK"||Y.getAttribute("media")!=="not all")&&(h.set(Y.dataset.precedence,Y),p=Y)}p&&h.set(null,p)}S=u.instance,Y=S.getAttribute("data-precedence"),k=h.get(Y)||p,k===p&&h.set(null,S),h.set(Y,S),this.count++,p=Wm.bind(this),S.addEventListener("load",p),S.addEventListener("error",p),k?k.parentNode.insertBefore(S,k.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(S,i.firstChild)),u.state.loading|=4}}var Zh={$$typeof:A,Provider:null,Consumer:null,_currentValue:K,_currentValue2:K,_threadCount:0};function jE(i,u,h,p,S,k,Y,ce,Te){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ea(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ea(0),this.hiddenUpdates=Ea(null),this.identifierPrefix=p,this.onUncaughtError=S,this.onCaughtError=k,this.onRecoverableError=Y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Te,this.incompleteTransitions=new Map}function ab(i,u,h,p,S,k,Y,ce,Te,tt,dt,xt){return i=new jE(i,u,h,Y,Te,tt,dt,xt,ce),u=1,k===!0&&(u|=24),k=es(3,null,null,u),i.current=k,k.stateNode=i,u=Bc(),u.refCount++,i.pooledCache=u,u.refCount++,k.memoizedState={element:p,isDehydrated:h,cache:u},zt(k),i}function nb(i){return i?(i=zn,i):zn}function sb(i,u,h,p,S,k){S=nb(S),p.context===null?p.context=S:p.pendingContext=S,p=vr(u),p.payload={element:h},k=k===void 0?null:k,k!==null&&(p.callback=k),h=Tr(i,p,u),h!==null&&(fi(h,i,u),oa(h,i,u))}function ib(i,u){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var h=i.retryLane;i.retryLane=h!==0&&h<u?h:u}}function Ig(i,u){ib(i,u),(i=i.alternate)&&ib(i,u)}function ob(i){if(i.tag===13||i.tag===31){var u=Do(i,67108864);u!==null&&fi(u,i,67108864),Ig(i,67108864)}}function lb(i){if(i.tag===13||i.tag===31){var u=Ci();u=qt(u);var h=Do(i,u);h!==null&&fi(h,i,u),Ig(i,u)}}var Ym=!0;function kE(i,u,h,p){var S=X.T;X.T=null;var k=Z.p;try{Z.p=2,Bg(i,u,h,p)}finally{Z.p=k,X.T=S}}function EE(i,u,h,p){var S=X.T;X.T=null;var k=Z.p;try{Z.p=8,Bg(i,u,h,p)}finally{Z.p=k,X.T=S}}function Bg(i,u,h,p){if(Ym){var S=Ug(p);if(S===null)jg(i,u,p,Xm,h),ub(i,p);else if(CE(S,i,u,h,p))p.stopPropagation();else if(ub(i,p),u&4&&-1<AE.indexOf(i)){for(;S!==null;){var k=Ht(S);if(k!==null)switch(k.tag){case 3:if(k=k.stateNode,k.current.memoizedState.isDehydrated){var Y=It(k.pendingLanes);if(Y!==0){var ce=k;for(ce.pendingLanes|=2,ce.entangledLanes|=2;Y;){var Te=1<<31-$e(Y);ce.entanglements[1]|=Te,Y&=~Te}xl(k),(ca&6)===0&&(Om=Lt()+500,Vh(0))}}break;case 31:case 13:ce=Do(k,2),ce!==null&&fi(ce,k,2),Dm(),Ig(k,2)}if(k=Ug(p),k===null&&jg(i,u,p,Xm,h),k===S)break;S=k}S!==null&&p.stopPropagation()}else jg(i,u,p,null,h)}}function Ug(i){return i=Rl(i),qg(i)}var Xm=null;function qg(i){if(Xm=null,i=Ft(i),i!==null){var u=s(i);if(u===null)i=null;else{var h=u.tag;if(h===13){if(i=l(u),i!==null)return i;i=null}else if(h===31){if(i=c(u),i!==null)return i;i=null}else if(h===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;i=null}else u!==i&&(i=null)}}return Xm=i,null}function cb(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Vt()){case $t:return 2;case Wt:return 8;case Ot:case kt:return 32;case qe:return 268435456;default:return 32}default:return 32}}var zg=!1,Zc=null,Qc=null,eu=null,Qh=new Map,e0=new Map,tu=[],AE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ub(i,u){switch(i){case"focusin":case"focusout":Zc=null;break;case"dragenter":case"dragleave":Qc=null;break;case"mouseover":case"mouseout":eu=null;break;case"pointerover":case"pointerout":Qh.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":e0.delete(u.pointerId)}}function t0(i,u,h,p,S,k){return i===null||i.nativeEvent!==k?(i={blockedOn:u,domEventName:h,eventSystemFlags:p,nativeEvent:k,targetContainers:[S]},u!==null&&(u=Ht(u),u!==null&&ob(u)),i):(i.eventSystemFlags|=p,u=i.targetContainers,S!==null&&u.indexOf(S)===-1&&u.push(S),i)}function CE(i,u,h,p,S){switch(u){case"focusin":return Zc=t0(Zc,i,u,h,p,S),!0;case"dragenter":return Qc=t0(Qc,i,u,h,p,S),!0;case"mouseover":return eu=t0(eu,i,u,h,p,S),!0;case"pointerover":var k=S.pointerId;return Qh.set(k,t0(Qh.get(k)||null,i,u,h,p,S)),!0;case"gotpointercapture":return k=S.pointerId,e0.set(k,t0(e0.get(k)||null,i,u,h,p,S)),!0}return!1}function fb(i){var u=Ft(i.target);if(u!==null){var h=s(u);if(h!==null){if(u=h.tag,u===13){if(u=l(h),u!==null){i.blockedOn=u,Ne(i.priority,function(){lb(h)});return}}else if(u===31){if(u=c(h),u!==null){i.blockedOn=u,Ne(i.priority,function(){lb(h)});return}}else if(u===3&&h.stateNode.current.memoizedState.isDehydrated){i.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Km(i){if(i.blockedOn!==null)return!1;for(var u=i.targetContainers;0<u.length;){var h=Ug(i.nativeEvent);if(h===null){h=i.nativeEvent;var p=new h.constructor(h.type,h);go=p,h.target.dispatchEvent(p),go=null}else return u=Ht(h),u!==null&&ob(u),i.blockedOn=h,!1;u.shift()}return!0}function db(i,u,h){Km(i)&&h.delete(u)}function TE(){zg=!1,Zc!==null&&Km(Zc)&&(Zc=null),Qc!==null&&Km(Qc)&&(Qc=null),eu!==null&&Km(eu)&&(eu=null),Qh.forEach(db),e0.forEach(db)}function Jm(i,u){i.blockedOn===u&&(i.blockedOn=null,zg||(zg=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,TE)))}var Zm=null;function hb(i){Zm!==i&&(Zm=i,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Zm===i&&(Zm=null);for(var u=0;u<i.length;u+=3){var h=i[u],p=i[u+1],S=i[u+2];if(typeof p!="function"){if(qg(p||h)===null)continue;break}var k=Ht(h);k!==null&&(i.splice(u,3),u-=3,U1(k,{pending:!0,data:S,method:h.method,action:p},p,S))}}))}function Cd(i){function u(Te){return Jm(Te,i)}Zc!==null&&Jm(Zc,i),Qc!==null&&Jm(Qc,i),eu!==null&&Jm(eu,i),Qh.forEach(u),e0.forEach(u);for(var h=0;h<tu.length;h++){var p=tu[h];p.blockedOn===i&&(p.blockedOn=null)}for(;0<tu.length&&(h=tu[0],h.blockedOn===null);)fb(h),h.blockedOn===null&&tu.shift();if(h=(i.ownerDocument||i).$$reactFormReplay,h!=null)for(p=0;p<h.length;p+=3){var S=h[p],k=h[p+1],Y=S[we]||null;if(typeof k=="function")Y||hb(h);else if(Y){var ce=null;if(k&&k.hasAttribute("formAction")){if(S=k,Y=k[we]||null)ce=Y.formAction;else if(qg(S)!==null)continue}else ce=Y.action;typeof ce=="function"?h[p+1]=ce:(h.splice(p,3),p-=3),hb(h)}}}function mb(){function i(k){k.canIntercept&&k.info==="react-transition"&&k.intercept({handler:function(){return new Promise(function(Y){return S=Y})},focusReset:"manual",scroll:"manual"})}function u(){S!==null&&(S(),S=null),p||setTimeout(h,20)}function h(){if(!p&&!navigation.transition){var k=navigation.currentEntry;k&&k.url!=null&&navigation.navigate(k.url,{state:k.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,S=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",u),navigation.addEventListener("navigateerror",u),setTimeout(h,100),function(){p=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",u),navigation.removeEventListener("navigateerror",u),S!==null&&(S(),S=null)}}}function Hg(i){this._internalRoot=i}Qm.prototype.render=Hg.prototype.render=function(i){var u=this._internalRoot;if(u===null)throw Error(a(409));var h=u.current,p=Ci();sb(h,p,i,u,null,null)},Qm.prototype.unmount=Hg.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var u=i.containerInfo;sb(i.current,2,null,i,null,null),Dm(),u[je]=null}};function Qm(i){this._internalRoot=i}Qm.prototype.unstable_scheduleHydration=function(i){if(i){var u=re();i={blockedOn:null,target:i,priority:u};for(var h=0;h<tu.length&&u!==0&&u<tu[h].priority;h++);tu.splice(h,0,i),h===0&&fb(i)}};var pb=e.version;if(pb!=="19.2.0")throw Error(a(527,pb,"19.2.0"));Z.findDOMNode=function(i){var u=i._reactInternals;if(u===void 0)throw typeof i.render=="function"?Error(a(188)):(i=Object.keys(i).join(","),Error(a(268,i)));return i=d(u),i=i!==null?m(i):null,i=i===null?null:i.stateNode,i};var OE={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:X,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ep=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ep.isDisabled&&ep.supportsFiber)try{Et=ep.inject(OE),Dt=ep}catch{}}return a0.createRoot=function(i,u){if(!n(i))throw Error(a(299));var h=!1,p="",S=wy,k=Sy,Y=Ny;return u!=null&&(u.unstable_strictMode===!0&&(h=!0),u.identifierPrefix!==void 0&&(p=u.identifierPrefix),u.onUncaughtError!==void 0&&(S=u.onUncaughtError),u.onCaughtError!==void 0&&(k=u.onCaughtError),u.onRecoverableError!==void 0&&(Y=u.onRecoverableError)),u=ab(i,1,!1,null,null,h,p,null,S,k,Y,mb),i[je]=u.current,Ng(i),new Hg(u)},a0.hydrateRoot=function(i,u,h){if(!n(i))throw Error(a(299));var p=!1,S="",k=wy,Y=Sy,ce=Ny,Te=null;return h!=null&&(h.unstable_strictMode===!0&&(p=!0),h.identifierPrefix!==void 0&&(S=h.identifierPrefix),h.onUncaughtError!==void 0&&(k=h.onUncaughtError),h.onCaughtError!==void 0&&(Y=h.onCaughtError),h.onRecoverableError!==void 0&&(ce=h.onRecoverableError),h.formState!==void 0&&(Te=h.formState)),u=ab(i,1,!0,u,h??null,p,S,Te,k,Y,ce,mb),u.context=nb(null),h=u.current,p=Ci(),p=qt(p),S=vr(p),S.callback=null,Tr(h,S,p),h=p,u.current.lanes=h,rr(u,h),xl(u),i[je]=u.current,Ng(i),new Qm(u)},a0.version="19.2.0",a0}var jb;function $E(){if(jb)return Vg.exports;jb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Vg.exports=HE(),Vg.exports}var WE=$E();const VE=Gx(WE);var sx=function(t,e){return sx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r[n]=a[n])},sx(t,e)};function KS(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");sx(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var $p=function(){return $p=Object.assign||function(e){for(var r,a=1,n=arguments.length;a<n;a++){r=arguments[a];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},$p.apply(this,arguments)};function fh(t,e){var r={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(r[a]=t[a]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(t);n<a.length;n++)e.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(t,a[n])&&(r[a[n]]=t[a[n]]);return r}function JS(t,e,r,a){var n=arguments.length,s=n<3?e:a===null?a=Object.getOwnPropertyDescriptor(e,r):a,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,a);else for(var c=t.length-1;c>=0;c--)(l=t[c])&&(s=(n<3?l(s):n>3?l(e,r,s):l(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function ZS(t,e){return function(r,a){e(r,a,t)}}function QS(t,e,r,a,n,s){function l(E){if(E!==void 0&&typeof E!="function")throw new TypeError("Function expected");return E}for(var c=a.kind,f=c==="getter"?"get":c==="setter"?"set":"value",d=!e&&t?a.static?t:t.prototype:null,m=e||(d?Object.getOwnPropertyDescriptor(d,a.name):{}),v,x=!1,g=r.length-1;g>=0;g--){var b={};for(var _ in a)b[_]=_==="access"?{}:a[_];for(var _ in a.access)b.access[_]=a.access[_];b.addInitializer=function(E){if(x)throw new TypeError("Cannot add initializers after decoration has completed");s.push(l(E||null))};var w=(0,r[g])(c==="accessor"?{get:m.get,set:m.set}:m[f],b);if(c==="accessor"){if(w===void 0)continue;if(w===null||typeof w!="object")throw new TypeError("Object expected");(v=l(w.get))&&(m.get=v),(v=l(w.set))&&(m.set=v),(v=l(w.init))&&n.unshift(v)}else(v=l(w))&&(c==="field"?n.unshift(v):m[f]=v)}d&&Object.defineProperty(d,a.name,m),x=!0}function e4(t,e,r){for(var a=arguments.length>2,n=0;n<e.length;n++)r=a?e[n].call(t,r):e[n].call(t);return a?r:void 0}function t4(t){return typeof t=="symbol"?t:"".concat(t)}function r4(t,e,r){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:r?"".concat(r," ",e):e})}function a4(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function tr(t,e,r,a){function n(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function c(m){try{d(a.next(m))}catch(v){l(v)}}function f(m){try{d(a.throw(m))}catch(v){l(v)}}function d(m){m.done?s(m.value):n(m.value).then(c,f)}d((a=a.apply(t,e||[])).next())})}function n4(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},a,n,s,l=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return l.next=c(0),l.throw=c(1),l.return=c(2),typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function c(d){return function(m){return f([d,m])}}function f(d){if(a)throw new TypeError("Generator is already executing.");for(;l&&(l=0,d[0]&&(r=0)),r;)try{if(a=1,n&&(s=d[0]&2?n.return:d[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,d[1])).done)return s;switch(n=0,s&&(d=[d[0]&2,s.value]),d[0]){case 0:case 1:s=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,n=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!s||d[1]>s[0]&&d[1]<s[3])){r.label=d[1];break}if(d[0]===6&&r.label<s[1]){r.label=s[1],s=d;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(d);break}s[2]&&r.ops.pop(),r.trys.pop();continue}d=e.call(t,r)}catch(m){d=[6,m],n=0}finally{a=s=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}var p1=Object.create?(function(t,e,r,a){a===void 0&&(a=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,a,n)}):(function(t,e,r,a){a===void 0&&(a=r),t[a]=e[r]});function s4(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&p1(e,t,r)}function Wp(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],a=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&a>=t.length&&(t=void 0),{value:t&&t[a++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Xx(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var a=r.call(t),n,s=[],l;try{for(;(e===void 0||e-- >0)&&!(n=a.next()).done;)s.push(n.value)}catch(c){l={error:c}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(l)throw l.error}}return s}function i4(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Xx(arguments[e]));return t}function o4(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var a=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],l=0,c=s.length;l<c;l++,n++)a[n]=s[l];return a}function l4(t,e,r){if(r||arguments.length===2)for(var a=0,n=e.length,s;a<n;a++)(s||!(a in e))&&(s||(s=Array.prototype.slice.call(e,0,a)),s[a]=e[a]);return t.concat(s||Array.prototype.slice.call(e))}function oh(t){return this instanceof oh?(this.v=t,this):new oh(t)}function c4(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=r.apply(t,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),n[Symbol.asyncIterator]=function(){return this},n;function l(g){return function(b){return Promise.resolve(b).then(g,v)}}function c(g,b){a[g]&&(n[g]=function(_){return new Promise(function(w,E){s.push([g,_,w,E])>1||f(g,_)})},b&&(n[g]=b(n[g])))}function f(g,b){try{d(a[g](b))}catch(_){x(s[0][3],_)}}function d(g){g.value instanceof oh?Promise.resolve(g.value.v).then(m,v):x(s[0][2],g)}function m(g){f("next",g)}function v(g){f("throw",g)}function x(g,b){g(b),s.shift(),s.length&&f(s[0][0],s[0][1])}}function u4(t){var e,r;return e={},a("next"),a("throw",function(n){throw n}),a("return"),e[Symbol.iterator]=function(){return this},e;function a(n,s){e[n]=t[n]?function(l){return(r=!r)?{value:oh(t[n](l)),done:!1}:s?s(l):l}:s}}function f4(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Wp=="function"?Wp(t):t[Symbol.iterator](),r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r);function a(s){r[s]=t[s]&&function(l){return new Promise(function(c,f){l=t[s](l),n(c,f,l.done,l.value)})}}function n(s,l,c,f){Promise.resolve(f).then(function(d){s({value:d,done:c})},l)}}function d4(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var GE=Object.create?(function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}):function(t,e){t.default=e},ix=function(t){return ix=Object.getOwnPropertyNames||function(e){var r=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(r[r.length]=a);return r},ix(t)};function h4(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r=ix(t),a=0;a<r.length;a++)r[a]!=="default"&&p1(e,t,r[a]);return GE(e,t),e}function m4(t){return t&&t.__esModule?t:{default:t}}function p4(t,e,r,a){if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!a:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?a:r==="a"?a.call(t):a?a.value:e.get(t)}function g4(t,e,r,a,n){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?n.call(t,r):n?n.value=r:e.set(t,r),r}function v4(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}function x4(t,e,r){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var a,n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");a=e[Symbol.asyncDispose]}if(a===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");a=e[Symbol.dispose],r&&(n=a)}if(typeof a!="function")throw new TypeError("Object not disposable.");n&&(a=function(){try{n.call(this)}catch(s){return Promise.reject(s)}}),t.stack.push({value:e,dispose:a,async:r})}else r&&t.stack.push({async:!0});return e}var YE=typeof SuppressedError=="function"?SuppressedError:function(t,e,r){var a=new Error(r);return a.name="SuppressedError",a.error=t,a.suppressed=e,a};function y4(t){function e(s){t.error=t.hasError?new YE(s,t.error,"An error was suppressed during disposal."):s,t.hasError=!0}var r,a=0;function n(){for(;r=t.stack.pop();)try{if(!r.async&&a===1)return a=0,t.stack.push(r),Promise.resolve().then(n);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return a|=2,Promise.resolve(s).then(n,function(l){return e(l),n()})}else a|=1}catch(l){e(l)}if(a===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return n()}function _4(t,e){return typeof t=="string"&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,a,n,s,l){return a?e?".jsx":".js":n&&(!s||!l)?r:n+s+"."+l.toLowerCase()+"js"}):t}const XE={__extends:KS,__assign:$p,__rest:fh,__decorate:JS,__param:ZS,__esDecorate:QS,__runInitializers:e4,__propKey:t4,__setFunctionName:r4,__metadata:a4,__awaiter:tr,__generator:n4,__createBinding:p1,__exportStar:s4,__values:Wp,__read:Xx,__spread:i4,__spreadArrays:o4,__spreadArray:l4,__await:oh,__asyncGenerator:c4,__asyncDelegator:u4,__asyncValues:f4,__makeTemplateObject:d4,__importStar:h4,__importDefault:m4,__classPrivateFieldGet:p4,__classPrivateFieldSet:g4,__classPrivateFieldIn:v4,__addDisposableResource:x4,__disposeResources:y4,__rewriteRelativeImportExtension:_4},KE=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:x4,get __assign(){return $p},__asyncDelegator:u4,__asyncGenerator:c4,__asyncValues:f4,__await:oh,__awaiter:tr,__classPrivateFieldGet:p4,__classPrivateFieldIn:v4,__classPrivateFieldSet:g4,__createBinding:p1,__decorate:JS,__disposeResources:y4,__esDecorate:QS,__exportStar:s4,__extends:KS,__generator:n4,__importDefault:m4,__importStar:h4,__makeTemplateObject:d4,__metadata:a4,__param:ZS,__propKey:t4,__read:Xx,__rest:fh,__rewriteRelativeImportExtension:_4,__runInitializers:e4,__setFunctionName:r4,__spread:i4,__spreadArray:l4,__spreadArrays:o4,__values:Wp,default:XE},Symbol.toStringTag,{value:"Module"})),JE=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class Kx extends Error{constructor(e,r="FunctionsError",a){super(e),this.name=r,this.context=a}}class ZE extends Kx{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class kb extends Kx{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Eb extends Kx{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ox;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(ox||(ox={}));class QE{constructor(e,{headers:r={},customFetch:a,region:n=ox.Any}={}){this.url=e,this.headers=r,this.region=n,this.fetch=JE(a)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return tr(this,arguments,void 0,function*(r,a={}){var n;let s,l;try{const{headers:c,method:f,body:d,signal:m,timeout:v}=a;let x={},{region:g}=a;g||(g=this.region);const b=new URL(`${this.url}/${r}`);g&&g!=="any"&&(x["x-region"]=g,b.searchParams.set("forceFunctionRegion",g));let _;d&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(x["Content-Type"]="application/octet-stream",_=d):typeof d=="string"?(x["Content-Type"]="text/plain",_=d):typeof FormData<"u"&&d instanceof FormData?_=d:(x["Content-Type"]="application/json",_=JSON.stringify(d)):_=d;let w=m;v&&(l=new AbortController,s=setTimeout(()=>l.abort(),v),m?(w=l.signal,m.addEventListener("abort",()=>l.abort())):w=l.signal);const E=yield this.fetch(b.toString(),{method:f||"POST",headers:Object.assign(Object.assign(Object.assign({},x),this.headers),c),body:_,signal:w}).catch(G=>{throw new ZE(G)}),C=E.headers.get("x-relay-error");if(C&&C==="true")throw new kb(E);if(!E.ok)throw new Eb(E);let A=((n=E.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),T;return A==="application/json"?T=yield E.json():A==="application/octet-stream"||A==="application/pdf"?T=yield E.blob():A==="text/event-stream"?T=E:A==="multipart/form-data"?T=yield E.formData():T=yield E.text(),{data:T,error:null,response:E}}catch(c){return{data:null,error:c,response:c instanceof Eb||c instanceof kb?c.context:void 0}}finally{s&&clearTimeout(s)}})}}var js={};const dh=FE(KE);var tp={},rp={},ap={},np={},sp={},ip={},Ab;function b4(){if(Ab)return ip;Ab=1,Object.defineProperty(ip,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return ip.default=t,ip}var Cb;function w4(){if(Cb)return sp;Cb=1,Object.defineProperty(sp,"__esModule",{value:!0});const e=dh.__importDefault(b4());class r{constructor(n){var s,l;this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=new Headers(n.headers),this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=(s=n.shouldThrowOnError)!==null&&s!==void 0?s:!1,this.signal=n.signal,this.isMaybeSingle=(l=n.isMaybeSingle)!==null&&l!==void 0?l:!1,n.fetch?this.fetch=n.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,s){return this.headers=new Headers(this.headers),this.headers.set(n,s),this}then(n,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const l=this.fetch;let c=l(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async f=>{var d,m,v,x;let g=null,b=null,_=null,w=f.status,E=f.statusText;if(f.ok){if(this.method!=="HEAD"){const G=await f.text();G===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((d=this.headers.get("Accept"))===null||d===void 0)&&d.includes("application/vnd.pgrst.plan+text"))?b=G:b=JSON.parse(G))}const A=(m=this.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),T=(v=f.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");A&&T&&T.length>1&&(_=parseInt(T[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(b)&&(b.length>1?(g={code:"PGRST116",details:`Results contain ${b.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},b=null,_=null,w=406,E="Not Acceptable"):b.length===1?b=b[0]:b=null)}else{const A=await f.text();try{g=JSON.parse(A),Array.isArray(g)&&f.status===404&&(b=[],g=null,w=200,E="OK")}catch{f.status===404&&A===""?(w=204,E="No Content"):g={message:A}}if(g&&this.isMaybeSingle&&(!((x=g?.details)===null||x===void 0)&&x.includes("0 rows"))&&(g=null,w=200,E="OK"),g&&this.shouldThrowOnError)throw new e.default(g)}return{error:g,data:b,count:_,status:w,statusText:E}});return this.shouldThrowOnError||(c=c.catch(f=>{var d,m,v,x,g,b;let _="";const w=f?.cause;if(w){const E=(d=w?.message)!==null&&d!==void 0?d:"",C=(m=w?.code)!==null&&m!==void 0?m:"";_=`${(v=f?.name)!==null&&v!==void 0?v:"FetchError"}: ${f?.message}`,_+=`

Caused by: ${(x=w?.name)!==null&&x!==void 0?x:"Error"}: ${E}`,C&&(_+=` (${C})`),w?.stack&&(_+=`
${w.stack}`)}else _=(g=f?.stack)!==null&&g!==void 0?g:"";return{error:{message:`${(b=f?.name)!==null&&b!==void 0?b:"FetchError"}: ${f?.message}`,details:_,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),c.then(n,s)}returns(){return this}overrideTypes(){return this}}return sp.default=r,sp}var Tb;function S4(){if(Tb)return np;Tb=1,Object.defineProperty(np,"__esModule",{value:!0});const e=dh.__importDefault(w4());class r extends e.default{select(n){let s=!1;const l=(n??"*").split("").map(c=>/\s/.test(c)&&!s?"":(c==='"'&&(s=!s),c)).join("");return this.url.searchParams.set("select",l),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:s=!0,nullsFirst:l,foreignTable:c,referencedTable:f=c}={}){const d=f?`${f}.order`:"order",m=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${m?`${m},`:""}${n}.${s?"asc":"desc"}${l===void 0?"":l?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:s,referencedTable:l=s}={}){const c=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${n}`),this}range(n,s,{foreignTable:l,referencedTable:c=l}={}){const f=typeof c>"u"?"offset":`${c}.offset`,d=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(f,`${n}`),this.url.searchParams.set(d,`${s-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:s=!1,settings:l=!1,buffers:c=!1,wal:f=!1,format:d="text"}={}){var m;const v=[n?"analyze":null,s?"verbose":null,l?"settings":null,c?"buffers":null,f?"wal":null].filter(Boolean).join("|"),x=(m=this.headers.get("Accept"))!==null&&m!==void 0?m:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${x}"; options=${v};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}}return np.default=r,np}var Ob;function Jx(){if(Ob)return ap;Ob=1,Object.defineProperty(ap,"__esModule",{value:!0});const e=dh.__importDefault(S4()),r=new RegExp("[,()]");class a extends e.default{eq(s,l){return this.url.searchParams.append(s,`eq.${l}`),this}neq(s,l){return this.url.searchParams.append(s,`neq.${l}`),this}gt(s,l){return this.url.searchParams.append(s,`gt.${l}`),this}gte(s,l){return this.url.searchParams.append(s,`gte.${l}`),this}lt(s,l){return this.url.searchParams.append(s,`lt.${l}`),this}lte(s,l){return this.url.searchParams.append(s,`lte.${l}`),this}like(s,l){return this.url.searchParams.append(s,`like.${l}`),this}likeAllOf(s,l){return this.url.searchParams.append(s,`like(all).{${l.join(",")}}`),this}likeAnyOf(s,l){return this.url.searchParams.append(s,`like(any).{${l.join(",")}}`),this}ilike(s,l){return this.url.searchParams.append(s,`ilike.${l}`),this}ilikeAllOf(s,l){return this.url.searchParams.append(s,`ilike(all).{${l.join(",")}}`),this}ilikeAnyOf(s,l){return this.url.searchParams.append(s,`ilike(any).{${l.join(",")}}`),this}regexMatch(s,l){return this.url.searchParams.append(s,`match.${l}`),this}regexIMatch(s,l){return this.url.searchParams.append(s,`imatch.${l}`),this}is(s,l){return this.url.searchParams.append(s,`is.${l}`),this}isDistinct(s,l){return this.url.searchParams.append(s,`isdistinct.${l}`),this}in(s,l){const c=Array.from(new Set(l)).map(f=>typeof f=="string"&&r.test(f)?`"${f}"`:`${f}`).join(",");return this.url.searchParams.append(s,`in.(${c})`),this}contains(s,l){return typeof l=="string"?this.url.searchParams.append(s,`cs.${l}`):Array.isArray(l)?this.url.searchParams.append(s,`cs.{${l.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(l)}`),this}containedBy(s,l){return typeof l=="string"?this.url.searchParams.append(s,`cd.${l}`):Array.isArray(l)?this.url.searchParams.append(s,`cd.{${l.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(l)}`),this}rangeGt(s,l){return this.url.searchParams.append(s,`sr.${l}`),this}rangeGte(s,l){return this.url.searchParams.append(s,`nxl.${l}`),this}rangeLt(s,l){return this.url.searchParams.append(s,`sl.${l}`),this}rangeLte(s,l){return this.url.searchParams.append(s,`nxr.${l}`),this}rangeAdjacent(s,l){return this.url.searchParams.append(s,`adj.${l}`),this}overlaps(s,l){return typeof l=="string"?this.url.searchParams.append(s,`ov.${l}`):this.url.searchParams.append(s,`ov.{${l.join(",")}}`),this}textSearch(s,l,{config:c,type:f}={}){let d="";f==="plain"?d="pl":f==="phrase"?d="ph":f==="websearch"&&(d="w");const m=c===void 0?"":`(${c})`;return this.url.searchParams.append(s,`${d}fts${m}.${l}`),this}match(s){return Object.entries(s).forEach(([l,c])=>{this.url.searchParams.append(l,`eq.${c}`)}),this}not(s,l,c){return this.url.searchParams.append(s,`not.${l}.${c}`),this}or(s,{foreignTable:l,referencedTable:c=l}={}){const f=c?`${c}.or`:"or";return this.url.searchParams.append(f,`(${s})`),this}filter(s,l,c){return this.url.searchParams.append(s,`${l}.${c}`),this}}return ap.default=a,ap}var Rb;function N4(){if(Rb)return rp;Rb=1,Object.defineProperty(rp,"__esModule",{value:!0});const e=dh.__importDefault(Jx());class r{constructor(n,{headers:s={},schema:l,fetch:c}){this.url=n,this.headers=new Headers(s),this.schema=l,this.fetch=c}select(n,s){const{head:l=!1,count:c}=s??{},f=l?"HEAD":"GET";let d=!1;const m=(n??"*").split("").map(v=>/\s/.test(v)&&!d?"":(v==='"'&&(d=!d),v)).join("");return this.url.searchParams.set("select",m),c&&this.headers.append("Prefer",`count=${c}`),new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(n,{count:s,defaultToNull:l=!0}={}){var c;const f="POST";if(s&&this.headers.append("Prefer",`count=${s}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const d=n.reduce((m,v)=>m.concat(Object.keys(v)),[]);if(d.length>0){const m=[...new Set(d)].map(v=>`"${v}"`);this.url.searchParams.set("columns",m.join(","))}}return new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}upsert(n,{onConflict:s,ignoreDuplicates:l=!1,count:c,defaultToNull:f=!0}={}){var d;const m="POST";if(this.headers.append("Prefer",`resolution=${l?"ignore":"merge"}-duplicates`),s!==void 0&&this.url.searchParams.set("on_conflict",s),c&&this.headers.append("Prefer",`count=${c}`),f||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const v=n.reduce((x,g)=>x.concat(Object.keys(g)),[]);if(v.length>0){const x=[...new Set(v)].map(g=>`"${g}"`);this.url.searchParams.set("columns",x.join(","))}}return new e.default({method:m,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(n,{count:s}={}){var l;const c="PATCH";return s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}delete({count:n}={}){var s;const l="DELETE";return n&&this.headers.append("Prefer",`count=${n}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}}return rp.default=r,rp}var Db;function eA(){if(Db)return tp;Db=1,Object.defineProperty(tp,"__esModule",{value:!0});const t=dh,e=t.__importDefault(N4()),r=t.__importDefault(Jx());class a{constructor(s,{headers:l={},schema:c,fetch:f}={}){this.url=s,this.headers=new Headers(l),this.schemaName=c,this.fetch=f}from(s){if(!s||typeof s!="string"||s.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const l=new URL(`${this.url}/${s}`);return new e.default(l,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new a(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,l={},{head:c=!1,get:f=!1,count:d}={}){var m;let v;const x=new URL(`${this.url}/rpc/${s}`);let g;c||f?(v=c?"HEAD":"GET",Object.entries(l).filter(([_,w])=>w!==void 0).map(([_,w])=>[_,Array.isArray(w)?`{${w.join(",")}}`:`${w}`]).forEach(([_,w])=>{x.searchParams.append(_,w)})):(v="POST",g=l);const b=new Headers(this.headers);return d&&b.set("Prefer",`count=${d}`),new r.default({method:v,url:x,headers:b,schema:this.schemaName,body:g,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}}return tp.default=a,tp}var Fb;function tA(){if(Fb)return js;Fb=1,Object.defineProperty(js,"__esModule",{value:!0}),js.PostgrestError=js.PostgrestBuilder=js.PostgrestTransformBuilder=js.PostgrestFilterBuilder=js.PostgrestQueryBuilder=js.PostgrestClient=void 0;const t=dh,e=t.__importDefault(eA());js.PostgrestClient=e.default;const r=t.__importDefault(N4());js.PostgrestQueryBuilder=r.default;const a=t.__importDefault(Jx());js.PostgrestFilterBuilder=a.default;const n=t.__importDefault(S4());js.PostgrestTransformBuilder=n.default;const s=t.__importDefault(w4());js.PostgrestBuilder=s.default;const l=t.__importDefault(b4());return js.PostgrestError=l.default,js.default={PostgrestClient:e.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:a.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:s.default,PostgrestError:l.default},js}var j4=tA();const k4=Gx(j4),rA=DE({__proto__:null,default:k4},[j4]),{PostgrestClient:aA,PostgrestQueryBuilder:C$,PostgrestFilterBuilder:T$,PostgrestTransformBuilder:O$,PostgrestBuilder:R$,PostgrestError:D$}=k4||rA;class nA{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const a=r.node,n=parseInt(a.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const a=this.getWebSocketConstructor();return new a(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const sA="2.86.0",iA=`realtime-js/${sA}`,E4="1.0.0",oA="2.0.0",Lb=E4,lx=1e4,lA=1e3,cA=100;var lf;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(lf||(lf={}));var Yn;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Yn||(Yn={}));var Vo;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Vo||(Vo={}));var cx;(function(t){t.websocket="websocket"})(cx||(cx={}));var cf;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(cf||(cf={}));class uA{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,r){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(e));let a=[e.join_ref,e.ref,e.topic,e.event,e.payload];return r(JSON.stringify(a))}_binaryEncodeUserBroadcastPush(e){var r;return this._isArrayBuffer((r=e.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var r,a;const n=(a=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,n)}_encodeJsonUserBroadcastPush(e){var r,a;const n=(a=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:{},l=new TextEncoder().encode(JSON.stringify(n)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,l)}_encodeUserBroadcastPush(e,r,a){var n,s;const l=e.topic,c=(n=e.ref)!==null&&n!==void 0?n:"",f=(s=e.join_ref)!==null&&s!==void 0?s:"",d=e.payload.event,m=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},v=Object.keys(m).length===0?"":JSON.stringify(m);if(f.length>255)throw new Error(`joinRef length ${f.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`ref length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`topic length ${l.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`userEvent length ${d.length} exceeds maximum of 255`);if(v.length>255)throw new Error(`metadata length ${v.length} exceeds maximum of 255`);const x=this.USER_BROADCAST_PUSH_META_LENGTH+f.length+c.length+l.length+d.length+v.length,g=new ArrayBuffer(this.HEADER_LENGTH+x);let b=new DataView(g),_=0;b.setUint8(_++,this.KINDS.userBroadcastPush),b.setUint8(_++,f.length),b.setUint8(_++,c.length),b.setUint8(_++,l.length),b.setUint8(_++,d.length),b.setUint8(_++,v.length),b.setUint8(_++,r),Array.from(f,E=>b.setUint8(_++,E.charCodeAt(0))),Array.from(c,E=>b.setUint8(_++,E.charCodeAt(0))),Array.from(l,E=>b.setUint8(_++,E.charCodeAt(0))),Array.from(d,E=>b.setUint8(_++,E.charCodeAt(0))),Array.from(v,E=>b.setUint8(_++,E.charCodeAt(0)));var w=new Uint8Array(g.byteLength+a.byteLength);return w.set(new Uint8Array(g),0),w.set(new Uint8Array(a),g.byteLength),w.buffer}decode(e,r){if(this._isArrayBuffer(e)){let a=this._binaryDecode(e);return r(a)}if(typeof e=="string"){const a=JSON.parse(e),[n,s,l,c,f]=a;return r({join_ref:n,ref:s,topic:l,event:c,payload:f})}return r({})}_binaryDecode(e){const r=new DataView(e),a=r.getUint8(0),n=new TextDecoder;switch(a){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,r,n)}}_decodeUserBroadcast(e,r,a){const n=r.getUint8(1),s=r.getUint8(2),l=r.getUint8(3),c=r.getUint8(4);let f=this.HEADER_LENGTH+4;const d=a.decode(e.slice(f,f+n));f=f+n;const m=a.decode(e.slice(f,f+s));f=f+s;const v=a.decode(e.slice(f,f+l));f=f+l;const x=e.slice(f,e.byteLength),g=c===this.JSON_ENCODING?JSON.parse(a.decode(x)):x,b={type:this.BROADCAST_EVENT,event:m,payload:g};return l>0&&(b.meta=JSON.parse(v)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST_EVENT,payload:b}}_isArrayBuffer(e){var r;return e instanceof ArrayBuffer||((r=e?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(e,r){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([a])=>r.includes(a)))}}class A4{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ra;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Ra||(Ra={}));const Pb=(t,e,r={})=>{var a;const n=(a=r.skipTypes)!==null&&a!==void 0?a:[];return e?Object.keys(e).reduce((s,l)=>(s[l]=fA(l,t,e,n),s),{}):{}},fA=(t,e,r,a)=>{const n=e.find(c=>c.name===t),s=n?.type,l=r[t];return s&&!a.includes(s)?C4(s,l):ux(l)},C4=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return pA(e,r)}switch(t){case Ra.bool:return dA(e);case Ra.float4:case Ra.float8:case Ra.int2:case Ra.int4:case Ra.int8:case Ra.numeric:case Ra.oid:return hA(e);case Ra.json:case Ra.jsonb:return mA(e);case Ra.timestamp:return gA(e);case Ra.abstime:case Ra.date:case Ra.daterange:case Ra.int4range:case Ra.int8range:case Ra.money:case Ra.reltime:case Ra.text:case Ra.time:case Ra.timestamptz:case Ra.timetz:case Ra.tsrange:case Ra.tstzrange:return ux(e);default:return ux(e)}},ux=t=>t,dA=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},hA=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},mA=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},pA=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,a=t[r];if(t[0]==="{"&&a==="}"){let s;const l=t.slice(1,r);try{s=JSON.parse("["+l+"]")}catch{s=l?l.split(","):[]}return s.map(c=>C4(e,c))}return t},gA=t=>typeof t=="string"?t.replace(" ","T"):t,T4=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Kg{constructor(e,r,a={},n=lx){this.channel=e,this.event=r,this.payload=a,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var a;return this._hasReceived(e)&&r((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(a=>a.status===e).forEach(a=>a.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Mb;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Mb||(Mb={}));class h0{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},n=>{const{onJoin:s,onLeave:l,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=h0.syncState(this.state,n,s,l),this.pendingDiffs.forEach(f=>{this.state=h0.syncDiff(this.state,f,s,l)}),this.pendingDiffs=[],c()}),this.channel._on(a.diff,{},n=>{const{onJoin:s,onLeave:l,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=h0.syncDiff(this.state,n,s,l),c())}),this.onJoin((n,s,l)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:s,newPresences:l})}),this.onLeave((n,s,l)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:s,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,a,n){const s=this.cloneDeep(e),l=this.transformState(r),c={},f={};return this.map(s,(d,m)=>{l[d]||(f[d]=m)}),this.map(l,(d,m)=>{const v=s[d];if(v){const x=m.map(w=>w.presence_ref),g=v.map(w=>w.presence_ref),b=m.filter(w=>g.indexOf(w.presence_ref)<0),_=v.filter(w=>x.indexOf(w.presence_ref)<0);b.length>0&&(c[d]=b),_.length>0&&(f[d]=_)}else c[d]=m}),this.syncDiff(s,{joins:c,leaves:f},a,n)}static syncDiff(e,r,a,n){const{joins:s,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return a||(a=()=>{}),n||(n=()=>{}),this.map(s,(c,f)=>{var d;const m=(d=e[c])!==null&&d!==void 0?d:[];if(e[c]=this.cloneDeep(f),m.length>0){const v=e[c].map(g=>g.presence_ref),x=m.filter(g=>v.indexOf(g.presence_ref)<0);e[c].unshift(...x)}a(c,m,f)}),this.map(l,(c,f)=>{let d=e[c];if(!d)return;const m=f.map(v=>v.presence_ref);d=d.filter(v=>m.indexOf(v.presence_ref)<0),e[c]=d,n(c,d,f),d.length===0&&delete e[c]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(a=>r(a,e[a]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,a)=>{const n=e[a];return"metas"in n?r[a]=n.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[a]=n,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ib;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Ib||(Ib={}));var m0;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(m0||(m0={}));var sc;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(sc||(sc={}));class Zx{constructor(e,r={config:{}},a){var n,s;if(this.topic=e,this.params=r,this.socket=a,this.bindings={},this.state=Yn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Kg(this,Vo.join,this.params,this.timeout),this.rejoinTimer=new A4(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Yn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Yn.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Yn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Yn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Yn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Vo.reply,{},(l,c)=>{this._trigger(this._replyEventName(c),l)}),this.presence=new h0(this),this.broadcastEndpointURL=T4(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var a,n,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Yn.closed){const{config:{broadcast:l,presence:c,private:f}}=this.params,d=(n=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(g=>g.filter))!==null&&n!==void 0?n:[],m=!!this.bindings[m0.PRESENCE]&&this.bindings[m0.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,v={},x={broadcast:l,presence:Object.assign(Object.assign({},c),{enabled:m}),postgres_changes:d,private:f};this.socket.accessTokenValue&&(v.access_token=this.socket.accessTokenValue),this._onError(g=>e?.(sc.CHANNEL_ERROR,g)),this._onClose(()=>e?.(sc.CLOSED)),this.updateJoinPayload(Object.assign({config:x},v)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:g})=>{var b;if(this.socket.setAuth(),g===void 0){e?.(sc.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,w=(b=_?.length)!==null&&b!==void 0?b:0,E=[];for(let C=0;C<w;C++){const A=_[C],{filter:{event:T,schema:G,table:W,filter:B}}=A,q=g&&g[C];if(q&&q.event===T&&q.schema===G&&q.table===W&&q.filter===B)E.push(Object.assign(Object.assign({},A),{id:q.id}));else{this.unsubscribe(),this.state=Yn.errored,e?.(sc.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=E,e&&e(sc.SUBSCRIBED);return}}).receive("error",g=>{this.state=Yn.errored,e?.(sc.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{e?.(sc.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,a){return this.state===Yn.joined&&e===m0.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,r,a)}async httpSend(e,r,a={}){var n;const s=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const l={method:"POST",headers:{Authorization:s,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=a.timeout)!==null&&n!==void 0?n:this.timeout);if(c.status===202)return{success:!0};let f=c.statusText;try{const d=await c.json();f=d.error||d.message||f}catch{}return Promise.reject(new Error(f))}async send(e,r={}){var a,n;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:l}=e,f={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:l,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return await((n=d.body)===null||n===void 0?void 0:n.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var l,c,f;const d=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((f=(c=(l=this.params)===null||l===void 0?void 0:l.config)===null||c===void 0?void 0:c.broadcast)===null||f===void 0)&&f.ack)&&s("ok"),d.receive("ok",()=>s("ok")),d.receive("error",()=>s("error")),d.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Yn.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Vo.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(n=>{a=new Kg(this,Vo.leave,{},e),a.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Yn.closed,this.bindings={}}async _fetchWithTimeout(e,r,a){const n=new AbortController,s=setTimeout(()=>n.abort(),a),l=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(s),l}_push(e,r,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Kg(this,e,r,a);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>cA){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,a){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,a){var n,s;const l=e.toLocaleLowerCase(),{close:c,error:f,leave:d,join:m}=Vo;if(a&&[c,f,d,m].indexOf(l)>=0&&a!==this._joinRef())return;let x=this._onMessage(l,r,a);if(r&&!x)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(g=>{var b,_,w;return((b=g.filter)===null||b===void 0?void 0:b.event)==="*"||((w=(_=g.filter)===null||_===void 0?void 0:_.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===l}).map(g=>g.callback(x,a)):(s=this.bindings[l])===null||s===void 0||s.filter(g=>{var b,_,w,E,C,A;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in g){const T=g.id,G=(b=g.filter)===null||b===void 0?void 0:b.event;return T&&((_=r.ids)===null||_===void 0?void 0:_.includes(T))&&(G==="*"||G?.toLocaleLowerCase()===((w=r.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))}else{const T=(C=(E=g?.filter)===null||E===void 0?void 0:E.event)===null||C===void 0?void 0:C.toLocaleLowerCase();return T==="*"||T===((A=r?.event)===null||A===void 0?void 0:A.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===l}).map(g=>{if(typeof x=="object"&&"ids"in x){const b=x.data,{schema:_,table:w,commit_timestamp:E,type:C,errors:A}=b;x=Object.assign(Object.assign({},{schema:_,table:w,commit_timestamp:E,eventType:C,new:{},old:{},errors:A}),this._getPayloadRecords(b))}g.callback(x,a)})}_isClosed(){return this.state===Yn.closed}_isJoined(){return this.state===Yn.joined}_isJoining(){return this.state===Yn.joining}_isLeaving(){return this.state===Yn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,a){const n=e.toLocaleLowerCase(),s={type:n,filter:r,callback:a};return this.bindings[n]?this.bindings[n].push(s):this.bindings[n]=[s],this}_off(e,r){const a=e.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(n=>{var s;return!(((s=n.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===a&&Zx.isEqual(n.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const a in e)if(e[a]!==r[a])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Vo.close,{},e)}_onError(e){this._on(Vo.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Yn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Pb(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Pb(e.columns,e.old_record)),r}}const Jg=()=>{},op={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},vA=[1e3,2e3,5e3,1e4],xA=1e4,yA=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class _A{constructor(e,r){var a;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=lx,this.transport=null,this.heartbeatIntervalMs=op.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Jg,this.ref=0,this.reconnectTimer=null,this.vsn=Lb,this.logger=Jg,this.conn=null,this.sendBuffer=[],this.serializer=new uA,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>n?(...s)=>n(...s):(...s)=>fetch(...s),!(!((a=r?.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${cx.websocket}`,this.httpEndpoint=T4(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=nA.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,a){this.logger(e,r,a)}connectionState(){switch(this.conn&&this.conn.readyState){case lf.connecting:return cf.Connecting;case lf.open:return cf.Open;case lf.closing:return cf.Closing;default:return cf.Closed}}isConnected(){return this.connectionState()===cf.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const a=`realtime:${e}`,n=this.getChannels().find(s=>s.topic===a);if(n)return n;{const s=new Zx(`realtime:${e}`,r,this);return this.channels.push(s),s}}push(e){const{topic:r,event:a,payload:n,ref:s}=e,l=()=>{this.encode(e,c=>{var f;(f=this.conn)===null||f===void 0||f.send(c)})};this.log("push",`${r} ${a} (${s})`,n),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(lA,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},op.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(a=>a.topic===e&&(a._isJoined()||a._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:n,payload:s,ref:l}=r,c=l?`(${l})`:"",f=s.status||"";this.log("receive",`${f} ${a} ${n} ${c}`.trim(),s),this.channels.filter(d=>d._isMember(a)).forEach(d=>d._trigger(n,s,l)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===lf.open||this.conn.readyState===lf.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Vo.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const a=e.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${e}${a}${n}`}_workerObjectUrl(e){let r;if(e)r=e;else{const a=new Blob([yA],{type:"application/javascript"});r=URL.createObjectURL(a)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const n={access_token:r,version:iA};r&&a.updateJoinPayload(n),a.joinedOnce&&a._isJoined()&&a._push(Vo.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(a=>{try{a(r)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(a){this.log("error",`error triggering ${e} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new A4(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},op.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,a,n,s,l,c,f,d,m,v,x,g;switch(this.transport=(r=e?.transport)!==null&&r!==void 0?r:null,this.timeout=(a=e?.timeout)!==null&&a!==void 0?a:lx,this.heartbeatIntervalMs=(n=e?.heartbeatIntervalMs)!==null&&n!==void 0?n:op.HEARTBEAT_INTERVAL,this.worker=(s=e?.worker)!==null&&s!==void 0?s:!1,this.accessToken=(l=e?.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(c=e?.heartbeatCallback)!==null&&c!==void 0?c:Jg,this.vsn=(f=e?.vsn)!==null&&f!==void 0?f:Lb,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=e?.reconnectAfterMs)!==null&&d!==void 0?d:(b=>vA[b-1]||xA),this.vsn){case E4:this.encode=(m=e?.encode)!==null&&m!==void 0?m:((b,_)=>_(JSON.stringify(b))),this.decode=(v=e?.decode)!==null&&v!==void 0?v:((b,_)=>_(JSON.parse(b)));break;case oA:this.encode=(x=e?.encode)!==null&&x!==void 0?x:this.serializer.encode.bind(this.serializer),this.decode=(g=e?.decode)!==null&&g!==void 0?g:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class g1 extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function en(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class bA extends g1{constructor(e,r,a){super(e),this.name="StorageApiError",this.status=r,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class fx extends g1{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}const Qx=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),wA=()=>Response,dx=t=>{if(Array.isArray(t))return t.map(r=>dx(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,a])=>{const n=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[n]=dx(a)}),e},SA=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},NA=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t),Zg=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},jA=(t,e,r)=>tr(void 0,void 0,void 0,function*(){const a=yield wA();t instanceof a&&!r?.noResolveJson?t.json().then(n=>{const s=t.status||500,l=n?.statusCode||s+"";e(new bA(Zg(n),s,l))}).catch(n=>{e(new fx(Zg(n),n))}):e(new fx(Zg(t),t))}),kA=(t,e,r,a)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"||!a?n:(SA(a)?(n.headers=Object.assign({"Content-Type":"application/json"},e?.headers),n.body=JSON.stringify(a)):n.body=a,e?.duplex&&(n.duplex=e.duplex),Object.assign(Object.assign({},n),r))};function K0(t,e,r,a,n,s){return tr(this,void 0,void 0,function*(){return new Promise((l,c)=>{t(r,kA(e,a,n,s)).then(f=>{if(!f.ok)throw f;return a?.noResolveJson?f:f.json()}).then(f=>l(f)).catch(f=>jA(f,c,a))})})}function E0(t,e,r,a){return tr(this,void 0,void 0,function*(){return K0(t,"GET",e,r,a)})}function $o(t,e,r,a,n){return tr(this,void 0,void 0,function*(){return K0(t,"POST",e,a,n,r)})}function hx(t,e,r,a,n){return tr(this,void 0,void 0,function*(){return K0(t,"PUT",e,a,n,r)})}function EA(t,e,r,a){return tr(this,void 0,void 0,function*(){return K0(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),a)})}function e2(t,e,r,a,n){return tr(this,void 0,void 0,function*(){return K0(t,"DELETE",e,a,n,r)})}class AA{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r}then(e,r){return this.execute().then(e,r)}execute(){return tr(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(en(e))return{data:null,error:e};throw e}})}}var O4;class CA{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r,this[O4]="BlobDownloadBuilder",this.promise=null}asStream(){return new AA(this.downloadFn,this.shouldThrowOnError)}then(e,r){return this.getPromise().then(e,r)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return tr(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(en(e))return{data:null,error:e};throw e}})}}O4=Symbol.toStringTag;const TA={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Bb={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class OA{constructor(e,r={},a,n){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.bucketId=a,this.fetch=Qx(n)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,r,a,n){return tr(this,void 0,void 0,function*(){try{let s;const l=Object.assign(Object.assign({},Bb),n);let c=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const f=l.metadata;typeof Blob<"u"&&a instanceof Blob?(s=new FormData,s.append("cacheControl",l.cacheControl),f&&s.append("metadata",this.encodeMetadata(f)),s.append("",a)):typeof FormData<"u"&&a instanceof FormData?(s=a,s.has("cacheControl")||s.append("cacheControl",l.cacheControl),f&&!s.has("metadata")&&s.append("metadata",this.encodeMetadata(f))):(s=a,c["cache-control"]=`max-age=${l.cacheControl}`,c["content-type"]=l.contentType,f&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(f))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!l.duplex&&(l.duplex="half")),n?.headers&&(c=Object.assign(Object.assign({},c),n.headers));const d=this._removeEmptyFolders(r),m=this._getFinalPath(d),v=yield(e=="PUT"?hx:$o)(this.fetch,`${this.url}/object/${m}`,s,Object.assign({headers:c},l?.duplex?{duplex:l.duplex}:{}));return{data:{path:d,id:v.Id,fullPath:v.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(en(s))return{data:null,error:s};throw s}})}upload(e,r,a){return tr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,a)})}uploadToSignedUrl(e,r,a,n){return tr(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),l=this._getFinalPath(s),c=new URL(this.url+`/object/upload/sign/${l}`);c.searchParams.set("token",r);try{let f;const d=Object.assign({upsert:Bb.upsert},n),m=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&a instanceof Blob?(f=new FormData,f.append("cacheControl",d.cacheControl),f.append("",a)):typeof FormData<"u"&&a instanceof FormData?(f=a,f.append("cacheControl",d.cacheControl)):(f=a,m["cache-control"]=`max-age=${d.cacheControl}`,m["content-type"]=d.contentType);const v=yield hx(this.fetch,c.toString(),f,{headers:m});return{data:{path:s,fullPath:v.Key},error:null}}catch(f){if(this.shouldThrowOnError)throw f;if(en(f))return{data:null,error:f};throw f}})}createSignedUploadUrl(e,r){return tr(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e);const n=Object.assign({},this.headers);r?.upsert&&(n["x-upsert"]="true");const s=yield $o(this.fetch,`${this.url}/object/upload/sign/${a}`,{},{headers:n}),l=new URL(this.url+s.url),c=l.searchParams.get("token");if(!c)throw new g1("No token returned by API");return{data:{signedUrl:l.toString(),path:e,token:c},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(en(a))return{data:null,error:a};throw a}})}update(e,r,a){return tr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,a)})}move(e,r,a){return tr(this,void 0,void 0,function*(){try{return{data:yield $o(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:a?.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(en(n))return{data:null,error:n};throw n}})}copy(e,r,a){return tr(this,void 0,void 0,function*(){try{return{data:{path:(yield $o(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:a?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(en(n))return{data:null,error:n};throw n}})}createSignedUrl(e,r,a){return tr(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),s=yield $o(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:r},a?.transform?{transform:a.transform}:{}),{headers:this.headers});const l=a?.download?`&download=${a.download===!0?"":a.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${l}`)},{data:s,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(en(n))return{data:null,error:n};throw n}})}createSignedUrls(e,r,a){return tr(this,void 0,void 0,function*(){try{const n=yield $o(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),s=a?.download?`&download=${a.download===!0?"":a.download}`:"";return{data:n.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${s}`):null})),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(en(n))return{data:null,error:n};throw n}})}download(e,r){const n=typeof r?.transform<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString(r?.transform||{}),l=s?`?${s}`:"",c=this._getFinalPath(e),f=()=>E0(this.fetch,`${this.url}/${n}/${c}${l}`,{headers:this.headers,noResolveJson:!0});return new CA(f,this.shouldThrowOnError)}info(e){return tr(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const a=yield E0(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:dx(a),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(en(a))return{data:null,error:a};throw a}})}exists(e){return tr(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield EA(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(en(a)&&a instanceof fx){const n=a.originalError;if([400,404].includes(n?.status))return{data:!1,error:a}}throw a}})}getPublicUrl(e,r){const a=this._getFinalPath(e),n=[],s=r?.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&n.push(s);const c=typeof r?.transform<"u"?"render/image":"object",f=this.transformOptsToQueryString(r?.transform||{});f!==""&&n.push(f);let d=n.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${a}${d}`)}}}remove(e){return tr(this,void 0,void 0,function*(){try{return{data:yield e2(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}})}list(e,r,a){return tr(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},TA),r),{prefix:e||""});return{data:yield $o(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},a),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(en(n))return{data:null,error:n};throw n}})}listV2(e,r){return tr(this,void 0,void 0,function*(){try{const a=Object.assign({},e);return{data:yield $o(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(en(a))return{data:null,error:a};throw a}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const R4="2.86.0",D4={"X-Client-Info":`storage-js/${R4}`};class RA{constructor(e,r={},a,n){this.shouldThrowOnError=!1;const s=new URL(e);n?.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},D4),r),this.fetch=Qx(a)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return tr(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(e);return{data:yield E0(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}})}getBucket(e){return tr(this,void 0,void 0,function*(){try{return{data:yield E0(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}})}createBucket(e){return tr(this,arguments,void 0,function*(r,a={public:!1}){try{return{data:yield $o(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:a.type,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(en(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return tr(this,void 0,void 0,function*(){try{return{data:yield hx(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(en(a))return{data:null,error:a};throw a}})}emptyBucket(e){return tr(this,void 0,void 0,function*(){try{return{data:yield $o(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}})}deleteBucket(e){return tr(this,void 0,void 0,function*(){try{return{data:yield e2(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(e){const r={};return e&&("limit"in e&&(r.limit=String(e.limit)),"offset"in e&&(r.offset=String(e.offset)),e.search&&(r.search=e.search),e.sortColumn&&(r.sortColumn=e.sortColumn),e.sortOrder&&(r.sortOrder=e.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}var A0=class extends Error{constructor(t,e){super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function DA(t,e,r){const a=new URL(e,t);if(r)for(const[n,s]of Object.entries(r))s!==void 0&&a.searchParams.set(n,s);return a.toString()}async function FA(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function LA(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:r,path:a,query:n,body:s,headers:l}){const c=DA(t.baseUrl,a,n),f=await FA(t.auth),d=await e(c,{method:r,headers:{...s?{"Content-Type":"application/json"}:{},...f,...l},body:s?JSON.stringify(s):void 0}),m=await d.text(),v=(d.headers.get("content-type")||"").includes("application/json"),x=v&&m?JSON.parse(m):m;if(!d.ok){const g=v?x:void 0,b=g?.error;throw new A0(b?.message??`Request failed with status ${d.status}`,{status:d.status,icebergType:b?.type,icebergCode:b?.code,details:g})}return{status:d.status,headers:d.headers,data:x}}}}function lp(t){return t.join("")}var PA=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:lp(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(t,e){const r={namespace:t.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${lp(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${lp(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${lp(t.namespace)}`}),!0}catch(e){if(e instanceof A0&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(r){if(r instanceof A0&&r.status===409)return;throw r}}};function Td(t){return t.join("")}var MA=class{constructor(t,e="",r){this.client=t,this.prefix=e,this.accessDelegation=r}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Td(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Td(t.namespace)}/tables`,body:e,headers:r})).data.metadata}async updateTable(t,e){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Td(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Td(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Td(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Td(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(r){if(r instanceof A0&&r.status===404)return!1;throw r}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(r){if(r instanceof A0&&r.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw r}}},IA=class{constructor(t){let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const r=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=LA({baseUrl:r,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=t.accessDelegation?.join(","),this.namespaceOps=new PA(this.client,e),this.tableOps=new MA(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}};class BA{constructor(e,r={},a){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},D4),r),this.fetch=Qx(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return tr(this,void 0,void 0,function*(){try{return{data:yield $o(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}})}listBuckets(e){return tr(this,void 0,void 0,function*(){try{const r=new URLSearchParams;e?.limit!==void 0&&r.set("limit",e.limit.toString()),e?.offset!==void 0&&r.set("offset",e.offset.toString()),e?.sortColumn&&r.set("sortColumn",e.sortColumn),e?.sortOrder&&r.set("sortOrder",e.sortOrder),e?.search&&r.set("search",e.search);const a=r.toString(),n=a?`${this.url}/bucket?${a}`:`${this.url}/bucket`;return{data:yield E0(this.fetch,n,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}})}deleteBucket(e){return tr(this,void 0,void 0,function*(){try{return{data:yield e2(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}})}from(e){if(!NA(e))throw new g1("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");return new IA({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:()=>tr(this,void 0,void 0,function*(){return this.headers})},fetch:this.fetch})}}const t2={"X-Client-Info":`storage-js/${R4}`,"Content-Type":"application/json"};class F4 extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Li(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}class Qg extends F4{constructor(e,r,a){super(e),this.name="StorageVectorsApiError",this.status=r,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class UA extends F4{constructor(e,r){super(e),this.name="StorageVectorsUnknownError",this.originalError=r}}var Ub;(function(t){t.InternalError="InternalError",t.S3VectorConflictException="S3VectorConflictException",t.S3VectorNotFoundException="S3VectorNotFoundException",t.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",t.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",t.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Ub||(Ub={}));const r2=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),qA=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},qb=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),zA=(t,e,r)=>tr(void 0,void 0,void 0,function*(){if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!r?.noResolveJson){const n=t.status||500,s=t;if(typeof s.json=="function")s.json().then(l=>{const c=l?.statusCode||l?.code||n+"";e(new Qg(qb(l),n,c))}).catch(()=>{const l=n+"",c=s.statusText||`HTTP ${n} error`;e(new Qg(c,n,l))});else{const l=n+"",c=s.statusText||`HTTP ${n} error`;e(new Qg(c,n,l))}}else e(new UA(qb(t),t))}),HA=(t,e,r,a)=>{const n={method:t,headers:e?.headers||{}};return a?(qA(a)?(n.headers=Object.assign({"Content-Type":"application/json"},e?.headers),n.body=JSON.stringify(a)):n.body=a,Object.assign(Object.assign({},n),r)):n};function $A(t,e,r,a,n,s){return tr(this,void 0,void 0,function*(){return new Promise((l,c)=>{t(r,HA(e,a,n,s)).then(f=>{if(!f.ok)throw f;if(a?.noResolveJson)return f;const d=f.headers.get("content-type");return!d||!d.includes("application/json")?{}:f.json()}).then(f=>l(f)).catch(f=>zA(f,c,a))})})}function Pi(t,e,r,a,n){return tr(this,void 0,void 0,function*(){return $A(t,"POST",e,a,n,r)})}class WA{constructor(e,r={},a){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},t2),r),this.fetch=r2(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return tr(this,void 0,void 0,function*(){try{return{data:(yield Pi(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Li(r))return{data:null,error:r};throw r}})}getIndex(e,r){return tr(this,void 0,void 0,function*(){try{return{data:yield Pi(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Li(a))return{data:null,error:a};throw a}})}listIndexes(e){return tr(this,void 0,void 0,function*(){try{return{data:yield Pi(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Li(r))return{data:null,error:r};throw r}})}deleteIndex(e,r){return tr(this,void 0,void 0,function*(){try{return{data:(yield Pi(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}))||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Li(a))return{data:null,error:a};throw a}})}}class VA{constructor(e,r={},a){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},t2),r),this.fetch=r2(a)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return tr(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Pi(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Li(r))return{data:null,error:r};throw r}})}getVectors(e){return tr(this,void 0,void 0,function*(){try{return{data:yield Pi(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Li(r))return{data:null,error:r};throw r}})}listVectors(e){return tr(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield Pi(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Li(r))return{data:null,error:r};throw r}})}queryVectors(e){return tr(this,void 0,void 0,function*(){try{return{data:yield Pi(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Li(r))return{data:null,error:r};throw r}})}deleteVectors(e){return tr(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Pi(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Li(r))return{data:null,error:r};throw r}})}}class GA{constructor(e,r={},a){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},t2),r),this.fetch=r2(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return tr(this,void 0,void 0,function*(){try{return{data:(yield Pi(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Li(r))return{data:null,error:r};throw r}})}getBucket(e){return tr(this,void 0,void 0,function*(){try{return{data:yield Pi(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Li(r))return{data:null,error:r};throw r}})}listBuckets(){return tr(this,arguments,void 0,function*(e={}){try{return{data:yield Pi(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Li(r))return{data:null,error:r};throw r}})}deleteBucket(e){return tr(this,void 0,void 0,function*(){try{return{data:(yield Pi(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Li(r))return{data:null,error:r};throw r}})}}class YA extends GA{constructor(e,r={}){super(e,r.headers||{},r.fetch)}from(e){return new XA(this.url,this.headers,e,this.fetch)}createBucket(e){const r=Object.create(null,{createBucket:{get:()=>super.createBucket}});return tr(this,void 0,void 0,function*(){return r.createBucket.call(this,e)})}getBucket(e){const r=Object.create(null,{getBucket:{get:()=>super.getBucket}});return tr(this,void 0,void 0,function*(){return r.getBucket.call(this,e)})}listBuckets(){const e=Object.create(null,{listBuckets:{get:()=>super.listBuckets}});return tr(this,arguments,void 0,function*(r={}){return e.listBuckets.call(this,r)})}deleteBucket(e){const r=Object.create(null,{deleteBucket:{get:()=>super.deleteBucket}});return tr(this,void 0,void 0,function*(){return r.deleteBucket.call(this,e)})}}class XA extends WA{constructor(e,r,a,n){super(e,r,n),this.vectorBucketName=a}createIndex(e){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return tr(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return tr(this,arguments,void 0,function*(r={}){return e.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return tr(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return tr(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new KA(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class KA extends VA{constructor(e,r,a,n,s){super(e,r,s),this.vectorBucketName=a,this.indexName=n}putVectors(e){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return tr(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return tr(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return tr(this,arguments,void 0,function*(r={}){return e.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return tr(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return tr(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class JA extends RA{constructor(e,r={},a,n){super(e,r,a,n)}from(e){return new OA(this.url,this.headers,e,this.fetch)}get vectors(){return new YA(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new BA(this.url+"/iceberg",this.headers,this.fetch)}}const ZA="2.86.0";let c0="";typeof Deno<"u"?c0="deno":typeof document<"u"?c0="web":typeof navigator<"u"&&navigator.product==="ReactNative"?c0="react-native":c0="node";const QA={"X-Client-Info":`supabase-js-${c0}/${ZA}`},e6={headers:QA},t6={schema:"public"},r6={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},a6={},n6=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),s6=()=>Headers,i6=(t,e,r)=>{const a=n6(r),n=s6();return async(s,l)=>{var c;const f=(c=await e())!==null&&c!==void 0?c:t;let d=new n(l?.headers);return d.has("apikey")||d.set("apikey",t),d.has("Authorization")||d.set("Authorization",`Bearer ${f}`),a(s,Object.assign(Object.assign({},l),{headers:d}))}};function o6(t){return t.endsWith("/")?t:t+"/"}function l6(t,e){var r,a;const{db:n,auth:s,realtime:l,global:c}=t,{db:f,auth:d,realtime:m,global:v}=e,x={db:Object.assign(Object.assign({},f),n),auth:Object.assign(Object.assign({},d),s),realtime:Object.assign(Object.assign({},m),l),storage:{},global:Object.assign(Object.assign(Object.assign({},v),c),{headers:Object.assign(Object.assign({},(r=v?.headers)!==null&&r!==void 0?r:{}),(a=c?.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return t.accessToken?x.accessToken=t.accessToken:delete x.accessToken,x}function c6(t){const e=t?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(o6(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const L4="2.86.0",Hd=30*1e3,mx=3,ev=mx*Hd,u6="http://localhost:9999",f6="supabase.auth.token",d6={"X-Client-Info":`gotrue-js/${L4}`},px="X-Supabase-Api-Version",P4={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},h6=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,m6=600*1e3;class C0 extends Error{constructor(e,r,a){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=a}}function cr(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class p6 extends C0{constructor(e,r,a){super(e,r,a),this.name="AuthApiError",this.status=r,this.code=a}}function g6(t){return cr(t)&&t.name==="AuthApiError"}class uf extends C0{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class wu extends C0{constructor(e,r,a,n){super(e,a,n),this.name=r,this.status=a}}class Ri extends wu{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function v6(t){return cr(t)&&t.name==="AuthSessionMissingError"}class Od extends wu{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class cp extends wu{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class up extends wu{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function x6(t){return cr(t)&&t.name==="AuthImplicitGrantRedirectError"}class zb extends wu{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class gx extends wu{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function tv(t){return cr(t)&&t.name==="AuthRetryableFetchError"}class Hb extends wu{constructor(e,r,a){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=a}}class vx extends wu{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Vp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),$b=` 	
\r=`.split(""),y6=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<$b.length;e+=1)t[$b[e].charCodeAt(0)]=-2;for(let e=0;e<Vp.length;e+=1)t[Vp[e].charCodeAt(0)]=e;return t})();function Wb(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const a=e.queue>>e.queuedBits-6&63;r(Vp[a]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const a=e.queue>>e.queuedBits-6&63;r(Vp[a]),e.queuedBits-=6}}function M4(t,e,r){const a=y6[t];if(a>-1)for(e.queue=e.queue<<6|a,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Vb(t){const e=[],r=l=>{e.push(String.fromCodePoint(l))},a={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},s=l=>{w6(l,a,r)};for(let l=0;l<t.length;l+=1)M4(t.charCodeAt(l),n,s);return e.join("")}function _6(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function b6(t,e){for(let r=0;r<t.length;r+=1){let a=t.charCodeAt(r);if(a>55295&&a<=56319){const n=(a-55296)*1024&65535;a=(t.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}_6(a,e)}}function w6(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let a=1;a<6;a+=1)if((t>>7-a&1)===0){e.utf8seq=a;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function Jd(t){const e=[],r={queue:0,queuedBits:0},a=n=>{e.push(n)};for(let n=0;n<t.length;n+=1)M4(t.charCodeAt(n),r,a);return new Uint8Array(e)}function S6(t){const e=[];return b6(t,r=>e.push(r)),new Uint8Array(e)}function hf(t){const e=[],r={queue:0,queuedBits:0},a=n=>{e.push(n)};return t.forEach(n=>Wb(n,r,a)),Wb(null,r,a),e.join("")}function N6(t){return Math.round(Date.now()/1e3)+t}function j6(){return Symbol("auth-callback")}const vs=()=>typeof window<"u"&&typeof document<"u",ef={tested:!1,writable:!1},I4=()=>{if(!vs())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ef.tested)return ef.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),ef.tested=!0,ef.writable=!0}catch{ef.tested=!0,ef.writable=!1}return ef.writable};function k6(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,s)=>{e[s]=n})}catch{}return r.searchParams.forEach((a,n)=>{e[n]=a}),e}const B4=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),E6=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",$d=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},tf=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},au=async(t,e)=>{await t.removeItem(e)};class v1{constructor(){this.promise=new v1.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}v1.promiseConstructor=Promise;function rv(t){const e=t.split(".");if(e.length!==3)throw new vx("Invalid JWT structure");for(let a=0;a<e.length;a++)if(!h6.test(e[a]))throw new vx("JWT not in base64url format");return{header:JSON.parse(Vb(e[0])),payload:JSON.parse(Vb(e[1])),signature:Jd(e[2]),raw:{header:e[0],payload:e[1]}}}async function A6(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function C6(t,e){return new Promise((a,n)=>{(async()=>{for(let s=0;s<1/0;s++)try{const l=await t(s);if(!e(s,null,l)){a(l);return}}catch(l){if(!e(s,l)){n(l);return}}})()})}function T6(t){return("0"+t.toString(16)).substr(-2)}function O6(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=r.length;let n="";for(let s=0;s<56;s++)n+=r.charAt(Math.floor(Math.random()*a));return n}return crypto.getRandomValues(e),Array.from(e,T6).join("")}async function R6(t){const r=new TextEncoder().encode(t),a=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(a);return Array.from(n).map(s=>String.fromCharCode(s)).join("")}async function D6(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await R6(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Rd(t,e,r=!1){const a=O6();let n=a;r&&(n+="/PASSWORD_RECOVERY"),await $d(t,`${e}-code-verifier`,n);const s=await D6(a);return[s,a===s?"plain":"s256"]}const F6=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function L6(t){const e=t.headers.get(px);if(!e||!e.match(F6))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function P6(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function M6(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const I6=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Dd(t){if(!I6.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function av(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function B6(t,e){return new Proxy(t,{get:(r,a,n)=>{if(a==="__isInsecureUserWarningProxy")return!0;if(typeof a=="symbol"){const s=a.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,a,n)}return!e.value&&typeof a=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,a,n)}})}function Gb(t){return JSON.parse(JSON.stringify(t))}const sf=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),U6=[502,503,504];async function Yb(t){var e;if(!E6(t))throw new gx(sf(t),0);if(U6.includes(t.status))throw new gx(sf(t),t.status);let r;try{r=await t.json()}catch(s){throw new uf(sf(s),s)}let a;const n=L6(t);if(n&&n.getTime()>=P4["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?a=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(a=r.error_code),a){if(a==="weak_password")throw new Hb(sf(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(a==="session_not_found")throw new Ri}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,l)=>s&&typeof l=="string",!0))throw new Hb(sf(r),t.status,r.weak_password.reasons);throw new p6(sf(r),t.status||500,a)}const q6=(t,e,r,a)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),n.body=JSON.stringify(a),Object.assign(Object.assign({},n),r))};async function _r(t,e,r,a){var n;const s=Object.assign({},a?.headers);s[px]||(s[px]=P4["2024-01-01"].name),a?.jwt&&(s.Authorization=`Bearer ${a.jwt}`);const l=(n=a?.query)!==null&&n!==void 0?n:{};a?.redirectTo&&(l.redirect_to=a.redirectTo);const c=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",f=await z6(t,e,r+c,{headers:s,noResolveJson:a?.noResolveJson},{},a?.body);return a?.xform?a?.xform(f):{data:Object.assign({},f),error:null}}async function z6(t,e,r,a,n,s){const l=q6(e,a,n,s);let c;try{c=await t(r,Object.assign({},l))}catch(f){throw console.error(f),new gx(sf(f),0)}if(c.ok||await Yb(c),a?.noResolveJson)return c;try{return await c.json()}catch(f){await Yb(f)}}function Ho(t){var e;let r=null;W6(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=N6(t.expires_in)));const a=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:a},error:null}}function Xb(t){const e=Ho(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0)&&(e.data.weak_password=t.weak_password),e}function fu(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function H6(t){return{data:t,error:null}}function $6(t){const{action_link:e,email_otp:r,hashed_token:a,redirect_to:n,verification_type:s}=t,l=fh(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:r,hashed_token:a,redirect_to:n,verification_type:s},f=Object.assign({},l);return{data:{properties:c,user:f},error:null}}function Kb(t){return t}function W6(t){return t.access_token&&t.refresh_token&&t.expires_in}const nv=["global","local","others"];class V6{constructor({url:e="",headers:r={},fetch:a}){this.url=e,this.headers=r,this.fetch=B4(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=nv[0]){if(nv.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${nv.join(", ")}`);try{return await _r(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(a){if(cr(a))return{data:null,error:a};throw a}}async inviteUserByEmail(e,r={}){try{return await _r(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:fu})}catch(a){if(cr(a))return{data:{user:null},error:a};throw a}}async generateLink(e){try{const{options:r}=e,a=fh(e,["options"]),n=Object.assign(Object.assign({},a),r);return"newEmail"in a&&(n.new_email=a?.newEmail,delete n.newEmail),await _r(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:$6,redirectTo:r?.redirectTo})}catch(r){if(cr(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await _r(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:fu})}catch(r){if(cr(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,a,n,s,l,c,f;try{const d={nextPage:null,lastPage:0,total:0},m=await _r(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(s=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""},xform:Kb});if(m.error)throw m.error;const v=await m.json(),x=(l=m.headers.get("x-total-count"))!==null&&l!==void 0?l:0,g=(f=(c=m.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&f!==void 0?f:[];return g.length>0&&(g.forEach(b=>{const _=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(b.split(";")[1].split("=")[1]);d[`${w}Page`]=_}),d.total=parseInt(x)),{data:Object.assign(Object.assign({},v),d),error:null}}catch(d){if(cr(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Dd(e);try{return await _r(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:fu})}catch(r){if(cr(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Dd(e);try{return await _r(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:fu})}catch(a){if(cr(a))return{data:{user:null},error:a};throw a}}async deleteUser(e,r=!1){Dd(e);try{return await _r(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:fu})}catch(a){if(cr(a))return{data:{user:null},error:a};throw a}}async _listFactors(e){Dd(e.userId);try{const{data:r,error:a}=await _r(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:a}}catch(r){if(cr(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Dd(e.userId),Dd(e.id);try{return{data:await _r(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(cr(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,a,n,s,l,c,f;try{const d={nextPage:null,lastPage:0,total:0},m=await _r(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(s=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""},xform:Kb});if(m.error)throw m.error;const v=await m.json(),x=(l=m.headers.get("x-total-count"))!==null&&l!==void 0?l:0,g=(f=(c=m.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&f!==void 0?f:[];return g.length>0&&(g.forEach(b=>{const _=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(b.split(";")[1].split("=")[1]);d[`${w}Page`]=_}),d.total=parseInt(x)),{data:Object.assign(Object.assign({},v),d),error:null}}catch(d){if(cr(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await _r(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(cr(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await _r(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(cr(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await _r(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(cr(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(e){try{return await _r(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(cr(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await _r(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(cr(r))return{data:null,error:r};throw r}}}function Jb(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const Fd={debug:!!(globalThis&&I4()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class U4 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class G6 extends U4{}async function Y6(t,e,r){Fd.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const a=new globalThis.AbortController;return e>0&&setTimeout(()=>{a.abort(),Fd.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async n=>{if(n){Fd.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await r()}finally{Fd.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw Fd.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new G6(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Fd.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function X6(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function q4(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function K6(t){return parseInt(t,16)}function J6(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,a=>a.toString(16).padStart(2,"0")).join("")}function Z6(t){var e;const{chainId:r,domain:a,expirationTime:n,issuedAt:s=new Date,nonce:l,notBefore:c,requestId:f,resources:d,scheme:m,uri:v,version:x}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!v)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(x!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${x}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const g=q4(t.address),b=m?`${m}://${a}`:a,_=t.statement?`${t.statement}
`:"",w=`${b} wants you to sign in with your Ethereum account:
${g}

${_}`;let E=`URI: ${v}
Version: ${x}
Chain ID: ${r}${l?`
Nonce: ${l}`:""}
Issued At: ${s.toISOString()}`;if(n&&(E+=`
Expiration Time: ${n.toISOString()}`),c&&(E+=`
Not Before: ${c.toISOString()}`),f&&(E+=`
Request ID: ${f}`),d){let C=`
Resources:`;for(const A of d){if(!A||typeof A!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${A}`);C+=`
- ${A}`}E+=C}return`${w}
${E}`}class In extends Error{constructor({message:e,code:r,cause:a,name:n}){var s;super(e,{cause:a}),this.__isWebAuthnError=!0,this.name=(s=n??(a instanceof Error?a.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class Gp extends In{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function Q6({error:t,options:e}){var r,a,n;const{publicKey:s}=e;if(!s)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new In({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new In({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((a=s.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new In({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new In({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new In({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new In({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return s.pubKeyCredParams.filter(c=>c.type==="public-key").length===0?new In({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new In({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const l=window.location.hostname;if(z4(l)){if(s.rp.id!==l)return new In({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new In({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new In({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new In({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new In({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function eC({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new In({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new In({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const a=window.location.hostname;if(z4(a)){if(r.rpId!==a)return new In({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new In({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new In({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new In({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class tC{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const rC=new tC;function aC(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:a}=t,n=fh(t,["challenge","user","excludeCredentials"]),s=Jd(e).buffer,l=Object.assign(Object.assign({},r),{id:Jd(r.id).buffer}),c=Object.assign(Object.assign({},n),{challenge:s,user:l});if(a&&a.length>0){c.excludeCredentials=new Array(a.length);for(let f=0;f<a.length;f++){const d=a[f];c.excludeCredentials[f]=Object.assign(Object.assign({},d),{id:Jd(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return c}function nC(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,a=fh(t,["challenge","allowCredentials"]),n=Jd(e).buffer,s=Object.assign(Object.assign({},a),{challenge:n});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let l=0;l<r.length;l++){const c=r[l];s.allowCredentials[l]=Object.assign(Object.assign({},c),{id:Jd(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return s}function sC(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:hf(new Uint8Array(t.response.attestationObject)),clientDataJSON:hf(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function iC(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,a=t.getClientExtensionResults(),n=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:hf(new Uint8Array(n.authenticatorData)),clientDataJSON:hf(new Uint8Array(n.clientDataJSON)),signature:hf(new Uint8Array(n.signature)),userHandle:n.userHandle?hf(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function z4(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function Zb(){var t,e;return!!(vs()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function oC(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Gp("Browser returned unexpected credential type",e)}:{data:null,error:new Gp("Empty credential response",e)}}catch(e){return{data:null,error:Q6({error:e,options:t})}}}async function lC(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Gp("Browser returned unexpected credential type",e)}:{data:null,error:new Gp("Empty credential response",e)}}catch(e){return{data:null,error:eC({error:e,options:t})}}}const cC={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},uC={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Yp(...t){const e=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),r=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),a={};for(const n of t)if(n)for(const s in n){const l=n[s];if(l!==void 0)if(Array.isArray(l))a[s]=l;else if(r(l))a[s]=l;else if(e(l)){const c=a[s];e(c)?a[s]=Yp(c,l):a[s]=Yp(l)}else a[s]=l}return a}function fC(t,e){return Yp(cC,t,e||{})}function dC(t,e){return Yp(uC,t,e||{})}class hC{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:a,signal:n},s){try{const{data:l,error:c}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!l)return{data:null,error:c};const f=n??rC.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:d}=l.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${a}`),d.displayName||(d.displayName=d.name)}switch(l.webauthn.type){case"create":{const d=fC(l.webauthn.credential_options.publicKey,s?.create),{data:m,error:v}=await oC({publicKey:d,signal:f});return m?{data:{factorId:e,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:m}},error:null}:{data:null,error:v}}case"request":{const d=dC(l.webauthn.credential_options.publicKey,s?.request),{data:m,error:v}=await lC(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:d,signal:f}));return m?{data:{factorId:e,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:m}},error:null}:{data:null,error:v}}}}catch(l){return cr(l)?{data:null,error:l}:{data:null,error:new uf("Unexpected error in challenge",l)}}}async _verify({challengeId:e,factorId:r,webauthn:a}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:a})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},s){if(!r)return{data:null,error:new C0("rpId is required for WebAuthn authentication")};try{if(!Zb())return{data:null,error:new uf("Browser does not support WebAuthn",null)};const{data:l,error:c}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:a},signal:n},{request:s});if(!l)return{data:null,error:c};const{webauthn:f}=l;return this._verify({factorId:e,challengeId:l.challengeId,webauthn:{type:f.type,rpId:r,rpOrigins:a,credential_response:f.credential_response}})}catch(l){return cr(l)?{data:null,error:l}:{data:null,error:new uf("Unexpected error in authenticate",l)}}}async _register({friendlyName:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},s){if(!r)return{data:null,error:new C0("rpId is required for WebAuthn registration")};try{if(!Zb())return{data:null,error:new uf("Browser does not support WebAuthn",null)};const{data:l,error:c}=await this._enroll({friendlyName:e});if(!l)return await this.client.mfa.listFactors().then(m=>{var v;return(v=m.data)===null||v===void 0?void 0:v.all.find(x=>x.factor_type==="webauthn"&&x.friendly_name===e&&x.status!=="unverified")}).then(m=>m?this.client.mfa.unenroll({factorId:m?.id}):void 0),{data:null,error:c};const{data:f,error:d}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:r,rpOrigins:a},signal:n},{create:s});return f?this._verify({factorId:l.id,challengeId:f.challengeId,webauthn:{rpId:r,rpOrigins:a,type:f.webauthn.type,credential_response:f.webauthn.credential_response}}):{data:null,error:d}}catch(l){return cr(l)?{data:null,error:l}:{data:null,error:new uf("Unexpected error in register",l)}}}}X6();const mC={url:u6,storageKey:f6,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:d6,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Qb(t,e,r){return await r()}const Ld={};class T0{get jwks(){var e,r;return(r=(e=Ld[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Ld[this.storageKey]=Object.assign(Object.assign({},Ld[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Ld[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Ld[this.storageKey]=Object.assign(Object.assign({},Ld[this.storageKey]),{cachedAt:e})}constructor(e){var r,a,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},mC),e);if(this.storageKey=s.storageKey,this.instanceID=(r=T0.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,T0.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.instanceID>0&&vs()){const l=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(l),this.logDebugMessages&&console.trace(l)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new V6({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=B4(s.fetch),this.lock=s.lock||Qb,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,s.lock?this.lock=s.lock:vs()&&(!((a=globalThis?.navigator)===null||a===void 0)&&a.locks)?this.lock=Y6:this.lock=Qb,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new hC(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:I4()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Jb(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=Jb(this.memoryStorage)),vs()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${L4}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},a="none";if(vs()&&(r=k6(window.location.href),this._isImplicitGrantCallback(r)?a="implicit":await this._isPKCECallback(r)&&(a="pkce")),vs()&&this.detectSessionInUrl&&a!=="none"){const{data:n,error:s}=await this._getSessionFromURL(r,a);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),x6(s)){const f=(e=s.details)===null||e===void 0?void 0:e.code;if(f==="identity_already_exists"||f==="identity_not_found"||f==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:l,redirectType:c}=n;return this._debug("#_initialize()","detected session in URL",l,"redirect type",c),await this._saveSession(l),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return cr(r)?this._returnResult({error:r}):this._returnResult({error:new uf("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,a,n;try{const s=await _r(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(n=e?.options)===null||n===void 0?void 0:n.captchaToken}},xform:Ho}),{data:l,error:c}=s;if(c||!l)return this._returnResult({data:{user:null,session:null},error:c});const f=l.session,d=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",f)),this._returnResult({data:{user:d,session:f},error:null})}catch(s){if(cr(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(e){var r,a,n;try{let s;if("email"in e){const{email:m,password:v,options:x}=e;let g=null,b=null;this.flowType==="pkce"&&([g,b]=await Rd(this.storage,this.storageKey)),s=await _r(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:x?.emailRedirectTo,body:{email:m,password:v,data:(r=x?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:x?.captchaToken},code_challenge:g,code_challenge_method:b},xform:Ho})}else if("phone"in e){const{phone:m,password:v,options:x}=e;s=await _r(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:v,data:(a=x?.data)!==null&&a!==void 0?a:{},channel:(n=x?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:x?.captchaToken}},xform:Ho})}else throw new cp("You must provide either an email or phone number and a password");const{data:l,error:c}=s;if(c||!l)return this._returnResult({data:{user:null,session:null},error:c});const f=l.session,d=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",f)),this._returnResult({data:{user:d,session:f},error:null})}catch(s){if(cr(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(e){try{let r;if("email"in e){const{email:s,password:l,options:c}=e;r=await _r(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:l,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Xb})}else if("phone"in e){const{phone:s,password:l,options:c}=e;r=await _r(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:l,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Xb})}else throw new cp("You must provide either an email or phone number and a password");const{data:a,error:n}=r;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!a||!a.session||!a.user){const s=new Od;return this._returnResult({data:{user:null,session:null},error:s})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:n})}catch(r){if(cr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,a,n,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,a,n,s,l,c,f,d,m,v,x;let g,b;if("message"in e)g=e.message,b=e.signature;else{const{chain:_,wallet:w,statement:E,options:C}=e;let A;if(vs())if(typeof w=="object")A=w;else{const L=window;if("ethereum"in L&&typeof L.ethereum=="object"&&"request"in L.ethereum&&typeof L.ethereum.request=="function")A=L.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!C?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");A=w}const T=new URL((r=C?.url)!==null&&r!==void 0?r:window.location.href),G=await A.request({method:"eth_requestAccounts"}).then(L=>L).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!G||G.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const W=q4(G[0]);let B=(a=C?.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!B){const L=await A.request({method:"eth_chainId"});B=K6(L)}const q={domain:T.host,address:W,statement:E,uri:T.href,version:"1",chainId:B,nonce:(n=C?.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(l=(s=C?.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(c=C?.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(f=C?.signInWithEthereum)===null||f===void 0?void 0:f.notBefore,requestId:(d=C?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(m=C?.signInWithEthereum)===null||m===void 0?void 0:m.resources};g=Z6(q),b=await A.request({method:"personal_sign",params:[J6(g),W]})}try{const{data:_,error:w}=await _r(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:g,signature:b},!((v=e.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(x=e.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:Ho});if(w)throw w;if(!_||!_.session||!_.user){const E=new Od;return this._returnResult({data:{user:null,session:null},error:E})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:w})}catch(_){if(cr(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signInWithSolana(e){var r,a,n,s,l,c,f,d,m,v,x,g;let b,_;if("message"in e)b=e.message,_=e.signature;else{const{chain:w,wallet:E,statement:C,options:A}=e;let T;if(vs())if(typeof E=="object")T=E;else{const W=window;if("solana"in W&&typeof W.solana=="object"&&("signIn"in W.solana&&typeof W.solana.signIn=="function"||"signMessage"in W.solana&&typeof W.solana.signMessage=="function"))T=W.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof E!="object"||!A?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");T=E}const G=new URL((r=A?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in T&&T.signIn){const W=await T.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},A?.signInWithSolana),{version:"1",domain:G.host,uri:G.href}),C?{statement:C}:null));let B;if(Array.isArray(W)&&W[0]&&typeof W[0]=="object")B=W[0];else if(W&&typeof W=="object"&&"signedMessage"in W&&"signature"in W)B=W;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in B&&"signature"in B&&(typeof B.signedMessage=="string"||B.signedMessage instanceof Uint8Array)&&B.signature instanceof Uint8Array)b=typeof B.signedMessage=="string"?B.signedMessage:new TextDecoder().decode(B.signedMessage),_=B.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in T)||typeof T.signMessage!="function"||!("publicKey"in T)||typeof T!="object"||!T.publicKey||!("toBase58"in T.publicKey)||typeof T.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${G.host} wants you to sign in with your Solana account:`,T.publicKey.toBase58(),...C?["",C,""]:[""],"Version: 1",`URI: ${G.href}`,`Issued At: ${(n=(a=A?.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((s=A?.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${A.signInWithSolana.notBefore}`]:[],...!((l=A?.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${A.signInWithSolana.expirationTime}`]:[],...!((c=A?.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${A.signInWithSolana.chainId}`]:[],...!((f=A?.signInWithSolana)===null||f===void 0)&&f.nonce?[`Nonce: ${A.signInWithSolana.nonce}`]:[],...!((d=A?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${A.signInWithSolana.requestId}`]:[],...!((v=(m=A?.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||v===void 0)&&v.length?["Resources",...A.signInWithSolana.resources.map(B=>`- ${B}`)]:[]].join(`
`);const W=await T.signMessage(new TextEncoder().encode(b),"utf8");if(!W||!(W instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=W}}try{const{data:w,error:E}=await _r(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:hf(_)},!((x=e.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(g=e.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:Ho});if(E)throw E;if(!w||!w.session||!w.user){const C=new Od;return this._returnResult({data:{user:null,session:null},error:C})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:E})}catch(w){if(cr(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async _exchangeCodeForSession(e){const r=await tf(this.storage,`${this.storageKey}-code-verifier`),[a,n]=(r??"").split("/");try{const{data:s,error:l}=await _r(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:a},xform:Ho});if(await au(this.storage,`${this.storageKey}-code-verifier`),l)throw l;if(!s||!s.session||!s.user){const c=new Od;return this._returnResult({data:{user:null,session:null,redirectType:null},error:c})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:n??null}),error:l})}catch(s){if(cr(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(e){try{const{options:r,provider:a,token:n,access_token:s,nonce:l}=e,c=await _r(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:n,access_token:s,nonce:l,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Ho}),{data:f,error:d}=c;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!f||!f.session||!f.user){const m=new Od;return this._returnResult({data:{user:null,session:null},error:m})}return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",f.session)),this._returnResult({data:f,error:d})}catch(r){if(cr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,a,n,s,l;try{if("email"in e){const{email:c,options:f}=e;let d=null,m=null;this.flowType==="pkce"&&([d,m]=await Rd(this.storage,this.storageKey));const{error:v}=await _r(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(r=f?.data)!==null&&r!==void 0?r:{},create_user:(a=f?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:d,code_challenge_method:m},redirectTo:f?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:v})}if("phone"in e){const{phone:c,options:f}=e,{data:d,error:m}=await _r(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(n=f?.data)!==null&&n!==void 0?n:{},create_user:(s=f?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},channel:(l=f?.channel)!==null&&l!==void 0?l:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d?.message_id},error:m})}throw new cp("You must provide either an email or phone number.")}catch(c){if(cr(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async verifyOtp(e){var r,a;try{let n,s;"options"in e&&(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo,s=(a=e.options)===null||a===void 0?void 0:a.captchaToken);const{data:l,error:c}=await _r(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:n,xform:Ho});if(c)throw c;if(!l)throw new Error("An error occurred on token verification.");const f=l.session,d=l.user;return f?.access_token&&(await this._saveSession(f),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",f)),this._returnResult({data:{user:d,session:f},error:null})}catch(n){if(cr(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(e){var r,a,n,s,l;try{let c=null,f=null;this.flowType==="pkce"&&([c,f]=await Rd(this.storage,this.storageKey));const d=await _r(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(a=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&a!==void 0?a:void 0}),!((n=e?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:f}),headers:this.headers,xform:H6});return!((s=d.data)===null||s===void 0)&&s.url&&vs()&&!(!((l=e.options)===null||l===void 0)&&l.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(c){if(cr(c))return this._returnResult({data:null,error:c});throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:a}=e;if(a)throw a;if(!r)throw new Ri;const{error:n}=await _r(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(e){if(cr(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:a,type:n,options:s}=e,{error:l}=await _r(this.fetch,"POST",r,{headers:this.headers,body:{email:a,type:n,gotrue_meta_security:{captcha_token:s?.captchaToken}},redirectTo:s?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:l})}else if("phone"in e){const{phone:a,type:n,options:s}=e,{data:l,error:c}=await _r(this.fetch,"POST",r,{headers:this.headers,body:{phone:a,type:n,gotrue_meta_security:{captcha_token:s?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:l?.message_id},error:c})}throw new cp("You must provide either an email or phone number and a type")}catch(r){if(cr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await a,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=r();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await tf(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const a=e.expires_at?e.expires_at*1e3-Date.now()<ev:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",e.expires_at),!a){if(this.userStorage){const l=await tf(this.userStorage,this.storageKey+"-user");l?.user?e.user=l.user:e.user=av()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const l={value:this.suppressGetSessionWarning};e.user=B6(e.user,l),l.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:n,error:s}=await this._callRefreshToken(e.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await _r(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:fu}):await this._useSession(async r=>{var a,n,s;const{data:l,error:c}=r;if(c)throw c;return!(!((a=l.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ri}:await _r(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0,xform:fu})})}catch(r){if(cr(r))return v6(r)&&(await this._removeSession(),await au(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async a=>{const{data:n,error:s}=a;if(s)throw s;if(!n.session)throw new Ri;const l=n.session;let c=null,f=null;this.flowType==="pkce"&&e.email!=null&&([c,f]=await Rd(this.storage,this.storageKey));const{data:d,error:m}=await _r(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:f}),jwt:l.access_token,xform:fu});if(m)throw m;return l.user=d.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),this._returnResult({data:{user:l.user},error:null})})}catch(a){if(cr(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ri;const r=Date.now()/1e3;let a=r,n=!0,s=null;const{payload:l}=rv(e.access_token);if(l.exp&&(a=l.exp,n=a<=r),n){const{data:c,error:f}=await this._callRefreshToken(e.refresh_token);if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!c)return{data:{user:null,session:null},error:null};s=c}else{const{data:c,error:f}=await this._getUser(e.access_token);if(f)throw f;s={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:a-r,expires_at:a},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(r){if(cr(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var a;if(!e){const{data:l,error:c}=r;if(c)throw c;e=(a=l.session)!==null&&a!==void 0?a:void 0}if(!e?.refresh_token)throw new Ri;const{data:n,error:s}=await this._callRefreshToken(e.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(cr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!vs())throw new up("No browser detected.");if(e.error||e.error_description||e.error_code)throw new up(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new zb("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new up("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new zb("No code detected.");const{data:C,error:A}=await this._exchangeCodeForSession(e.code);if(A)throw A;const T=new URL(window.location.href);return T.searchParams.delete("code"),window.history.replaceState(window.history.state,"",T.toString()),{data:{session:C.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:n,access_token:s,refresh_token:l,expires_in:c,expires_at:f,token_type:d}=e;if(!s||!c||!l||!d)throw new up("No session defined in URL");const m=Math.round(Date.now()/1e3),v=parseInt(c);let x=m+v;f&&(x=parseInt(f));const g=x-m;g*1e3<=Hd&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${v}s`);const b=x-v;m-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,x,m):m-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,x,m);const{data:_,error:w}=await this._getUser(s);if(w)throw w;const E={provider_token:a,provider_refresh_token:n,access_token:s,expires_in:v,expires_at:x,refresh_token:l,token_type:d,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:E,redirectType:e.type},error:null})}catch(a){if(cr(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await tf(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var a;const{data:n,error:s}=r;if(s)return this._returnResult({error:s});const l=(a=n.session)===null||a===void 0?void 0:a.access_token;if(l){const{error:c}=await this.admin.signOut(l,e);if(c&&!(g6(c)&&(c.status===404||c.status===401||c.status===403)))return this._returnResult({error:c})}return e!=="others"&&(await this._removeSession(),await au(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=j6(),a={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:a}}}async _emitInitialSession(e){return await this._useSession(async r=>{var a,n;try{const{data:{session:s},error:l}=r;if(l)throw l;await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,r={}){let a=null,n=null;this.flowType==="pkce"&&([a,n]=await Rd(this.storage,this.storageKey,!0));try{return await _r(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:a,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(cr(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var e;try{const{data:r,error:a}=await this.getUser();if(a)throw a;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(cr(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:a,error:n}=await this._useSession(async s=>{var l,c,f,d,m;const{data:v,error:x}=s;if(x)throw x;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(l=e.options)===null||l===void 0?void 0:l.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(f=e.options)===null||f===void 0?void 0:f.queryParams,skipBrowserRedirect:!0});return await _r(this.fetch,"GET",g,{headers:this.headers,jwt:(m=(d=v.session)===null||d===void 0?void 0:d.access_token)!==null&&m!==void 0?m:void 0})});if(n)throw n;return vs()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(a?.url),this._returnResult({data:{provider:e.provider,url:a?.url},error:null})}catch(a){if(cr(a))return this._returnResult({data:{provider:e.provider,url:null},error:a});throw a}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var a;try{const{error:n,data:{session:s}}=r;if(n)throw n;const{options:l,provider:c,token:f,access_token:d,nonce:m}=e,v=await _r(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=s?.access_token)!==null&&a!==void 0?a:void 0,body:{provider:c,id_token:f,access_token:d,nonce:m,link_identity:!0,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Ho}),{data:x,error:g}=v;return g?this._returnResult({data:{user:null,session:null},error:g}):!x||!x.session||!x.user?this._returnResult({data:{user:null,session:null},error:new Od}):(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("USER_UPDATED",x.session)),this._returnResult({data:x,error:g}))}catch(n){if(cr(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var a,n;const{data:s,error:l}=r;if(l)throw l;return await _r(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(a=s.session)===null||a===void 0?void 0:a.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(cr(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const a=Date.now();return await C6(async n=>(n>0&&await A6(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await _r(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ho})),(n,s)=>{const l=200*Math.pow(2,n);return s&&tv(s)&&Date.now()+l-a<Hd})}catch(a){if(this._debug(r,"error",a),cr(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const a=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",a),vs()&&!r.skipBrowserRedirect&&window.location.assign(a),{data:{provider:e,url:a},error:null}}async _recoverAndRefresh(){var e,r;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const n=await tf(this.storage,this.storageKey);if(n&&this.userStorage){let l=await tf(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:n.user},await $d(this.userStorage,this.storageKey+"-user",l)),n.user=(e=l?.user)!==null&&e!==void 0?e:av()}else if(n&&!n.user&&!n.user){const l=await tf(this.storage,this.storageKey+"-user");l&&l?.user?(n.user=l.user,await au(this.storage,this.storageKey+"-user"),await $d(this.storage,this.storageKey,n)):n.user=av()}if(this._debug(a,"session from storage",n),!this._isValidSession(n)){this._debug(a,"session is not valid"),n!==null&&await this._removeSession();return}const s=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<ev;if(this._debug(a,`session has${s?"":" not"} expired with margin of ${ev}s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:l}=await this._callRefreshToken(n.refresh_token);l&&(console.error(l),tv(l)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:c}=await this._getUser(n.access_token);!c&&l?.user?(n.user=l.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(a,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(a,"error",n),console.error(n);return}finally{this._debug(a,"end")}}async _callRefreshToken(e){var r,a;if(!e)throw new Ri;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new v1;const{data:s,error:l}=await this._refreshAccessToken(e);if(l)throw l;if(!s.session)throw new Ri;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const c={data:s.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(s){if(this._debug(n,"error",s),cr(s)){const l={data:null,error:s};return tv(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(s),s}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,r,a=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",r,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:e,session:r});const s=[],l=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,r)}catch(f){s.push(f)}});if(await Promise.all(l),s.length>0){for(let c=0;c<s.length;c+=1)console.error(s[c]);throw s[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),a=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&r.user&&await $d(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const s=Gb(n);await $d(this.storage,this.storageKey,s)}else{const n=Gb(r);await $d(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await au(this.storage,this.storageKey),await au(this.storage,this.storageKey+"-code-verifier"),await au(this.storage,this.storageKey+"-user"),this.userStorage&&await au(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&vs()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Hd);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:a}}=r;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((a.expires_at*1e3-e)/Hd);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Hd}ms, refresh threshold is ${mx} ticks`),n<=mx&&await this._callRefreshToken(a.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof U4)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!vs()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,a){const n=[`provider=${encodeURIComponent(r)}`];if(a?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a?.scopes&&n.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[s,l]=await Rd(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(l)}`});n.push(c.toString())}if(a?.queryParams){const s=new URLSearchParams(a.queryParams);n.push(s.toString())}return a?.skipBrowserRedirect&&n.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var a;const{data:n,error:s}=r;return s?this._returnResult({data:null,error:s}):await _r(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(a=n?.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(cr(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var a,n;const{data:s,error:l}=r;if(l)return this._returnResult({data:null,error:l});const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:f,error:d}=await _r(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(a=s?.session)===null||a===void 0?void 0:a.access_token});return d?this._returnResult({data:null,error:d}):(e.factorType==="totp"&&f.type==="totp"&&(!((n=f?.totp)===null||n===void 0)&&n.qr_code)&&(f.totp.qr_code=`data:image/svg+xml;utf-8,${f.totp.qr_code}`),this._returnResult({data:f,error:null}))})}catch(r){if(cr(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:n,error:s}=r;if(s)return this._returnResult({data:null,error:s});const l=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?sC(e.webauthn.credential_response):iC(e.webauthn.credential_response)})}:{code:e.code}),{data:c,error:f}=await _r(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:l,headers:this.headers,jwt:(a=n?.session)===null||a===void 0?void 0:a.access_token});return f?this._returnResult({data:null,error:f}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),this._returnResult({data:c,error:f}))})}catch(r){if(cr(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:n,error:s}=r;if(s)return this._returnResult({data:null,error:s});const l=await _r(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(a=n?.session)===null||a===void 0?void 0:a.access_token});if(l.error)return l;const{data:c}=l;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:aC(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:nC(c.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(cr(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:a}=await this._challenge({factorId:e.factorId});return a?this._returnResult({data:null,error:a}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:a}=await this.getUser();if(a)return{data:null,error:a};const n={all:[],phone:[],totp:[],webauthn:[]};for(const s of(e=r?.factors)!==null&&e!==void 0?e:[])n.all.push(s),s.status==="verified"&&n[s.factor_type].push(s);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){var e,r;const{data:{session:a},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=rv(a.access_token);let l=null;s.aal&&(l=s.aal);let c=l;((r=(e=a.user.factors)===null||e===void 0?void 0:e.filter(m=>m.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const d=s.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:a},error:n}=r;return n?this._returnResult({data:null,error:n}):a?await _r(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:a.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Ri})})}catch(r){if(cr(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async a=>{const{data:{session:n},error:s}=a;if(s)return this._returnResult({data:null,error:s});if(!n)return this._returnResult({data:null,error:new Ri});const l=await _r(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:c=>({data:c,error:null})});return l.data&&l.data.redirect_url&&vs()&&!r?.skipBrowserRedirect&&window.location.assign(l.data.redirect_url),l})}catch(a){if(cr(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(e,r){try{return await this._useSession(async a=>{const{data:{session:n},error:s}=a;if(s)return this._returnResult({data:null,error:s});if(!n)return this._returnResult({data:null,error:new Ri});const l=await _r(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:c=>({data:c,error:null})});return l.data&&l.data.redirect_url&&vs()&&!r?.skipBrowserRedirect&&window.location.assign(l.data.redirect_url),l})}catch(a){if(cr(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:r},error:a}=e;return a?this._returnResult({data:null,error:a}):r?await _r(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new Ri})})}catch(e){if(cr(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async r=>{const{data:{session:a},error:n}=r;return n?this._returnResult({data:null,error:n}):a?(await _r(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:a.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Ri})})}catch(r){if(cr(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,r={keys:[]}){let a=r.keys.find(c=>c.kid===e);if(a)return a;const n=Date.now();if(a=this.jwks.keys.find(c=>c.kid===e),a&&this.jwks_cached_at+m6>n)return a;const{data:s,error:l}=await _r(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=n,a=s.keys.find(c=>c.kid===e),!a)?null:a}async getClaims(e,r={}){try{let a=e;if(!a){const{data:g,error:b}=await this.getSession();if(b||!g.session)return this._returnResult({data:null,error:b});a=g.session.access_token}const{header:n,payload:s,signature:l,raw:{header:c,payload:f}}=rv(a);r?.allowExpired||P6(s.exp);const d=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!d){const{error:g}=await this.getUser(a);if(g)throw g;return{data:{claims:s,header:n,signature:l},error:null}}const m=M6(n.alg),v=await crypto.subtle.importKey("jwk",d,m,!0,["verify"]);if(!await crypto.subtle.verify(m,v,l,S6(`${c}.${f}`)))throw new vx("Invalid JWT signature");return{data:{claims:s,header:n,signature:l},error:null}}catch(a){if(cr(a))return this._returnResult({data:null,error:a});throw a}}}T0.nextInstanceID={};const pC=T0;class gC extends pC{constructor(e){super(e)}}class vC{constructor(e,r,a){var n,s,l;this.supabaseUrl=e,this.supabaseKey=r;const c=c6(e);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const f=`sb-${c.hostname.split(".")[0]}-auth-token`,d={db:t6,realtime:a6,auth:Object.assign(Object.assign({},r6),{storageKey:f}),global:e6},m=l6(a??{},d);this.storageKey=(n=m.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(s=m.global.headers)!==null&&s!==void 0?s:{},m.accessToken?(this.accessToken=m.accessToken,this.auth=new Proxy({},{get:(v,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=m.auth)!==null&&l!==void 0?l:{},this.headers,m.global.fetch),this.fetch=i6(r,this._getAccessToken.bind(this),m.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},m.realtime)),this.accessToken&&this.accessToken().then(v=>this.realtime.setAuth(v)).catch(v=>console.warn("Failed to set initial Realtime auth token:",v)),this.rest=new aA(new URL("rest/v1",c).href,{headers:this.headers,schema:m.db.schema,fetch:this.fetch}),this.storage=new JA(this.storageUrl.href,this.headers,this.fetch,a?.storage),m.accessToken||this._listenForAuthEvents()}get functions(){return new QE(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},a={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,r,a)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,r;if(this.accessToken)return await this.accessToken();const{data:a}=await this.auth.getSession();return(r=(e=a.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:a,storage:n,userStorage:s,storageKey:l,flowType:c,lock:f,debug:d,throwOnError:m},v,x){const g={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new gC({url:this.authUrl.href,headers:Object.assign(Object.assign({},g),v),storageKey:l,autoRefreshToken:e,persistSession:r,detectSessionInUrl:a,storage:n,userStorage:s,flowType:c,lock:f,debug:d,throwOnError:m,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(b=>b.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new _A(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,a)=>{this._handleTokenChanged(r,"CLIENT",a?.access_token)})}_handleTokenChanged(e,r,a){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==a?(this.changedAccessToken=a,this.realtime.setAuth(a)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const xC=(t,e,r)=>new vC(t,e,r);function yC(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}yC()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const _C="fieldsync-offline",bC=1,Sn={PROJECTS:"projects",AREAS:"areas",CREW_CHECKINS:"crew_checkins",PENDING_ACTIONS:"pending_actions",CACHED_DATA:"cached_data"};let mf=null;const vc=()=>new Promise((t,e)=>{if(mf){t(mf);return}const r=indexedDB.open(_C,bC);r.onerror=()=>{console.error("Failed to open offline database"),e(r.error)},r.onsuccess=()=>{mf=r.result,console.log("Offline database initialized"),t(mf)},r.onupgradeneeded=a=>{const n=a.target.result;if(n.objectStoreNames.contains(Sn.PROJECTS)||n.createObjectStore(Sn.PROJECTS,{keyPath:"id"}).createIndex("company_id","company_id",{unique:!1}),n.objectStoreNames.contains(Sn.AREAS)||n.createObjectStore(Sn.AREAS,{keyPath:"id"}).createIndex("project_id","project_id",{unique:!1}),n.objectStoreNames.contains(Sn.CREW_CHECKINS)||n.createObjectStore(Sn.CREW_CHECKINS,{keyPath:"id"}).createIndex("project_id","project_id",{unique:!1}),!n.objectStoreNames.contains(Sn.PENDING_ACTIONS)){const s=n.createObjectStore(Sn.PENDING_ACTIONS,{keyPath:"id",autoIncrement:!0});s.createIndex("type","type",{unique:!1}),s.createIndex("created_at","created_at",{unique:!1})}n.objectStoreNames.contains(Sn.CACHED_DATA)||n.createObjectStore(Sn.CACHED_DATA,{keyPath:"key"})}}),Tf=(t,e="readonly")=>{if(!mf)throw new Error("Database not initialized");return mf.transaction(t,e).objectStore(t)},wC=async(t,e)=>(await vc(),new Promise((r,a)=>{const s=Tf(t,"readwrite").put(e);s.onsuccess=()=>r(s.result),s.onerror=()=>a(s.error)})),H4=async(t,e)=>(await vc(),new Promise((r,a)=>{const n=mf.transaction(t,"readwrite"),s=n.objectStore(t);e.forEach(l=>s.put(l)),n.oncomplete=()=>r(),n.onerror=()=>a(n.error)})),SC=async(t,e)=>(await vc(),new Promise((r,a)=>{const s=Tf(t).get(e);s.onsuccess=()=>r(s.result),s.onerror=()=>a(s.error)})),$4=async t=>(await vc(),new Promise((e,r)=>{const n=Tf(t).getAll();n.onsuccess=()=>e(n.result||[]),n.onerror=()=>r(n.error)})),W4=async(t,e,r)=>(await vc(),new Promise((a,n)=>{const c=Tf(t).index(e).getAll(r);c.onsuccess=()=>a(c.result||[]),c.onerror=()=>n(c.error)})),NC=async(t,e)=>(await vc(),new Promise((r,a)=>{const s=Tf(t,"readwrite").delete(e);s.onsuccess=()=>r(),s.onerror=()=>a(s.error)})),uu={UPDATE_AREA_STATUS:"UPDATE_AREA_STATUS",CREATE_TM_TICKET:"CREATE_TM_TICKET",SAVE_CREW_CHECKIN:"SAVE_CREW_CHECKIN",SUBMIT_DAILY_REPORT:"SUBMIT_DAILY_REPORT",SEND_MESSAGE:"SEND_MESSAGE",CREATE_MATERIAL_REQUEST:"CREATE_MATERIAL_REQUEST"},ew=async(t,e,r={})=>{await vc();const a={type:t,payload:e,metadata:r,created_at:new Date().toISOString(),attempts:0,last_error:null};return new Promise((n,s)=>{const c=Tf(Sn.PENDING_ACTIONS,"readwrite").add(a);c.onsuccess=()=>{console.log(`Queued offline action: ${t}`),n(c.result)},c.onerror=()=>s(c.error)})},V4=async()=>$4(Sn.PENDING_ACTIONS),sv=async()=>(await V4()).length,jC=async t=>NC(Sn.PENDING_ACTIONS,t),kC=async(t,e)=>(await vc(),new Promise((r,a)=>{const n=Tf(Sn.PENDING_ACTIONS,"readwrite"),s=n.get(t);s.onsuccess=()=>{const l=s.result;if(l){const c={...l,...e},f=n.put(c);f.onsuccess=()=>r(c),f.onerror=()=>a(f.error)}else a(new Error("Action not found"))},s.onerror=()=>a(s.error)})),EC=async t=>H4(Sn.PROJECTS,t),tw=async t=>t?W4(Sn.PROJECTS,"company_id",t):$4(Sn.PROJECTS),AC=async t=>H4(Sn.AREAS,t),rw=async t=>W4(Sn.AREAS,"project_id",t),iv=async(t,e)=>{const r=await SC(Sn.AREAS,t);return r&&(r.status=e,r.updated_at=new Date().toISOString(),await wC(Sn.AREAS,r)),r};let a2=navigator.onLine;const xx=new Set,G4=t=>(xx.add(t),()=>xx.delete(t)),p0=()=>a2,aw=t=>{a2=t,xx.forEach(e=>e(t))};typeof window<"u"&&(window.addEventListener("online",()=>{console.log("Connection restored"),aw(!0)}),window.addEventListener("offline",()=>{console.log("Connection lost"),aw(!1)}));let ov=!1;const CC=async t=>{if(ov||!a2)return{synced:0,failed:0};ov=!0;const e={synced:0,failed:0};try{const r=await V4();console.log(`Syncing ${r.length} pending actions...`);for(const a of r)try{await TC(a,t),await jC(a.id),e.synced++,console.log(`Synced action: ${a.type}`)}catch(n){console.error(`Failed to sync action ${a.type}:`,n),e.failed++,await kC(a.id,{attempts:(a.attempts||0)+1,last_error:n.message,last_attempt:new Date().toISOString()})}}finally{ov=!1}return e},TC=async(t,e)=>{const{type:r,payload:a}=t;switch(r){case uu.UPDATE_AREA_STATUS:return e.updateAreaStatus(a.areaId,a.status);case uu.CREATE_TM_TICKET:const n=await e.createTMTicket(a.ticket);return a.workers?.length>0&&await e.addTMWorkers(n.id,a.workers),a.items?.length>0&&await e.addTMItems(n.id,a.items),n;case uu.SAVE_CREW_CHECKIN:return e.saveCrewCheckin(a.projectId,a.workers,a.checkInDate);case uu.SUBMIT_DAILY_REPORT:return await e.saveDailyReport(a.projectId,a.reportData),e.submitDailyReport(a.projectId,a.submittedBy);case uu.SEND_MESSAGE:return e.sendMessage(a.projectId,a.senderType,a.senderName,a.content);case uu.CREATE_MATERIAL_REQUEST:return e.createMaterialRequest(a.projectId,a.items,a.requestedBy,a.neededBy,a.priority,a.notes);default:throw new Error(`Unknown action type: ${r}`)}},Y4="",OC="",Ue=!!Y4;vc().catch(t=>console.error("Failed to init offline DB:",t));const Re=Ue?xC(Y4,OC):null,X4="fieldsync_data",yx="fieldsync_user",or=()=>{const t=localStorage.getItem(X4);return t?JSON.parse(t):{projects:[],areas:[],users:[],assignments:[]}},Gr=t=>{localStorage.setItem(X4,JSON.stringify(t))},fp=()=>{const t=localStorage.getItem(yx);return t?JSON.parse(t):null},dp=t=>{t?localStorage.setItem(yx,JSON.stringify(t)):localStorage.removeItem(yx)},RC={async signUp(t,e,r,a){if(Ue){const{data:n,error:s}=await Re.auth.signUp({email:t,password:e,options:{data:{name:r,role:a}}});if(s)throw s;return n}else{const n=or(),s={id:crypto.randomUUID(),email:t,name:r,role:a,created_at:new Date().toISOString()};return n.users.push(s),Gr(n),dp(s),{user:s}}},async signIn(t,e){if(Ue){const{data:r,error:a}=await Re.auth.signInWithPassword({email:t,password:e});if(a)throw a;return r}else{const a=or().users.find(n=>n.email===t);if(!a)throw new Error("User not found");return dp(a),{user:a}}},async signOut(){if(Ue){const{error:t}=await Re.auth.signOut();if(t)throw t}else dp(null)},async getUser(){if(Ue){const{data:{user:t}}=await Re.auth.getUser();return t}else return fp()},async getProfile(){if(Ue){const{data:{user:t}}=await Re.auth.getUser();if(!t)return null;const{data:e,error:r}=await Re.from("users").select("*").eq("id",t.id).single();return r?{id:t.id,email:t.email,name:t.user_metadata?.name||"",role:t.user_metadata?.role||"foreman"}:e}else return fp()},async updateRole(t,e){if(Ue){const{data:r,error:a}=await Re.from("users").update({role:e}).eq("id",t).select().single();if(a)throw a;return r}else{const r=or(),a=r.users.find(n=>n.id===t);return a&&(a.role=e,Gr(r),fp()?.id===t&&dp(a)),a}},onAuthStateChange(t){if(Ue)return Re.auth.onAuthStateChange(t);{const e=fp();return t(e?"SIGNED_IN":"SIGNED_OUT",{user:e}),{data:{subscription:{unsubscribe:()=>{}}}}}}},ot={async getProjects(t=null,e=!1){if(Ue){if(!p0()){console.log("Offline: returning cached projects");const s=await tw(t);return e?s:s.filter(l=>l.status!=="archived")}let r=Re.from("projects").select("*").order("created_at",{ascending:!1});t&&(r=r.eq("company_id",t)),e||(r=r.eq("status","active"));const{data:a,error:n}=await r;if(n){console.log("Error fetching projects, trying cache:",n.message);const s=await tw(t);if(s.length>0)return s;throw n}return a?.length>0&&EC(a).catch(s=>console.error("Failed to cache projects:",s)),a}else{const r=or().projects;return e?r:r.filter(a=>a.status!=="archived")}},async getArchivedProjects(t){if(Ue){const{data:e,error:r}=await Re.from("projects").select("*").eq("company_id",t).eq("status","archived").order("archived_at",{ascending:!1});if(r)throw r;return e}else return or().projects.filter(e=>e.status==="archived")},async getProjectCount(t){if(Ue){const{count:e,error:r}=await Re.from("projects").select("*",{count:"exact",head:!0}).eq("company_id",t).in("status",["active","archived"]);if(r)throw r;return e||0}else return or().projects.filter(r=>r.company_id===t&&r.status!=="deleted").length},async archiveProject(t){if(Ue){const{data:e,error:r}=await Re.from("projects").update({status:"archived",archived_at:new Date().toISOString()}).eq("id",t).select().single();if(r)throw r;return e}else{const e=or(),r=e.projects.find(a=>a.id===t);return r&&(r.status="archived",r.archived_at=new Date().toISOString(),Gr(e)),r}},async restoreProject(t){if(Ue){const{data:e,error:r}=await Re.from("projects").update({status:"active",archived_at:null}).eq("id",t).select().single();if(r)throw r;return e}else{const e=or(),r=e.projects.find(a=>a.id===t);return r&&(r.status="active",r.archived_at=null,Gr(e)),r}},async getProject(t){if(Ue){const{data:e,error:r}=await Re.from("projects").select("*").eq("id",t).single();if(r)throw r;return e}else return or().projects.find(e=>e.id===t)},async createProject(t){if(Ue){const{data:e,error:r}=await Re.from("projects").insert({...t,status:"active"}).select().single();if(r)throw r;return e}else{const e=or(),r={...t,id:crypto.randomUUID(),status:"active",created_at:new Date().toISOString()};return e.projects.push(r),Gr(e),r}},async getProjectByPin(t){if(Ue){const{data:e,error:r}=await Re.from("projects").select("*").eq("pin",t).eq("status","active").single();return r?null:e}else return or().projects.find(r=>r.pin===t&&r.status==="active")||null},async getProjectByPinAndCompany(t,e){if(Ue){const{data:r,error:a}=await Re.from("projects").select("*").eq("pin",t).eq("company_id",e).eq("status","active").single();return a?null:r}else return or().projects.find(a=>a.pin===t&&a.company_id===e&&a.status==="active")||null},async isPinAvailable(t,e=null){if(Ue){let r=Re.from("projects").select("id").eq("pin",t);e&&(r=r.neq("id",e));const{data:a,error:n}=await r;if(n)throw n;return a.length===0}else return!or().projects.some(a=>a.pin===t&&a.id!==e)},async updateProjectPin(t,e){if(Ue){const{data:r,error:a}=await Re.from("projects").update({pin:e}).eq("id",t).select().single();if(a)throw a;return r}else{const r=or(),a=r.projects.find(n=>n.id===t);return a&&(a.pin=e,Gr(r)),a}},async updateProject(t,e){if(Ue){const{data:r,error:a}=await Re.from("projects").update(e).eq("id",t).select().single();if(a)throw console.error("Error updating project:",a),a;return r}else{const r=or(),a=r.projects.find(n=>n.id===t);return a&&(Object.assign(a,e),Gr(r)),a}},async deleteProject(t){if(Ue){const{error:e}=await Re.from("projects").delete().eq("id",t);if(e)throw e}else{const e=or();e.projects=e.projects.filter(r=>r.id!==t),e.areas=e.areas.filter(r=>r.project_id!==t),Gr(e)}},async getAreas(t){if(Ue){if(!p0())return console.log("Offline: returning cached areas"),rw(t);const{data:e,error:r}=await Re.from("areas").select("*").eq("project_id",t).order("sort_order",{ascending:!0});if(r){console.log("Error fetching areas, trying cache:",r.message);const a=await rw(t);if(a.length>0)return a;throw r}return e?.length>0&&AC(e).catch(a=>console.error("Failed to cache areas:",a)),e}else return or().areas.filter(e=>e.project_id===t)},async createArea(t){if(Ue){const{data:e,error:r}=await Re.from("areas").insert(t).select().single();if(r)throw r;return e}else{const e=or(),r={...t,id:crypto.randomUUID(),created_at:new Date().toISOString()};return e.areas.push(r),Gr(e),r}},async updateAreaStatus(t,e){if(Ue){if(!p0()){console.log("Offline: queuing area status update");const n=await iv(t,e);return await ew(uu.UPDATE_AREA_STATUS,{areaId:t,status:e}),n}const{data:r,error:a}=await Re.from("areas").update({status:e}).eq("id",t).select().single();if(a){if(a.message?.includes("fetch")||a.message?.includes("network")){console.log("Network error: queuing area status update");const n=await iv(t,e);return await ew(uu.UPDATE_AREA_STATUS,{areaId:t,status:e}),n}throw a}return r&&iv(t,e).catch(n=>console.error("Failed to update cached area:",n)),r}else{const r=or(),a=r.areas.find(n=>n.id===t);return a&&(a.status=e,a.updated_at=new Date().toISOString()),Gr(r),a}},async updateArea(t,e){if(Ue){const{data:r,error:a}=await Re.from("areas").update(e).eq("id",t).select().single();if(a)throw a;return r}else{const r=or(),a=r.areas.find(n=>n.id===t);return a&&(Object.assign(a,e),a.updated_at=new Date().toISOString()),Gr(r),a}},async deleteArea(t){if(Ue){const{error:e}=await Re.from("areas").delete().eq("id",t);if(e)throw e}else{const e=or();e.areas=e.areas.filter(r=>r.id!==t),Gr(e)}},subscribeToAreas(t,e){return Ue?Re.channel(`areas:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"areas",filter:`project_id=eq.${t}`},e).subscribe():null},subscribeToMessages(t,e){return Ue?Re.channel(`messages:${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`project_id=eq.${t}`},e).subscribe():null},subscribeToMaterialRequests(t,e){return Ue?Re.channel(`material_requests:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"material_requests",filter:`project_id=eq.${t}`},e).subscribe():null},subscribeToDailyReports(t,e){return Ue?Re.channel(`daily_reports:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"daily_reports",filter:`project_id=eq.${t}`},e).subscribe():null},subscribeToCrewCheckins(t,e){return Ue?Re.channel(`crew_checkins:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"crew_checkins",filter:`project_id=eq.${t}`},e).subscribe():null},subscribeToInjuryReports(t,e){return Ue?Re.channel(`injury_reports:${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"injury_reports",filter:`company_id=eq.${t}`},e).subscribe():null},subscribeToTMTickets(t,e){return Ue?Re.channel(`tm_tickets:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"t_and_m_tickets",filter:`project_id=eq.${t}`},e).subscribe():null},subscribeToCompanyActivity(t,e,r){if(!Ue||!e||e.length===0)return null;const a=Re.channel(`company_activity:${t}`);return e.forEach(n=>{a.on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`project_id=eq.${n}`},s=>r.onMessage?.(s)),a.on("postgres_changes",{event:"INSERT",schema:"public",table:"material_requests",filter:`project_id=eq.${n}`},s=>r.onMaterialRequest?.(s)),a.on("postgres_changes",{event:"INSERT",schema:"public",table:"t_and_m_tickets",filter:`project_id=eq.${n}`},s=>r.onTMTicket?.(s))}),a.on("postgres_changes",{event:"INSERT",schema:"public",table:"injury_reports",filter:`company_id=eq.${t}`},n=>r.onInjuryReport?.(n)),a.subscribe()},unsubscribe(t){t&&Ue&&Re.removeChannel(t)},async getAssignedProjects(t){if(Ue){const{data:e,error:r}=await Re.from("project_assignments").select(`
          project_id,
          projects (*)
        `).eq("user_id",t);if(r)throw r;return e.map(a=>a.projects)}else{const e=or();return(e.assignments?.filter(a=>a.user_id===t)||[]).map(a=>e.projects.find(n=>n.id===a.project_id)).filter(Boolean)}},async assignUserToProject(t,e,r){if(Ue){const{data:a,error:n}=await Re.from("project_assignments").insert({project_id:t,user_id:e,assigned_by:r}).select().single();if(n)throw n;return a}else{const a=or();a.assignments||(a.assignments=[]);const n={id:crypto.randomUUID(),project_id:t,user_id:e,assigned_by:r,assigned_at:new Date().toISOString()};return a.assignments.push(n),Gr(a),n}},async removeUserFromProject(t,e){if(Ue){const{error:r}=await Re.from("project_assignments").delete().eq("project_id",t).eq("user_id",e);if(r)throw r}else{const r=or();r.assignments=r.assignments?.filter(a=>!(a.project_id===t&&a.user_id===e))||[],Gr(r)}},async getProjectAssignments(t){if(Ue){const{data:e,error:r}=await Re.from("project_assignments").select(`
          user_id,
          users (id, email, name, role)
        `).eq("project_id",t);if(r)throw r;return e.map(a=>a.users)}else{const e=or();return(e.assignments?.filter(a=>a.project_id===t)||[]).map(a=>e.users.find(n=>n.id===a.user_id)).filter(Boolean)}},async getAllUsers(){if(Ue){const{data:t,error:e}=await Re.from("users").select("*").order("name");if(e)throw e;return t}else return or().users||[]},async getForemen(){if(Ue){const{data:t,error:e}=await Re.from("users").select("*").eq("role","foreman").order("name");if(e)throw e;return t}else return(or().users||[]).filter(t=>t.role==="foreman")},async logActivity(t,e,r,a,n,s){if(Ue){const{error:l}=await Re.from("activity_log").insert({user_id:t,project_id:e,area_id:r,action:a,old_value:n,new_value:s});l&&console.error("Error logging activity:",l)}},async getProjectActivity(t,e=50){if(Ue){const{data:r,error:a}=await Re.from("activity_log").select(`
          *,
          users (name, email),
          areas (name)
        `).eq("project_id",t).order("created_at",{ascending:!1}).limit(e);if(a)throw a;return r}return[]},async getMaterialsEquipment(t){if(Ue){const{data:e,error:r}=await Re.from("materials_equipment").select("*").eq("company_id",t).eq("active",!0).order("category").order("name");if(r)throw r;return e}return[]},async getMaterialsEquipmentByCategory(t,e){if(Ue){const{data:r,error:a}=await Re.from("materials_equipment").select("*").eq("company_id",t).eq("category",e).eq("active",!0).order("name");if(a)throw a;return r}return[]},async getAllMaterialsEquipment(t){if(Ue){const{data:e,error:r}=await Re.from("materials_equipment").select("*").eq("company_id",t).order("category").order("name");if(r)throw r;return e}return[]},async createMaterialEquipment(t){if(Ue){const{data:e,error:r}=await Re.from("materials_equipment").insert(t).select().single();if(r)throw r;return e}return null},async updateMaterialEquipment(t,e){if(Ue){const{data:r,error:a}=await Re.from("materials_equipment").update(e).eq("id",t).select().single();if(a)throw a;return r}return null},async deleteMaterialEquipment(t){if(Ue){const{error:e}=await Re.from("materials_equipment").update({active:!1}).eq("id",t);if(e)throw e}},async getTMTickets(t){if(Ue){const{data:e,error:r}=await Re.from("t_and_m_tickets").select(`
          *,
          t_and_m_workers (*),
          t_and_m_items (
            *,
            materials_equipment (name, unit, cost_per_unit, category)
          )
        `).eq("project_id",t).order("created_at",{ascending:!1});if(r)throw r;return e}return[]},async getChangeOrderTotals(t){if(Ue){const{data:e,error:r}=await Re.from("t_and_m_tickets").select("ce_pco_number, change_order_value, status").eq("project_id",t).not("ce_pco_number","is",null).neq("ce_pco_number","");if(r)throw r;const a={};let n=0,s=0;return e?.forEach(l=>{const c=l.ce_pco_number;if(a[c]||(a[c]={approved:0,pending:0,count:0}),a[c].count++,l.status==="approved"||l.status==="billed"){const f=parseFloat(l.change_order_value)||0;a[c].approved+=f,n+=f}else l.status==="pending"&&s++}),{changeOrders:a,totalApprovedValue:n,pendingCount:s}}return{changeOrders:{},totalApprovedValue:0,pendingCount:0}},async getTMTicketsByStatus(t,e){if(Ue){const{data:r,error:a}=await Re.from("t_and_m_tickets").select(`
          *,
          t_and_m_workers (*),
          t_and_m_items (
            *,
            materials_equipment (name, unit, cost_per_unit, category)
          )
        `).eq("project_id",t).eq("status",e).order("created_at",{ascending:!1});if(a)throw a;return r}return[]},async createTMTicket(t){if(Ue){const{data:e,error:r}=await Re.from("t_and_m_tickets").insert({project_id:t.project_id,work_date:t.work_date,ce_pco_number:t.ce_pco_number||null,notes:t.notes,photos:t.photos||[],status:"pending",created_by_name:t.created_by_name||"Field User"}).select().single();if(r)throw r;return e}return null},async addTMWorkers(t,e){if(Ue){const r=e.map(n=>({ticket_id:t,name:n.name,hours:n.hours,overtime_hours:n.overtime_hours||0,time_started:n.time_started||null,time_ended:n.time_ended||null,role:n.role||"Laborer"})),{error:a}=await Re.from("t_and_m_workers").insert(r);if(a)throw a}},async addTMItems(t,e){if(Ue){const r=e.map(n=>({ticket_id:t,material_equipment_id:n.material_equipment_id||null,custom_name:n.custom_name||null,custom_category:n.custom_category||null,quantity:n.quantity})),{error:a}=await Re.from("t_and_m_items").insert(r);if(a)throw a}},async updateTMTicketStatus(t,e){if(Ue){const{data:r,error:a}=await Re.from("t_and_m_tickets").update({status:e}).eq("id",t).select().single();if(a)throw a;return r}return null},async approveTMTicket(t,e,r,a=null){if(Ue){const n={status:"approved",approved_by_user_id:e,approved_by_name:r,approved_at:new Date().toISOString(),rejected_by_user_id:null,rejected_by_name:null,rejected_at:null,rejection_reason:null};a!==null&&(n.change_order_value=parseFloat(a)||0);const{data:s,error:l}=await Re.from("t_and_m_tickets").update(n).eq("id",t).select().single();if(l)throw l;return s}return null},async rejectTMTicket(t,e,r,a=""){if(Ue){const{data:n,error:s}=await Re.from("t_and_m_tickets").update({status:"rejected",rejected_by_user_id:e,rejected_by_name:r,rejected_at:new Date().toISOString(),rejection_reason:a,approved_by_user_id:null,approved_by_name:null,approved_at:null}).eq("id",t).select().single();if(s)throw s;return n}return null},canApproveTickets(t){return["owner","admin","manager"].includes(t)},async updateTMTicketPhotos(t,e){if(Ue){const{data:r,error:a}=await Re.from("t_and_m_tickets").update({photos:e}).eq("id",t).select().single();if(a)throw a;return r}return null},async deleteTMTicket(t){if(Ue){const{error:e}=await Re.from("t_and_m_tickets").delete().eq("id",t);if(e)throw e}},async getCompanyByCode(t){if(Ue){const{data:e,error:r}=await Re.from("companies").select("*").eq("code",t).single();return r?null:e}return null},async getCompany(t){if(Ue){const{data:e,error:r}=await Re.from("companies").select("*").eq("id",t).single();if(r)throw r;return e}return null},async getUserCompanies(t){if(Ue){const{data:e,error:r}=await Re.from("user_companies").select(`
          id,
          role,
          company_id,
          companies (
            id,
            name,
            code
          )
        `).eq("user_id",t).order("created_at",{ascending:!0});return r?(console.error("Error fetching user companies:",r),[]):e.map(a=>({id:a.companies.id,name:a.companies.name,code:a.companies.code,role:a.role}))}return[]},async uploadPhoto(t,e,r,a){if(!Ue)return null;const n=Date.now(),s=Math.random().toString(36).substring(7),l=a.name?.split(".").pop()||"jpg",c=`${n}-${s}.${l}`,f=`${t}/${e}/${r}/${c}`,{data:d,error:m}=await Re.storage.from("tm-photos").upload(f,a,{cacheControl:"3600",upsert:!1});if(m)throw m;const{data:v}=Re.storage.from("tm-photos").getPublicUrl(f);return v.publicUrl},async uploadPhotoBase64(t,e,r,a,n="photo.jpg"){if(!Ue)return null;const l=await(await fetch(a)).blob(),c=Date.now(),f=Math.random().toString(36).substring(7),d=n.split(".").pop()||"jpg",m=`${c}-${f}.${d}`,v=`${t}/${e}/${r}/${m}`,{data:x,error:g}=await Re.storage.from("tm-photos").upload(v,l,{cacheControl:"3600",upsert:!1,contentType:l.type});if(g)throw g;const{data:b}=Re.storage.from("tm-photos").getPublicUrl(v);return b.publicUrl},async deletePhoto(t){if(!Ue)return;const r=new URL(t).pathname.match(/\/tm-photos\/(.+)$/);if(!r)return;const a=r[1],{error:n}=await Re.storage.from("tm-photos").remove([a]);if(n)throw n},async getCrewCheckin(t,e=null){if(!Ue)return null;const r=e||new Date().toISOString().split("T")[0],{data:a,error:n}=await Re.from("crew_checkins").select("*").eq("project_id",t).eq("check_in_date",r).single();return n&&n.code!=="PGRST116"&&console.error("Error fetching crew checkin:",n),a},async saveCrewCheckin(t,e,r=null,a=null){if(!Ue)return null;const n=a||new Date().toISOString().split("T")[0],{data:s,error:l}=await Re.from("crew_checkins").upsert({project_id:t,check_in_date:n,workers:e,created_by:r,updated_at:new Date().toISOString()},{onConflict:"project_id,check_in_date"}).select().single();if(l)throw console.error("Error saving crew checkin:",l),l;return s},async addCrewMember(t,e,r=null){if(!Ue)return null;const a=await this.getCrewCheckin(t),n=a?.workers||[];return n.find(s=>s.name.toLowerCase()===e.name.toLowerCase())?a:(n.push(e),await this.saveCrewCheckin(t,n,r))},async removeCrewMember(t,e){if(!Ue)return null;const r=await this.getCrewCheckin(t);if(!r)return null;const a=r.workers.filter(n=>n.name.toLowerCase()!==e.toLowerCase());return await this.saveCrewCheckin(t,a,r.created_by)},async getCrewCheckinHistory(t,e=30){if(!Ue)return[];const{data:r,error:a}=await Re.from("crew_checkins").select("*").eq("project_id",t).order("check_in_date",{ascending:!1}).limit(e);return a?(console.error("Error fetching crew history:",a),[]):r||[]},async getLaborRates(t,e=null,r=null){if(!Ue)return[];let a=Re.from("labor_rates").select("*").eq("company_id",t);e&&(a=a.eq("work_type",e)),r&&(a=a.eq("job_type",r));const{data:n,error:s}=await a;return s?(console.error("Error fetching labor rates:",s),[]):n||[]},async calculateManDayCosts(t,e,r,a){if(!Ue)return{totalCost:0,totalManDays:0,breakdown:[]};const n=await this.getCrewCheckinHistory(t,365),s=await this.getLaborRates(e,r,a),l={};s.forEach(v=>{l[v.role.toLowerCase()]=parseFloat(v.regular_rate)||0});let c=0,f=0;const d={},m=[];return n.forEach(v=>{const x=v.workers||[];let g=0;const b={};x.forEach(_=>{const w=(_.role||"laborer").toLowerCase(),E=l[w]||0;b[w]||(b[w]={count:0,cost:0}),b[w].count++,b[w].cost+=E,g+=E,d[w]||(d[w]={count:0,cost:0,rate:E}),d[w].count++,d[w].cost+=E}),c+=g,f+=x.length,m.push({date:v.check_in_date,workers:x.length,cost:g,breakdown:b})}),{totalCost:c,totalManDays:f,byRole:d,byDate:m,daysWorked:n.length}},async getDailyReport(t,e=null){if(!Ue)return null;const r=e||new Date().toISOString().split("T")[0],{data:a,error:n}=await Re.from("daily_reports").select("*").eq("project_id",t).eq("report_date",r).single();return n&&n.code!=="PGRST116"&&console.error("Error fetching daily report:",n),a},async compileDailyReport(t,e=null){if(!Ue)return null;const r=e||new Date().toISOString().split("T")[0],a=await this.getCrewCheckin(t,r),{data:n}=await Re.from("areas").select("*").eq("project_id",t),s=n?.filter(f=>f.status==="done"&&f.completed_at?.startsWith(r))||[],{data:l}=await Re.from("t_and_m_tickets").select("*").eq("project_id",t).eq("work_date",r),c=l?.reduce((f,d)=>f+(d.photos?.length||0),0)||0;return{crew_count:a?.workers?.length||0,crew_list:a?.workers||[],tasks_completed:s.length,tasks_total:n?.length||0,completed_tasks:s.map(f=>({name:f.name,group:f.group_name})),tm_tickets_count:l?.length||0,photos_count:c}},async saveDailyReport(t,e,r=null){if(!Ue)return null;const a=r||new Date().toISOString().split("T")[0],{data:n,error:s}=await Re.from("daily_reports").upsert({project_id:t,report_date:a,...e,updated_at:new Date().toISOString()},{onConflict:"project_id,report_date"}).select().single();if(s)throw console.error("Error saving daily report:",s),s;return n},async submitDailyReport(t,e,r=null){if(!Ue)return null;const a=r||new Date().toISOString().split("T")[0],n=await this.compileDailyReport(t,a),{data:s,error:l}=await Re.from("daily_reports").upsert({project_id:t,report_date:a,...n,status:"submitted",submitted_at:new Date().toISOString(),submitted_by:e,updated_at:new Date().toISOString()},{onConflict:"project_id,report_date"}).select().single();if(l)throw console.error("Error submitting daily report:",l),l;return s},async getDailyReports(t,e=30){if(!Ue)return[];const{data:r,error:a}=await Re.from("daily_reports").select("*").eq("project_id",t).order("report_date",{ascending:!1}).limit(e);return a?(console.error("Error fetching daily reports:",a),[]):r||[]},async sendMessage(t,e,r,a,n=null,s=null,l="general",c=null){if(!Ue)return null;const{data:f,error:d}=await Re.from("messages").insert({project_id:t,sender_type:r,sender_name:a,sender_user_id:n,message:e,photo_url:s,message_type:l,parent_message_id:c}).select().single();if(d)throw console.error("Error sending message:",d),d;return f},async getMessages(t,e=50){if(!Ue)return[];const{data:r,error:a}=await Re.from("messages").select("*").eq("project_id",t).order("created_at",{ascending:!1}).limit(e);return a?(console.error("Error fetching messages:",a),[]):r||[]},async getUnreadCount(t,e){if(!Ue)return 0;const r=e==="field"?"office":"field",{count:a,error:n}=await Re.from("messages").select("*",{count:"exact",head:!0}).eq("project_id",t).eq("sender_type",r).eq("is_read",!1);return n?(console.error("Error getting unread count:",n),0):a||0},async markMessagesRead(t,e){if(!Ue)return;const r=e==="field"?"office":"field",{error:a}=await Re.from("messages").update({is_read:!0,read_at:new Date().toISOString()}).eq("project_id",t).eq("sender_type",r).eq("is_read",!1);a&&console.error("Error marking messages read:",a)},async createMaterialRequest(t,e,r,a=null,n="normal",s=null){if(!Ue)return null;const{data:l,error:c}=await Re.from("material_requests").insert({project_id:t,items:e,requested_by:r,needed_by:a,priority:n,notes:s}).select().single();if(c)throw console.error("Error creating material request:",c),c;return l},async getMaterialRequests(t,e=null){if(!Ue)return[];let r=Re.from("material_requests").select("*").eq("project_id",t).order("created_at",{ascending:!1});e&&(r=r.eq("status",e));const{data:a,error:n}=await r;return n?(console.error("Error fetching material requests:",n),[]):a||[]},async getPendingRequestsCount(t){if(!Ue)return 0;const{count:e,error:r}=await Re.from("material_requests").select("*",{count:"exact",head:!0}).eq("project_id",t).eq("status","pending");return r?0:e||0},async updateMaterialRequest(t,e,r,a=null,n=null){if(!Ue)return null;const s={status:e,responded_by:r,responded_at:new Date().toISOString(),response_notes:a,updated_at:new Date().toISOString()};n&&(s.expected_delivery=n),e==="delivered"&&(s.delivered_at=new Date().toISOString());const{data:l,error:c}=await Re.from("material_requests").update(s).eq("id",t).select().single();if(c)throw console.error("Error updating material request:",c),c;return l},generateShareToken(){const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let e="";for(let r=0;r<12;r++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},async createProjectShare(t,e,r,a=null){if(!Ue){const f=or();f.projectShares||(f.projectShares=[]);const d={id:crypto.randomUUID(),project_id:t,share_token:this.generateShareToken(),created_by:e,expires_at:a,is_active:!0,permissions:r,view_count:0,last_viewed_at:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return f.projectShares.push(d),Gr(f),d}const{data:n,error:s}=await Re.rpc("generate_share_token");if(s)throw console.error("Error generating share token:",s),s;const{data:l,error:c}=await Re.from("project_shares").insert({project_id:t,share_token:n,created_by:e,expires_at:a,permissions:r}).select().single();if(c)throw console.error("Error creating project share:",c),c;return l},async getShareByToken(t){if(!Ue){const a=or();if(!a.projectShares)return null;const n=a.projectShares.find(s=>s.share_token===t&&s.is_active&&(!s.expires_at||new Date(s.expires_at)>new Date));return n&&(n.view_count++,n.last_viewed_at=new Date().toISOString(),Gr(a)),n}const{data:e,error:r}=await Re.from("project_shares").select("*, projects(*)").eq("share_token",t).eq("is_active",!0).single();return r?(console.error("Error fetching share by token:",r),null):e.expires_at&&new Date(e.expires_at)<new Date?null:(await Re.rpc("increment_share_view_count",{token:t}),e)},async getProjectShares(t){if(!Ue){const a=or();return a.projectShares?a.projectShares.filter(n=>n.project_id===t):[]}const{data:e,error:r}=await Re.from("project_shares").select("*, users(name, email)").eq("project_id",t).order("created_at",{ascending:!1});return r?(console.error("Error fetching project shares:",r),[]):e||[]},async updateProjectShare(t,e){if(!Ue){const n=or();if(!n.projectShares)return null;const s=n.projectShares.findIndex(l=>l.id===t);return s===-1?null:(n.projectShares[s]={...n.projectShares[s],...e,updated_at:new Date().toISOString()},Gr(n),n.projectShares[s])}const{data:r,error:a}=await Re.from("project_shares").update(e).eq("id",t).select().single();if(a)throw console.error("Error updating project share:",a),a;return r},async revokeProjectShare(t){return this.updateProjectShare(t,{is_active:!1})},async deleteProjectShare(t){if(!Ue){const r=or();if(!r.projectShares)return;r.projectShares=r.projectShares.filter(a=>a.id!==t),Gr(r);return}const{error:e}=await Re.from("project_shares").delete().eq("id",t);if(e)throw console.error("Error deleting project share:",e),e},async getPublicProjectData(t){const e=await this.getShareByToken(t);if(!e)return null;const r=e.project_id||e.projects?.id;if(!Ue){const s=or(),l=s.projects.find(v=>v.id===r);if(!l)return null;const c=s.areas.filter(v=>v.project_id===r),f=c.reduce((v,x)=>v+parseFloat(x.weight||0),0),d=c.filter(v=>v.status==="done").reduce((v,x)=>v+parseFloat(x.weight||0),0),m=f>0?Math.round(d/f*100):0;return{share:e,project:l,progress:m,areas:e.permissions.progress?c:[],photos:[],dailyReports:[],tmTickets:[]}}const a=e.projects||await this.getProject(r);if(!a)return null;const n={share:e,project:a,areas:[],photos:[],dailyReports:[],tmTickets:[]};if(e.permissions.progress){n.areas=await this.getAreas(r);const s=n.areas.reduce((c,f)=>c+parseFloat(f.weight||0),0),l=n.areas.filter(c=>c.status==="done").reduce((c,f)=>c+parseFloat(f.weight||0),0);n.progress=s>0?Math.round(l/s*100):0}if(e.permissions.photos){const{data:s}=await Re.from("t_and_m_tickets").select("photos, work_date").eq("project_id",r).not("photos","is",null).order("work_date",{ascending:!1}).limit(20);n.photos=s?.flatMap(l=>(l.photos||[]).map(c=>({url:c,date:l.work_date})))||[]}if(e.permissions.daily_reports){const{data:s}=await Re.from("daily_reports").select("*").eq("project_id",r).order("report_date",{ascending:!1}).limit(10);n.dailyReports=s||[]}return e.permissions.tm_tickets&&(n.tmTickets=await this.getTMTickets(r)),n},async createInjuryReport(t){if(!Ue){const a=or();a.injuryReports||(a.injuryReports=[]);const n={id:crypto.randomUUID(),...t,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return a.injuryReports.push(n),Gr(a),n}const{data:e,error:r}=await Re.from("injury_reports").insert(t).select().single();if(r)throw console.error("Error creating injury report:",r),r;return e},async getInjuryReports(t){if(!Ue){const a=or();return a.injuryReports?a.injuryReports.filter(n=>n.project_id===t).sort((n,s)=>new Date(s.incident_date)-new Date(n.incident_date)):[]}const{data:e,error:r}=await Re.from("injury_reports").select("*").eq("project_id",t).order("incident_date",{ascending:!1});return r?(console.error("Error fetching injury reports:",r),[]):e||[]},async getCompanyInjuryReports(t,e=null){if(!Ue){const s=or();if(!s.injuryReports)return[];let l=s.injuryReports.filter(c=>c.company_id===t);return e&&(l=l.filter(c=>c.status===e)),l.sort((c,f)=>new Date(f.incident_date)-new Date(c.incident_date))}let r=Re.from("injury_reports").select("*, projects(name)").eq("company_id",t).order("incident_date",{ascending:!1});e&&(r=r.eq("status",e));const{data:a,error:n}=await r;return n?(console.error("Error fetching company injury reports:",n),[]):a||[]},async getInjuryReport(t){if(!Ue){const a=or();return a.injuryReports?a.injuryReports.find(n=>n.id===t):null}const{data:e,error:r}=await Re.from("injury_reports").select("*, projects(name, pin), users(name, email)").eq("id",t).single();return r?(console.error("Error fetching injury report:",r),null):e},async updateInjuryReport(t,e){if(!Ue){const n=or();if(!n.injuryReports)return null;const s=n.injuryReports.findIndex(l=>l.id===t);return s===-1?null:(n.injuryReports[s]={...n.injuryReports[s],...e,updated_at:new Date().toISOString()},Gr(n),n.injuryReports[s])}const{data:r,error:a}=await Re.from("injury_reports").update(e).eq("id",t).select().single();if(a)throw console.error("Error updating injury report:",a),a;return r},async closeInjuryReport(t,e){return this.updateInjuryReport(t,{status:"closed",closed_at:new Date().toISOString(),closed_by:e})},async deleteInjuryReport(t){if(!Ue){const r=or();if(!r.injuryReports)return;r.injuryReports=r.injuryReports.filter(a=>a.id!==t),Gr(r);return}const{error:e}=await Re.from("injury_reports").delete().eq("id",t);if(e)throw console.error("Error deleting injury report:",e),e},async getInjuryStatistics(t,e=null,r=null){if(!Ue){const s=or();if(!s.injuryReports)return{total_incidents:0,minor_injuries:0,serious_injuries:0,critical_injuries:0,near_misses:0,osha_recordable:0,total_days_away:0,total_restricted_days:0};let l=s.injuryReports.filter(c=>c.company_id===t);return e&&(l=l.filter(c=>new Date(c.incident_date)>=new Date(e))),r&&(l=l.filter(c=>new Date(c.incident_date)<=new Date(r))),{total_incidents:l.length,minor_injuries:l.filter(c=>c.injury_type==="minor").length,serious_injuries:l.filter(c=>c.injury_type==="serious").length,critical_injuries:l.filter(c=>c.injury_type==="critical").length,near_misses:l.filter(c=>c.injury_type==="near_miss").length,osha_recordable:l.filter(c=>c.osha_recordable).length,total_days_away:l.reduce((c,f)=>c+(f.days_away_from_work||0),0),total_restricted_days:l.reduce((c,f)=>c+(f.restricted_work_days||0),0)}}const{data:a,error:n}=await Re.rpc("get_injury_statistics",{comp_id:t,start_date:e,end_date:r});return n?(console.error("Error fetching injury statistics:",n),null):a[0]||null},async addWitness(t,e){if(!Ue){const n=or();if(!n.injuryReports)return null;const s=n.injuryReports.findIndex(f=>f.id===t);if(s===-1)return null;const l=n.injuryReports[s],c=l.witnesses||[];return c.push(e),n.injuryReports[s]={...l,witnesses:c,updated_at:new Date().toISOString()},Gr(n),n.injuryReports[s]}const r=await this.getInjuryReport(t);if(!r)return null;const a=r.witnesses||[];return a.push(e),this.updateInjuryReport(t,{witnesses:a})},async removeWitness(t,e){if(!Ue){const n=or();if(!n.injuryReports)return null;const s=n.injuryReports.findIndex(f=>f.id===t);if(s===-1)return null;const l=n.injuryReports[s],c=l.witnesses||[];return c.splice(e,1),n.injuryReports[s]={...l,witnesses:c,updated_at:new Date().toISOString()},Gr(n),n.injuryReports[s]}const r=await this.getInjuryReport(t);if(!r)return null;const a=r.witnesses||[];return a.splice(e,1),this.updateInjuryReport(t,{witnesses:a})},async getCompanyUsers(t){if(Ue){const{data:e,error:r}=await Re.from("user_companies").select(`
          user_id,
          role,
          users (
            id,
            name,
            email
          )
        `).eq("company_id",t);return r?(console.error("Error fetching company users:",r),[]):e?.map(a=>({id:a.user_id,name:a.users?.name||a.users?.email,email:a.users?.email,role:a.role}))||[]}return[]},async getProjectNotificationPreferences(t){if(Ue){const{data:r,error:a}=await Re.from("notification_preferences").select(`
          *,
          users (
            id,
            name,
            email
          )
        `).eq("project_id",t);return a?(console.error("Error fetching notification preferences:",a),[]):r||[]}const e=or();return e.notificationPreferences?e.notificationPreferences.filter(r=>r.project_id===t):[]},async getUserNotificationPreferences(t){if(Ue){const{data:r,error:a}=await Re.from("notification_preferences").select(`
          *,
          projects (
            id,
            name
          )
        `).eq("user_id",t);return a?(console.error("Error fetching user notification preferences:",a),[]):r||[]}const e=or();return e.notificationPreferences?e.notificationPreferences.filter(r=>r.user_id===t):[]},async setNotificationPreference(t,e,r){if(Ue){const{data:l,error:c}=await Re.from("notification_preferences").upsert({project_id:t,user_id:e,notification_types:r,updated_at:new Date().toISOString()},{onConflict:"project_id,user_id"}).select().single();if(c)throw console.error("Error setting notification preference:",c),c;return l}const a=or();a.notificationPreferences||(a.notificationPreferences=[]);const n=a.notificationPreferences.findIndex(l=>l.project_id===t&&l.user_id===e),s={id:n>=0?a.notificationPreferences[n].id:crypto.randomUUID(),project_id:t,user_id:e,notification_types:r,created_at:n>=0?a.notificationPreferences[n].created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return n>=0?a.notificationPreferences[n]=s:a.notificationPreferences.push(s),Gr(a),s},async removeNotificationPreference(t,e){if(Ue){const{error:a}=await Re.from("notification_preferences").delete().eq("project_id",t).eq("user_id",e);if(a)throw console.error("Error removing notification preference:",a),a;return!0}const r=or();return r.notificationPreferences&&(r.notificationPreferences=r.notificationPreferences.filter(a=>!(a.project_id===t&&a.user_id===e)),Gr(r)),!0},async setProjectNotificationPreferences(t,e){const r=[];for(const a of e)if(a.notificationTypes&&a.notificationTypes.length>0){const n=await this.setNotificationPreference(t,a.userId,a.notificationTypes);r.push(n)}else await this.removeNotificationPreference(t,a.userId);return r},async getNotificationPresets(t){if(Ue){const{data:r,error:a}=await Re.from("notification_presets").select("*").eq("company_id",t).order("name");return a?(console.error("Error fetching notification presets:",a),[]):r||[]}const e=or();return e.notificationPresets?e.notificationPresets.filter(r=>r.company_id===t):[{id:"preset-1",name:"Project Manager",notification_types:["message","material_request","injury_report","tm_ticket"],company_id:t},{id:"preset-2",name:"Safety Officer",notification_types:["injury_report"],company_id:t},{id:"preset-3",name:"Purchasing",notification_types:["material_request"],company_id:t},{id:"preset-4",name:"Accounting",notification_types:["tm_ticket"],company_id:t}]},async createNotificationPreset(t,e,r){if(Ue){const{data:s,error:l}=await Re.from("notification_presets").insert({company_id:t,name:e,notification_types:r}).select().single();if(l)throw console.error("Error creating notification preset:",l),l;return s}const a=or();a.notificationPresets||(a.notificationPresets=[]);const n={id:crypto.randomUUID(),company_id:t,name:e,notification_types:r,created_at:new Date().toISOString()};return a.notificationPresets.push(n),Gr(a),n},async updateNotificationPreset(t,e,r){if(Ue){const{data:s,error:l}=await Re.from("notification_presets").update({name:e,notification_types:r,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(l)throw console.error("Error updating notification preset:",l),l;return s}const a=or();if(!a.notificationPresets)return null;const n=a.notificationPresets.findIndex(s=>s.id===t);return n===-1?null:(a.notificationPresets[n]={...a.notificationPresets[n],name:e,notification_types:r,updated_at:new Date().toISOString()},Gr(a),a.notificationPresets[n])},async deleteNotificationPreset(t){if(Ue){const{error:r}=await Re.from("notification_presets").delete().eq("id",t);if(r)throw console.error("Error deleting notification preset:",r),r;return!0}const e=or();return e.notificationPresets&&(e.notificationPresets=e.notificationPresets.filter(r=>r.id!==t),Gr(e)),!0},async getDumpSites(t){if(Ue){const{data:r,error:a}=await Re.from("dump_sites").select(`
          *,
          dump_site_rates (*)
        `).eq("company_id",t).eq("active",!0).order("name");return a?(console.error("Error fetching dump sites:",a),[]):r||[]}return(or().dumpSites||[]).filter(r=>r.company_id===t&&r.active)},async createDumpSite(t,e,r="",a=""){if(Ue){const{data:l,error:c}=await Re.from("dump_sites").insert({company_id:t,name:e,address:r,notes:a,active:!0}).select().single();if(c)throw console.error("Error creating dump site:",c),c;return l}const n=or();n.dumpSites||(n.dumpSites=[]);const s={id:crypto.randomUUID(),company_id:t,name:e,address:r,notes:a,active:!0,created_at:new Date().toISOString(),dump_site_rates:[]};return n.dumpSites.push(s),Gr(n),s},async updateDumpSite(t,e){if(Ue){const{data:n,error:s}=await Re.from("dump_sites").update({...e,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(s)throw console.error("Error updating dump site:",s),s;return n}const r=or();if(!r.dumpSites)return null;const a=r.dumpSites.findIndex(n=>n.id===t);return a===-1?null:(r.dumpSites[a]={...r.dumpSites[a],...e},Gr(r),r.dumpSites[a])},async deleteDumpSite(t){return this.updateDumpSite(t,{active:!1})},async setDumpSiteRate(t,e,r,a="load"){if(Ue){const{data:c}=await Re.from("dump_site_rates").select("id").eq("dump_site_id",t).eq("waste_type",e).maybeSingle();if(c){const{data:f,error:d}=await Re.from("dump_site_rates").update({estimated_cost_per_load:r,unit:a}).eq("id",c.id).select().single();if(d)throw console.error("Error updating dump site rate:",d),d;return f}else{const{data:f,error:d}=await Re.from("dump_site_rates").insert({dump_site_id:t,waste_type:e,estimated_cost_per_load:r,unit:a}).select().single();if(d)throw console.error("Error inserting dump site rate:",d),d;return f}}const n=or();n.dumpSiteRates||(n.dumpSiteRates=[]);const s=n.dumpSiteRates.findIndex(c=>c.dump_site_id===t&&c.waste_type===e),l={id:s>=0?n.dumpSiteRates[s].id:crypto.randomUUID(),dump_site_id:t,waste_type:e,estimated_cost_per_load:r,unit:a,created_at:new Date().toISOString()};return s>=0?n.dumpSiteRates[s]=l:n.dumpSiteRates.push(l),Gr(n),l},async getDumpSiteRates(t){if(Ue){const{data:r,error:a}=await Re.from("dump_site_rates").select("*").eq("dump_site_id",t);return a?(console.error("Error fetching dump site rates:",a),[]):r||[]}return(or().dumpSiteRates||[]).filter(r=>r.dump_site_id===t)},async getHaulOffs(t){if(Ue){const{data:r,error:a}=await Re.from("haul_offs").select(`
          *,
          dump_sites (name)
        `).eq("project_id",t).order("work_date",{ascending:!1});return a?(console.error("Error fetching haul-offs:",a),[]):r||[]}return(or().haulOffs||[]).filter(r=>r.project_id===t).sort((r,a)=>new Date(a.work_date)-new Date(r.work_date))},async createHaulOff(t,e){const r={project_id:t,dump_site_id:e.dumpSiteId,waste_type:e.wasteType,loads:e.loads,hauling_company:e.haulingCompany||"",work_date:e.workDate,notes:e.notes||"",estimated_cost:e.estimatedCost||0,created_by:e.createdBy||""};if(Ue){const{data:s,error:l}=await Re.from("haul_offs").insert(r).select().single();if(l)throw console.error("Error creating haul-off:",l),l;return s}const a=or();a.haulOffs||(a.haulOffs=[]);const n={...r,id:crypto.randomUUID(),created_at:new Date().toISOString()};return a.haulOffs.push(n),Gr(a),n},async calculateHaulOffCosts(t){const e=await this.getHaulOffs(t);let r=0,a=0;const n={},s=[],l={};e.forEach(f=>{const d=parseFloat(f.estimated_cost)||0,m=parseInt(f.loads)||0;r+=d,a+=m,n[f.waste_type]||(n[f.waste_type]={loads:0,cost:0}),n[f.waste_type].loads+=m,n[f.waste_type].cost+=d,l[f.work_date]||(l[f.work_date]={date:f.work_date,loads:0,cost:0}),l[f.work_date].loads+=m,l[f.work_date].cost+=d}),Object.values(l).sort((f,d)=>new Date(d.date)-new Date(f.date)).forEach(f=>s.push(f));const c=s.length;return{totalCost:r,totalLoads:a,byWasteType:n,byDate:s,daysWithHaulOff:c,avgDailyHaulOffCost:c>0?r/c:0}},subscribeToHaulOffs(t,e){return Ue?Re.channel(`haul_offs:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"haul_offs",filter:`project_id=eq.${t}`},e).subscribe():null},async createCOR(t){if(Ue){const{data:e,error:r}=await Re.from("change_orders").insert({company_id:t.company_id,project_id:t.project_id,area_id:t.area_id||null,cor_number:t.cor_number,title:t.title,description:t.description||"",scope_of_work:t.scope_of_work,period_start:t.period_start,period_end:t.period_end,status:"draft",labor_markup_percent:t.labor_markup_percent??1500,materials_markup_percent:t.materials_markup_percent??1500,equipment_markup_percent:t.equipment_markup_percent??1500,subcontractors_markup_percent:t.subcontractors_markup_percent??500,liability_insurance_percent:t.liability_insurance_percent??144,bond_percent:t.bond_percent??100,license_fee_percent:t.license_fee_percent??10,created_by:t.created_by||null}).select().single();if(r)throw r;return e}return null},async updateCOR(t,e){if(Ue){const{data:r,error:a}=await Re.from("change_orders").update({...e,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(a)throw a;return r}return null},async deleteCOR(t){if(Ue){const{error:e}=await Re.from("change_orders").delete().eq("id",t);if(e)throw e}},async getCORs(t,e={}){if(Ue){let r=Re.from("change_orders").select(`
          *,
          areas (id, name),
          labor_count:change_order_labor(count),
          materials_count:change_order_materials(count),
          equipment_count:change_order_equipment(count),
          subcontractors_count:change_order_subcontractors(count),
          tickets_count:change_order_ticket_associations(count)
        `).eq("project_id",t);e.status&&(r=r.eq("status",e.status)),e.area_id&&(r=r.eq("area_id",e.area_id)),e.date_start&&(r=r.gte("period_start",e.date_start)),e.date_end&&(r=r.lte("period_end",e.date_end)),r=r.order("created_at",{ascending:!1});const{data:a,error:n}=await r;if(n)throw n;return a}return[]},async getCORById(t){if(Ue){const{data:e,error:r}=await Re.from("change_orders").select(`
          *,
          areas (id, name),
          change_order_labor (*),
          change_order_materials (*),
          change_order_equipment (*),
          change_order_subcontractors (*),
          change_order_ticket_associations (
            *,
            t_and_m_tickets (
              id, work_date, ce_pco_number, status, notes
            )
          )
        `).eq("id",t).single();if(r)throw r;return e}return null},async getCORsByArea(t,e){if(Ue){const{data:r,error:a}=await Re.from("change_orders").select("*").eq("project_id",t).eq("area_id",e).order("created_at",{ascending:!1});if(a)throw a;return r}return[]},async getNextCORNumber(t){if(Ue){const{data:e,error:r}=await Re.from("change_orders").select("cor_number").eq("project_id",t).order("created_at",{ascending:!1}).limit(1);if(r)throw r;if(e&&e.length>0){const a=e[0].cor_number.match(/COR #(\d+)/);if(a)return`COR #${parseInt(a[1])+1}`}return"COR #1"}return"COR #1"},async addCORLaborItem(t,e){if(Ue){const r=Math.round(e.regular_hours*e.regular_rate),a=Math.round(e.overtime_hours*e.overtime_rate),n=r+a,{data:s,error:l}=await Re.from("change_order_labor").insert({change_order_id:t,labor_class:e.labor_class,wage_type:e.wage_type||"standard",regular_hours:e.regular_hours||0,overtime_hours:e.overtime_hours||0,regular_rate:e.regular_rate||0,overtime_rate:e.overtime_rate||0,regular_total:r,overtime_total:a,total:n,sort_order:e.sort_order||0,source_ticket_id:e.source_ticket_id||null}).select().single();if(l)throw l;return s}return null},async updateCORLaborItem(t,e){if(Ue){let r={...e};if(e.regular_hours!==void 0||e.regular_rate!==void 0||e.overtime_hours!==void 0||e.overtime_rate!==void 0){const{data:s}=await Re.from("change_order_labor").select("regular_hours, overtime_hours, regular_rate, overtime_rate").eq("id",t).single(),l=e.regular_hours??s?.regular_hours??0,c=e.overtime_hours??s?.overtime_hours??0,f=e.regular_rate??s?.regular_rate??0,d=e.overtime_rate??s?.overtime_rate??0;r.regular_total=Math.round(l*f),r.overtime_total=Math.round(c*d),r.total=r.regular_total+r.overtime_total}const{data:a,error:n}=await Re.from("change_order_labor").update(r).eq("id",t).select().single();if(n)throw n;return a}return null},async deleteCORLaborItem(t){if(Ue){const{error:e}=await Re.from("change_order_labor").delete().eq("id",t);if(e)throw e}},async addCORMaterialItem(t,e){if(Ue){const r=Math.round(e.quantity*e.unit_cost),{data:a,error:n}=await Re.from("change_order_materials").insert({change_order_id:t,description:e.description,quantity:e.quantity||1,unit:e.unit||"each",unit_cost:e.unit_cost||0,total:r,source_type:e.source_type||"custom",source_reference:e.source_reference||null,source_ticket_id:e.source_ticket_id||null,sort_order:e.sort_order||0}).select().single();if(n)throw n;return a}return null},async updateCORMaterialItem(t,e){if(Ue){let r={...e};if(e.quantity!==void 0||e.unit_cost!==void 0){const{data:s}=await Re.from("change_order_materials").select("quantity, unit_cost").eq("id",t).single(),l=e.quantity??s?.quantity??1,c=e.unit_cost??s?.unit_cost??0;r.total=Math.round(l*c)}const{data:a,error:n}=await Re.from("change_order_materials").update(r).eq("id",t).select().single();if(n)throw n;return a}return null},async deleteCORMaterialItem(t){if(Ue){const{error:e}=await Re.from("change_order_materials").delete().eq("id",t);if(e)throw e}},async addCOREquipmentItem(t,e){if(Ue){const r=Math.round(e.quantity*e.unit_cost),{data:a,error:n}=await Re.from("change_order_equipment").insert({change_order_id:t,description:e.description,quantity:e.quantity||1,unit:e.unit||"day",unit_cost:e.unit_cost||0,total:r,source_type:e.source_type||"custom",source_reference:e.source_reference||null,source_ticket_id:e.source_ticket_id||null,sort_order:e.sort_order||0}).select().single();if(n)throw n;return a}return null},async updateCOREquipmentItem(t,e){if(Ue){let r={...e};if(e.quantity!==void 0||e.unit_cost!==void 0){const{data:s}=await Re.from("change_order_equipment").select("quantity, unit_cost").eq("id",t).single(),l=e.quantity??s?.quantity??1,c=e.unit_cost??s?.unit_cost??0;r.total=Math.round(l*c)}const{data:a,error:n}=await Re.from("change_order_equipment").update(r).eq("id",t).select().single();if(n)throw n;return a}return null},async deleteCOREquipmentItem(t){if(Ue){const{error:e}=await Re.from("change_order_equipment").delete().eq("id",t);if(e)throw e}},async addCORSubcontractorItem(t,e){if(Ue){const r=Math.round(e.quantity*e.unit_cost),{data:a,error:n}=await Re.from("change_order_subcontractors").insert({change_order_id:t,description:e.description,quantity:e.quantity||1,unit:e.unit||"lump sum",unit_cost:e.unit_cost||0,total:r,source_type:e.source_type||"custom",source_reference:e.source_reference||null,sort_order:e.sort_order||0}).select().single();if(n)throw n;return a}return null},async updateCORSubcontractorItem(t,e){if(Ue){let r={...e};if(e.quantity!==void 0||e.unit_cost!==void 0){const{data:s}=await Re.from("change_order_subcontractors").select("quantity, unit_cost").eq("id",t).single(),l=e.quantity??s?.quantity??1,c=e.unit_cost??s?.unit_cost??0;r.total=Math.round(l*c)}const{data:a,error:n}=await Re.from("change_order_subcontractors").update(r).eq("id",t).select().single();if(n)throw n;return a}return null},async deleteCORSubcontractorItem(t){if(Ue){const{error:e}=await Re.from("change_order_subcontractors").delete().eq("id",t);if(e)throw e}},async addBulkLaborItems(t,e){if(Ue&&e.length>0){const r=e.map((s,l)=>{const c=Math.round(s.regular_hours*s.regular_rate),f=Math.round(s.overtime_hours*s.overtime_rate);return{change_order_id:t,labor_class:s.labor_class,wage_type:s.wage_type||"standard",regular_hours:s.regular_hours||0,overtime_hours:s.overtime_hours||0,regular_rate:s.regular_rate||0,overtime_rate:s.overtime_rate||0,regular_total:c,overtime_total:f,total:c+f,sort_order:s.sort_order??l,source_ticket_id:s.source_ticket_id||null}}),{data:a,error:n}=await Re.from("change_order_labor").insert(r).select();if(n)throw n;return a}return[]},async addBulkMaterialItems(t,e){if(Ue&&e.length>0){const r=e.map((s,l)=>({change_order_id:t,description:s.description,quantity:s.quantity||1,unit:s.unit||"each",unit_cost:s.unit_cost||0,total:Math.round((s.quantity||1)*(s.unit_cost||0)),source_type:s.source_type||"custom",source_reference:s.source_reference||null,source_ticket_id:s.source_ticket_id||null,sort_order:s.sort_order??l})),{data:a,error:n}=await Re.from("change_order_materials").insert(r).select();if(n)throw n;return a}return[]},async addBulkEquipmentItems(t,e){if(Ue&&e.length>0){const r=e.map((s,l)=>({change_order_id:t,description:s.description,quantity:s.quantity||1,unit:s.unit||"day",unit_cost:s.unit_cost||0,total:Math.round((s.quantity||1)*(s.unit_cost||0)),source_type:s.source_type||"custom",source_reference:s.source_reference||null,source_ticket_id:s.source_ticket_id||null,sort_order:s.sort_order??l})),{data:a,error:n}=await Re.from("change_order_equipment").insert(r).select();if(n)throw n;return a}return[]},async addBulkSubcontractorItems(t,e){if(Ue&&e.length>0){const r=e.map((s,l)=>({change_order_id:t,description:s.description,quantity:s.quantity||1,unit:s.unit||"lump sum",unit_cost:s.unit_cost||0,total:Math.round((s.quantity||1)*(s.unit_cost||0)),source_type:s.source_type||"custom",source_reference:s.source_reference||null,sort_order:s.sort_order??l})),{data:a,error:n}=await Re.from("change_order_subcontractors").insert(r).select();if(n)throw n;return a}return[]},async clearCORLineItems(t){Ue&&(await Re.from("change_order_labor").delete().eq("change_order_id",t),await Re.from("change_order_materials").delete().eq("change_order_id",t),await Re.from("change_order_equipment").delete().eq("change_order_id",t),await Re.from("change_order_subcontractors").delete().eq("change_order_id",t))},async saveCORLineItems(t,{laborItems:e,materialItems:r,equipmentItems:a,subcontractorItems:n}){if(Ue){await this.clearCORLineItems(t);const s=await Promise.all([e?.length>0?this.addBulkLaborItems(t,e):[],r?.length>0?this.addBulkMaterialItems(t,r):[],a?.length>0?this.addBulkEquipmentItems(t,a):[],n?.length>0?this.addBulkSubcontractorItems(t,n):[]]);return{labor:s[0],materials:s[1],equipment:s[2],subcontractors:s[3]}}return null},async assignTicketToCOR(t,e){if(Ue){const{data:r,error:a}=await Re.from("change_order_ticket_associations").insert({change_order_id:e,ticket_id:t,data_imported:!1}).select().single();if(a)throw a;const{error:n}=await Re.from("t_and_m_tickets").update({assigned_cor_id:e}).eq("id",t);if(n)throw n;return r}return null},async unassignTicketFromCOR(t,e){if(Ue){const{error:r}=await Re.from("change_order_ticket_associations").delete().eq("ticket_id",t).eq("change_order_id",e);if(r)throw r;const{error:a}=await Re.from("t_and_m_tickets").update({assigned_cor_id:null}).eq("id",t);if(a)throw a}},async getTicketsForCOR(t){if(Ue){const{data:e,error:r}=await Re.from("change_order_ticket_associations").select(`
          *,
          t_and_m_tickets (
            *,
            t_and_m_workers (*),
            t_and_m_items (
              *,
              materials_equipment (name, unit, cost_per_unit, category)
            )
          )
        `).eq("change_order_id",t);if(r)throw r;return e}return[]},async getUnassignedTickets(t){if(Ue){const{data:e,error:r}=await Re.from("t_and_m_tickets").select(`
          *,
          t_and_m_workers (*),
          t_and_m_items (
            *,
            materials_equipment (name, unit, cost_per_unit, category)
          )
        `).eq("project_id",t).is("assigned_cor_id",null).order("work_date",{ascending:!1});if(r)throw r;return e}return[]},async importTicketDataToCOR(t,e,r,a,n){if(Ue){const{data:s,error:l}=await Re.from("t_and_m_tickets").select(`
          *,
          t_and_m_workers (*),
          t_and_m_items (
            *,
            materials_equipment (name, unit, cost_per_unit, category)
          )
        `).eq("id",t).single();if(l)throw l;const{data:c,error:f}=await Re.from("labor_rates").select("*").eq("company_id",r).eq("work_type",a||"demolition").eq("job_type",n||"standard");if(f)throw f;const d={};c?.forEach(_=>{d[_.role.toLowerCase()]=_});const m={};s.t_and_m_workers?.forEach(_=>{const w=(_.role||"laborer").toLowerCase();m[w]||(m[w]={regular_hours:0,overtime_hours:0}),m[w].regular_hours+=parseFloat(_.hours)||0,m[w].overtime_hours+=parseFloat(_.overtime_hours)||0});const v=Object.entries(m).map(([_,w])=>{const E=d[_]||{regular_rate:0,overtime_rate:0},C=Math.round((parseFloat(E.regular_rate)||0)*100),A=Math.round((parseFloat(E.overtime_rate)||0)*100);return{labor_class:_.charAt(0).toUpperCase()+_.slice(1),wage_type:n||"standard",regular_hours:w.regular_hours,overtime_hours:w.overtime_hours,regular_rate:C,overtime_rate:A,source_ticket_id:t}});v.length>0&&await this.addBulkLaborItems(e,v);const x=[],g=[];s.t_and_m_items?.forEach(_=>{const w=_.custom_name||_.materials_equipment?.name||"Unknown Item",E=_.custom_category||_.materials_equipment?.category||"Other",C=_.materials_equipment?.unit||"each",A=Math.round((parseFloat(_.materials_equipment?.cost_per_unit)||0)*100),T={description:w,quantity:_.quantity||1,unit:C,unit_cost:A,source_type:"backup_sheet",source_ticket_id:t};E==="Equipment"?g.push(T):x.push(T)}),x.length>0&&await this.addBulkMaterialItems(e,x),g.length>0&&await this.addBulkEquipmentItems(e,g);const{error:b}=await Re.from("change_order_ticket_associations").update({data_imported:!0,imported_at:new Date().toISOString()}).eq("change_order_id",e).eq("ticket_id",t);if(b)throw b;return{laborItems:v,materialItems:x,equipmentItems:g}}return null},async reimportTicketDataToCOR(t,e,r,a,n){return Ue?(await Re.from("change_order_labor").delete().eq("change_order_id",e).eq("source_ticket_id",t),await Re.from("change_order_materials").delete().eq("change_order_id",e).eq("source_ticket_id",t),await Re.from("change_order_equipment").delete().eq("change_order_id",e).eq("source_ticket_id",t),this.importTicketDataToCOR(t,e,r,a,n)):null},async recalculateCOR(t){if(Ue){const{error:e}=await Re.rpc("recalculate_cor_totals",{cor_id:t});if(e)throw e;return this.getCORById(t)}return null},async updateCORMarkupPercentages(t,e){if(Ue){const r={};e.labor!==void 0&&(r.labor_markup_percent=e.labor),e.materials!==void 0&&(r.materials_markup_percent=e.materials),e.equipment!==void 0&&(r.equipment_markup_percent=e.equipment),e.subcontractors!==void 0&&(r.subcontractors_markup_percent=e.subcontractors);const{data:a,error:n}=await Re.from("change_orders").update(r).eq("id",t).select().single();if(n)throw n;return a}return null},async updateCORFeePercentages(t,e){if(Ue){const r={};e.liabilityInsurance!==void 0&&(r.liability_insurance_percent=e.liabilityInsurance),e.bond!==void 0&&(r.bond_percent=e.bond),e.licenseFee!==void 0&&(r.license_fee_percent=e.licenseFee);const{data:a,error:n}=await Re.from("change_orders").update(r).eq("id",t).select().single();if(n)throw n;return a}return null},async submitCORForApproval(t){if(Ue){const{data:e,error:r}=await Re.from("change_orders").update({status:"pending_approval",submitted_at:new Date().toISOString()}).eq("id",t).select().single();if(r)throw r;return e}return null},async approveCOR(t,e){if(Ue){const{data:r,error:a}=await Re.from("change_orders").update({status:"approved",approved_by:e,approved_at:new Date().toISOString()}).eq("id",t).select().single();if(a)throw a;return r}return null},async rejectCOR(t,e=null){if(Ue){const{data:r,error:a}=await Re.from("change_orders").update({status:"rejected",rejection_reason:e}).eq("id",t).select().single();if(a)throw a;return r}return null},async markCORAsBilled(t){if(Ue){const{data:e,error:r}=await Re.from("change_orders").update({status:"billed"}).eq("id",t).select().single();if(r)throw r;return e}return null},async closeCOR(t){if(Ue){const{data:e,error:r}=await Re.from("change_orders").update({status:"closed"}).eq("id",t).select().single();if(r)throw r;return e}return null},async saveCORSignature(t,e,r){if(Ue){const{data:a,error:n}=await Re.from("change_orders").update({gc_signature_data:e,gc_signature_name:r,gc_signature_date:new Date().toISOString(),status:"approved"}).eq("id",t).select().single();if(n)throw n;return a}return null},async getCORStats(t){if(Ue){const{data:e,error:r}=await Re.from("change_orders").select("status, cor_total").eq("project_id",t);if(r)throw r;const a={total_cors:e.length,draft_count:0,pending_count:0,approved_count:0,rejected_count:0,billed_count:0,total_approved_value:0,total_pending_value:0,total_billed_value:0};return e.forEach(n=>{switch(n.status){case"draft":a.draft_count++;break;case"pending_approval":a.pending_count++,a.total_pending_value+=n.cor_total||0;break;case"approved":a.approved_count++,a.total_approved_value+=n.cor_total||0;break;case"rejected":a.rejected_count++;break;case"billed":case"closed":a.billed_count++,a.total_billed_value+=n.cor_total||0;break}}),a}return{total_cors:0,draft_count:0,pending_count:0,approved_count:0,rejected_count:0,billed_count:0,total_approved_value:0,total_pending_value:0,total_billed_value:0}},subscribeToCORs(t,e){return Ue?Re.channel(`change_orders:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"change_orders",filter:`project_id=eq.${t}`},e).subscribe():null},async createSignatureRequest(t,e,r,a,n=null,s=null){if(Ue){const{data:l,error:c}=await Re.rpc("generate_signature_token");if(c)throw c;const{data:f,error:d}=await Re.from("signature_requests").insert({document_type:t,document_id:e,company_id:r,project_id:a,signature_token:l,expires_at:s,created_by:n}).select().single();if(d)throw d;return f}return null},async getSignatureRequestByToken(t){if(Ue){await Re.rpc("increment_signature_view_count",{token:t});const{data:e,error:r}=await Re.from("signature_requests").select(`
          *,
          signatures (*)
        `).eq("signature_token",t).single();if(r)throw r;return e}return null},async getSignatureRequestsForDocument(t,e){if(Ue){const{data:r,error:a}=await Re.from("signature_requests").select(`
          *,
          signatures (*)
        `).eq("document_type",t).eq("document_id",e).order("created_at",{ascending:!1});if(a)throw a;return r||[]}return[]},async addSignature(t,e,r){if(Ue){const{data:a,error:n}=await Re.from("signatures").insert({signature_request_id:t,signature_slot:e,signature_image:r.signature,signer_name:r.signerName,signer_title:r.signerTitle||null,signer_company:r.signerCompany||null,signed_at:r.signedAt||new Date().toISOString(),ip_address:r.ipAddress||null,user_agent:r.userAgent||null}).select().single();if(n)throw n;return a}return null},async syncSignatureToDocument(t,e){if(!Ue)return null;const{document_type:r,document_id:a}=e,n=t.signature_slot,s={};n===1?(s.gc_signature_data=t.signature_image,s.gc_signature_name=t.signer_name,s.gc_signature_title=t.signer_title,s.gc_signature_company=t.signer_company,s.gc_signature_date=t.signed_at,s.gc_signature_ip=t.ip_address):n===2&&(s.client_signature_data=t.signature_image,s.client_signature_name=t.signer_name,s.client_signature_title=t.signer_title,s.client_signature_company=t.signer_company,s.client_signature_date=t.signed_at,s.client_signature_ip=t.ip_address);const l=r==="cor"?"change_orders":"t_and_m_tickets",{data:c,error:f}=await Re.from(l).update(s).eq("id",a).select().single();if(f)throw f;return c},async revokeSignatureRequest(t){if(Ue){const{data:e,error:r}=await Re.from("signature_requests").update({status:"revoked"}).eq("id",t).select().single();if(r)throw r;return e}return null},async getDocumentForSigning(t,e){if(!Ue)return null;if(t==="cor"){const{data:r,error:a}=await Re.from("change_orders").select(`
          *,
          projects (
            id,
            name,
            job_number,
            companies (
              id,
              name,
              logo_url
            )
          ),
          change_order_labor (*),
          change_order_materials (*),
          change_order_equipment (*),
          change_order_subcontractors (*)
        `).eq("id",e).single();if(a)throw a;return r}else if(t==="tm_ticket"){const{data:r,error:a}=await Re.from("t_and_m_tickets").select(`
          *,
          projects (
            id,
            name,
            job_number,
            companies (
              id,
              name,
              logo_url
            )
          ),
          t_and_m_workers (*),
          t_and_m_items (*)
        `).eq("id",e).single();if(a)throw a;return r}return null},async getProjectCosts(t){if(Ue){const{data:r,error:a}=await Re.from("project_costs").select("*").eq("project_id",t).order("cost_date",{ascending:!1});return a?(console.error("Error fetching project costs:",a),[]):r||[]}return(or().projectCosts||[]).filter(r=>r.project_id===t).sort((r,a)=>new Date(a.cost_date)-new Date(r.cost_date))},async addProjectCost(t,e,r){const a={project_id:t,company_id:e,category:r.category,description:r.description,amount:parseFloat(r.amount),cost_date:r.cost_date||new Date().toISOString().split("T")[0],notes:r.notes||null,created_by:r.created_by||null};if(Ue){const{data:l,error:c}=await Re.from("project_costs").insert(a).select().single();if(c)throw console.error("Error adding project cost:",c),c;return l}const n=or();n.projectCosts||(n.projectCosts=[]);const s={...a,id:crypto.randomUUID(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return n.projectCosts.push(s),Gr(n),s},async updateProjectCost(t,e){const r={category:e.category,description:e.description,amount:parseFloat(e.amount),cost_date:e.cost_date,notes:e.notes||null,updated_at:new Date().toISOString()};if(Ue){const{data:s,error:l}=await Re.from("project_costs").update(r).eq("id",t).select().single();if(l)throw console.error("Error updating project cost:",l),l;return s}const a=or();if(!a.projectCosts)return null;const n=a.projectCosts.findIndex(s=>s.id===t);return n===-1?null:(a.projectCosts[n]={...a.projectCosts[n],...r},Gr(a),a.projectCosts[n])},async deleteProjectCost(t){if(Ue){const{error:r}=await Re.from("project_costs").delete().eq("id",t);if(r)throw console.error("Error deleting project cost:",r),r;return!0}const e=or();return e.projectCosts&&(e.projectCosts=e.projectCosts.filter(r=>r.id!==t),Gr(e)),!0},async getProjectCostsSummary(t){const e=await this.getProjectCosts(t),r={};let a=0;return e.forEach(n=>{const s=parseFloat(n.amount)||0;a+=s,r[n.category]||(r[n.category]={category:n.category,total:0,count:0,items:[]}),r[n.category].total+=s,r[n.category].count++,r[n.category].items.push(n)}),Object.values(r).forEach(n=>{n.percentage=a>0?n.total/a*100:0}),{totalCost:a,byCategory:r,itemCount:e.length}}};G4(async t=>{if(t&&Ue){console.log("Back online - syncing pending actions...");try{const e=await CC(ot);e.synced>0&&console.log(`Synced ${e.synced} pending actions`),e.failed>0&&console.warn(`Failed to sync ${e.failed} actions`)}catch(e){console.error("Error syncing pending actions:",e)}}});const K4=ee.createContext(),Ti={logo_url:null,favicon_url:null,login_background_url:null,primary_color:"#3B82F6",secondary_color:"#1E40AF",custom_app_name:"FieldSync",hide_fieldsync_branding:!1,email_from_name:"FieldSync",email_from_address:null,custom_domain:null,domain_verified:!1};function Pd({children:t,companyId:e}){const[r,a]=ee.useState(Ti),[n,s]=ee.useState(!0);ee.useEffect(()=>{e?l(e):c()},[e]),ee.useEffect(()=>{m(r)},[r]);const l=async g=>{try{if(s(!0),!Ue){a(Ti),s(!1);return}const{data:b,error:_}=await Re.from("company_branding").select("*").eq("company_id",g).single();_?(_.code==="PGRST116"?await f(g):console.error("Error loading branding:",_),a(Ti)):a({...Ti,...b})}catch(b){console.error("Error in loadBranding:",b),a(Ti)}finally{s(!1)}},c=async()=>{try{s(!0);const g=window.location.hostname;if(g==="localhost"||g==="127.0.0.1"){a(Ti),s(!1);return}if(!Ue){a(Ti),s(!1);return}const{data:b,error:_}=await Re.rpc("get_branding_by_domain",{domain_name:g});_||!b||b.length===0?a(Ti):a({...Ti,...b[0]})}catch(g){console.error("Error loading branding by domain:",g),a(Ti)}finally{s(!1)}},f=async g=>{try{const{data:b,error:_}=await Re.from("company_branding").insert({company_id:g,...Ti}).select().single();_&&console.error("Error creating default branding:",_)}catch(b){console.error("Error in createDefaultBranding:",b)}},d=async g=>{try{if(!Ue)return a(T=>({...T,...g})),{success:!0};if(!e)return{success:!1,error:"No company ID"};const b={},_=["logo_url","favicon_url","login_background_url","primary_color","secondary_color","custom_app_name","hide_fieldsync_branding","email_from_name","email_from_address","custom_domain","domain_verified"];for(const T of _)g[T]!==void 0&&(b[T]=g[T]);const{data:w,error:E}=await Re.from("company_branding").select("id").eq("company_id",e).single();if(E&&E.code==="PGRST116"){const{data:T,error:G}=await Re.from("company_branding").insert({company_id:e,...b}).select().single();return G?(console.error("Error creating branding:",G),{success:!1,error:G.message}):(a({...Ti,...T}),{success:!0,data:T})}const{data:C,error:A}=await Re.from("company_branding").update(b).eq("company_id",e).select().single();return A?(console.error("Error updating branding:",A),{success:!1,error:A.message}):(a({...Ti,...C}),{success:!0,data:C})}catch(b){return console.error("Error in updateBranding:",b),{success:!1,error:b.message}}},m=g=>{const b=document.documentElement;if(b.style.setProperty("--primary-color",g.primary_color),b.style.setProperty("--secondary-color",g.secondary_color),g.favicon_url){let _=document.querySelector("link[rel*='icon']");_||(_=document.createElement("link"),_.rel="icon",document.head.appendChild(_)),_.href=g.favicon_url}document.title=g.custom_app_name||"FieldSync"},x={branding:r,loading:n,updateBranding:d,uploadBrandingImage:async(g,b)=>{try{if(!Ue)return{success:!0,url:URL.createObjectURL(g)};const _=g.name.split(".").pop(),E=`branding/${`${e}/${b}-${Date.now()}.${_}`}`,{data:C,error:A}=await Re.storage.from("public").upload(E,g,{cacheControl:"3600",upsert:!0});if(A)return console.error("Error uploading image:",A),{success:!1,error:A.message};const{data:{publicUrl:T}}=Re.storage.from("public").getPublicUrl(E);return{success:!0,url:T}}catch(_){return console.error("Error in uploadBrandingImage:",_),{success:!1,error:_.message}}},refreshBranding:()=>e?l(e):c()};return o.jsx(K4.Provider,{value:x,children:t})}function hh(){const t=ee.useContext(K4);if(!t)throw new Error("useBranding must be used within a BrandingProvider");return t}const DC=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),FC=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,a)=>a?a.toUpperCase():r.toLowerCase()),nw=t=>{const e=FC(t);return e.charAt(0).toUpperCase()+e.slice(1)},J4=(...t)=>t.filter((e,r,a)=>!!e&&e.trim()!==""&&a.indexOf(e)===r).join(" ").trim(),LC=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var PC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const MC=ee.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:n="",children:s,iconNode:l,...c},f)=>ee.createElement("svg",{ref:f,...PC,width:e,height:e,stroke:t,strokeWidth:a?Number(r)*24/Number(e):r,className:J4("lucide",n),...!s&&!LC(c)&&{"aria-hidden":"true"},...c},[...l.map(([d,m])=>ee.createElement(d,m)),...Array.isArray(s)?s:[s]]));const mr=(t,e)=>{const r=ee.forwardRef(({className:a,...n},s)=>ee.createElement(MC,{ref:s,iconNode:e,className:J4(`lucide-${DC(nw(t))}`,`lucide-${t}`,a),...n}));return r.displayName=nw(t),r};const IC=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],BC=mr("bell",IC);const UC=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],O0=mr("briefcase",UC);const qC=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],n2=mr("building-2",qC);const zC=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],J0=mr("calendar",zC);const HC=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Mp=mr("camera",HC);const $C=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],R0=mr("check",$C);const WC=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],xc=mr("chevron-down",WC);const VC=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],GC=mr("chevron-left",VC);const YC=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Of=mr("chevron-right",YC);const XC=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],s2=mr("chevron-up",XC);const KC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],mh=mr("circle-alert",KC);const JC=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],pf=mr("circle-check-big",JC);const ZC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],sw=mr("circle-x",ZC);const QC=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],gu=mr("clipboard-list",QC);const eT=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Xp=mr("clock",eT);const tT=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],iw=mr("copy",tT);const rT=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],D0=mr("dollar-sign",rT);const aT=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],nT=mr("download",aT);const sT=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],Z4=mr("ellipsis",sT);const iT=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],ow=mr("external-link",iT);const oT=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],lT=mr("eye",oT);const cT=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],El=mr("file-text",cT);const uT=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],fT=mr("flame",uT);const dT=[["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M14 6a6 6 0 0 1 6 6v3",key:"1hnv84"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6",key:"9ciidu"}],["rect",{x:"2",y:"15",width:"20",height:"4",rx:"1",key:"g3x8cw"}]],Ys=mr("hard-hat",dT);const hT=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Q4=mr("info",hT);const mT=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],pT=mr("layout-grid",mT);const gT=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],i2=mr("link",gT);const vT=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],xT=mr("map-pin",vT);const yT=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Z0=mr("message-square",yT);const _T=[["path",{d:"M5 12h14",key:"1ays0h"}]],bT=mr("minus",_T);const wT=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],yc=mr("package",wT);const ST=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],o2=mr("pen-line",ST);const NT=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],jT=mr("pen-tool",NT);const kT=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],eN=mr("pen",kT);const ET=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],tN=mr("pencil",ET);const AT=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],CT=mr("percent",AT);const TT=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],OT=mr("phone",TT);const RT=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Wo=mr("plus",RT);const DT=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],rN=mr("rotate-ccw",DT);const FT=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],lw=mr("save",FT);const LT=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],PT=mr("search",LT);const MT=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],aN=mr("send",MT);const IT=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],nN=mr("shield",IT);const BT=[["path",{d:"M14 13V8.5C14 7 15 7 15 5a3 3 0 0 0-6 0c0 2 1 2 1 3.5V13",key:"i9gjdv"}],["path",{d:"M20 15.5a2.5 2.5 0 0 0-2.5-2.5h-11A2.5 2.5 0 0 0 4 15.5V17a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1z",key:"1vzg3v"}],["path",{d:"M5 22h14",key:"ehvnwv"}]],UT=mr("stamp",BT);const qT=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],lc=mr("trash-2",qT);const zT=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],sN=mr("trending-down",zT);const HT=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],$T=mr("trending-up",HT);const WT=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],x1=mr("triangle-alert",WT);const VT=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],ph=mr("truck",VT);const GT=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],YT=mr("upload",GT);const XT=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],KT=mr("user-check",XT);const JT=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],y1=mr("users",JT);const ZT=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]],Q0=mr("wrench",ZT);const QT=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Rf=mr("x",QT);const e8=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],t8=mr("zap",e8);function Nl({className:t="",showPoweredBy:e=!1}){const{branding:r}=hh();return o.jsxs("div",{className:`app-logo ${t}`,children:[r.logo_url?o.jsx("img",{src:r.logo_url,alt:r.custom_app_name||"Logo",className:"custom-logo"}):o.jsxs("div",{className:"logo",children:[r.custom_app_name||"Field",o.jsx("span",{children:"Sync"})]}),e&&!r.hide_fieldsync_branding&&o.jsx("div",{className:"powered-by",children:"Powered by FieldSync"})]})}function r8({onForemanAccess:t,onOfficeLogin:e,onShowToast:r}){const[a,n]=ee.useState(null),[s,l]=ee.useState(""),[c,f]=ee.useState(null),[d,m]=ee.useState(""),[v,x]=ee.useState(!1),[g,b]=ee.useState(""),[_,w]=ee.useState(""),[E,C]=ee.useState(1),[A,T]=ee.useState(null),[G,W]=ee.useState(""),[B,q]=ee.useState(""),[L,J]=ee.useState(""),[D,O]=ee.useState(""),M=F=>{const I=F.toUpperCase().replace(/[^A-Z0-9]/g,"").slice(0,20);l(I)},V=async()=>{if(s.length<2){r("Enter company code","error");return}x(!0);try{const F=await ot.getCompanyByCode(s);F?f(F):(r("Invalid company code","error"),l(""))}catch{r("Error checking code","error")}finally{x(!1)}},ie=async F=>{if(F.length===4){x(!0);try{const I=await ot.getProjectByPinAndCompany(F,c.id);I?t(I):(r("Invalid PIN","error"),m(""))}catch{r("Error checking PIN","error")}finally{x(!1)}}},X=F=>{if(d.length<4){const I=d+F;m(I),I.length===4&&setTimeout(()=>ie(I),200)}},Z=()=>{m(F=>F.slice(0,-1))},K=()=>{f(null),m("")},ae=()=>{if(!g.trim()||!_.trim()){r("Enter email and password","error");return}e(g,_)},fe=async()=>{if(s.length<2){r("Enter company code","error");return}x(!0);try{const F=await ot.getCompanyByCode(s);F?(T(F),C(2)):(r("Invalid company code","error"),l(""))}catch{r("Error checking code","error")}finally{x(!1)}},U=async()=>{if(!G.trim()){r("Enter office code","error");return}x(!0);try{const{data:F,error:I}=await Re.rpc("verify_office_code",{company_id:A.id,code:G.trim()});if(I)throw I;F===!0?C(3):(r("Invalid office code","error"),W(""))}catch{r("Error verifying code","error")}finally{x(!1)}},j=async()=>{if(!B.trim()){r("Enter your name","error");return}if(!L.trim()||!L.includes("@")){r("Enter valid email","error");return}if(D.length<6){r("Password must be 6+ characters","error");return}x(!0);try{const{data:F,error:I}=await Re.auth.signUp({email:L,password:D});if(I)throw I;const z=F.user?.id;if(!z)throw new Error("Failed to create user");const{error:ne}=await Re.from("users").insert({id:z,email:L,password_hash:"managed_by_supabase_auth",name:B.trim(),company_id:A.id,role:"member",is_active:!0});if(ne)throw ne;const{error:se}=await Re.from("user_companies").insert({user_id:z,company_id:A.id,role:"member"});se&&console.error("Error adding to user_companies:",se),r("Account created! Logging you in...","success"),setTimeout(()=>{window.location.reload()},1e3)}catch(F){console.error("Join error:",F),r(F.message||"Error creating account","error")}finally{x(!1)}};if(a===null)return o.jsx("div",{className:"entry-container",children:o.jsxs("div",{className:"entry-card",children:[o.jsx(Nl,{className:"entry-logo",showPoweredBy:!1}),o.jsxs("div",{className:"entry-buttons",children:[o.jsxs("button",{className:"entry-mode-btn foreman",onClick:()=>n("foreman"),children:[o.jsx("span",{className:"entry-mode-icon",children:o.jsx(Ys,{size:32})}),o.jsx("span",{className:"entry-mode-title",children:"Foreman"}),o.jsx("span",{className:"entry-mode-desc",children:"Enter project PIN"})]}),o.jsxs("button",{className:"entry-mode-btn office",onClick:()=>n("office"),children:[o.jsx("span",{className:"entry-mode-icon",children:o.jsx(O0,{size:32})}),o.jsx("span",{className:"entry-mode-title",children:"Office"}),o.jsx("span",{className:"entry-mode-desc",children:"Sign in to dashboard"})]})]})]})});if(a==="foreman")return c?o.jsx("div",{className:"entry-container",children:o.jsxs("div",{className:"entry-card",children:[o.jsx("button",{className:"entry-back",onClick:K,children:""}),o.jsx(Nl,{className:"entry-logo",showPoweredBy:!1}),o.jsx("div",{className:"entry-company-badge",children:c.name}),o.jsx("p",{className:"entry-subtitle",children:"Enter project PIN"}),o.jsx("div",{className:"pin-display",children:[0,1,2,3].map(F=>o.jsx("div",{className:`pin-dot ${d.length>F?"filled":""}`,children:d.length>F?"":""},F))}),o.jsxs("div",{className:"number-pad",children:[[1,2,3,4,5,6,7,8,9].map(F=>o.jsx("button",{className:"num-btn",onClick:()=>X(F.toString()),disabled:v,children:F},F)),o.jsx("button",{className:"num-btn empty",disabled:!0}),o.jsx("button",{className:"num-btn",onClick:()=>X("0"),disabled:v,children:"0"}),o.jsx("button",{className:"num-btn backspace",onClick:Z,disabled:v||d.length===0,children:""})]}),v&&o.jsx("div",{className:"entry-loading",children:o.jsx("div",{className:"spinner"})})]})}):o.jsx("div",{className:"entry-container",children:o.jsxs("div",{className:"entry-card",children:[o.jsx("button",{className:"entry-back",onClick:()=>n(null),children:""}),o.jsx(Nl,{className:"entry-logo",showPoweredBy:!1}),o.jsx("p",{className:"entry-subtitle",children:"Enter company code"}),o.jsxs("div",{className:"entry-input-group",children:[o.jsx("input",{type:"text",value:s,onChange:F=>M(F.target.value),placeholder:"Company Code",disabled:v,autoFocus:!0,onKeyDown:F=>{F.key==="Enter"&&V()}}),o.jsx("button",{className:"entry-submit-btn",onClick:V,disabled:v||s.length<2,children:v?"...":""})]})]})});if(a==="office")return o.jsx("div",{className:"entry-container",children:o.jsxs("div",{className:"entry-card",children:[o.jsx("button",{className:"entry-back",onClick:()=>n(null),children:""}),o.jsx(Nl,{className:"entry-logo",showPoweredBy:!1}),o.jsx("p",{className:"entry-subtitle",children:"Sign in to your account"}),o.jsxs("div",{className:"entry-form",children:[o.jsx("input",{type:"email",value:g,onChange:F=>b(F.target.value),placeholder:"Email",autoFocus:!0,onKeyDown:F=>{F.key==="Enter"&&ae()}}),o.jsx("input",{type:"password",value:_,onChange:F=>w(F.target.value),placeholder:"Password",onKeyDown:F=>{F.key==="Enter"&&ae()}}),o.jsx("button",{className:"entry-login-btn",onClick:ae,children:"Sign In"})]}),o.jsxs("div",{className:"entry-signup-hint",children:[o.jsx("p",{children:"New employee?"}),o.jsx("button",{className:"entry-join-link",onClick:()=>n("join"),children:"Join your company"})]})]})});if(a==="join")return E===1?o.jsx("div",{className:"entry-container",children:o.jsxs("div",{className:"entry-card",children:[o.jsx("button",{className:"entry-back",onClick:()=>n("office"),children:""}),o.jsx(Nl,{className:"entry-logo",showPoweredBy:!1}),o.jsx("p",{className:"entry-subtitle",children:"Enter your company code"}),o.jsx("p",{className:"entry-hint",children:"Ask your manager or admin for the code"}),o.jsxs("div",{className:"entry-input-group",children:[o.jsx("input",{type:"text",value:s,onChange:F=>M(F.target.value),placeholder:"Company Code",disabled:v,autoFocus:!0,onKeyDown:F=>{F.key==="Enter"&&fe()}}),o.jsx("button",{className:"entry-submit-btn",onClick:fe,disabled:v||s.length<2,children:v?"...":""})]})]})}):E===2?o.jsx("div",{className:"entry-container",children:o.jsxs("div",{className:"entry-card",children:[o.jsx("button",{className:"entry-back",onClick:()=>{C(1),T(null),W("")},children:""}),o.jsx(Nl,{className:"entry-logo",showPoweredBy:!1}),o.jsx("div",{className:"entry-company-badge",children:A?.name}),o.jsx("p",{className:"entry-subtitle",children:"Enter office code"}),o.jsx("p",{className:"entry-hint",children:"This code is only for office staff"}),o.jsxs("div",{className:"entry-input-group",children:[o.jsx("input",{type:"password",value:G,onChange:F=>W(F.target.value),placeholder:"Office Code",disabled:v,autoFocus:!0,onKeyDown:F=>{F.key==="Enter"&&U()}}),o.jsx("button",{className:"entry-submit-btn",onClick:U,disabled:v||!G.trim(),children:v?"...":""})]})]})}):o.jsx("div",{className:"entry-container",children:o.jsxs("div",{className:"entry-card",children:[o.jsx("button",{className:"entry-back",onClick:()=>{C(2),W("")},children:""}),o.jsx(Nl,{className:"entry-logo",showPoweredBy:!1}),o.jsx("div",{className:"entry-company-badge",children:A?.name}),o.jsx("p",{className:"entry-subtitle",children:"Create your account"}),o.jsxs("div",{className:"entry-form",children:[o.jsx("input",{type:"text",value:B,onChange:F=>q(F.target.value),placeholder:"Your Name",autoFocus:!0}),o.jsx("input",{type:"email",value:L,onChange:F=>J(F.target.value),placeholder:"Email"}),o.jsx("input",{type:"password",value:D,onChange:F=>O(F.target.value),placeholder:"Password (6+ characters)",onKeyDown:F=>{F.key==="Enter"&&j()}}),o.jsx("button",{className:"entry-login-btn",onClick:j,disabled:v,children:v?"Creating...":"Join Company"})]}),o.jsx("p",{className:"entry-join-note",children:"You'll join as a team member. Your admin can update your role."})]})})}function Xn(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}function _x(t){if(!t||t.length===0)return 0;let e=0;return t.forEach(r=>{r.status==="done"&&(e+=r.weight)}),Math.round(e)}function iN(t){if(!t||t.length===0)return"not_started";const e=t.some(n=>n.status==="working"),r=t.some(n=>n.status==="done");return t.every(n=>n.status==="done")?"done":e||r?"working":"not_started"}function a8(t){const e=iN(t);return e==="done"?"Complete":e==="working"?"In Progress":"Not Started"}const cw=["Containment","PPE","Disposal","Equipment"];function n8({project:t,companyId:e,maxPhotos:r=10,onSubmit:a,onCancel:n,onShowToast:s}){const[l,c]=ee.useState(1),[f,d]=ee.useState(new Date().toISOString().split("T")[0]),[m,v]=ee.useState(""),[x,g]=ee.useState(""),[b,_]=ee.useState([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:"",role:"Foreman"}]),[w,E]=ee.useState([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}]),[C,A]=ee.useState([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}]),[T,G]=ee.useState([]),[W,B]=ee.useState(""),[q,L]=ee.useState([]),[J,D]=ee.useState(!1),[O,M]=ee.useState(""),[V,ie]=ee.useState([]),[X,Z]=ee.useState(!1),[K,ae]=ee.useState(null),[fe,U]=ee.useState([]),[j,F]=ee.useState(!1),[I,z]=ee.useState(!1),[ne,se]=ee.useState({name:"",category:"",quantity:""});ee.useEffect(()=>{pe()},[t.id]);const pe=async()=>{try{const Ce=await ot.getCrewCheckin(t.id);Ce?.workers&&ie(Ce.workers)}catch(Ce){console.error("Error loading crew:",Ce)}};ee.useEffect(()=>{K&&e&&ye(K)},[K,e]);const ye=async Ce=>{F(!0);try{const $e=await ot.getMaterialsEquipmentByCategory(e,Ce);U($e)}catch($e){console.error("Error loading items:",$e),s("Error loading items","error")}finally{F(!1)}},_e=()=>{_([...b,{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:"",role:"Foreman"}])},Le=(Ce,$e,xe)=>{_(b.map((Be,Pe)=>Pe===Ce?{...Be,[$e]:xe}:Be))},ue=Ce=>{b.length>1?_(b.filter(($e,xe)=>xe!==Ce)):_([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:"",role:"Foreman"}])},at=()=>{A([...C,{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])},ht=(Ce,$e,xe)=>{A(C.map((Be,Pe)=>Pe===Ce?{...Be,[$e]:xe}:Be))},de=Ce=>{C.length>1?A(C.filter(($e,xe)=>xe!==Ce)):A([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])},it=()=>{E([...w,{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])},Se=(Ce,$e,xe)=>{E(w.map((Be,Pe)=>Pe===Ce?{...Be,[$e]:xe}:Be))},ve=Ce=>{w.length>1?E(w.filter(($e,xe)=>xe!==Ce)):E([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])},Ie=Ce=>{const $e=T.findIndex(xe=>xe.material_equipment_id===Ce.id);$e>=0?G(T.map((xe,Be)=>Be===$e?{...xe,quantity:xe.quantity+1}:xe)):G([...T,{material_equipment_id:Ce.id,name:Ce.name,unit:Ce.unit,category:Ce.category,quantity:1,isCustom:!1}]),s(`Added ${Ce.name}`,"success")},wt=()=>{if(!ne.name||!ne.category||!ne.quantity){s("Fill in all fields","error");return}G([...T,{material_equipment_id:null,custom_name:ne.name,custom_category:ne.category,name:ne.name,category:ne.category,quantity:parseFloat(ne.quantity),unit:"each",isCustom:!0}]),se({name:"",category:"",quantity:""}),z(!1),ae(null),s("Custom item added","success")},Xe=(Ce,$e)=>{const xe=parseFloat($e)||0;xe<=0?ct(Ce):G(T.map((Be,Pe)=>Pe===Ce?{...Be,quantity:xe}:Be))},ct=Ce=>{G(T.filter(($e,xe)=>xe!==Ce))},jt=Ce=>{const $e=Array.from(Ce.target.files);if($e.length===0)return;const xe=r===-1?1/0:r-q.length;if(xe<=0){s(`Photo limit reached (${r} max)`,"error"),Ce.target.value="";return}const Be=$e.slice(0,xe);Be.length<$e.length&&s(`Only ${Be.length} photo(s) added (${r} max)`,"error"),Be.forEach(Pe=>{if(!Pe.type.startsWith("image/")){s("Please select an image file","error");return}const Ct=URL.createObjectURL(Pe);L(gt=>[...gt,{id:Date.now()+Math.random(),file:Pe,previewUrl:Ct,name:Pe.name}])}),Ce.target.value=""},Lt=Ce=>{const $e=q.find(xe=>xe.id===Ce);$e?.previewUrl&&URL.revokeObjectURL($e.previewUrl),L(q.filter(xe=>xe.id!==Ce))},Vt=()=>{if(l===1){const Ce=b.some(Be=>Be.name.trim()&&(parseFloat(Be.hours)>0||parseFloat(Be.overtimeHours)>0)),$e=w.some(Be=>Be.name.trim()&&(parseFloat(Be.hours)>0||parseFloat(Be.overtimeHours)>0)),xe=C.some(Be=>Be.name.trim()&&(parseFloat(Be.hours)>0||parseFloat(Be.overtimeHours)>0));return Ce||$e||xe}return!0},$t=()=>{l<3&&c(l+1)},Wt=()=>{K?(ae(null),z(!1)):I?z(!1):l>1?c(l-1):n()},Ot=async()=>{if(!x.trim()){s("Enter your name to submit","error");return}const Ce=b.filter(Be=>Be.name.trim()&&(parseFloat(Be.hours)>0||parseFloat(Be.overtimeHours)>0)),$e=w.filter(Be=>Be.name.trim()&&(parseFloat(Be.hours)>0||parseFloat(Be.overtimeHours)>0)),xe=C.filter(Be=>Be.name.trim()&&(parseFloat(Be.hours)>0||parseFloat(Be.overtimeHours)>0));if(Ce.length===0&&$e.length===0&&xe.length===0){s("Add at least one worker","error");return}D(!0),M("Creating ticket...");try{const Be=await ot.createTMTicket({project_id:t.id,work_date:f,ce_pco_number:m.trim()||null,notes:W.trim()||null,photos:[],created_by_name:x.trim()});let Pe=[];if(q.length>0){M(`Uploading ${q.length} photo${q.length>1?"s":""}...`);const gt=q.map(It=>ot.uploadPhoto(e,t.id,Be.id,It.file).catch(pr=>(console.error("Error uploading photo:",pr),null)));Pe=(await Promise.all(gt)).filter(It=>It!==null)}Pe.length>0&&(M("Saving photos..."),await ot.updateTMTicketPhotos(Be.id,Pe));const Ct=[...Ce.map(gt=>({name:gt.name.trim(),hours:parseFloat(gt.hours)||0,overtime_hours:parseFloat(gt.overtimeHours)||0,time_started:gt.timeStarted||null,time_ended:gt.timeEnded||null,role:gt.role})),...$e.map(gt=>({name:gt.name.trim(),hours:parseFloat(gt.hours)||0,overtime_hours:parseFloat(gt.overtimeHours)||0,time_started:gt.timeStarted||null,time_ended:gt.timeEnded||null,role:"Operator"})),...xe.map(gt=>({name:gt.name.trim(),hours:parseFloat(gt.hours)||0,overtime_hours:parseFloat(gt.overtimeHours)||0,time_started:gt.timeStarted||null,time_ended:gt.timeEnded||null,role:"Laborer"}))];M("Saving workers..."),await ot.addTMWorkers(Be.id,Ct),T.length>0&&(M("Saving materials..."),await ot.addTMItems(Be.id,T.map(gt=>({material_equipment_id:gt.material_equipment_id,custom_name:gt.custom_name||null,custom_category:gt.custom_category||null,quantity:gt.quantity})))),q.forEach(gt=>{gt.previewUrl&&URL.revokeObjectURL(gt.previewUrl)}),s("T&M submitted!","success"),a()}catch(Be){console.error("Error submitting T&M:",Be),s("Error submitting T&M","error")}finally{D(!1),M("")}},kt=b.filter(Ce=>Ce.name.trim()&&(parseFloat(Ce.hours)>0||parseFloat(Ce.overtimeHours)>0)),qe=w.filter(Ce=>Ce.name.trim()&&(parseFloat(Ce.hours)>0||parseFloat(Ce.overtimeHours)>0)),Ye=C.filter(Ce=>Ce.name.trim()&&(parseFloat(Ce.hours)>0||parseFloat(Ce.overtimeHours)>0)),Pt=kt.length+qe.length+Ye.length,Et=[...kt,...qe,...Ye].reduce((Ce,$e)=>Ce+parseFloat($e.hours||0),0),Dt=[...kt,...qe,...Ye].reduce((Ce,$e)=>Ce+parseFloat($e.overtimeHours||0),0);return T.reduce((Ce,$e)=>Ce+$e.quantity,0),l===2&&(K||I)?o.jsxs("div",{className:"tm-wizard",children:[o.jsxs("div",{className:"tm-wizard-header",children:[o.jsx("button",{className:"tm-back-btn",onClick:Wt,children:""}),o.jsx("h2",{children:I?"Add Custom Item":K}),o.jsxs("div",{className:"tm-item-count",children:[T.length," items"]})]}),I?o.jsxs("div",{className:"tm-custom-form",children:[o.jsxs("div",{className:"tm-field",children:[o.jsx("label",{children:"Item Name"}),o.jsx("input",{type:"text",placeholder:"What did you use?",value:ne.name,onChange:Ce=>se({...ne,name:Ce.target.value}),autoFocus:!0})]}),o.jsxs("div",{className:"tm-field",children:[o.jsx("label",{children:"Category"}),o.jsx("div",{className:"tm-category-select",children:cw.map(Ce=>o.jsx("button",{className:`tm-cat-chip ${ne.category===Ce?"active":""}`,onClick:()=>se({...ne,category:Ce}),children:Ce},Ce))})]}),o.jsxs("div",{className:"tm-field",children:[o.jsx("label",{children:"Quantity"}),o.jsx("input",{type:"number",placeholder:"How many?",value:ne.quantity,onChange:Ce=>se({...ne,quantity:Ce.target.value})})]}),o.jsx("button",{className:"tm-big-btn primary",onClick:wt,children:"Add Custom Item"})]}):o.jsx("div",{className:"tm-item-grid",children:j?o.jsx("div",{className:"tm-loading",children:"Loading..."}):o.jsxs(o.Fragment,{children:[fe.map(Ce=>{const $e=T.find(xe=>xe.material_equipment_id===Ce.id);return o.jsxs("button",{className:`tm-item-card ${$e?"added":""}`,onClick:()=>Ie(Ce),children:[o.jsx("span",{className:"tm-item-name",children:Ce.name}),o.jsx("span",{className:"tm-item-unit",children:Ce.unit}),$e&&o.jsx("span",{className:"tm-item-badge",children:$e.quantity})]},Ce.id)}),o.jsxs("button",{className:"tm-item-card custom",onClick:()=>z(!0),children:[o.jsx("span",{className:"tm-item-name",children:"+ Add Other"}),o.jsx("span",{className:"tm-item-unit",children:"Not on list"})]})]})}),!I&&T.length>0&&o.jsx("div",{className:"tm-wizard-footer",children:o.jsxs("button",{className:"tm-big-btn primary",onClick:()=>ae(null),children:["Done Adding (",T.length," items)"]})})]}):o.jsxs("div",{className:"tm-wizard",children:[o.jsxs("div",{className:"tm-wizard-header",children:[o.jsx("button",{className:"tm-back-btn",onClick:Wt,children:""}),o.jsxs("h2",{children:[l===1&&"Workers",l===2&&"Materials & Equipment",l===3&&"Review"]}),o.jsxs("div",{className:"tm-step-dots",children:[o.jsx("span",{className:`tm-dot ${l>=1?"active":""}`}),o.jsx("span",{className:`tm-dot ${l>=2?"active":""}`}),o.jsx("span",{className:`tm-dot ${l>=3?"active":""}`})]})]}),l===1&&o.jsxs("div",{className:"tm-step-content",children:[o.jsxs("div",{className:"tm-project-info",children:[t.job_number&&o.jsxs("div",{className:"tm-project-detail",children:[o.jsx("span",{className:"tm-project-label",children:"Job #"}),o.jsx("span",{className:"tm-project-value",children:t.job_number})]}),o.jsxs("div",{className:"tm-project-detail",children:[o.jsx("span",{className:"tm-project-label",children:"Project"}),o.jsx("span",{className:"tm-project-value",children:t.name})]}),t.address&&o.jsxs("div",{className:"tm-project-detail",children:[o.jsx("span",{className:"tm-project-label",children:"Address"}),o.jsx("span",{className:"tm-project-value",children:t.address})]}),t.general_contractor&&o.jsxs("div",{className:"tm-project-detail",children:[o.jsx("span",{className:"tm-project-label",children:"GC"}),o.jsx("span",{className:"tm-project-value",children:t.general_contractor})]})]}),o.jsxs("div",{className:"tm-field-row",children:[o.jsxs("div",{className:"tm-field tm-field-half",children:[o.jsx("label",{children:"Date"}),o.jsx("input",{type:"date",value:f,onChange:Ce=>d(Ce.target.value),className:"tm-date"})]}),o.jsxs("div",{className:"tm-field tm-field-half",children:[o.jsx("label",{children:"CE / PCO #"}),o.jsx("input",{type:"text",placeholder:"Change Event / PCO",value:m,onChange:Ce=>v(Ce.target.value),className:"tm-input"})]})]}),V.length>0&&o.jsxs("div",{className:"tm-crew-picker",children:[o.jsxs("button",{className:"tm-crew-picker-btn",onClick:()=>Z(!X),children:[o.jsx(Ys,{size:16})," ",X?"Hide":"Select from"," Today's Crew (",V.length,")"]}),X&&o.jsx("div",{className:"tm-crew-list",children:V.map((Ce,$e)=>{const xe=b.some(Be=>Be.name.toLowerCase()===Ce.name.toLowerCase())||w.some(Be=>Be.name.toLowerCase()===Ce.name.toLowerCase())||C.some(Be=>Be.name.toLowerCase()===Ce.name.toLowerCase());return o.jsxs("button",{className:`tm-crew-item ${xe?"added":""}`,onClick:()=>{if(!xe){if(Ce.role==="Foreman"||Ce.role==="Supervisor"){const Be=b.findIndex(Pe=>!Pe.name.trim());Be>=0?Le(Be,"name",Ce.name):_([...b,{name:Ce.name,hours:"",overtimeHours:"",timeStarted:"",timeEnded:"",role:Ce.role==="Supervisor"?"Superintendent":"Foreman"}])}else if(Ce.role==="Operator"){const Be=w.findIndex(Pe=>!Pe.name.trim());Be>=0?Se(Be,"name",Ce.name):E([...w,{name:Ce.name,hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])}else{const Be=C.findIndex(Pe=>!Pe.name.trim());Be>=0?ht(Be,"name",Ce.name):A([...C,{name:Ce.name,hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])}s(`Added ${Ce.name}`,"success")}},disabled:xe,children:[o.jsx("span",{className:"tm-crew-item-name",children:Ce.name}),o.jsx("span",{className:`tm-crew-item-role ${(Ce.role||"laborer").toLowerCase()}`,children:Ce.role||"Laborer"}),xe&&o.jsx("span",{className:"tm-crew-item-check",children:""})]},$e)})})]}),o.jsxs("div",{className:"tm-field",children:[o.jsx("label",{children:"Supervision"}),o.jsx("div",{className:"tm-workers-list",children:b.map((Ce,$e)=>o.jsxs("div",{className:"tm-worker-card-expanded",children:[o.jsxs("div",{className:"tm-worker-row-top",children:[o.jsx("div",{className:"tm-role-select",children:o.jsxs("select",{value:Ce.role,onChange:xe=>Le($e,"role",xe.target.value),children:[o.jsx("option",{value:"Foreman",children:"Foreman"}),o.jsx("option",{value:"Superintendent",children:"Superintendent"})]})}),o.jsx("input",{type:"text",placeholder:"First & Last Name",value:Ce.name,onChange:xe=>Le($e,"name",xe.target.value),className:"tm-worker-input"}),o.jsx("button",{className:"tm-remove",onClick:()=>ue($e),children:""})]}),o.jsxs("div",{className:"tm-worker-row-bottom",children:[o.jsxs("div",{className:"tm-time-group",children:[o.jsx("label",{children:"Start"}),o.jsx("input",{type:"time",value:Ce.timeStarted,onChange:xe=>Le($e,"timeStarted",xe.target.value)})]}),o.jsxs("div",{className:"tm-time-group",children:[o.jsx("label",{children:"End"}),o.jsx("input",{type:"time",value:Ce.timeEnded,onChange:xe=>Le($e,"timeEnded",xe.target.value)})]}),o.jsxs("div",{className:"tm-time-group",children:[o.jsx("label",{children:"Reg Hrs"}),o.jsx("input",{type:"number",placeholder:"0",value:Ce.hours,onChange:xe=>Le($e,"hours",xe.target.value)})]}),o.jsxs("div",{className:"tm-time-group",children:[o.jsx("label",{children:"OT Hrs"}),o.jsx("input",{type:"number",placeholder:"0",value:Ce.overtimeHours,onChange:xe=>Le($e,"overtimeHours",xe.target.value)})]})]})]},$e))}),o.jsx("button",{className:"tm-add-btn",onClick:_e,children:"+ Add Supervision"})]}),o.jsxs("div",{className:"tm-field",children:[o.jsx("label",{children:"Operators"}),o.jsx("div",{className:"tm-workers-list",children:w.map((Ce,$e)=>o.jsxs("div",{className:"tm-worker-card-expanded",children:[o.jsxs("div",{className:"tm-worker-row-top",children:[o.jsx("input",{type:"text",placeholder:"First & Last Name",value:Ce.name,onChange:xe=>Se($e,"name",xe.target.value),className:"tm-worker-input"}),o.jsx("button",{className:"tm-remove",onClick:()=>ve($e),children:""})]}),o.jsxs("div",{className:"tm-worker-row-bottom",children:[o.jsxs("div",{className:"tm-time-group",children:[o.jsx("label",{children:"Start"}),o.jsx("input",{type:"time",value:Ce.timeStarted,onChange:xe=>Se($e,"timeStarted",xe.target.value)})]}),o.jsxs("div",{className:"tm-time-group",children:[o.jsx("label",{children:"End"}),o.jsx("input",{type:"time",value:Ce.timeEnded,onChange:xe=>Se($e,"timeEnded",xe.target.value)})]}),o.jsxs("div",{className:"tm-time-group",children:[o.jsx("label",{children:"Reg Hrs"}),o.jsx("input",{type:"number",placeholder:"0",value:Ce.hours,onChange:xe=>Se($e,"hours",xe.target.value)})]}),o.jsxs("div",{className:"tm-time-group",children:[o.jsx("label",{children:"OT Hrs"}),o.jsx("input",{type:"number",placeholder:"0",value:Ce.overtimeHours,onChange:xe=>Se($e,"overtimeHours",xe.target.value)})]})]})]},$e))}),o.jsx("button",{className:"tm-add-btn",onClick:it,children:"+ Add Operator"})]}),o.jsxs("div",{className:"tm-field",children:[o.jsx("label",{children:"Laborers"}),o.jsx("div",{className:"tm-workers-list",children:C.map((Ce,$e)=>o.jsxs("div",{className:"tm-worker-card-expanded",children:[o.jsxs("div",{className:"tm-worker-row-top",children:[o.jsx("input",{type:"text",placeholder:"First & Last Name",value:Ce.name,onChange:xe=>ht($e,"name",xe.target.value),className:"tm-worker-input"}),o.jsx("button",{className:"tm-remove",onClick:()=>de($e),children:""})]}),o.jsxs("div",{className:"tm-worker-row-bottom",children:[o.jsxs("div",{className:"tm-time-group",children:[o.jsx("label",{children:"Start"}),o.jsx("input",{type:"time",value:Ce.timeStarted,onChange:xe=>ht($e,"timeStarted",xe.target.value)})]}),o.jsxs("div",{className:"tm-time-group",children:[o.jsx("label",{children:"End"}),o.jsx("input",{type:"time",value:Ce.timeEnded,onChange:xe=>ht($e,"timeEnded",xe.target.value)})]}),o.jsxs("div",{className:"tm-time-group",children:[o.jsx("label",{children:"Reg Hrs"}),o.jsx("input",{type:"number",placeholder:"0",value:Ce.hours,onChange:xe=>ht($e,"hours",xe.target.value)})]}),o.jsxs("div",{className:"tm-time-group",children:[o.jsx("label",{children:"OT Hrs"}),o.jsx("input",{type:"number",placeholder:"0",value:Ce.overtimeHours,onChange:xe=>ht($e,"overtimeHours",xe.target.value)})]})]})]},$e))}),o.jsx("button",{className:"tm-add-btn",onClick:at,children:"+ Add Laborer"})]}),o.jsxs("div",{className:"tm-field",children:[o.jsx("label",{children:"Description of Work"}),o.jsx("textarea",{placeholder:"What work was performed today?",value:W,onChange:Ce=>B(Ce.target.value),rows:3,className:"tm-description"})]}),o.jsxs("div",{className:"tm-field",children:[o.jsxs("label",{children:[o.jsx(Mp,{size:16,className:"inline-icon"})," Photos",r!==-1&&o.jsxs("span",{className:"tm-photo-count",children:["(",q.length,"/",r,")"]})]}),q.length>0&&o.jsx("div",{className:"tm-photo-grid",children:q.map(Ce=>o.jsxs("div",{className:"tm-photo-item",children:[o.jsx("img",{src:Ce.previewUrl,alt:Ce.name}),o.jsx("button",{className:"tm-photo-remove",onClick:()=>Lt(Ce.id),children:""})]},Ce.id))}),(r===-1||q.length<r)&&o.jsxs("label",{className:"tm-photo-btn",children:[o.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:jt,style:{display:"none"}}),o.jsx(Mp,{size:16,className:"inline-icon"})," ",q.length>0?"Add More Photos":"Add Photos"]}),r!==-1&&q.length>=r&&o.jsxs("div",{className:"tm-photo-limit-reached",children:["Photo limit reached (",r," max)"]})]})]}),l===2&&!K&&o.jsxs("div",{className:"tm-step-content",children:[o.jsxs("div",{className:"tm-field",children:[o.jsx("label",{children:"What was used?"}),o.jsx("div",{className:"tm-category-grid",children:cw.map(Ce=>{const $e=T.filter(xe=>xe.category===Ce);return o.jsxs("button",{className:"tm-category-card",onClick:()=>ae(Ce),children:[o.jsx("span",{className:"tm-cat-name",children:Ce}),$e.length>0&&o.jsx("span",{className:"tm-cat-count",children:$e.length})]},Ce)})})]}),T.length>0&&o.jsxs("div",{className:"tm-field",children:[o.jsxs("label",{children:["Added Items (",T.length,")"]}),o.jsx("div",{className:"tm-added-list",children:T.map((Ce,$e)=>o.jsxs("div",{className:"tm-added-item",children:[o.jsxs("div",{className:"tm-added-info",children:[Ce.isCustom&&o.jsx("span",{className:"tm-custom-badge",children:"Custom"}),o.jsx("span",{className:"tm-added-name",children:Ce.name})]}),o.jsxs("div",{className:"tm-added-qty",children:[o.jsx("button",{onClick:()=>Xe($e,Ce.quantity-1),children:""}),o.jsx("span",{children:Ce.quantity}),o.jsx("button",{onClick:()=>Xe($e,Ce.quantity+1),children:"+"})]})]},$e))})]})]}),l===3&&o.jsxs("div",{className:"tm-step-content",children:[o.jsx("div",{className:"tm-review-section",children:o.jsxs("div",{className:"tm-review-header",children:[o.jsx("span",{children:" Date"}),o.jsx("span",{children:new Date(f).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})})]})}),W&&o.jsxs("div",{className:"tm-review-section",children:[o.jsx("div",{className:"tm-review-header",children:o.jsxs("span",{children:[o.jsx(El,{size:16,className:"inline-icon"})," Description"]})}),o.jsx("div",{className:"tm-review-notes",children:W})]}),q.length>0&&o.jsxs("div",{className:"tm-review-section",children:[o.jsxs("div",{className:"tm-review-header",children:[o.jsxs("span",{children:[o.jsx(Mp,{size:16,className:"inline-icon"})," Photos"]}),o.jsx("span",{children:q.length})]}),o.jsx("div",{className:"tm-review-photos",children:q.map(Ce=>o.jsx("img",{src:Ce.previewUrl,alt:Ce.name},Ce.id))})]}),kt.length>0&&o.jsxs("div",{className:"tm-review-section",children:[o.jsxs("div",{className:"tm-review-header",children:[o.jsxs("span",{children:[o.jsx(KT,{size:16,className:"inline-icon"})," Supervision"]}),o.jsxs("span",{children:[kt.reduce((Ce,$e)=>Ce+parseFloat($e.hours||0)+parseFloat($e.overtimeHours||0),0)," hrs"]})]}),o.jsx("div",{className:"tm-review-list",children:kt.map((Ce,$e)=>o.jsxs("div",{className:"tm-review-row-detailed",children:[o.jsxs("div",{className:"tm-review-worker-name",children:[o.jsx("span",{className:"tm-role-badge",children:Ce.role})," ",Ce.name]}),o.jsxs("div",{className:"tm-review-worker-details",children:[Ce.timeStarted&&Ce.timeEnded&&o.jsxs("span",{className:"tm-review-time",children:[Ce.timeStarted," - ",Ce.timeEnded]}),o.jsxs("span",{className:"tm-review-hours",children:[Ce.hours||0," reg",parseFloat(Ce.overtimeHours)>0?` + ${Ce.overtimeHours} OT`:""]})]})]},$e))})]}),qe.length>0&&o.jsxs("div",{className:"tm-review-section",children:[o.jsxs("div",{className:"tm-review-header",children:[o.jsx("span",{children:" Operators"}),o.jsxs("span",{children:[qe.reduce((Ce,$e)=>Ce+parseFloat($e.hours||0)+parseFloat($e.overtimeHours||0),0)," hrs"]})]}),o.jsx("div",{className:"tm-review-list",children:qe.map((Ce,$e)=>o.jsxs("div",{className:"tm-review-row-detailed",children:[o.jsx("div",{className:"tm-review-worker-name",children:Ce.name}),o.jsxs("div",{className:"tm-review-worker-details",children:[Ce.timeStarted&&Ce.timeEnded&&o.jsxs("span",{className:"tm-review-time",children:[Ce.timeStarted," - ",Ce.timeEnded]}),o.jsxs("span",{className:"tm-review-hours",children:[Ce.hours||0," reg",parseFloat(Ce.overtimeHours)>0?` + ${Ce.overtimeHours} OT`:""]})]})]},$e))})]}),Ye.length>0&&o.jsxs("div",{className:"tm-review-section",children:[o.jsxs("div",{className:"tm-review-header",children:[o.jsxs("span",{children:[o.jsx(Ys,{size:16,className:"inline-icon"})," Laborers"]}),o.jsxs("span",{children:[Ye.reduce((Ce,$e)=>Ce+parseFloat($e.hours||0)+parseFloat($e.overtimeHours||0),0)," hrs"]})]}),o.jsx("div",{className:"tm-review-list",children:Ye.map((Ce,$e)=>o.jsxs("div",{className:"tm-review-row-detailed",children:[o.jsx("div",{className:"tm-review-worker-name",children:Ce.name}),o.jsxs("div",{className:"tm-review-worker-details",children:[Ce.timeStarted&&Ce.timeEnded&&o.jsxs("span",{className:"tm-review-time",children:[Ce.timeStarted," - ",Ce.timeEnded]}),o.jsxs("span",{className:"tm-review-hours",children:[Ce.hours||0," reg",parseFloat(Ce.overtimeHours)>0?` + ${Ce.overtimeHours} OT`:""]})]})]},$e))})]}),T.length>0&&o.jsxs("div",{className:"tm-review-section",children:[o.jsxs("div",{className:"tm-review-header",children:[o.jsxs("span",{children:[o.jsx(Q0,{size:16,className:"inline-icon"})," Materials & Equipment"]}),o.jsxs("span",{children:[T.length," items"]})]}),o.jsx("div",{className:"tm-review-list",children:T.map((Ce,$e)=>o.jsxs("div",{className:"tm-review-row",children:[o.jsxs("span",{children:[Ce.isCustom&&o.jsxs(o.Fragment,{children:[o.jsx(t8,{size:14,className:"inline-icon"})," "]}),Ce.name]}),o.jsxs("span",{children:[Ce.quantity," ",Ce.unit]})]},$e))})]}),o.jsxs("div",{className:"tm-review-section tm-certification",children:[o.jsx("div",{className:"tm-review-header",children:o.jsxs("span",{children:[o.jsx(o2,{size:16,className:"inline-icon"})," Submitted By"]})}),o.jsx("input",{type:"text",className:"tm-certification-input",placeholder:"Enter your name",value:x,onChange:Ce=>g(Ce.target.value)}),o.jsx("p",{className:"tm-certification-note",children:"By submitting, you certify this T&M is accurate."})]})]}),o.jsxs("div",{className:"tm-wizard-footer",children:[l<3?o.jsx("button",{className:"tm-big-btn primary",onClick:$t,disabled:l===1&&!Vt(),children:l===1?`Next: Materials (${Pt} workers, ${Et+Dt} hrs)`:l===2?`Review (${T.length} items)`:"Next"}):o.jsx("button",{className:"tm-big-btn submit",onClick:Ot,disabled:J,children:J?O||"Submitting...":" Submit T&M"}),l===2&&o.jsx("button",{className:"tm-skip-btn",onClick:$t,children:"Skip (no materials)"})]})]})}function s8({project:t,onShowToast:e}){const[r,a]=ee.useState([]),[n,s]=ee.useState(!0),[l,c]=ee.useState(!1),[f,d]=ee.useState(!1),[m,v]=ee.useState({name:"",role:"Laborer"});ee.useEffect(()=>{x()},[t.id]);const x=async()=>{try{const w=await ot.getCrewCheckin(t.id);w?.workers&&a(w.workers)}catch(w){console.error("Error loading crew:",w)}finally{s(!1)}},g=async()=>{if(!m.name.trim()){e("Enter worker name","error");return}if(r.find(w=>w.name.toLowerCase()===m.name.trim().toLowerCase())){e("Worker already added","error");return}c(!0);try{const w=[...r,{name:m.name.trim(),role:m.role}];await ot.saveCrewCheckin(t.id,w),a(w),v({name:"",role:"Laborer"}),d(!1),e("Crew member added","success")}catch(w){console.error("Error adding worker:",w),e("Error adding crew member","error")}finally{c(!1)}},b=async w=>{c(!0);try{const E=r.filter(C=>C.name.toLowerCase()!==w.toLowerCase());await ot.saveCrewCheckin(t.id,E),a(E),e("Crew member removed","success")}catch(E){console.error("Error removing worker:",E),e("Error removing crew member","error")}finally{c(!1)}},_=new Date().toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"});return n?o.jsxs("div",{className:"crew-checkin",children:[o.jsxs("div",{className:"crew-header",children:[o.jsxs("h3",{children:[o.jsx(Ys,{size:18,className:"inline-icon"})," Today's Crew"]}),o.jsx("span",{className:"crew-date",children:_})]}),o.jsx("div",{className:"crew-loading",children:"Loading..."})]}):o.jsxs("div",{className:"crew-checkin",children:[o.jsxs("div",{className:"crew-header",children:[o.jsxs("h3",{children:[o.jsx(Ys,{size:18,className:"inline-icon"})," Today's Crew"]}),o.jsx("span",{className:"crew-date",children:_})]}),r.length===0?o.jsxs("div",{className:"crew-empty",children:[o.jsx("p",{children:"No crew checked in yet"}),o.jsx("p",{className:"crew-empty-hint",children:"Add your crew for the day"})]}):o.jsx("div",{className:"crew-list",children:r.map(w=>o.jsxs("div",{className:"crew-member",children:[o.jsxs("div",{className:"crew-member-info",children:[o.jsx("span",{className:"crew-member-name",children:w.name}),o.jsx("span",{className:`crew-member-role ${w.role.toLowerCase()}`,children:w.role})]}),o.jsx("button",{className:"crew-remove-btn",onClick:()=>b(w.name),disabled:l,children:""})]},w.name))}),f?o.jsxs("div",{className:"crew-add-form",children:[o.jsx("input",{type:"text",value:m.name,onChange:w=>v({...m,name:w.target.value}),placeholder:"Name",autoFocus:!0}),o.jsxs("select",{value:m.role,onChange:w=>v({...m,role:w.target.value}),children:[o.jsx("option",{value:"Foreman",children:"Foreman"}),o.jsx("option",{value:"Laborer",children:"Laborer"}),o.jsx("option",{value:"Supervisor",children:"Supervisor"}),o.jsx("option",{value:"Operator",children:"Operator"})]}),o.jsxs("div",{className:"crew-add-buttons",children:[o.jsx("button",{className:"crew-add-confirm",onClick:g,disabled:l,children:l?"...":"Add"}),o.jsx("button",{className:"crew-add-cancel",onClick:()=>{d(!1),v({name:"",role:"Laborer"})},children:"Cancel"})]})]}):o.jsx("button",{className:"crew-add-btn",onClick:()=>d(!0),children:"+ Add Crew Member"}),o.jsxs("div",{className:"crew-count",children:[r.length," ",r.length===1?"person":"people"," on site"]})]})}function i8({project:t,onShowToast:e,onClose:r}){const[a,n]=ee.useState(!0),[s,l]=ee.useState(!1),[c,f]=ee.useState(null),[d,m]=ee.useState(""),[v,x]=ee.useState("");ee.useEffect(()=>{g()},[t.id]);const g=async()=>{try{const E=await ot.getDailyReport(t.id);if(E)f(E),m(E.field_notes||""),x(E.issues||"");else{const C=await ot.compileDailyReport(t.id);f({...C,status:"draft"})}}catch(E){console.error("Error loading report:",E),e("Error loading report","error")}finally{n(!1)}},b=async()=>{if(!Ue){e("Demo Mode: Report saved locally only - won't reach office","info"),r();return}l(!0);try{await ot.saveDailyReport(t.id,{field_notes:d,issues:v}),await ot.submitDailyReport(t.id,"Field")?(e("Daily report submitted!","success"),r()):e("Report not sent - check connection","error")}catch(E){console.error("Error submitting report:",E),e("Error submitting report","error")}finally{l(!1)}},_=new Date().toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"});if(a)return o.jsxs("div",{className:"daily-report",children:[o.jsxs("div",{className:"daily-report-header",children:[o.jsx("button",{className:"back-btn-simple",onClick:r,children:""}),o.jsx("h2",{children:"Daily Report"})]}),o.jsx("div",{className:"daily-report-loading",children:"Compiling report..."})]});const w=c?.status==="submitted";return o.jsxs("div",{className:"daily-report",children:[o.jsxs("div",{className:"daily-report-header",children:[o.jsx("button",{className:"back-btn-simple",onClick:r,children:""}),o.jsxs("div",{children:[o.jsx("h2",{children:"Daily Report"}),o.jsx("p",{className:"daily-report-date",children:_})]})]}),w&&o.jsxs("div",{className:"daily-report-submitted-banner",children:[" Submitted ",new Date(c.submitted_at).toLocaleTimeString()]}),o.jsxs("div",{className:"daily-report-content",children:[o.jsxs("div",{className:"daily-report-summary",children:[o.jsxs("div",{className:"daily-report-card",children:[o.jsx("div",{className:"daily-report-card-value",children:c.crew_count||0}),o.jsx("div",{className:"daily-report-card-label",children:"Crew on Site"})]}),o.jsxs("div",{className:"daily-report-card",children:[o.jsx("div",{className:"daily-report-card-value",children:c.tasks_completed||0}),o.jsx("div",{className:"daily-report-card-label",children:"Tasks Done"})]}),o.jsxs("div",{className:"daily-report-card",children:[o.jsx("div",{className:"daily-report-card-value",children:c.tm_tickets_count||0}),o.jsx("div",{className:"daily-report-card-label",children:"T&M Tickets"})]}),o.jsxs("div",{className:"daily-report-card",children:[o.jsx("div",{className:"daily-report-card-value",children:c.photos_count||0}),o.jsx("div",{className:"daily-report-card-label",children:"Photos"})]})]}),c.crew_list?.length>0&&o.jsxs("div",{className:"daily-report-section",children:[o.jsxs("h3",{children:[o.jsx(Ys,{size:18,className:"inline-icon"})," Crew"]}),o.jsx("div",{className:"daily-report-crew",children:c.crew_list.map((E,C)=>o.jsxs("div",{className:"daily-report-crew-item",children:[o.jsx("span",{children:E.name}),o.jsx("span",{className:"daily-report-crew-role",children:E.role})]},C))})]}),c.completed_tasks?.length>0&&o.jsxs("div",{className:"daily-report-section",children:[o.jsxs("h3",{children:[o.jsx(pf,{size:18,className:"inline-icon"})," Completed Today"]}),o.jsx("ul",{className:"daily-report-tasks",children:c.completed_tasks.map((E,C)=>o.jsxs("li",{children:[E.name,E.group&&o.jsx("span",{className:"daily-report-task-group",children:E.group})]},C))})]}),o.jsxs("div",{className:"daily-report-section",children:[o.jsxs("h3",{children:[o.jsx(El,{size:18,className:"inline-icon"})," Notes"]}),o.jsx("textarea",{value:d,onChange:E=>m(E.target.value),placeholder:"Any notes about today's work...",rows:3,disabled:w})]}),o.jsxs("div",{className:"daily-report-section",children:[o.jsxs("h3",{children:[o.jsx(x1,{size:18,className:"inline-icon"})," Issues / Concerns"]}),o.jsx("textarea",{value:v,onChange:E=>x(E.target.value),placeholder:"Any problems, delays, or concerns...",rows:3,disabled:w})]})]}),!w&&o.jsxs("div",{className:"daily-report-footer",children:[o.jsx("button",{className:"btn btn-primary daily-report-submit",onClick:b,disabled:s,children:s?"Submitting...":o.jsxs(o.Fragment,{children:[o.jsx(YT,{size:16,className:"inline-icon"})," Submit Report"]})}),o.jsx("p",{className:"daily-report-hint",children:"This will be sent to the office"})]})]})}function o8({project:t,viewerType:e,viewerName:r,onShowToast:a,onClose:n}){const[s,l]=ee.useState([]),[c,f]=ee.useState(!0),[d,m]=ee.useState(!1),[v,x]=ee.useState(""),g=ee.useRef(null);ee.useEffect(()=>{b(),ot.markMessagesRead(t.id,e)},[t.id]),ee.useEffect(()=>{g.current?.scrollIntoView({behavior:"smooth"})},[s]);const b=async()=>{try{const C=await ot.getMessages(t.id);l(C.reverse())}catch(C){console.error("Error loading messages:",C)}finally{f(!1)}},_=async()=>{if(v.trim()){if(!Ue){a("Demo Mode: Messages won't sync to other users","info");const C={id:Date.now(),project_id:t.id,message:v.trim(),sender_type:e,sender_name:r,created_at:new Date().toISOString()};l([...s,C]),x("");return}m(!0);try{const C=await ot.sendMessage(t.id,v.trim(),e,r);C?(l([...s,C]),x("")):a("Message not sent - check connection","error")}catch(C){console.error("Error sending message:",C),a("Error sending message","error")}finally{m(!1)}}},w=C=>{C.key==="Enter"&&!C.shiftKey&&(C.preventDefault(),_())},E=C=>{const A=new Date(C),T=new Date;return A.toDateString()===T.toDateString()?A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}):A.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})};return o.jsxs("div",{className:"messages-container",children:[o.jsxs("div",{className:"messages-header",children:[o.jsx("button",{className:"back-btn-simple",onClick:n,children:""}),o.jsxs("div",{children:[o.jsx("h2",{children:"Messages"}),o.jsx("p",{className:"messages-project",children:t.name})]})]}),o.jsxs("div",{className:"messages-list",children:[c?o.jsx("div",{className:"messages-loading",children:"Loading..."}):s.length===0?o.jsxs("div",{className:"messages-empty",children:[o.jsx("p",{children:"No messages yet"}),o.jsx("p",{className:"messages-empty-hint",children:e==="field"?"Messages from the office will appear here":"Send a message to the field crew"})]}):s.map(C=>o.jsx("div",{className:`message ${C.sender_type===e?"sent":"received"}`,children:o.jsxs("div",{className:"message-bubble",children:[o.jsxs("div",{className:"message-sender",children:[C.sender_type==="office"?o.jsx(O0,{size:14,className:"inline-icon"}):o.jsx(Ys,{size:14,className:"inline-icon"})," ",C.sender_name]}),o.jsx("div",{className:"message-text",children:C.message}),C.photo_url&&o.jsx("img",{src:C.photo_url,alt:"Attached",className:"message-photo"}),o.jsx("div",{className:"message-time",children:E(C.created_at)})]})},C.id)),o.jsx("div",{ref:g})]}),o.jsxs("div",{className:"messages-input-container",children:[o.jsx("textarea",{value:v,onChange:C=>x(C.target.value),onKeyDown:w,placeholder:"Type a message...",rows:1,disabled:d}),o.jsx("button",{className:"messages-send-btn",onClick:_,disabled:d||!v.trim(),children:d?"...":""})]})]})}function l8({project:t,requestedBy:e,onShowToast:r,onClose:a}){const[n,s]=ee.useState([{name:"",quantity:"",unit:"each"}]),[l,c]=ee.useState(""),[f,d]=ee.useState("normal"),[m,v]=ee.useState(""),[x,g]=ee.useState(!1),b=()=>{s([...n,{name:"",quantity:"",unit:"each"}])},_=(C,A,T)=>{s(n.map((G,W)=>W===C?{...G,[A]:T}:G))},w=C=>{n.length>1&&s(n.filter((A,T)=>T!==C))},E=async()=>{const C=n.filter(A=>A.name.trim()&&parseFloat(A.quantity)>0);if(C.length===0){r("Add at least one item with quantity","error");return}if(!Ue){r("Demo Mode: Request saved locally only - won't reach office","info"),a();return}g(!0);try{await ot.createMaterialRequest(t.id,C,e,l||null,f,m||null)?(r("Request submitted!","success"),a()):r("Request not sent - check connection","error")}catch(A){console.error("Error submitting request:",A),r("Error submitting request","error")}finally{g(!1)}};return o.jsxs("div",{className:"material-request",children:[o.jsxs("div",{className:"material-request-header",children:[o.jsx("button",{className:"back-btn-simple",onClick:a,children:""}),o.jsx("h2",{children:"Request Materials"})]}),o.jsxs("div",{className:"material-request-content",children:[o.jsxs("div",{className:"material-request-section",children:[o.jsx("label",{children:"What do you need?"}),n.map((C,A)=>o.jsxs("div",{className:"material-request-item",children:[o.jsx("input",{type:"text",placeholder:"Item name",value:C.name,onChange:T=>_(A,"name",T.target.value),className:"material-request-name"}),o.jsx("input",{type:"number",placeholder:"Qty",value:C.quantity,onChange:T=>_(A,"quantity",T.target.value),className:"material-request-qty"}),o.jsxs("select",{value:C.unit,onChange:T=>_(A,"unit",T.target.value),className:"material-request-unit",children:[o.jsx("option",{value:"each",children:"each"}),o.jsx("option",{value:"rolls",children:"rolls"}),o.jsx("option",{value:"boxes",children:"boxes"}),o.jsx("option",{value:"bags",children:"bags"}),o.jsx("option",{value:"sheets",children:"sheets"}),o.jsx("option",{value:"gallons",children:"gal"}),o.jsx("option",{value:"feet",children:"ft"}),o.jsx("option",{value:"lbs",children:"lbs"})]}),o.jsx("button",{className:"material-request-remove",onClick:()=>w(A),children:""})]},A)),o.jsx("button",{className:"material-request-add",onClick:b,children:"+ Add Another Item"})]}),o.jsxs("div",{className:"material-request-section",children:[o.jsx("label",{children:"Priority"}),o.jsx("div",{className:"material-request-priority",children:["low","normal","urgent"].map(C=>o.jsxs("button",{className:`priority-btn ${f===C?"active":""} ${C}`,onClick:()=>d(C),children:[C==="urgent"&&" ",C==="normal"&&" ",C==="low"&&" ",C.charAt(0).toUpperCase()+C.slice(1)]},C))})]}),o.jsxs("div",{className:"material-request-section",children:[o.jsx("label",{children:"Needed By (optional)"}),o.jsx("input",{type:"date",value:l,onChange:C=>c(C.target.value),min:new Date().toISOString().split("T")[0]})]}),o.jsxs("div",{className:"material-request-section",children:[o.jsx("label",{children:"Notes (optional)"}),o.jsx("textarea",{value:m,onChange:C=>v(C.target.value),placeholder:"Any additional details...",rows:2})]})]}),o.jsx("div",{className:"material-request-footer",children:o.jsx("button",{className:"btn btn-primary",onClick:E,disabled:x,children:x?"Submitting...":o.jsxs(o.Fragment,{children:[o.jsx(yc,{size:16,className:"inline-icon"})," Submit Request"]})})})]})}const c8=ee.createContext({}),oN=()=>ee.useContext(c8);function du({message:t,type:e="",onClose:r}){return ee.useEffect(()=>{const a=setTimeout(r,3e3);return()=>clearTimeout(a)},[r]),o.jsx("div",{className:"toast-container",children:o.jsx("div",{className:`toast ${e}`,children:t})})}function lN({project:t,companyId:e,onClose:r,onReportCreated:a}){const{user:n}=oN(),[s,l]=ee.useState(!1),[c,f]=ee.useState(null),[d,m]=ee.useState(1),[v,x]=ee.useState(new Date().toISOString().split("T")[0]),[g,b]=ee.useState(new Date().toTimeString().split(" ")[0].substring(0,5)),[_,w]=ee.useState(""),[E,C]=ee.useState(""),[A,T]=ee.useState("minor"),[G,W]=ee.useState(""),[B,q]=ee.useState(""),[L,J]=ee.useState(""),[D,O]=ee.useState(""),[M,V]=ee.useState(""),[ie,X]=ee.useState(""),[Z,K]=ee.useState(""),[ae,fe]=ee.useState(n?.name||""),[U,j]=ee.useState(""),[F,I]=ee.useState(""),[z,ne]=ee.useState(n?.email||""),[se,pe]=ee.useState([]),[ye,_e]=ee.useState(""),[Le,ue]=ee.useState(""),[at,ht]=ee.useState(""),[de,it]=ee.useState(""),[Se,ve]=ee.useState(!1),[Ie,wt]=ee.useState(""),[Xe,ct]=ee.useState(""),[jt,Lt]=ee.useState(!1),[Vt,$t]=ee.useState(""),[Wt,Ot]=ee.useState(""),[kt,qe]=ee.useState(""),[Ye,Pt]=ee.useState(""),[Et,Dt]=ee.useState(!1),[Ce,$e]=ee.useState(!1),[xe,Be]=ee.useState(0),[Pe,Ct]=ee.useState(0),gt=()=>{if(!ye.trim()){f({type:"error",message:"Please enter witness name"});return}const Nt={name:ye,phone:Le,email:at,testimony:de};pe([...se,Nt]),_e(""),ue(""),ht(""),it(""),f({type:"success",message:"Witness added"})},Rt=Nt=>{pe(se.filter((Ea,rr)=>rr!==Nt))},It=Nt=>{switch(Nt){case 1:if(!_.trim()||!E.trim())return f({type:"error",message:"Please fill in all incident details"}),!1;break;case 2:if(!B.trim()||!ie.trim())return f({type:"error",message:"Please fill in employee name and job title"}),!1;break;case 3:if(!ae.trim()||!U.trim())return f({type:"error",message:"Please fill in supervisor name and title"}),!1;break}return!0},pr=()=>{It(d)&&m(d+1)},sa=()=>{m(d-1)},fa=async()=>{if(It(d)){if(!Ue){f({type:"info",message:"Demo Mode: Report saved locally only - won't reach office"}),setTimeout(()=>{r()},1500);return}l(!0);try{const Nt={project_id:t.id,company_id:e,incident_date:v,incident_time:g,incident_location:_,incident_description:E,injury_type:A,body_part_affected:G||null,employee_name:B,employee_phone:L||null,employee_email:D||null,employee_address:M||null,employee_job_title:ie,employee_hire_date:Z||null,medical_treatment_required:Se,medical_facility_name:Ie||null,medical_facility_address:Xe||null,hospitalized:jt,reported_by_name:ae,reported_by_title:U,reported_by_phone:F||null,reported_by_email:z||null,witnesses:se,immediate_actions_taken:Vt||null,corrective_actions_planned:Wt||null,safety_equipment_used:kt||null,safety_equipment_failed:Ye||null,osha_recordable:Et,workers_comp_claim:Ce,days_away_from_work:parseInt(xe)||0,restricted_work_days:parseInt(Pe)||0,status:"reported",created_by:n?.id},Ea=await ot.createInjuryReport(Nt);f({type:"success",message:"Injury report submitted successfully"}),a&&a(Ea),setTimeout(()=>{r()},1500)}catch(Nt){console.error("Error submitting injury report:",Nt),f({type:"error",message:"Failed to submit injury report"})}finally{l(!1)}}};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"modal-overlay",onClick:r,children:o.jsxs("div",{className:"modal-content injury-report-modal",onClick:Nt=>Nt.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:"Workplace Injury/Incident Report"}),o.jsx("button",{className:"close-btn",onClick:r,children:""})]}),o.jsxs("div",{className:"progress-steps",children:[o.jsx("div",{className:`step ${d>=1?"active":""}`,children:"1. Incident"}),o.jsx("div",{className:`step ${d>=2?"active":""}`,children:"2. Employee"}),o.jsx("div",{className:`step ${d>=3?"active":""}`,children:"3. Supervisor"}),o.jsx("div",{className:`step ${d>=4?"active":""}`,children:"4. Witnesses"}),o.jsx("div",{className:`step ${d>=5?"active":""}`,children:"5. Medical & Safety"})]}),o.jsxs("div",{className:"modal-body",children:[d===1&&o.jsxs("div",{className:"form-step",children:[o.jsx("h3",{children:"Incident Details"}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Date of Incident *"}),o.jsx("input",{type:"date",value:v,onChange:Nt=>x(Nt.target.value),max:new Date().toISOString().split("T")[0]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Time of Incident *"}),o.jsx("input",{type:"time",value:g,onChange:Nt=>b(Nt.target.value)})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Location on Site *"}),o.jsx("input",{type:"text",value:_,onChange:Nt=>w(Nt.target.value),placeholder:"e.g., Floor 2, near elevator shaft"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Incident Description *"}),o.jsx("textarea",{value:E,onChange:Nt=>C(Nt.target.value),rows:4,placeholder:"Describe what happened in detail..."})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Injury Type *"}),o.jsxs("select",{value:A,onChange:Nt=>T(Nt.target.value),children:[o.jsx("option",{value:"minor",children:"Minor Injury"}),o.jsx("option",{value:"serious",children:"Serious Injury"}),o.jsx("option",{value:"critical",children:"Critical Injury"}),o.jsx("option",{value:"near_miss",children:"Near Miss (No Injury)"})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Body Part Affected"}),o.jsx("input",{type:"text",value:G,onChange:Nt=>W(Nt.target.value),placeholder:"e.g., Left hand, lower back"})]})]})]}),d===2&&o.jsxs("div",{className:"form-step",children:[o.jsx("h3",{children:"Injured Employee Information"}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Full Name *"}),o.jsx("input",{type:"text",value:B,onChange:Nt=>q(Nt.target.value),placeholder:"First and last name"})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Phone Number"}),o.jsx("input",{type:"tel",value:L,onChange:Nt=>J(Nt.target.value),placeholder:"(555) 123-4567"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Email Address"}),o.jsx("input",{type:"email",value:D,onChange:Nt=>O(Nt.target.value),placeholder:"email@example.com"})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Home Address"}),o.jsx("input",{type:"text",value:M,onChange:Nt=>V(Nt.target.value),placeholder:"Street address, city, state, zip"})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Job Title *"}),o.jsx("input",{type:"text",value:ie,onChange:Nt=>X(Nt.target.value),placeholder:"e.g., Carpenter, Electrician"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Hire Date"}),o.jsx("input",{type:"date",value:Z,onChange:Nt=>K(Nt.target.value)})]})]})]}),d===3&&o.jsxs("div",{className:"form-step",children:[o.jsx("h3",{children:"Foreman/Supervisor Making Report"}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Your Name *"}),o.jsx("input",{type:"text",value:ae,onChange:Nt=>fe(Nt.target.value),placeholder:"Full name"})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Your Title *"}),o.jsx("input",{type:"text",value:U,onChange:Nt=>j(Nt.target.value),placeholder:"e.g., Site Foreman, Project Manager"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Your Phone Number"}),o.jsx("input",{type:"tel",value:F,onChange:Nt=>I(Nt.target.value),placeholder:"(555) 123-4567"})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Your Email Address"}),o.jsx("input",{type:"email",value:z,onChange:Nt=>ne(Nt.target.value),placeholder:"email@example.com"})]})]}),d===4&&o.jsxs("div",{className:"form-step",children:[o.jsx("h3",{children:"Witness Testimonies (Optional)"}),se.length>0&&o.jsx("div",{className:"witnesses-list",children:se.map((Nt,Ea)=>o.jsxs("div",{className:"witness-item",children:[o.jsxs("div",{className:"witness-info",children:[o.jsx("strong",{children:Nt.name}),Nt.phone&&o.jsxs("span",{children:["  ",Nt.phone]}),Nt.testimony&&o.jsxs("p",{className:"witness-testimony",children:['"',Nt.testimony,'"']})]}),o.jsx("button",{className:"btn-danger btn-small",onClick:()=>Rt(Ea),children:"Remove"})]},Ea))}),o.jsxs("div",{className:"add-witness-form",children:[o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Witness Name"}),o.jsx("input",{type:"text",value:ye,onChange:Nt=>_e(Nt.target.value),placeholder:"Full name"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Phone Number"}),o.jsx("input",{type:"tel",value:Le,onChange:Nt=>ue(Nt.target.value),placeholder:"(555) 123-4567"})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Email Address"}),o.jsx("input",{type:"email",value:at,onChange:Nt=>ht(Nt.target.value),placeholder:"email@example.com"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Witness Testimony"}),o.jsx("textarea",{value:de,onChange:Nt=>it(Nt.target.value),rows:3,placeholder:"What did the witness see or hear?"})]}),o.jsx("button",{className:"btn-secondary",onClick:gt,children:"+ Add Witness"})]})]}),d===5&&o.jsxs("div",{className:"form-step",children:[o.jsx("h3",{children:"Medical Treatment & Safety"}),o.jsx("div",{className:"form-group checkbox-group",children:o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:Se,onChange:Nt=>ve(Nt.target.checked)}),"Medical treatment required"]})}),Se&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Medical Facility Name"}),o.jsx("input",{type:"text",value:Ie,onChange:Nt=>wt(Nt.target.value),placeholder:"Hospital or clinic name"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Medical Facility Address"}),o.jsx("input",{type:"text",value:Xe,onChange:Nt=>ct(Nt.target.value),placeholder:"Street address"})]}),o.jsx("div",{className:"form-group checkbox-group",children:o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:jt,onChange:Nt=>Lt(Nt.target.checked)}),"Employee was hospitalized"]})})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Immediate Actions Taken"}),o.jsx("textarea",{value:Vt,onChange:Nt=>$t(Nt.target.value),rows:2,placeholder:"What was done immediately after the incident?"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Corrective Actions Planned"}),o.jsx("textarea",{value:Wt,onChange:Nt=>Ot(Nt.target.value),rows:2,placeholder:"What will be done to prevent this in the future?"})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Safety Equipment Used"}),o.jsx("input",{type:"text",value:kt,onChange:Nt=>qe(Nt.target.value),placeholder:"e.g., Hard hat, gloves, harness"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Safety Equipment Failed"}),o.jsx("input",{type:"text",value:Ye,onChange:Nt=>Pt(Nt.target.value),placeholder:"Equipment that failed, if any"})]})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Days Away From Work"}),o.jsx("input",{type:"number",min:"0",value:xe,onChange:Nt=>Be(Nt.target.value)})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Restricted Work Days"}),o.jsx("input",{type:"number",min:"0",value:Pe,onChange:Nt=>Ct(Nt.target.value)})]})]}),o.jsx("div",{className:"form-group checkbox-group",children:o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:Et,onChange:Nt=>Dt(Nt.target.checked)}),"OSHA Recordable Incident"]})}),o.jsx("div",{className:"form-group checkbox-group",children:o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:Ce,onChange:Nt=>$e(Nt.target.checked)}),"Workers' Compensation Claim Filed"]})})]})]}),o.jsx("div",{className:"modal-footer",children:o.jsxs("div",{className:"form-actions",children:[d>1&&o.jsx("button",{className:"btn-secondary",onClick:sa,children:" Back"}),o.jsx("button",{className:"btn-secondary",onClick:r,children:"Cancel"}),d<5?o.jsx("button",{className:"btn-primary",onClick:pr,children:"Next "}):o.jsx("button",{className:"btn-primary",onClick:fa,disabled:s,children:s?"Submitting...":"Submit Report"})]})})]})}),c&&o.jsx(du,{message:c.message,type:c.type,onClose:()=>f(null)}),o.jsx("style",{children:`
        .injury-report-modal {
          max-width: 800px;
          max-height: 90vh;
          overflow-y: auto;
        }

        .progress-steps {
          display: flex;
          justify-content: space-between;
          padding: 1rem 1.5rem;
          border-bottom: 1px solid #e5e7eb;
          background-color: #f9fafb;
          overflow-x: auto;
        }

        .progress-steps .step {
          font-size: 0.875rem;
          color: #9ca3af;
          font-weight: 500;
          white-space: nowrap;
          padding: 0.5rem;
        }

        .progress-steps .step.active {
          color: var(--primary-color, #3b82f6);
          font-weight: 600;
        }

        .form-step h3 {
          margin-top: 0;
          margin-bottom: 1.5rem;
          color: #111827;
          font-size: 1.25rem;
        }

        .form-row {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 1rem;
        }

        .form-group {
          margin-bottom: 1rem;
        }

        .form-group label {
          display: block;
          margin-bottom: 0.5rem;
          font-weight: 500;
          color: #374151;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
          width: 100%;
          padding: 0.5rem;
          border: 1px solid #d1d5db;
          border-radius: 4px;
          font-size: 1rem;
        }

        .form-group textarea {
          resize: vertical;
        }

        .checkbox-group label {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-weight: normal;
          cursor: pointer;
        }

        .checkbox-group input[type="checkbox"] {
          width: auto;
          margin: 0;
        }

        .witnesses-list {
          margin-bottom: 1.5rem;
        }

        .witness-item {
          border: 1px solid #e5e7eb;
          border-radius: 6px;
          padding: 1rem;
          margin-bottom: 0.5rem;
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
        }

        .witness-info {
          flex: 1;
        }

        .witness-testimony {
          margin-top: 0.5rem;
          color: #6b7280;
          font-style: italic;
          font-size: 0.875rem;
        }

        .add-witness-form {
          border: 2px dashed #d1d5db;
          border-radius: 6px;
          padding: 1rem;
          background-color: #f9fafb;
        }

        .modal-footer {
          border-top: 1px solid #e5e7eb;
          padding: 1rem 1.5rem;
        }

        .form-actions {
          display: flex;
          justify-content: space-between;
          gap: 0.5rem;
        }

        .btn-primary,
        .btn-secondary,
        .btn-danger {
          padding: 0.5rem 1rem;
          border-radius: 6px;
          font-weight: 500;
          cursor: pointer;
          border: none;
        }

        .btn-primary {
          background-color: var(--primary-color, #3b82f6);
          color: white;
        }

        .btn-primary:hover:not(:disabled) {
          opacity: 0.9;
        }

        .btn-primary:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .btn-secondary {
          background-color: #f3f4f6;
          color: #374151;
        }

        .btn-secondary:hover {
          background-color: #e5e7eb;
        }

        .btn-danger {
          background-color: #ef4444;
          color: white;
        }

        .btn-danger:hover {
          background-color: #dc2626;
        }

        .btn-small {
          padding: 0.25rem 0.75rem;
          font-size: 0.875rem;
        }

        @media (max-width: 768px) {
          .injury-report-modal {
            max-width: 100%;
            height: 100vh;
            max-height: 100vh;
            border-radius: 0;
          }

          .form-row {
            grid-template-columns: 1fr;
          }

          .progress-steps .step {
            font-size: 0.75rem;
            padding: 0.25rem;
          }
        }
      `})]})}const uw=[{id:"trash",label:"Trash",description:"General debris"},{id:"metal",label:"Metal",description:"Scrap metal (recyclable)"},{id:"copper",label:"Copper",description:"Copper scrap (recyclable)"},{id:"concrete",label:"Concrete",description:"Concrete/masonry"},{id:"hazardous",label:"Hazardous",description:"Hazardous materials"}];function u8({project:t,companyId:e,onClose:r,onSubmit:a,onShowToast:n}){const[s,l]=ee.useState(!1),[c,f]=ee.useState([]),[d,m]=ee.useState(!0),[v,x]=ee.useState(new Date().toISOString().split("T")[0]),[g,b]=ee.useState("trash"),[_,w]=ee.useState(1),[E,C]=ee.useState(""),[A,T]=ee.useState(t.default_dump_site_id||""),[G,W]=ee.useState(""),[B,q]=ee.useState(null),[L,J]=ee.useState(null);ee.useEffect(()=>{D()},[e]),ee.useEffect(()=>{O()},[A,g,_,c]);const D=async()=>{try{const Z=await ot.getDumpSites(e);f(Z||[]),t.default_dump_site_id?T(t.default_dump_site_id):Z&&Z.length>0&&T(Z[0].id)}catch(Z){console.error("Error loading dump sites:",Z)}finally{m(!1)}},O=()=>{if(!A||!g||!_){q(null),J(null);return}const Z=c.find(ae=>ae.id===A);if(!Z||!Z.dump_site_rates){q(null),J(null);return}const K=Z.dump_site_rates.find(ae=>ae.waste_type===g);if(K&&K.estimated_cost_per_load!==null){const ae=parseFloat(K.estimated_cost_per_load);J(ae),q(ae*parseInt(_))}else q(null),J(null)},M=Z=>Z==null?"--":Z<0?`-$${Math.abs(Z).toFixed(0)}`:`$${Z.toFixed(0)}`,V=async Z=>{if(Z.preventDefault(),!A){n("Please select a dump site","error");return}if(!_||_<1){n("Please enter number of loads","error");return}l(!0);try{await ot.createHaulOff(t.id,{dump_site_id:A,waste_type:g,loads:parseInt(_),hauling_company:E.trim()||null,work_date:v,notes:G.trim()||null,estimated_cost:B,created_by:"Field"}),n("Haul-off logged successfully","success"),a&&a(),r()}catch(K){console.error("Error logging haul-off:",K),n("Error logging haul-off","error")}finally{l(!1)}},ie=c.find(Z=>Z.id===A),X=uw.find(Z=>Z.id===g);return o.jsxs("div",{className:"hauloff-form-container",children:[o.jsxs("div",{className:"hauloff-header",children:[o.jsx("button",{className:"back-btn-simple",onClick:r,children:""}),o.jsx("h2",{children:"Log Haul-Off"})]}),o.jsxs("form",{onSubmit:V,className:"hauloff-form",children:[o.jsxs("div",{className:"hauloff-field",children:[o.jsx("label",{children:"Date"}),o.jsx("input",{type:"date",value:v,onChange:Z=>x(Z.target.value),max:new Date().toISOString().split("T")[0]})]}),o.jsxs("div",{className:"hauloff-field",children:[o.jsx("label",{children:"Waste Type"}),o.jsx("div",{className:"waste-type-grid",children:uw.map(Z=>o.jsxs("button",{type:"button",className:`waste-type-btn ${g===Z.id?"active":""} ${Z.id==="metal"||Z.id==="copper"?"recyclable":""}`,onClick:()=>b(Z.id),children:[o.jsx("span",{className:"waste-label",children:Z.label}),(Z.id==="metal"||Z.id==="copper")&&o.jsx("span",{className:"waste-badge",children:"$"})]},Z.id))})]}),o.jsxs("div",{className:"hauloff-field",children:[o.jsx("label",{children:"Number of Loads"}),o.jsxs("div",{className:"loads-input-row",children:[o.jsx("button",{type:"button",className:"loads-btn",onClick:()=>w(Math.max(1,_-1)),children:""}),o.jsx("input",{type:"number",value:_,onChange:Z=>w(Math.max(1,parseInt(Z.target.value)||1)),min:"1",className:"loads-input"}),o.jsx("button",{type:"button",className:"loads-btn",onClick:()=>w(_+1),children:"+"})]})]}),o.jsxs("div",{className:"hauloff-field",children:[o.jsx("label",{children:"Dump Site"}),d?o.jsx("div",{className:"loading-inline",children:"Loading sites..."}):c.length===0?o.jsx("div",{className:"no-sites-warning",children:"No dump sites configured. Ask office to add dump sites."}):o.jsxs("select",{value:A,onChange:Z=>T(Z.target.value),children:[o.jsx("option",{value:"",children:"-- Select Dump Site --"}),c.map(Z=>o.jsx("option",{value:Z.id,children:Z.name},Z.id))]}),ie?.address&&o.jsx("span",{className:"field-hint",children:ie.address})]}),o.jsxs("div",{className:"hauloff-field",children:[o.jsx("label",{children:"Hauling Company (Optional)"}),o.jsx("input",{type:"text",value:E,onChange:Z=>C(Z.target.value),placeholder:"e.g., ABC Trucking"})]}),o.jsxs("div",{className:"hauloff-field",children:[o.jsx("label",{children:"Notes (Optional)"}),o.jsx("textarea",{value:G,onChange:Z=>W(Z.target.value),placeholder:"Any additional notes...",rows:2})]}),o.jsxs("div",{className:"hauloff-estimate",children:[o.jsx("div",{className:"estimate-header",children:"Estimated Cost"}),B!==null?o.jsxs("div",{className:`estimate-value ${B<0?"revenue":""}`,children:[o.jsx("span",{className:"estimate-amount",children:M(B)}),o.jsxs("span",{className:"estimate-breakdown",children:[M(L),"/load  ",_," load",_>1?"s":""]}),B<0&&o.jsx("span",{className:"estimate-note revenue-note",children:"Revenue from recyclables"})]}):o.jsxs("div",{className:"estimate-value",children:[o.jsx("span",{className:"estimate-amount",children:"--"}),o.jsx("span",{className:"estimate-breakdown",children:A?ie?.dump_site_rates?.find(Z=>Z.waste_type===g)?"Unable to calculate":`No rate set for ${X?.label||g}`:"Select a dump site"})]}),o.jsx("div",{className:"estimate-disclaimer",children:"This is an estimate for burn rate tracking, not an invoice amount."})]}),o.jsxs("div",{className:"hauloff-actions",children:[o.jsx("button",{type:"button",className:"btn btn-secondary",onClick:r,disabled:s,children:"Cancel"}),o.jsx("button",{type:"submit",className:"btn btn-primary",disabled:s||!A,children:s?"Saving...":"Log Haul-Off"})]})]})]})}function f8({project:t,companyId:e,onShowToast:r,onExit:a}){const[n,s]=ee.useState([]),[l,c]=ee.useState(!0),[f,d]=ee.useState(null),[m,v]=ee.useState({}),[x,g]=ee.useState(!1),[b,_]=ee.useState(!0),[w,E]=ee.useState(!1),[C,A]=ee.useState(!1),[T,G]=ee.useState(!1),[W,B]=ee.useState(!1),[q,L]=ee.useState(!1),[J,D]=ee.useState(!1),[O,M]=ee.useState(0);ee.useEffect(()=>{V(),ie()},[t.id]);const V=async()=>{try{const z=await ot.getAreas(t.id);s(z);const ne=[...new Set(z.map(pe=>pe.group_name||"General"))],se={};ne.forEach(pe=>se[pe]=!1),v(se)}catch(z){console.error("Error loading areas:",z),r("Error loading areas","error")}finally{c(!1)}},ie=async()=>{const z=await ot.getUnreadCount(t.id,"field");M(z)},X=async(z,ne)=>{const se=n.find(ye=>ye.id===z);if(!se)return;const pe=se.status===ne?"not_started":ne;d(z);try{await ot.updateAreaStatus(z,pe),s(ye=>ye.map(_e=>_e.id===z?{..._e,status:pe}:_e)),r("Updated","success")}catch(ye){console.error("Error updating status:",ye),r("Error updating","error")}finally{d(null)}},Z=z=>{v(ne=>({...ne,[z]:!ne[z]}))};if(l)return o.jsx("div",{className:"foreman-container",children:o.jsxs("div",{className:"loading",children:[o.jsx("div",{className:"spinner"}),"Loading..."]})});if(x)return o.jsx("div",{className:"foreman-container",children:o.jsx(n8,{project:t,companyId:e,onSubmit:()=>g(!1),onCancel:()=>g(!1),onShowToast:r})});if(w)return o.jsx(i8,{project:t,onShowToast:r,onClose:()=>E(!1)});if(C)return o.jsx(o8,{project:t,viewerType:"field",viewerName:"Field",onShowToast:r,onClose:()=>{A(!1),ie()}});if(T)return o.jsx(l8,{project:t,requestedBy:"Field",onShowToast:r,onClose:()=>G(!1)});if(W)return o.jsx("div",{className:"foreman-container",children:o.jsx(lN,{project:t,companyId:e,onClose:()=>B(!1),onReportCreated:()=>{B(!1),r("Injury report submitted","success")}})});if(q)return o.jsx("div",{className:"foreman-container",children:o.jsx(u8,{project:t,companyId:e,onClose:()=>L(!1),onSubmit:()=>L(!1),onShowToast:r})});const K=_x(n),ae=n.reduce((z,ne)=>{const se=ne.group_name||"General";return z[se]||(z[se]=[]),z[se].push(ne),z},{}),fe=Object.keys(ae).length>1||Object.keys(ae).length===1&&!ae.General,U=z=>`${z.filter(se=>se.status==="done").length}/${z.length}`,j=n.filter(z=>z.status==="done").length,F=n.filter(z=>z.status==="working").length,I=n.length-j;return o.jsxs("div",{className:"foreman-container",children:[o.jsxs("div",{className:"foreman-header",children:[o.jsx("button",{className:"back-btn-simple",onClick:a,children:""}),o.jsxs("div",{className:"foreman-header-info",children:[o.jsx("div",{className:"foreman-project-name",children:t.name}),o.jsxs("div",{className:"foreman-progress",children:[K,"% Complete"]})]}),o.jsx("button",{className:"foreman-info-btn",onClick:()=>D(!J),children:o.jsx(Q4,{size:20})})]}),J&&o.jsxs("div",{className:"foreman-project-info",children:[t.job_number&&o.jsxs("div",{className:"foreman-info-row",children:[o.jsx("span",{className:"foreman-info-label",children:"Job #"}),o.jsx("span",{className:"foreman-info-value",children:t.job_number})]}),t.address&&o.jsxs("div",{className:"foreman-info-row",children:[o.jsx("span",{className:"foreman-info-label",children:"Address"}),o.jsx("span",{className:"foreman-info-value",children:t.address})]}),t.general_contractor&&o.jsxs("div",{className:"foreman-info-row",children:[o.jsx("span",{className:"foreman-info-label",children:"GC / Client"}),o.jsx("span",{className:"foreman-info-value",children:t.general_contractor})]}),t.client_contact&&o.jsxs("div",{className:"foreman-info-row",children:[o.jsx("span",{className:"foreman-info-label",children:"Contact"}),o.jsx("span",{className:"foreman-info-value",children:t.client_contact})]}),t.client_phone&&o.jsxs("div",{className:"foreman-info-row",children:[o.jsx("span",{className:"foreman-info-label",children:"Phone"}),o.jsx("a",{href:`tel:${t.client_phone}`,className:"foreman-info-value foreman-info-link",children:t.client_phone})]})]}),o.jsxs("div",{className:"foreman-stats",children:[o.jsxs("div",{className:"foreman-stat",children:[o.jsx("div",{className:"foreman-stat-value working",children:F}),o.jsx("div",{className:"foreman-stat-label",children:"Working"})]}),o.jsxs("div",{className:"foreman-stat",children:[o.jsx("div",{className:"foreman-stat-value done",children:j}),o.jsx("div",{className:"foreman-stat-label",children:"Done"})]}),o.jsxs("div",{className:"foreman-stat",children:[o.jsx("div",{className:"foreman-stat-value remaining",children:I}),o.jsx("div",{className:"foreman-stat-label",children:"Remaining"})]})]}),o.jsxs("div",{className:"field-actions",children:[o.jsxs("button",{className:"field-action-btn",onClick:()=>g(!0),children:[o.jsx(El,{size:20,className:"icon"}),"T&M Ticket"]}),o.jsxs("button",{className:"field-action-btn",onClick:()=>A(!0),children:[o.jsx(Z0,{size:20,className:"icon"}),"Messages",O>0&&o.jsx("span",{className:"badge",children:O})]}),o.jsxs("button",{className:"field-action-btn",onClick:()=>G(!0),children:[o.jsx(yc,{size:20,className:"icon"}),"Materials"]}),o.jsxs("button",{className:"field-action-btn",onClick:()=>E(!0),children:[o.jsx(gu,{size:20,className:"icon"}),"Daily Report"]}),o.jsxs("button",{className:"field-action-btn",onClick:()=>L(!0),children:[o.jsx(ph,{size:20,className:"icon"}),"Haul-Off"]}),o.jsxs("button",{className:"field-action-btn danger",onClick:()=>B(!0),children:[o.jsx(x1,{size:20,className:"icon"}),"Report Injury"]})]}),o.jsx(s8,{project:t,onShowToast:r}),o.jsx("div",{className:"foreman-areas",children:fe?Object.entries(ae).map(([z,ne])=>o.jsxs("div",{className:"foreman-group",children:[o.jsxs("div",{className:"foreman-group-header",onClick:()=>Z(z),children:[o.jsxs("div",{className:"foreman-group-title",children:[o.jsx("span",{className:"foreman-group-arrow",children:m[z]?"":""}),o.jsx("span",{className:"foreman-group-name",children:z})]}),o.jsx("span",{className:"foreman-group-progress",children:U(ne)})]}),m[z]&&o.jsx("div",{className:"foreman-group-tasks",children:ne.map(se=>o.jsxs("div",{className:`foreman-area-card ${se.status}`,children:[o.jsx("div",{className:"foreman-area-name",children:se.name}),o.jsxs("div",{className:"foreman-area-buttons",children:[o.jsx("button",{className:`foreman-btn working ${se.status==="working"?"active":""}`,onClick:()=>X(se.id,"working"),disabled:f===se.id,children:f===se.id?"...":"Working"}),o.jsx("button",{className:`foreman-btn done ${se.status==="done"?"active":""}`,onClick:()=>X(se.id,"done"),disabled:f===se.id,children:f===se.id?"...":"Done"})]})]},se.id))})]},z)):n.map(z=>o.jsxs("div",{className:`foreman-area-card ${z.status}`,children:[o.jsx("div",{className:"foreman-area-name",children:z.name}),o.jsxs("div",{className:"foreman-area-buttons",children:[o.jsx("button",{className:`foreman-btn working ${z.status==="working"?"active":""}`,onClick:()=>X(z.id,"working"),disabled:f===z.id,children:f===z.id?"...":"Working"}),o.jsx("button",{className:`foreman-btn done ${z.status==="done"?"active":""}`,onClick:()=>X(z.id,"done"),disabled:f===z.id,children:f===z.id?"...":"Done"})]})]},z.id))}),n.length===0&&o.jsxs("div",{className:"foreman-empty",children:[o.jsx(gu,{size:48,className:"foreman-empty-icon"}),o.jsx("div",{className:"foreman-empty-text",children:"No areas yet"}),o.jsx("div",{className:"foreman-empty-subtext",children:"Office needs to add areas to this project"})]})]})}const fw=t=>t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never";function cN({documentType:t,documentId:e,companyId:r,projectId:a,documentTitle:n="",onClose:s,onShowToast:l}){const[c,f]=ee.useState(!0),[d,m]=ee.useState(!1),[v,x]=ee.useState([]),[g,b]=ee.useState(null),[_,w]=ee.useState(!1),[E,C]=ee.useState("never");ee.useEffect(()=>{A()},[t,e]);const A=async()=>{try{f(!0);const L=await ot.getSignatureRequestsForDocument(t,e);x(L||[])}catch(L){console.error("Error loading signature requests:",L)}finally{f(!1)}},T=async()=>{try{m(!0);let L=null;if(E!=="never"){const D=parseInt(E);L=new Date,L.setDate(L.getDate()+D),L=L.toISOString()}const J=await ot.createSignatureRequest(t,e,r,a,null,L);if(J){const D=`${window.location.origin}/sign/${J.signature_token}`;b(D),await A(),l?.("Signature link created","success")}}catch(L){console.error("Error generating signature link:",L),l?.("Failed to create signature link","error")}finally{m(!1)}},G=async L=>{try{await navigator.clipboard.writeText(L),w(!0),l?.("Link copied to clipboard","success"),setTimeout(()=>w(!1),2e3)}catch(J){console.error("Error copying to clipboard:",J)}},W=async L=>{if(confirm("Are you sure you want to revoke this signature link? It will no longer be usable."))try{await ot.revokeSignatureRequest(L),await A(),l?.("Signature link revoked","success")}catch(J){console.error("Error revoking signature request:",J),l?.("Failed to revoke link","error")}},B=L=>{switch(L){case"pending":return{label:"Awaiting Signatures",color:"#f59e0b",bg:"#fef3c7"};case"partially_signed":return{label:"1 of 2 Signed",color:"#3b82f6",bg:"#dbeafe"};case"completed":return{label:"Fully Signed",color:"#10b981",bg:"#d1fae5"};case"revoked":return{label:"Revoked",color:"#ef4444",bg:"#fee2e2"};case"expired":return{label:"Expired",color:"#6b7280",bg:"#f3f4f6"};default:return{label:L,color:"#6b7280",bg:"#f3f4f6"}}},q=t==="cor"?"Change Order":"T&M Ticket";return o.jsx("div",{className:"modal-overlay",onClick:s,role:"dialog","aria-modal":"true",children:o.jsxs("div",{className:"modal-content signature-link-modal",onClick:L=>L.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsxs("div",{children:[o.jsx("h2",{children:"Get Signature Link"}),n&&o.jsx("span",{className:"modal-subtitle",children:n})]}),o.jsx("button",{className:"close-btn",onClick:s,"aria-label":"Close",children:o.jsx(Rf,{size:20})})]}),o.jsxs("div",{className:"modal-body",children:[o.jsxs("div",{className:"signature-link-section",children:[o.jsxs("h3",{children:[o.jsx(i2,{size:16}),"Create New Signature Link"]}),o.jsxs("p",{className:"section-description",children:["Generate a secure link that allows GC/Client to sign this ",q," without logging in."]}),o.jsxs("div",{className:"link-options",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Link Expiration"}),o.jsxs("select",{value:E,onChange:L=>C(L.target.value),disabled:d,children:[o.jsx("option",{value:"never",children:"Never expires"}),o.jsx("option",{value:"7",children:"7 days"}),o.jsx("option",{value:"30",children:"30 days"}),o.jsx("option",{value:"90",children:"90 days"})]})]}),o.jsx("button",{className:"btn btn-primary",onClick:T,disabled:d,children:d?"Generating...":"Generate Link"})]}),g&&o.jsxs("div",{className:"new-link-box",children:[o.jsxs("div",{className:"link-display",children:[o.jsx("input",{type:"text",value:g,readOnly:!0,className:"link-input"}),o.jsxs("button",{className:"btn btn-secondary copy-btn",onClick:()=>G(g),children:[_?o.jsx(R0,{size:16}):o.jsx(iw,{size:16}),_?"Copied!":"Copy"]})]}),o.jsxs("a",{href:g,target:"_blank",rel:"noopener noreferrer",className:"preview-link",children:[o.jsx(ow,{size:14}),"Preview link"]})]})]}),o.jsxs("div",{className:"signature-link-section",children:[o.jsxs("h3",{children:[o.jsx(Xp,{size:16}),"Existing Signature Links"]}),c?o.jsx("div",{className:"loading-inline",children:"Loading..."}):v.length===0?o.jsxs("p",{className:"empty-state",children:["No signature links have been created for this ",q,"."]}):o.jsx("div",{className:"existing-links-list",children:v.map(L=>{const J=B(L.status),D=`${window.location.origin}/sign/${L.signature_token}`,O=L.signatures?.length||0;return o.jsxs("div",{className:"existing-link-card",children:[o.jsxs("div",{className:"link-card-header",children:[o.jsx("span",{className:"status-badge",style:{color:J.color,backgroundColor:J.bg},children:J.label}),o.jsxs("span",{className:"link-created",children:["Created ",fw(L.created_at)]})]}),o.jsxs("div",{className:"link-card-body",children:[o.jsxs("div",{className:"link-info",children:[o.jsxs("span",{className:"link-token",children:["...",L.signature_token.slice(-8)]}),L.expires_at&&o.jsxs("span",{className:"link-expires",children:["Expires ",fw(L.expires_at)]}),o.jsxs("span",{className:"link-views",children:[L.view_count," view",L.view_count!==1?"s":""]})]}),O>0&&o.jsx("div",{className:"signatures-summary",children:L.signatures.map(M=>o.jsxs("div",{className:"sig-item",children:[o.jsx(R0,{size:12}),o.jsxs("span",{children:["Slot ",M.signature_slot,": ",M.signer_name,M.signer_company&&` (${M.signer_company})`]})]},M.id))})]}),o.jsxs("div",{className:"link-card-actions",children:[L.status!=="revoked"&&L.status!=="expired"&&o.jsxs(o.Fragment,{children:[o.jsxs("button",{className:"btn btn-ghost btn-small",onClick:()=>G(D),children:[o.jsx(iw,{size:14})," Copy"]}),o.jsxs("a",{href:D,target:"_blank",rel:"noopener noreferrer",className:"btn btn-ghost btn-small",children:[o.jsx(ow,{size:14})," Open"]})]}),L.status!=="completed"&&L.status!=="revoked"&&o.jsxs("button",{className:"btn btn-ghost btn-small btn-danger",onClick:()=>W(L.id),children:[o.jsx(lc,{size:14})," Revoke"]})]})]},L.id)})})]}),o.jsxs("div",{className:"signature-info-box",children:[o.jsx(mh,{size:16}),o.jsxs("div",{children:[o.jsx("strong",{children:"How it works:"}),o.jsxs("ul",{children:[o.jsx("li",{children:"Share the link with your GC or Client"}),o.jsx("li",{children:"They can view the document and sign without logging in"}),o.jsx("li",{children:"Supports 2 signatures (GC + Client)"}),o.jsx("li",{children:"Signatures are recorded with name, title, company, date, and IP"})]})]})]})]}),o.jsx("div",{className:"modal-footer",children:o.jsx("button",{className:"btn btn-secondary",onClick:s,children:"Close"})})]})})}var Kp={};Kp.version="0.18.5";var uN=1252,d8=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],l2={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},c2=function(t){d8.indexOf(t)!=-1&&(uN=l2[0]=t)};function h8(){c2(1252)}var Go=function(t){c2(t)};function u2(){Go(1200),h8()}function dw(t){for(var e=[],r=0,a=t.length;r<a;++r)e[r]=t.charCodeAt(r);return e}function m8(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function fN(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var u0=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?m8(t.slice(2)):e==254&&r==255?fN(t.slice(2)):e==65279?t.slice(1):t},hp=function(e){return String.fromCharCode(e)},hw=function(e){return String.fromCharCode(e)},F0,hu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function L0(t){for(var e="",r=0,a=0,n=0,s=0,l=0,c=0,f=0,d=0;d<t.length;)r=t.charCodeAt(d++),s=r>>2,a=t.charCodeAt(d++),l=(r&3)<<4|a>>4,n=t.charCodeAt(d++),c=(a&15)<<2|n>>6,f=n&63,isNaN(a)?c=f=64:isNaN(n)&&(f=64),e+=hu.charAt(s)+hu.charAt(l)+hu.charAt(c)+hu.charAt(f);return e}function qi(t){var e="",r=0,a=0,n=0,s=0,l=0,c=0,f=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)s=hu.indexOf(t.charAt(d++)),l=hu.indexOf(t.charAt(d++)),r=s<<2|l>>4,e+=String.fromCharCode(r),c=hu.indexOf(t.charAt(d++)),a=(l&15)<<4|c>>2,c!==64&&(e+=String.fromCharCode(a)),f=hu.indexOf(t.charAt(d++)),n=(c&3)<<6|f,f!==64&&(e+=String.fromCharCode(n));return e}var Pr=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),_c=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function vu(t){return Pr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function mw(t){return Pr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Mi=function(e){return Pr?_c(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function _1(t){if(typeof ArrayBuffer>"u")return Mi(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),a=0;a!=t.length;++a)r[a]=t.charCodeAt(a)&255;return e}function Su(t){if(Array.isArray(t))return t.map(function(a){return String.fromCharCode(a)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function p8(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function f2(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return f2(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var is=Pr?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:_c(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var a=new Uint8Array(r),n=0;for(e=0,r=0;e<t.length;r+=n,++e)if(n=t[e].length,t[e]instanceof Uint8Array)a.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";a.set(new Uint8Array(t[e]),r)}return a}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function g8(t){for(var e=[],r=0,a=t.length+250,n=vu(t.length+255),s=0;s<t.length;++s){var l=t.charCodeAt(s);if(l<128)n[r++]=l;else if(l<2048)n[r++]=192|l>>6&31,n[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=t.charCodeAt(++s)&1023;n[r++]=240|l>>8&7,n[r++]=128|l>>2&63,n[r++]=128|c>>6&15|(l&3)<<4,n[r++]=128|c&63}else n[r++]=224|l>>12&15,n[r++]=128|l>>6&63,n[r++]=128|l&63;r>a&&(e.push(n.slice(0,r)),r=0,n=vu(65535),a=65530)}return e.push(n.slice(0,r)),is(e)}var Gs=/\u0000/g,f0=/[\u0001-\u0006]/g;function Zd(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Yo(t,e){var r=""+t;return r.length>=e?r:mn("0",e-r.length)+r}function d2(t,e){var r=""+t;return r.length>=e?r:mn(" ",e-r.length)+r}function Jp(t,e){var r=""+t;return r.length>=e?r:r+mn(" ",e-r.length)}function v8(t,e){var r=""+Math.round(t);return r.length>=e?r:mn("0",e-r.length)+r}function x8(t,e){var r=""+t;return r.length>=e?r:mn("0",e-r.length)+r}var pw=Math.pow(2,32);function Md(t,e){if(t>pw||t<-pw)return v8(t,e);var r=Math.round(t);return x8(r,e)}function Zp(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var gw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],lv=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function y8(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var br={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},vw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},_8={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Qp(t,e,r){for(var a=t<0?-1:1,n=t*a,s=0,l=1,c=0,f=1,d=0,m=0,v=Math.floor(n);d<e&&(v=Math.floor(n),c=v*l+s,m=v*d+f,!(n-v<5e-8));)n=1/(n-v),s=l,l=c,f=d,d=m;if(m>e&&(d>e?(m=f,c=s):(m=d,c=l)),!r)return[0,a*c,m];var x=Math.floor(a*c/m);return[x,a*c-x*m,m]}function gf(t,e,r){if(t>2958465||t<0)return null;var a=t|0,n=Math.floor(86400*(t-a)),s=0,l=[],c={D:a,T:n,u:86400*(t-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(a+=1462),c.u>.9999&&(c.u=0,++n==86400&&(c.T=n=0,++a,++c.D)),a===60)l=r?[1317,10,29]:[1900,2,29],s=3;else if(a===0)l=r?[1317,8,29]:[1900,1,0],s=6;else{a>60&&--a;var f=new Date(1900,0,1);f.setDate(f.getDate()+a-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],s=f.getDay(),a<60&&(s=(s+6)%7),r&&(s=k8(f,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=n%60,n=Math.floor(n/60),c.M=n%60,n=Math.floor(n/60),c.H=n,c.q=s,c}var dN=new Date(1899,11,31,0,0,0),b8=dN.getTime(),w8=new Date(1900,2,1,0,0,0);function hN(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=w8&&(r+=1440*60*1e3),(r-(b8+(t.getTimezoneOffset()-dN.getTimezoneOffset())*6e4))/(1440*60*1e3)}function h2(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function S8(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function N8(t){var e=t<0?12:11,r=h2(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function j8(t){var e=h2(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function P0(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=N8(t):e===10?r=t.toFixed(10).substr(0,12):r=j8(t),h2(S8(r.toUpperCase()))}function wf(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):P0(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return fo(14,hN(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function k8(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function E8(t,e,r,a){var n="",s=0,l=0,c=r.y,f,d=0;switch(t){case 98:c=r.y+543;case 121:switch(e.length){case 1:case 2:f=c%100,d=2;break;default:f=c%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:f=r.m,d=e.length;break;case 3:return lv[r.m-1][1];case 5:return lv[r.m-1][0];default:return lv[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:f=r.d,d=e.length;break;case 3:return gw[r.q][0];default:return gw[r.q][1]}break;case 104:switch(e.length){case 1:case 2:f=1+(r.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:f=r.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:f=r.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Yo(r.S,e.length):(a>=2?l=a===3?1e3:100:l=a===1?10:1,s=Math.round(l*(r.S+r.u)),s>=60*l&&(s=0),e==="s"?s===0?"0":""+s/l:(n=Yo(s,2+a),e==="ss"?n.substr(0,2):"."+n.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":f=r.D*24+r.H;break;case"[m]":case"[mm]":f=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:f=c,d=1;break}var m=d>0?Yo(f,d):"";return m}function mu(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,a=t.substr(0,r);r!=t.length;r+=e)a+=(a.length>0?",":"")+t.substr(r,e);return a}var mN=/%/g;function A8(t,e,r){var a=e.replace(mN,""),n=e.length-a.length;return dc(t,a,r*Math.pow(10,2*n))+mn("%",n)}function C8(t,e,r){for(var a=e.length-1;e.charCodeAt(a-1)===44;)--a;return dc(t,e.substr(0,a),r/Math.pow(10,3*(e.length-a)))}function pN(t,e){var r,a=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+pN(t,-e);var n=t.indexOf(".");n===-1&&(n=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(e/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),r.indexOf("e")===-1){var l=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,d,m){return f+d+m.substr(0,(n+s)%n)+"."+m.substr(s)+"E"})}else r=e.toExponential(a);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var gN=/# (\?+)( ?)\/( ?)(\d+)/;function T8(t,e,r){var a=parseInt(t[4],10),n=Math.round(e*a),s=Math.floor(n/a),l=n-s*a,c=a;return r+(s===0?"":""+s)+" "+(l===0?mn(" ",t[1].length+1+t[4].length):d2(l,t[1].length)+t[2]+"/"+t[3]+Yo(c,t[4].length))}function O8(t,e,r){return r+(e===0?"":""+e)+mn(" ",t[1].length+2+t[4].length)}var vN=/^#*0*\.([0#]+)/,xN=/\).*[0#]/,yN=/\(###\) ###\\?-####/;function Ws(t){for(var e="",r,a=0;a!=t.length;++a)switch(r=t.charCodeAt(a)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function xw(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function yw(t,e){var r=t-Math.floor(t),a=Math.pow(10,e);return e<(""+Math.round(r*a)).length?0:Math.round(r*a)}function R8(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function D8(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function so(t,e,r){if(t.charCodeAt(0)===40&&!e.match(xN)){var a=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?so("n",a,r):"("+so("n",a,-r)+")"}if(e.charCodeAt(e.length-1)===44)return C8(t,e,r);if(e.indexOf("%")!==-1)return A8(t,e,r);if(e.indexOf("E")!==-1)return pN(e,r);if(e.charCodeAt(0)===36)return"$"+so(t,e.substr(e.charAt(1)==" "?2:1),r);var n,s,l,c,f=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+Md(f,e.length);if(e.match(/^[#?]+$/))return n=Md(r,0),n==="0"&&(n=""),n.length>e.length?n:Ws(e.substr(0,e.length-n.length))+n;if(s=e.match(gN))return T8(s,f,d);if(e.match(/^#+0+$/))return d+Md(f,e.length-e.indexOf("0"));if(s=e.match(vN))return n=xw(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Ws(s[1])).replace(/\.$/,"."+Ws(s[1])).replace(/\.(\d*)$/,function(b,_){return"."+_+mn("0",Ws(s[1]).length-_.length)}),e.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return d+xw(f,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return d+mu(Md(f,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+so(t,e,-r):mu(""+(Math.floor(r)+R8(r,s[1].length)))+"."+Yo(yw(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return so(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Zd(so(t,e.replace(/[\\-]/g,""),r)),l=0,Zd(Zd(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return l<n.length?n.charAt(l++):b==="0"?"0":""}));if(e.match(yN))return n=so(t,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var m="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),c=Qp(f,Math.pow(10,l)-1,!1),n=""+d,m=dc("n",s[1],c[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),n+=m+s[2]+"/"+s[3],m=Jp(c[2],l),m.length<s[4].length&&(m=Ws(s[4].substr(s[4].length-m.length))+m),n+=m,n;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),c=Qp(f,Math.pow(10,l)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?d2(c[1],l)+s[2]+"/"+s[3]+Jp(c[2],l):mn(" ",2*l+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return n=Md(r,0),e.length<=n.length?n:Ws(e.substr(0,e.length-n.length))+n;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var v=e.indexOf(".")-l,x=e.length-n.length-v;return Ws(e.substr(0,v)+n+e.substr(e.length-x))}if(s=e.match(/^00,000\.([#0]*0)$/))return l=yw(r,s[1].length),r<0?"-"+so(t,e,-r):mu(D8(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Yo(0,3-b.length):"")+b})+"."+Yo(l,s[1].length);switch(e){case"###,##0.00":return so(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=mu(Md(f,0));return g!=="0"?d+g:"";case"###,###.00":return so(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return so(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function F8(t,e,r){for(var a=e.length-1;e.charCodeAt(a-1)===44;)--a;return dc(t,e.substr(0,a),r/Math.pow(10,3*(e.length-a)))}function L8(t,e,r){var a=e.replace(mN,""),n=e.length-a.length;return dc(t,a,r*Math.pow(10,2*n))+mn("%",n)}function _N(t,e){var r,a=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+_N(t,-e);var n=t.indexOf(".");n===-1&&(n=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(e/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),!r.match(/[Ee]/)){var l=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,d,m){return f+d+m.substr(0,(n+s)%n)+"."+m.substr(s)+"E"})}else r=e.toExponential(a);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function bl(t,e,r){if(t.charCodeAt(0)===40&&!e.match(xN)){var a=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?bl("n",a,r):"("+bl("n",a,-r)+")"}if(e.charCodeAt(e.length-1)===44)return F8(t,e,r);if(e.indexOf("%")!==-1)return L8(t,e,r);if(e.indexOf("E")!==-1)return _N(e,r);if(e.charCodeAt(0)===36)return"$"+bl(t,e.substr(e.charAt(1)==" "?2:1),r);var n,s,l,c,f=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+Yo(f,e.length);if(e.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>e.length?n:Ws(e.substr(0,e.length-n.length))+n;if(s=e.match(gN))return O8(s,f,d);if(e.match(/^#+0+$/))return d+Yo(f,e.length-e.indexOf("0"));if(s=e.match(vN))return n=(""+r).replace(/^([^\.]+)$/,"$1."+Ws(s[1])).replace(/\.$/,"."+Ws(s[1])),n=n.replace(/\.(\d*)$/,function(b,_){return"."+_+mn("0",Ws(s[1]).length-_.length)}),e.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return d+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return d+mu(""+f);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+bl(t,e,-r):mu(""+r)+"."+mn("0",s[1].length);if(s=e.match(/^#,#*,#0/))return bl(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Zd(bl(t,e.replace(/[\\-]/g,""),r)),l=0,Zd(Zd(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return l<n.length?n.charAt(l++):b==="0"?"0":""}));if(e.match(yN))return n=bl(t,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var m="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),c=Qp(f,Math.pow(10,l)-1,!1),n=""+d,m=dc("n",s[1],c[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),n+=m+s[2]+"/"+s[3],m=Jp(c[2],l),m.length<s[4].length&&(m=Ws(s[4].substr(s[4].length-m.length))+m),n+=m,n;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),c=Qp(f,Math.pow(10,l)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?d2(c[1],l)+s[2]+"/"+s[3]+Jp(c[2],l):mn(" ",2*l+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return n=""+r,e.length<=n.length?n:Ws(e.substr(0,e.length-n.length))+n;if(s=e.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var v=e.indexOf(".")-l,x=e.length-n.length-v;return Ws(e.substr(0,v)+n+e.substr(e.length-x))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+bl(t,e,-r):mu(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Yo(0,3-b.length):"")+b})+"."+Yo(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var g=mu(""+f);return g!=="0"?d+g:"";default:if(e.match(/\.[0#?]*$/))return bl(t,e.slice(0,e.lastIndexOf(".")),r)+Ws(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function dc(t,e,r){return(r|0)===r?bl(t,e,r):so(t,e,r)}function P8(t){for(var e=[],r=!1,a=0,n=0;a<t.length;++a)switch(t.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:e[e.length]=t.substr(n,a-n),n=a+1}if(e[e.length]=t.substr(n),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var bN=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function gh(t){for(var e=0,r="",a="";e<t.length;)switch(r=t.charAt(e)){case"G":Zp(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(a=r;t.charAt(e++)!=="]"&&e<t.length;)a+=t.charAt(e);if(a.match(bN))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function M8(t,e,r,a){for(var n=[],s="",l=0,c="",f="t",d,m,v,x="H";l<t.length;)switch(c=t.charAt(l)){case"G":if(!Zp(t,l))throw new Error("unrecognized character "+c+" in "+t);n[n.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(v=t.charCodeAt(++l))!==34&&l<t.length;)s+=String.fromCharCode(v);n[n.length]={t:"t",v:s},++l;break;case"\\":var g=t.charAt(++l),b=g==="("||g===")"?g:"t";n[n.length]={t:b,v:g},++l;break;case"_":n[n.length]={t:"t",v:" "},l+=2;break;case"@":n[n.length]={t:"T",v:e},++l;break;case"B":case"b":if(t.charAt(l+1)==="1"||t.charAt(l+1)==="2"){if(d==null&&(d=gf(e,r,t.charAt(l+1)==="2"),d==null))return"";n[n.length]={t:"X",v:t.substr(l,2)},f=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=gf(e,r),d==null))return"";for(s=c;++l<t.length&&t.charAt(l).toLowerCase()===c;)s+=c;c==="m"&&f.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=x),n[n.length]={t:c,v:s},f=c;break;case"A":case"a":case"":var _={t:c,v:c};if(d==null&&(d=gf(e,r)),t.substr(l,3).toUpperCase()==="A/P"?(d!=null&&(_.v=d.H>=12?"P":"A"),_.t="T",x="h",l+=3):t.substr(l,5).toUpperCase()==="AM/PM"?(d!=null&&(_.v=d.H>=12?"PM":"AM"),_.t="T",l+=5,x="h"):t.substr(l,5).toUpperCase()==="/"?(d!=null&&(_.v=d.H>=12?"":""),_.t="T",l+=5,x="h"):(_.t="t",++l),d==null&&_.t==="T")return"";n[n.length]=_,f=c;break;case"[":for(s=c;t.charAt(l++)!=="]"&&l<t.length;)s+=t.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(bN)){if(d==null&&(d=gf(e,r),d==null))return"";n[n.length]={t:"Z",v:s.toLowerCase()},f=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",gh(t)||(n[n.length]={t:"t",v:s}));break;case".":if(d!=null){for(s=c;++l<t.length&&(c=t.charAt(l))==="0";)s+=c;n[n.length]={t:"s",v:s};break}case"0":case"#":for(s=c;++l<t.length&&"0#?.,E+-%".indexOf(c=t.charAt(l))>-1;)s+=c;n[n.length]={t:"n",v:s};break;case"?":for(s=c;t.charAt(++l)===c;)s+=c;n[n.length]={t:c,v:s},f=c;break;case"*":++l,(t.charAt(l)==" "||t.charAt(l)=="*")&&++l;break;case"(":case")":n[n.length]={t:a===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=c;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)s+=t.charAt(l);n[n.length]={t:"D",v:s};break;case" ":n[n.length]={t:c,v:c},++l;break;case"$":n[n.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+t);n[n.length]={t:"t",v:c},++l;break}var w=0,E=0,C;for(l=n.length-1,f="t";l>=0;--l)switch(n[l].t){case"h":case"H":n[l].t=x,f="h",w<1&&(w=1);break;case"s":(C=n[l].v.match(/\.0+$/))&&(E=Math.max(E,C[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":f=n[l].t;break;case"m":f==="s"&&(n[l].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&n[l].v.match(/[Hh]/)&&(w=1),w<2&&n[l].v.match(/[Mm]/)&&(w=2),w<3&&n[l].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var A="",T;for(l=0;l<n.length;++l)switch(n[l].t){case"t":case"T":case" ":case"D":break;case"X":n[l].v="",n[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[l].v=E8(n[l].t.charCodeAt(0),n[l].v,d,E),n[l].t="t";break;case"n":case"?":for(T=l+1;n[T]!=null&&((c=n[T].t)==="?"||c==="D"||(c===" "||c==="t")&&n[T+1]!=null&&(n[T+1].t==="?"||n[T+1].t==="t"&&n[T+1].v==="/")||n[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(n[T].v==="/"||n[T].v===" "&&n[T+1]!=null&&n[T+1].t=="?"));)n[l].v+=n[T].v,n[T]={v:"",t:";"},++T;A+=n[l].v,l=T-1;break;case"G":n[l].t="t",n[l].v=wf(e,r);break}var G="",W,B;if(A.length>0){A.charCodeAt(0)==40?(W=e<0&&A.charCodeAt(0)===45?-e:e,B=dc("n",A,W)):(W=e<0&&a>1?-e:e,B=dc("n",A,W),W<0&&n[0]&&n[0].t=="t"&&(B=B.substr(1),n[0].v="-"+n[0].v)),T=B.length-1;var q=n.length;for(l=0;l<n.length;++l)if(n[l]!=null&&n[l].t!="t"&&n[l].v.indexOf(".")>-1){q=l;break}var L=n.length;if(q===n.length&&B.indexOf("E")===-1){for(l=n.length-1;l>=0;--l)n[l]==null||"n?".indexOf(n[l].t)===-1||(T>=n[l].v.length-1?(T-=n[l].v.length,n[l].v=B.substr(T+1,n[l].v.length)):T<0?n[l].v="":(n[l].v=B.substr(0,T+1),T=-1),n[l].t="t",L=l);T>=0&&L<n.length&&(n[L].v=B.substr(0,T+1)+n[L].v)}else if(q!==n.length&&B.indexOf("E")===-1){for(T=B.indexOf(".")-1,l=q;l>=0;--l)if(!(n[l]==null||"n?".indexOf(n[l].t)===-1)){for(m=n[l].v.indexOf(".")>-1&&l===q?n[l].v.indexOf(".")-1:n[l].v.length-1,G=n[l].v.substr(m+1);m>=0;--m)T>=0&&(n[l].v.charAt(m)==="0"||n[l].v.charAt(m)==="#")&&(G=B.charAt(T--)+G);n[l].v=G,n[l].t="t",L=l}for(T>=0&&L<n.length&&(n[L].v=B.substr(0,T+1)+n[L].v),T=B.indexOf(".")+1,l=q;l<n.length;++l)if(!(n[l]==null||"n?(".indexOf(n[l].t)===-1&&l!==q)){for(m=n[l].v.indexOf(".")>-1&&l===q?n[l].v.indexOf(".")+1:0,G=n[l].v.substr(0,m);m<n[l].v.length;++m)T<B.length&&(G+=B.charAt(T++));n[l].v=G,n[l].t="t",L=l}}}for(l=0;l<n.length;++l)n[l]!=null&&"n?".indexOf(n[l].t)>-1&&(W=a>1&&e<0&&l>0&&n[l-1].v==="-"?-e:e,n[l].v=dc(n[l].t,n[l].v,W),n[l].t="t");var J="";for(l=0;l!==n.length;++l)n[l]!=null&&(J+=n[l].v);return J}var _w=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function bw(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function I8(t,e){var r=P8(t),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(_w),c=r[1].match(_w);return bw(e,l)?[a,r[0]]:bw(e,c)?[a,r[1]]:[a,r[l!=null&&c!=null?2:1]]}return[a,s]}function fo(t,e,r){r==null&&(r={});var a="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?a=r.dateNF:a=t;break;case"number":t==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:br)[t],a==null&&(a=r.table&&r.table[vw[t]]||br[vw[t]]),a==null&&(a=_8[t]||"General");break}if(Zp(a,0))return wf(e,r);e instanceof Date&&(e=hN(e,r.date1904));var n=I8(a,e);if(Zp(n[1]))return wf(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return M8(n[1],e,r,n[0])}function hc(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(br[r]==null){e<0&&(e=r);continue}if(br[r]==t){e=r;break}}e<0&&(e=391)}return br[e]=t,e}function b1(t){for(var e=0;e!=392;++e)t[e]!==void 0&&hc(t[e],e)}function vh(){br=y8()}var B8={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},wN=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function U8(t){var e=typeof t=="number"?br[t]:t;return e=e.replace(wN,"(\\d+)"),new RegExp("^"+e+"$")}function q8(t,e,r){var a=-1,n=-1,s=-1,l=-1,c=-1,f=-1;(e.match(wN)||[]).forEach(function(v,x){var g=parseInt(r[x+1],10);switch(v.toLowerCase().charAt(0)){case"y":a=g;break;case"d":s=g;break;case"h":l=g;break;case"s":f=g;break;case"m":l>=0?c=g:n=g;break}}),f>=0&&c==-1&&n>=0&&(c=n,n=-1);var d=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var m=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&c==-1&&f==-1?d:a==-1&&n==-1&&s==-1?m:d+"T"+m}var z8=(function(){var t={};t.version="1.2.0";function e(){for(var B=0,q=new Array(256),L=0;L!=256;++L)B=L,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,q[L]=B;return typeof Int32Array<"u"?new Int32Array(q):q}var r=e();function a(B){var q=0,L=0,J=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(J=0;J!=256;++J)D[J]=B[J];for(J=0;J!=256;++J)for(L=B[J],q=256+J;q<4096;q+=256)L=D[q]=L>>>8^B[L&255];var O=[];for(J=1;J!=16;++J)O[J-1]=typeof Int32Array<"u"?D.subarray(J*256,J*256+256):D.slice(J*256,J*256+256);return O}var n=a(r),s=n[0],l=n[1],c=n[2],f=n[3],d=n[4],m=n[5],v=n[6],x=n[7],g=n[8],b=n[9],_=n[10],w=n[11],E=n[12],C=n[13],A=n[14];function T(B,q){for(var L=q^-1,J=0,D=B.length;J<D;)L=L>>>8^r[(L^B.charCodeAt(J++))&255];return~L}function G(B,q){for(var L=q^-1,J=B.length-15,D=0;D<J;)L=A[B[D++]^L&255]^C[B[D++]^L>>8&255]^E[B[D++]^L>>16&255]^w[B[D++]^L>>>24]^_[B[D++]]^b[B[D++]]^g[B[D++]]^x[B[D++]]^v[B[D++]]^m[B[D++]]^d[B[D++]]^f[B[D++]]^c[B[D++]]^l[B[D++]]^s[B[D++]]^r[B[D++]];for(J+=15;D<J;)L=L>>>8^r[(L^B[D++])&255];return~L}function W(B,q){for(var L=q^-1,J=0,D=B.length,O=0,M=0;J<D;)O=B.charCodeAt(J++),O<128?L=L>>>8^r[(L^O)&255]:O<2048?(L=L>>>8^r[(L^(192|O>>6&31))&255],L=L>>>8^r[(L^(128|O&63))&255]):O>=55296&&O<57344?(O=(O&1023)+64,M=B.charCodeAt(J++)&1023,L=L>>>8^r[(L^(240|O>>8&7))&255],L=L>>>8^r[(L^(128|O>>2&63))&255],L=L>>>8^r[(L^(128|M>>6&15|(O&3)<<4))&255],L=L>>>8^r[(L^(128|M&63))&255]):(L=L>>>8^r[(L^(224|O>>12&15))&255],L=L>>>8^r[(L^(128|O>>6&63))&255],L=L>>>8^r[(L^(128|O&63))&255]);return~L}return t.table=r,t.bstr=T,t.buf=G,t.str=W,t})(),hr=(function(){var e={};e.version="1.2.1";function r(re,Ne){for(var me=re.split("/"),ge=Ne.split("/"),we=0,je=0,We=Math.min(me.length,ge.length);we<We;++we){if(je=me[we].length-ge[we].length)return je;if(me[we]!=ge[we])return me[we]<ge[we]?-1:1}return me.length-ge.length}function a(re){if(re.charAt(re.length-1)=="/")return re.slice(0,-1).indexOf("/")===-1?re:a(re.slice(0,-1));var Ne=re.lastIndexOf("/");return Ne===-1?re:re.slice(0,Ne+1)}function n(re){if(re.charAt(re.length-1)=="/")return n(re.slice(0,-1));var Ne=re.lastIndexOf("/");return Ne===-1?re:re.slice(Ne+1)}function s(re,Ne){typeof Ne=="string"&&(Ne=new Date(Ne));var me=Ne.getHours();me=me<<6|Ne.getMinutes(),me=me<<5|Ne.getSeconds()>>>1,re.write_shift(2,me);var ge=Ne.getFullYear()-1980;ge=ge<<4|Ne.getMonth()+1,ge=ge<<5|Ne.getDate(),re.write_shift(2,ge)}function l(re){var Ne=re.read_shift(2)&65535,me=re.read_shift(2)&65535,ge=new Date,we=me&31;me>>>=5;var je=me&15;me>>>=4,ge.setMilliseconds(0),ge.setFullYear(me+1980),ge.setMonth(je-1),ge.setDate(we);var We=Ne&31;Ne>>>=5;var st=Ne&63;return Ne>>>=6,ge.setHours(Ne),ge.setMinutes(st),ge.setSeconds(We<<1),ge}function c(re){ys(re,0);for(var Ne={},me=0;re.l<=re.length-4;){var ge=re.read_shift(2),we=re.read_shift(2),je=re.l+we,We={};switch(ge){case 21589:me=re.read_shift(1),me&1&&(We.mtime=re.read_shift(4)),we>5&&(me&2&&(We.atime=re.read_shift(4)),me&4&&(We.ctime=re.read_shift(4))),We.mtime&&(We.mt=new Date(We.mtime*1e3));break}re.l=je,Ne[ge]=We}return Ne}var f;function d(){return f||(f={})}function m(re,Ne){if(re[0]==80&&re[1]==75)return Ct(re,Ne);if((re[0]|32)==109&&(re[1]|32)==105)return rr(re,Ne);if(re.length<512)throw new Error("CFB file size "+re.length+" < 512");var me=3,ge=512,we=0,je=0,We=0,st=0,Ke=0,Je=[],Qe=re.slice(0,512);ys(Qe,0);var St=v(Qe);switch(me=St[0],me){case 3:ge=512;break;case 4:ge=4096;break;case 0:if(St[1]==0)return Ct(re,Ne);default:throw new Error("Major Version: Expected 3 or 4 saw "+me)}ge!==512&&(Qe=re.slice(0,ge),ys(Qe,28));var Ft=re.slice(0,ge);x(Qe,me);var Ht=Qe.read_shift(4,"i");if(me===3&&Ht!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ht);Qe.l+=4,We=Qe.read_shift(4,"i"),Qe.l+=4,Qe.chk("00100000","Mini Stream Cutoff Size: "),st=Qe.read_shift(4,"i"),we=Qe.read_shift(4,"i"),Ke=Qe.read_shift(4,"i"),je=Qe.read_shift(4,"i");for(var Tt=-1,Bt=0;Bt<109&&(Tt=Qe.read_shift(4,"i"),!(Tt<0));++Bt)Je[Bt]=Tt;var Jt=g(re,ge);w(Ke,je,Jt,ge,Je);var ia=C(Jt,We,Je,ge);ia[We].name="!Directory",we>0&&st!==M&&(ia[st].name="!MiniFAT"),ia[Je[0]].name="!FAT",ia.fat_addrs=Je,ia.ssz=ge;var Lr={},ua=[],ls=[],gi=[];A(We,ia,Jt,ua,we,Lr,ls,st),b(ls,gi,ua),ua.shift();var vi={FileIndex:ls,FullPaths:gi};return Ne&&Ne.raw&&(vi.raw={header:Ft,sectors:Jt}),vi}function v(re){if(re[re.l]==80&&re[re.l+1]==75)return[0,0];re.chk(V,"Header Signature: "),re.l+=16;var Ne=re.read_shift(2,"u");return[re.read_shift(2,"u"),Ne]}function x(re,Ne){var me=9;switch(re.l+=2,me=re.read_shift(2)){case 9:if(Ne!=3)throw new Error("Sector Shift: Expected 9 saw "+me);break;case 12:if(Ne!=4)throw new Error("Sector Shift: Expected 12 saw "+me);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+me)}re.chk("0600","Mini Sector Shift: "),re.chk("000000000000","Reserved: ")}function g(re,Ne){for(var me=Math.ceil(re.length/Ne)-1,ge=[],we=1;we<me;++we)ge[we-1]=re.slice(we*Ne,(we+1)*Ne);return ge[me-1]=re.slice(me*Ne),ge}function b(re,Ne,me){for(var ge=0,we=0,je=0,We=0,st=0,Ke=me.length,Je=[],Qe=[];ge<Ke;++ge)Je[ge]=Qe[ge]=ge,Ne[ge]=me[ge];for(;st<Qe.length;++st)ge=Qe[st],we=re[ge].L,je=re[ge].R,We=re[ge].C,Je[ge]===ge&&(we!==-1&&Je[we]!==we&&(Je[ge]=Je[we]),je!==-1&&Je[je]!==je&&(Je[ge]=Je[je])),We!==-1&&(Je[We]=ge),we!==-1&&ge!=Je[ge]&&(Je[we]=Je[ge],Qe.lastIndexOf(we)<st&&Qe.push(we)),je!==-1&&ge!=Je[ge]&&(Je[je]=Je[ge],Qe.lastIndexOf(je)<st&&Qe.push(je));for(ge=1;ge<Ke;++ge)Je[ge]===ge&&(je!==-1&&Je[je]!==je?Je[ge]=Je[je]:we!==-1&&Je[we]!==we&&(Je[ge]=Je[we]));for(ge=1;ge<Ke;++ge)if(re[ge].type!==0){if(st=ge,st!=Je[st])do st=Je[st],Ne[ge]=Ne[st]+"/"+Ne[ge];while(st!==0&&Je[st]!==-1&&st!=Je[st]);Je[ge]=-1}for(Ne[0]+="/",ge=1;ge<Ke;++ge)re[ge].type!==2&&(Ne[ge]+="/")}function _(re,Ne,me){for(var ge=re.start,we=re.size,je=[],We=ge;me&&we>0&&We>=0;)je.push(Ne.slice(We*O,We*O+O)),we-=O,We=ff(me,We*4);return je.length===0?ft(0):is(je).slice(0,re.size)}function w(re,Ne,me,ge,we){var je=M;if(re===M){if(Ne!==0)throw new Error("DIFAT chain shorter than expected")}else if(re!==-1){var We=me[re],st=(ge>>>2)-1;if(!We)return;for(var Ke=0;Ke<st&&(je=ff(We,Ke*4))!==M;++Ke)we.push(je);w(ff(We,ge-4),Ne-1,me,ge,we)}}function E(re,Ne,me,ge,we){var je=[],We=[];we||(we=[]);var st=ge-1,Ke=0,Je=0;for(Ke=Ne;Ke>=0;){we[Ke]=!0,je[je.length]=Ke,We.push(re[Ke]);var Qe=me[Math.floor(Ke*4/ge)];if(Je=Ke*4&st,ge<4+Je)throw new Error("FAT boundary crossed: "+Ke+" 4 "+ge);if(!re[Qe])break;Ke=ff(re[Qe],Je)}return{nodes:je,data:Dw([We])}}function C(re,Ne,me,ge){var we=re.length,je=[],We=[],st=[],Ke=[],Je=ge-1,Qe=0,St=0,Ft=0,Ht=0;for(Qe=0;Qe<we;++Qe)if(st=[],Ft=Qe+Ne,Ft>=we&&(Ft-=we),!We[Ft]){Ke=[];var Tt=[];for(St=Ft;St>=0;){Tt[St]=!0,We[St]=!0,st[st.length]=St,Ke.push(re[St]);var Bt=me[Math.floor(St*4/ge)];if(Ht=St*4&Je,ge<4+Ht)throw new Error("FAT boundary crossed: "+St+" 4 "+ge);if(!re[Bt]||(St=ff(re[Bt],Ht),Tt[St]))break}je[Ft]={nodes:st,data:Dw([Ke])}}return je}function A(re,Ne,me,ge,we,je,We,st){for(var Ke=0,Je=ge.length?2:0,Qe=Ne[re].data,St=0,Ft=0,Ht;St<Qe.length;St+=128){var Tt=Qe.slice(St,St+128);ys(Tt,64),Ft=Tt.read_shift(2),Ht=_2(Tt,0,Ft-Je),ge.push(Ht);var Bt={name:Ht,type:Tt.read_shift(1),color:Tt.read_shift(1),L:Tt.read_shift(4,"i"),R:Tt.read_shift(4,"i"),C:Tt.read_shift(4,"i"),clsid:Tt.read_shift(16),state:Tt.read_shift(4,"i"),start:0,size:0},Jt=Tt.read_shift(2)+Tt.read_shift(2)+Tt.read_shift(2)+Tt.read_shift(2);Jt!==0&&(Bt.ct=T(Tt,Tt.l-8));var ia=Tt.read_shift(2)+Tt.read_shift(2)+Tt.read_shift(2)+Tt.read_shift(2);ia!==0&&(Bt.mt=T(Tt,Tt.l-8)),Bt.start=Tt.read_shift(4,"i"),Bt.size=Tt.read_shift(4,"i"),Bt.size<0&&Bt.start<0&&(Bt.size=Bt.type=0,Bt.start=M,Bt.name=""),Bt.type===5?(Ke=Bt.start,we>0&&Ke!==M&&(Ne[Ke].name="!StreamData")):Bt.size>=4096?(Bt.storage="fat",Ne[Bt.start]===void 0&&(Ne[Bt.start]=E(me,Bt.start,Ne.fat_addrs,Ne.ssz)),Ne[Bt.start].name=Bt.name,Bt.content=Ne[Bt.start].data.slice(0,Bt.size)):(Bt.storage="minifat",Bt.size<0?Bt.size=0:Ke!==M&&Bt.start!==M&&Ne[Ke]&&(Bt.content=_(Bt,Ne[Ke].data,(Ne[st]||{}).data))),Bt.content&&ys(Bt.content,0),je[Ht]=Bt,We.push(Bt)}}function T(re,Ne){return new Date((Fi(re,Ne+4)/1e7*Math.pow(2,32)+Fi(re,Ne)/1e7-11644473600)*1e3)}function G(re,Ne){return d(),m(f.readFileSync(re),Ne)}function W(re,Ne){var me=Ne&&Ne.type;switch(me||Pr&&Buffer.isBuffer(re)&&(me="buffer"),me||"base64"){case"file":return G(re,Ne);case"base64":return m(Mi(qi(re)),Ne);case"binary":return m(Mi(re),Ne)}return m(re,Ne)}function B(re,Ne){var me=Ne||{},ge=me.root||"Root Entry";if(re.FullPaths||(re.FullPaths=[]),re.FileIndex||(re.FileIndex=[]),re.FullPaths.length!==re.FileIndex.length)throw new Error("inconsistent CFB structure");re.FullPaths.length===0&&(re.FullPaths[0]=ge+"/",re.FileIndex[0]={name:ge,type:5}),me.CLSID&&(re.FileIndex[0].clsid=me.CLSID),q(re)}function q(re){var Ne="Sh33tJ5";if(!hr.find(re,"/"+Ne)){var me=ft(4);me[0]=55,me[1]=me[3]=50,me[2]=54,re.FileIndex.push({name:Ne,type:2,content:me,size:4,L:69,R:69,C:69}),re.FullPaths.push(re.FullPaths[0]+Ne),L(re)}}function L(re,Ne){B(re);for(var me=!1,ge=!1,we=re.FullPaths.length-1;we>=0;--we){var je=re.FileIndex[we];switch(je.type){case 0:ge?me=!0:(re.FileIndex.pop(),re.FullPaths.pop());break;case 1:case 2:case 5:ge=!0,isNaN(je.R*je.L*je.C)&&(me=!0),je.R>-1&&je.L>-1&&je.R==je.L&&(me=!0);break;default:me=!0;break}}if(!(!me&&!Ne)){var We=new Date(1987,1,19),st=0,Ke=Object.create?Object.create(null):{},Je=[];for(we=0;we<re.FullPaths.length;++we)Ke[re.FullPaths[we]]=!0,re.FileIndex[we].type!==0&&Je.push([re.FullPaths[we],re.FileIndex[we]]);for(we=0;we<Je.length;++we){var Qe=a(Je[we][0]);ge=Ke[Qe],ge||(Je.push([Qe,{name:n(Qe).replace("/",""),type:1,clsid:X,ct:We,mt:We,content:null}]),Ke[Qe]=!0)}for(Je.sort(function(Ht,Tt){return r(Ht[0],Tt[0])}),re.FullPaths=[],re.FileIndex=[],we=0;we<Je.length;++we)re.FullPaths[we]=Je[we][0],re.FileIndex[we]=Je[we][1];for(we=0;we<Je.length;++we){var St=re.FileIndex[we],Ft=re.FullPaths[we];if(St.name=n(Ft).replace("/",""),St.L=St.R=St.C=-(St.color=1),St.size=St.content?St.content.length:0,St.start=0,St.clsid=St.clsid||X,we===0)St.C=Je.length>1?1:-1,St.size=0,St.type=5;else if(Ft.slice(-1)=="/"){for(st=we+1;st<Je.length&&a(re.FullPaths[st])!=Ft;++st);for(St.C=st>=Je.length?-1:st,st=we+1;st<Je.length&&a(re.FullPaths[st])!=a(Ft);++st);St.R=st>=Je.length?-1:st,St.type=1}else a(re.FullPaths[we+1]||"")==a(Ft)&&(St.R=we+1),St.type=2}}}function J(re,Ne){var me=Ne||{};if(me.fileType=="mad")return ya(re,me);switch(L(re),me.fileType){case"zip":return Rt(re,me)}var ge=(function(Ht){for(var Tt=0,Bt=0,Jt=0;Jt<Ht.FileIndex.length;++Jt){var ia=Ht.FileIndex[Jt];if(ia.content){var Lr=ia.content.length;Lr>0&&(Lr<4096?Tt+=Lr+63>>6:Bt+=Lr+511>>9)}}for(var ua=Ht.FullPaths.length+3>>2,ls=Tt+7>>3,gi=Tt+127>>7,vi=ls+Bt+ua+gi,Is=vi+127>>7,el=Is<=109?0:Math.ceil((Is-109)/127);vi+Is+el+127>>7>Is;)el=++Is<=109?0:Math.ceil((Is-109)/127);var Fa=[1,el,Is,gi,ua,Bt,Tt,0];return Ht.FileIndex[0].size=Tt<<6,Fa[7]=(Ht.FileIndex[0].start=Fa[0]+Fa[1]+Fa[2]+Fa[3]+Fa[4]+Fa[5])+(Fa[6]+7>>3),Fa})(re),we=ft(ge[7]<<9),je=0,We=0;{for(je=0;je<8;++je)we.write_shift(1,ie[je]);for(je=0;je<8;++je)we.write_shift(2,0);for(we.write_shift(2,62),we.write_shift(2,3),we.write_shift(2,65534),we.write_shift(2,9),we.write_shift(2,6),je=0;je<3;++je)we.write_shift(2,0);for(we.write_shift(4,0),we.write_shift(4,ge[2]),we.write_shift(4,ge[0]+ge[1]+ge[2]+ge[3]-1),we.write_shift(4,0),we.write_shift(4,4096),we.write_shift(4,ge[3]?ge[0]+ge[1]+ge[2]-1:M),we.write_shift(4,ge[3]),we.write_shift(-4,ge[1]?ge[0]-1:M),we.write_shift(4,ge[1]),je=0;je<109;++je)we.write_shift(-4,je<ge[2]?ge[1]+je:-1)}if(ge[1])for(We=0;We<ge[1];++We){for(;je<236+We*127;++je)we.write_shift(-4,je<ge[2]?ge[1]+je:-1);we.write_shift(-4,We===ge[1]-1?M:We+1)}var st=function(Ht){for(We+=Ht;je<We-1;++je)we.write_shift(-4,je+1);Ht&&(++je,we.write_shift(-4,M))};for(We=je=0,We+=ge[1];je<We;++je)we.write_shift(-4,Z.DIFSECT);for(We+=ge[2];je<We;++je)we.write_shift(-4,Z.FATSECT);st(ge[3]),st(ge[4]);for(var Ke=0,Je=0,Qe=re.FileIndex[0];Ke<re.FileIndex.length;++Ke)Qe=re.FileIndex[Ke],Qe.content&&(Je=Qe.content.length,!(Je<4096)&&(Qe.start=We,st(Je+511>>9)));for(st(ge[6]+7>>3);we.l&511;)we.write_shift(-4,Z.ENDOFCHAIN);for(We=je=0,Ke=0;Ke<re.FileIndex.length;++Ke)Qe=re.FileIndex[Ke],Qe.content&&(Je=Qe.content.length,!(!Je||Je>=4096)&&(Qe.start=We,st(Je+63>>6)));for(;we.l&511;)we.write_shift(-4,Z.ENDOFCHAIN);for(je=0;je<ge[4]<<2;++je){var St=re.FullPaths[je];if(!St||St.length===0){for(Ke=0;Ke<17;++Ke)we.write_shift(4,0);for(Ke=0;Ke<3;++Ke)we.write_shift(4,-1);for(Ke=0;Ke<12;++Ke)we.write_shift(4,0);continue}Qe=re.FileIndex[je],je===0&&(Qe.start=Qe.size?Qe.start-1:M);var Ft=je===0&&me.root||Qe.name;if(Je=2*(Ft.length+1),we.write_shift(64,Ft,"utf16le"),we.write_shift(2,Je),we.write_shift(1,Qe.type),we.write_shift(1,Qe.color),we.write_shift(-4,Qe.L),we.write_shift(-4,Qe.R),we.write_shift(-4,Qe.C),Qe.clsid)we.write_shift(16,Qe.clsid,"hex");else for(Ke=0;Ke<4;++Ke)we.write_shift(4,0);we.write_shift(4,Qe.state||0),we.write_shift(4,0),we.write_shift(4,0),we.write_shift(4,0),we.write_shift(4,0),we.write_shift(4,Qe.start),we.write_shift(4,Qe.size),we.write_shift(4,0)}for(je=1;je<re.FileIndex.length;++je)if(Qe=re.FileIndex[je],Qe.size>=4096)if(we.l=Qe.start+1<<9,Pr&&Buffer.isBuffer(Qe.content))Qe.content.copy(we,we.l,0,Qe.size),we.l+=Qe.size+511&-512;else{for(Ke=0;Ke<Qe.size;++Ke)we.write_shift(1,Qe.content[Ke]);for(;Ke&511;++Ke)we.write_shift(1,0)}for(je=1;je<re.FileIndex.length;++je)if(Qe=re.FileIndex[je],Qe.size>0&&Qe.size<4096)if(Pr&&Buffer.isBuffer(Qe.content))Qe.content.copy(we,we.l,0,Qe.size),we.l+=Qe.size+63&-64;else{for(Ke=0;Ke<Qe.size;++Ke)we.write_shift(1,Qe.content[Ke]);for(;Ke&63;++Ke)we.write_shift(1,0)}if(Pr)we.l=we.length;else for(;we.l<we.length;)we.write_shift(1,0);return we}function D(re,Ne){var me=re.FullPaths.map(function(Ke){return Ke.toUpperCase()}),ge=me.map(function(Ke){var Je=Ke.split("/");return Je[Je.length-(Ke.slice(-1)=="/"?2:1)]}),we=!1;Ne.charCodeAt(0)===47?(we=!0,Ne=me[0].slice(0,-1)+Ne):we=Ne.indexOf("/")!==-1;var je=Ne.toUpperCase(),We=we===!0?me.indexOf(je):ge.indexOf(je);if(We!==-1)return re.FileIndex[We];var st=!je.match(f0);for(je=je.replace(Gs,""),st&&(je=je.replace(f0,"!")),We=0;We<me.length;++We)if((st?me[We].replace(f0,"!"):me[We]).replace(Gs,"")==je||(st?ge[We].replace(f0,"!"):ge[We]).replace(Gs,"")==je)return re.FileIndex[We];return null}var O=64,M=-2,V="d0cf11e0a1b11ae1",ie=[208,207,17,224,161,177,26,225],X="00000000000000000000000000000000",Z={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:M,FREESECT:-1,HEADER_SIGNATURE:V,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:X,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function K(re,Ne,me){d();var ge=J(re,me);f.writeFileSync(Ne,ge)}function ae(re){for(var Ne=new Array(re.length),me=0;me<re.length;++me)Ne[me]=String.fromCharCode(re[me]);return Ne.join("")}function fe(re,Ne){var me=J(re,Ne);switch(Ne&&Ne.type||"buffer"){case"file":return d(),f.writeFileSync(Ne.filename,me),me;case"binary":return typeof me=="string"?me:ae(me);case"base64":return L0(typeof me=="string"?me:ae(me));case"buffer":if(Pr)return Buffer.isBuffer(me)?me:_c(me);case"array":return typeof me=="string"?Mi(me):me}return me}var U;function j(re){try{var Ne=re.InflateRaw,me=new Ne;if(me._processChunk(new Uint8Array([3,0]),me._finishFlushFlag),me.bytesRead)U=re;else throw new Error("zlib does not expose bytesRead")}catch(ge){console.error("cannot use native zlib: "+(ge.message||ge))}}function F(re,Ne){if(!U)return Be(re,Ne);var me=U.InflateRaw,ge=new me,we=ge._processChunk(re.slice(re.l),ge._finishFlushFlag);return re.l+=ge.bytesRead,we}function I(re){return U?U.deflateRawSync(re):qe(re)}var z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function pe(re){var Ne=(re<<1|re<<11)&139536|(re<<5|re<<15)&558144;return(Ne>>16|Ne>>8|Ne)&255}for(var ye=typeof Uint8Array<"u",_e=ye?new Uint8Array(256):[],Le=0;Le<256;++Le)_e[Le]=pe(Le);function ue(re,Ne){var me=_e[re&255];return Ne<=8?me>>>8-Ne:(me=me<<8|_e[re>>8&255],Ne<=16?me>>>16-Ne:(me=me<<8|_e[re>>16&255],me>>>24-Ne))}function at(re,Ne){var me=Ne&7,ge=Ne>>>3;return(re[ge]|(me<=6?0:re[ge+1]<<8))>>>me&3}function ht(re,Ne){var me=Ne&7,ge=Ne>>>3;return(re[ge]|(me<=5?0:re[ge+1]<<8))>>>me&7}function de(re,Ne){var me=Ne&7,ge=Ne>>>3;return(re[ge]|(me<=4?0:re[ge+1]<<8))>>>me&15}function it(re,Ne){var me=Ne&7,ge=Ne>>>3;return(re[ge]|(me<=3?0:re[ge+1]<<8))>>>me&31}function Se(re,Ne){var me=Ne&7,ge=Ne>>>3;return(re[ge]|(me<=1?0:re[ge+1]<<8))>>>me&127}function ve(re,Ne,me){var ge=Ne&7,we=Ne>>>3,je=(1<<me)-1,We=re[we]>>>ge;return me<8-ge||(We|=re[we+1]<<8-ge,me<16-ge)||(We|=re[we+2]<<16-ge,me<24-ge)||(We|=re[we+3]<<24-ge),We&je}function Ie(re,Ne,me){var ge=Ne&7,we=Ne>>>3;return ge<=5?re[we]|=(me&7)<<ge:(re[we]|=me<<ge&255,re[we+1]=(me&7)>>8-ge),Ne+3}function wt(re,Ne,me){var ge=Ne&7,we=Ne>>>3;return me=(me&1)<<ge,re[we]|=me,Ne+1}function Xe(re,Ne,me){var ge=Ne&7,we=Ne>>>3;return me<<=ge,re[we]|=me&255,me>>>=8,re[we+1]=me,Ne+8}function ct(re,Ne,me){var ge=Ne&7,we=Ne>>>3;return me<<=ge,re[we]|=me&255,me>>>=8,re[we+1]=me&255,re[we+2]=me>>>8,Ne+16}function jt(re,Ne){var me=re.length,ge=2*me>Ne?2*me:Ne+5,we=0;if(me>=Ne)return re;if(Pr){var je=mw(ge);if(re.copy)re.copy(je);else for(;we<re.length;++we)je[we]=re[we];return je}else if(ye){var We=new Uint8Array(ge);if(We.set)We.set(re);else for(;we<me;++we)We[we]=re[we];return We}return re.length=ge,re}function Lt(re){for(var Ne=new Array(re),me=0;me<re;++me)Ne[me]=0;return Ne}function Vt(re,Ne,me){var ge=1,we=0,je=0,We=0,st=0,Ke=re.length,Je=ye?new Uint16Array(32):Lt(32);for(je=0;je<32;++je)Je[je]=0;for(je=Ke;je<me;++je)re[je]=0;Ke=re.length;var Qe=ye?new Uint16Array(Ke):Lt(Ke);for(je=0;je<Ke;++je)Je[we=re[je]]++,ge<we&&(ge=we),Qe[je]=0;for(Je[0]=0,je=1;je<=ge;++je)Je[je+16]=st=st+Je[je-1]<<1;for(je=0;je<Ke;++je)st=re[je],st!=0&&(Qe[je]=Je[st+16]++);var St=0;for(je=0;je<Ke;++je)if(St=re[je],St!=0)for(st=ue(Qe[je],ge)>>ge-St,We=(1<<ge+4-St)-1;We>=0;--We)Ne[st|We<<St]=St&15|je<<4;return ge}var $t=ye?new Uint16Array(512):Lt(512),Wt=ye?new Uint16Array(32):Lt(32);if(!ye){for(var Ot=0;Ot<512;++Ot)$t[Ot]=0;for(Ot=0;Ot<32;++Ot)Wt[Ot]=0}(function(){for(var re=[],Ne=0;Ne<32;Ne++)re.push(5);Vt(re,Wt,32);var me=[];for(Ne=0;Ne<=143;Ne++)me.push(8);for(;Ne<=255;Ne++)me.push(9);for(;Ne<=279;Ne++)me.push(7);for(;Ne<=287;Ne++)me.push(8);Vt(me,$t,288)})();var kt=(function(){for(var Ne=ye?new Uint8Array(32768):[],me=0,ge=0;me<se.length-1;++me)for(;ge<se[me+1];++ge)Ne[ge]=me;for(;ge<32768;++ge)Ne[ge]=29;var we=ye?new Uint8Array(259):[];for(me=0,ge=0;me<ne.length-1;++me)for(;ge<ne[me+1];++ge)we[ge]=me;function je(st,Ke){for(var Je=0;Je<st.length;){var Qe=Math.min(65535,st.length-Je),St=Je+Qe==st.length;for(Ke.write_shift(1,+St),Ke.write_shift(2,Qe),Ke.write_shift(2,~Qe&65535);Qe-- >0;)Ke[Ke.l++]=st[Je++]}return Ke.l}function We(st,Ke){for(var Je=0,Qe=0,St=ye?new Uint16Array(32768):[];Qe<st.length;){var Ft=Math.min(65535,st.length-Qe);if(Ft<10){for(Je=Ie(Ke,Je,+(Qe+Ft==st.length)),Je&7&&(Je+=8-(Je&7)),Ke.l=Je/8|0,Ke.write_shift(2,Ft),Ke.write_shift(2,~Ft&65535);Ft-- >0;)Ke[Ke.l++]=st[Qe++];Je=Ke.l*8;continue}Je=Ie(Ke,Je,+(Qe+Ft==st.length)+2);for(var Ht=0;Ft-- >0;){var Tt=st[Qe];Ht=(Ht<<5^Tt)&32767;var Bt=-1,Jt=0;if((Bt=St[Ht])&&(Bt|=Qe&-32768,Bt>Qe&&(Bt-=32768),Bt<Qe))for(;st[Bt+Jt]==st[Qe+Jt]&&Jt<250;)++Jt;if(Jt>2){Tt=we[Jt],Tt<=22?Je=Xe(Ke,Je,_e[Tt+1]>>1)-1:(Xe(Ke,Je,3),Je+=5,Xe(Ke,Je,_e[Tt-23]>>5),Je+=3);var ia=Tt<8?0:Tt-4>>2;ia>0&&(ct(Ke,Je,Jt-ne[Tt]),Je+=ia),Tt=Ne[Qe-Bt],Je=Xe(Ke,Je,_e[Tt]>>3),Je-=3;var Lr=Tt<4?0:Tt-2>>1;Lr>0&&(ct(Ke,Je,Qe-Bt-se[Tt]),Je+=Lr);for(var ua=0;ua<Jt;++ua)St[Ht]=Qe&32767,Ht=(Ht<<5^st[Qe])&32767,++Qe;Ft-=Jt-1}else Tt<=143?Tt=Tt+48:Je=wt(Ke,Je,1),Je=Xe(Ke,Je,_e[Tt]),St[Ht]=Qe&32767,++Qe}Je=Xe(Ke,Je,0)-1}return Ke.l=(Je+7)/8|0,Ke.l}return function(Ke,Je){return Ke.length<8?je(Ke,Je):We(Ke,Je)}})();function qe(re){var Ne=ft(50+Math.floor(re.length*1.1)),me=kt(re,Ne);return Ne.slice(0,me)}var Ye=ye?new Uint16Array(32768):Lt(32768),Pt=ye?new Uint16Array(32768):Lt(32768),Et=ye?new Uint16Array(128):Lt(128),Dt=1,Ce=1;function $e(re,Ne){var me=it(re,Ne)+257;Ne+=5;var ge=it(re,Ne)+1;Ne+=5;var we=de(re,Ne)+4;Ne+=4;for(var je=0,We=ye?new Uint8Array(19):Lt(19),st=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ke=1,Je=ye?new Uint8Array(8):Lt(8),Qe=ye?new Uint8Array(8):Lt(8),St=We.length,Ft=0;Ft<we;++Ft)We[z[Ft]]=je=ht(re,Ne),Ke<je&&(Ke=je),Je[je]++,Ne+=3;var Ht=0;for(Je[0]=0,Ft=1;Ft<=Ke;++Ft)Qe[Ft]=Ht=Ht+Je[Ft-1]<<1;for(Ft=0;Ft<St;++Ft)(Ht=We[Ft])!=0&&(st[Ft]=Qe[Ht]++);var Tt=0;for(Ft=0;Ft<St;++Ft)if(Tt=We[Ft],Tt!=0){Ht=_e[st[Ft]]>>8-Tt;for(var Bt=(1<<7-Tt)-1;Bt>=0;--Bt)Et[Ht|Bt<<Tt]=Tt&7|Ft<<3}var Jt=[];for(Ke=1;Jt.length<me+ge;)switch(Ht=Et[Se(re,Ne)],Ne+=Ht&7,Ht>>>=3){case 16:for(je=3+at(re,Ne),Ne+=2,Ht=Jt[Jt.length-1];je-- >0;)Jt.push(Ht);break;case 17:for(je=3+ht(re,Ne),Ne+=3;je-- >0;)Jt.push(0);break;case 18:for(je=11+Se(re,Ne),Ne+=7;je-- >0;)Jt.push(0);break;default:Jt.push(Ht),Ke<Ht&&(Ke=Ht);break}var ia=Jt.slice(0,me),Lr=Jt.slice(me);for(Ft=me;Ft<286;++Ft)ia[Ft]=0;for(Ft=ge;Ft<30;++Ft)Lr[Ft]=0;return Dt=Vt(ia,Ye,286),Ce=Vt(Lr,Pt,30),Ne}function xe(re,Ne){if(re[0]==3&&!(re[1]&3))return[vu(Ne),2];for(var me=0,ge=0,we=mw(Ne||1<<18),je=0,We=we.length>>>0,st=0,Ke=0;(ge&1)==0;){if(ge=ht(re,me),me+=3,ge>>>1)ge>>1==1?(st=9,Ke=5):(me=$e(re,me),st=Dt,Ke=Ce);else{me&7&&(me+=8-(me&7));var Je=re[me>>>3]|re[(me>>>3)+1]<<8;if(me+=32,Je>0)for(!Ne&&We<je+Je&&(we=jt(we,je+Je),We=we.length);Je-- >0;)we[je++]=re[me>>>3],me+=8;continue}for(;;){!Ne&&We<je+32767&&(we=jt(we,je+32767),We=we.length);var Qe=ve(re,me,st),St=ge>>>1==1?$t[Qe]:Ye[Qe];if(me+=St&15,St>>>=4,(St>>>8&255)===0)we[je++]=St;else{if(St==256)break;St-=257;var Ft=St<8?0:St-4>>2;Ft>5&&(Ft=0);var Ht=je+ne[St];Ft>0&&(Ht+=ve(re,me,Ft),me+=Ft),Qe=ve(re,me,Ke),St=ge>>>1==1?Wt[Qe]:Pt[Qe],me+=St&15,St>>>=4;var Tt=St<4?0:St-2>>1,Bt=se[St];for(Tt>0&&(Bt+=ve(re,me,Tt),me+=Tt),!Ne&&We<Ht&&(we=jt(we,Ht+100),We=we.length);je<Ht;)we[je]=we[je-Bt],++je}}}return Ne?[we,me+7>>>3]:[we.slice(0,je),me+7>>>3]}function Be(re,Ne){var me=re.slice(re.l||0),ge=xe(me,Ne);return re.l+=ge[1],ge[0]}function Pe(re,Ne){if(re)typeof console<"u"&&console.error(Ne);else throw new Error(Ne)}function Ct(re,Ne){var me=re;ys(me,0);var ge=[],we=[],je={FileIndex:ge,FullPaths:we};B(je,{root:Ne.root});for(var We=me.length-4;(me[We]!=80||me[We+1]!=75||me[We+2]!=5||me[We+3]!=6)&&We>=0;)--We;me.l=We+4,me.l+=4;var st=me.read_shift(2);me.l+=6;var Ke=me.read_shift(4);for(me.l=Ke,We=0;We<st;++We){me.l+=20;var Je=me.read_shift(4),Qe=me.read_shift(4),St=me.read_shift(2),Ft=me.read_shift(2),Ht=me.read_shift(2);me.l+=8;var Tt=me.read_shift(4),Bt=c(me.slice(me.l+St,me.l+St+Ft));me.l+=St+Ft+Ht;var Jt=me.l;me.l=Tt+4,gt(me,Je,Qe,je,Bt),me.l=Jt}return je}function gt(re,Ne,me,ge,we){re.l+=2;var je=re.read_shift(2),We=re.read_shift(2),st=l(re);if(je&8257)throw new Error("Unsupported ZIP encryption");for(var Ke=re.read_shift(4),Je=re.read_shift(4),Qe=re.read_shift(4),St=re.read_shift(2),Ft=re.read_shift(2),Ht="",Tt=0;Tt<St;++Tt)Ht+=String.fromCharCode(re[re.l++]);if(Ft){var Bt=c(re.slice(re.l,re.l+Ft));(Bt[21589]||{}).mt&&(st=Bt[21589].mt),((we||{})[21589]||{}).mt&&(st=we[21589].mt)}re.l+=Ft;var Jt=re.slice(re.l,re.l+Je);switch(We){case 8:Jt=F(re,Qe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+We)}var ia=!1;je&8&&(Ke=re.read_shift(4),Ke==134695760&&(Ke=re.read_shift(4),ia=!0),Je=re.read_shift(4),Qe=re.read_shift(4)),Je!=Ne&&Pe(ia,"Bad compressed size: "+Ne+" != "+Je),Qe!=me&&Pe(ia,"Bad uncompressed size: "+me+" != "+Qe),Da(ge,Ht,Jt,{unsafe:!0,mt:st})}function Rt(re,Ne){var me=Ne||{},ge=[],we=[],je=ft(1),We=me.compression?8:0,st=0,Ke=0,Je=0,Qe=0,St=0,Ft=re.FullPaths[0],Ht=Ft,Tt=re.FileIndex[0],Bt=[],Jt=0;for(Ke=1;Ke<re.FullPaths.length;++Ke)if(Ht=re.FullPaths[Ke].slice(Ft.length),Tt=re.FileIndex[Ke],!(!Tt.size||!Tt.content||Ht=="Sh33tJ5")){var ia=Qe,Lr=ft(Ht.length);for(Je=0;Je<Ht.length;++Je)Lr.write_shift(1,Ht.charCodeAt(Je)&127);Lr=Lr.slice(0,Lr.l),Bt[St]=z8.buf(Tt.content,0);var ua=Tt.content;We==8&&(ua=I(ua)),je=ft(30),je.write_shift(4,67324752),je.write_shift(2,20),je.write_shift(2,st),je.write_shift(2,We),Tt.mt?s(je,Tt.mt):je.write_shift(4,0),je.write_shift(-4,Bt[St]),je.write_shift(4,ua.length),je.write_shift(4,Tt.content.length),je.write_shift(2,Lr.length),je.write_shift(2,0),Qe+=je.length,ge.push(je),Qe+=Lr.length,ge.push(Lr),Qe+=ua.length,ge.push(ua),je=ft(46),je.write_shift(4,33639248),je.write_shift(2,0),je.write_shift(2,20),je.write_shift(2,st),je.write_shift(2,We),je.write_shift(4,0),je.write_shift(-4,Bt[St]),je.write_shift(4,ua.length),je.write_shift(4,Tt.content.length),je.write_shift(2,Lr.length),je.write_shift(2,0),je.write_shift(2,0),je.write_shift(2,0),je.write_shift(2,0),je.write_shift(4,0),je.write_shift(4,ia),Jt+=je.l,we.push(je),Jt+=Lr.length,we.push(Lr),++St}return je=ft(22),je.write_shift(4,101010256),je.write_shift(2,0),je.write_shift(2,0),je.write_shift(2,St),je.write_shift(2,St),je.write_shift(4,Jt),je.write_shift(4,Qe),je.write_shift(2,0),is([is(ge),is(we),je])}var It={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function pr(re,Ne){if(re.ctype)return re.ctype;var me=re.name||"",ge=me.match(/\.([^\.]+)$/);return ge&&It[ge[1]]||Ne&&(ge=(me=Ne).match(/[\.\\]([^\.\\])+$/),ge&&It[ge[1]])?It[ge[1]]:"application/octet-stream"}function sa(re){for(var Ne=L0(re),me=[],ge=0;ge<Ne.length;ge+=76)me.push(Ne.slice(ge,ge+76));return me.join(`\r
`)+`\r
`}function fa(re){var Ne=re.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Je){var Qe=Je.charCodeAt(0).toString(16).toUpperCase();return"="+(Qe.length==1?"0"+Qe:Qe)});Ne=Ne.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Ne.charAt(0)==`
`&&(Ne="=0D"+Ne.slice(1)),Ne=Ne.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var me=[],ge=Ne.split(`\r
`),we=0;we<ge.length;++we){var je=ge[we];if(je.length==0){me.push("");continue}for(var We=0;We<je.length;){var st=76,Ke=je.slice(We,We+st);Ke.charAt(st-1)=="="?st--:Ke.charAt(st-2)=="="?st-=2:Ke.charAt(st-3)=="="&&(st-=3),Ke=je.slice(We,We+st),We+=st,We<je.length&&(Ke+="="),me.push(Ke)}}return me.join(`\r
`)}function Nt(re){for(var Ne=[],me=0;me<re.length;++me){for(var ge=re[me];me<=re.length&&ge.charAt(ge.length-1)=="=";)ge=ge.slice(0,ge.length-1)+re[++me];Ne.push(ge)}for(var we=0;we<Ne.length;++we)Ne[we]=Ne[we].replace(/[=][0-9A-Fa-f]{2}/g,function(je){return String.fromCharCode(parseInt(je.slice(1),16))});return Mi(Ne.join(`\r
`))}function Ea(re,Ne,me){for(var ge="",we="",je="",We,st=0;st<10;++st){var Ke=Ne[st];if(!Ke||Ke.match(/^\s*$/))break;var Je=Ke.match(/^(.*?):\s*([^\s].*)$/);if(Je)switch(Je[1].toLowerCase()){case"content-location":ge=Je[2].trim();break;case"content-type":je=Je[2].trim();break;case"content-transfer-encoding":we=Je[2].trim();break}}switch(++st,we.toLowerCase()){case"base64":We=Mi(qi(Ne.slice(st).join("")));break;case"quoted-printable":We=Nt(Ne.slice(st));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+we)}var Qe=Da(re,ge.slice(me.length),We,{unsafe:!0});je&&(Qe.ctype=je)}function rr(re,Ne){if(ae(re.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var me=Ne&&Ne.root||"",ge=(Pr&&Buffer.isBuffer(re)?re.toString("binary"):ae(re)).split(`\r
`),we=0,je="";for(we=0;we<ge.length;++we)if(je=ge[we],!!/^Content-Location:/i.test(je)&&(je=je.slice(je.indexOf("file")),me||(me=je.slice(0,je.lastIndexOf("/")+1)),je.slice(0,me.length)!=me))for(;me.length>0&&(me=me.slice(0,me.length-1),me=me.slice(0,me.lastIndexOf("/")+1),je.slice(0,me.length)!=me););var We=(ge[1]||"").match(/boundary="(.*?)"/);if(!We)throw new Error("MAD cannot find boundary");var st="--"+(We[1]||""),Ke=[],Je=[],Qe={FileIndex:Ke,FullPaths:Je};B(Qe);var St,Ft=0;for(we=0;we<ge.length;++we){var Ht=ge[we];Ht!==st&&Ht!==st+"--"||(Ft++&&Ea(Qe,ge.slice(St,we),me),St=we)}return Qe}function ya(re,Ne){var me=Ne||{},ge=me.boundary||"SheetJS";ge="------="+ge;for(var we=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ge.slice(2)+'"',"","",""],je=re.FullPaths[0],We=je,st=re.FileIndex[0],Ke=1;Ke<re.FullPaths.length;++Ke)if(We=re.FullPaths[Ke].slice(je.length),st=re.FileIndex[Ke],!(!st.size||!st.content||We=="Sh33tJ5")){We=We.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Jt){return"_x"+Jt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Jt){return"_u"+Jt.charCodeAt(0).toString(16)+"_"});for(var Je=st.content,Qe=Pr&&Buffer.isBuffer(Je)?Je.toString("binary"):ae(Je),St=0,Ft=Math.min(1024,Qe.length),Ht=0,Tt=0;Tt<=Ft;++Tt)(Ht=Qe.charCodeAt(Tt))>=32&&Ht<128&&++St;var Bt=St>=Ft*4/5;we.push(ge),we.push("Content-Location: "+(me.root||"file:///C:/SheetJS/")+We),we.push("Content-Transfer-Encoding: "+(Bt?"quoted-printable":"base64")),we.push("Content-Type: "+pr(st,We)),we.push(""),we.push(Bt?fa(Qe):sa(Qe))}return we.push(ge+`--\r
`),we.join(`\r
`)}function vn(re){var Ne={};return B(Ne,re),Ne}function Da(re,Ne,me,ge){var we=ge&&ge.unsafe;we||B(re);var je=!we&&hr.find(re,Ne);if(!je){var We=re.FullPaths[0];Ne.slice(0,We.length)==We?We=Ne:(We.slice(-1)!="/"&&(We+="/"),We=(We+Ne).replace("//","/")),je={name:n(Ne),type:2},re.FileIndex.push(je),re.FullPaths.push(We),we||hr.utils.cfb_gc(re)}return je.content=me,je.size=me?me.length:0,ge&&(ge.CLSID&&(je.clsid=ge.CLSID),ge.mt&&(je.mt=ge.mt),ge.ct&&(je.ct=ge.ct)),je}function an(re,Ne){B(re);var me=hr.find(re,Ne);if(me){for(var ge=0;ge<re.FileIndex.length;++ge)if(re.FileIndex[ge]==me)return re.FileIndex.splice(ge,1),re.FullPaths.splice(ge,1),!0}return!1}function qt(re,Ne,me){B(re);var ge=hr.find(re,Ne);if(ge){for(var we=0;we<re.FileIndex.length;++we)if(re.FileIndex[we]==ge)return re.FileIndex[we].name=n(me),re.FullPaths[we]=me,!0}return!1}function Kt(re){L(re,!0)}return e.find=D,e.read=W,e.parse=m,e.write=fe,e.writeFile=K,e.utils={cfb_new:vn,cfb_add:Da,cfb_del:an,cfb_mov:qt,cfb_gc:Kt,ReadShift:g0,CheckField:$N,prep_blob:ys,bconcat:is,use_zlib:j,_deflateRaw:qe,_inflateRaw:Be,consts:Z},e})();function H8(t){return typeof t=="string"?_1(t):Array.isArray(t)?p8(t):t}function em(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=_1(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var a=r=="utf8"?jl(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,t);if(typeof Blob<"u"){var n=new Blob([H8(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,t);if(typeof saveAs<"u")return saveAs(n,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=t,l.href=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(t);return c.open("w"),c.encoding="binary",Array.isArray(e)&&(e=Su(e)),c.write(e),c.close(),e}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+t)}function $8(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+t)}function gn(t){for(var e=Object.keys(t),r=[],a=0;a<e.length;++a)Object.prototype.hasOwnProperty.call(t,e[a])&&r.push(e[a]);return r}function ww(t,e){for(var r=[],a=gn(t),n=0;n!==a.length;++n)r[t[a[n]][e]]==null&&(r[t[a[n]][e]]=a[n]);return r}function w1(t){for(var e=[],r=gn(t),a=0;a!==r.length;++a)e[t[r[a]]]=r[a];return e}function S1(t){for(var e=[],r=gn(t),a=0;a!==r.length;++a)e[t[r[a]]]=parseInt(r[a],10);return e}function W8(t){for(var e=[],r=gn(t),a=0;a!==r.length;++a)e[t[r[a]]]==null&&(e[t[r[a]]]=[]),e[t[r[a]]].push(r[a]);return e}var e1=new Date(1899,11,30,0,0,0);function Jn(t,e){var r=t.getTime(),a=e1.getTime()+(t.getTimezoneOffset()-e1.getTimezoneOffset())*6e4;return(r-a)/(1440*60*1e3)}var SN=new Date,V8=e1.getTime()+(SN.getTimezoneOffset()-e1.getTimezoneOffset())*6e4,Sw=SN.getTimezoneOffset();function N1(t){var e=new Date;return e.setTime(t*24*60*60*1e3+V8),e.getTimezoneOffset()!==Sw&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Sw)*6e4),e}function G8(t){var e=0,r=0,a=!1,n=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=n.length;++s)if(n[s]){switch(r=1,s>3&&(a=!0),n[s].slice(n[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[s].slice(n[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(n[s],10)}return e}var Nw=new Date("2017-02-19T19:06:09.000Z"),NN=isNaN(Nw.getFullYear())?new Date("2/19/17"):Nw,Y8=NN.getFullYear()==2017;function za(t,e){var r=new Date(t);if(Y8)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(NN.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return t.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Sf(t,e){if(Pr&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return jl(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return jl(fN(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return jl(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return jl(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var a=[],n=0;n!=t.length;++n)a.push(String.fromCharCode(t[n]));return a.join("")}function Ha(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Ha(t[r]));return e}function mn(t,e){for(var r="";r.length<e;)r+=t;return r}function Xo(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,a=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,s){return r=-r,s}),!isNaN(e=Number(a)))?e/r:e}var X8=["january","february","march","april","may","june","july","august","september","october","november","december"];function lh(t){var e=new Date(t),r=new Date(NaN),a=e.getYear(),n=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var l=t.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&X8.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||s>1)&&a!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var K8=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(t||typeof a=="string")return r.split(a);for(var s=r.split(a),l=[s[0]],c=1;c<s.length;++c)l.push(n),l.push(s[c]);return l}})();function jN(t){return t?t.content&&t.type?Sf(t.content,!0):t.data?u0(t.data):t.asNodeBuffer&&Pr?u0(t.asNodeBuffer().toString("binary")):t.asBinary?u0(t.asBinary()):t._data&&t._data.getContent?u0(Sf(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function kN(t){if(!t)return null;if(t.data)return dw(t.data);if(t.asNodeBuffer&&Pr)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?dw(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function J8(t){return t&&t.name.slice(-4)===".bin"?kN(t):jN(t)}function lo(t,e){for(var r=t.FullPaths||gn(t.files),a=e.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),s=0;s<r.length;++s){var l=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==l||n==l)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function m2(t,e){var r=lo(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Pn(t,e,r){if(!r)return J8(m2(t,e));if(!e)return null;try{return Pn(t,e)}catch{return null}}function Ii(t,e,r){if(!r)return jN(m2(t,e));if(!e)return null;try{return Ii(t,e)}catch{return null}}function Z8(t,e,r){return kN(m2(t,e))}function jw(t){for(var e=t.FullPaths||gn(t.files),r=[],a=0;a<e.length;++a)e[a].slice(-1)!="/"&&r.push(e[a].replace(/^Root Entry[\/]/,""));return r.sort()}function Dr(t,e,r){if(t.FullPaths){if(typeof r=="string"){var a;return Pr?a=_c(r):a=g8(r),hr.utils.cfb_add(t,e,a)}hr.utils.cfb_add(t,e,r)}else t.file(e,r)}function p2(){return hr.utils.cfb_new()}function EN(t,e){switch(e.type){case"base64":return hr.read(t,{type:"base64"});case"binary":return hr.read(t,{type:"binary"});case"buffer":case"array":return hr.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function d0(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var a=t.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var Cn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Q8=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,kw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,eO=/<[^>]*>/g,Ms=Cn.match(kw)?kw:eO,tO=/<\w*:/,rO=/<(\/?)\w+:/;function Sr(t,e,r){for(var a={},n=0,s=0;n!==t.length&&!((s=t.charCodeAt(n))===32||s===10||s===13);++n);if(e||(a[0]=t.slice(0,n)),n===t.length)return a;var l=t.match(Q8),c=0,f="",d=0,m="",v="",x=1;if(l)for(d=0;d!=l.length;++d){for(v=l[d],s=0;s!=v.length&&v.charCodeAt(s)!==61;++s);for(m=v.slice(0,s).trim();v.charCodeAt(s+1)==32;)++s;for(x=(n=v.charCodeAt(s+1))==34||n==39?1:0,f=v.slice(s+1+x,v.length-x),c=0;c!=m.length&&m.charCodeAt(c)!==58;++c);if(c===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),a[m]=f,a[m.toLowerCase()]=f;else{var g=(c===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(c+1);if(a[g]&&m.slice(c-3,c)=="ext")continue;a[g]=f,a[g.toLowerCase()]=f}}return a}function Al(t){return t.replace(rO,"<$1")}var AN={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},g2=w1(AN),ea=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",s=n.indexOf("<![CDATA[");if(s==-1)return n.replace(t,function(c,f){return AN[c]||String.fromCharCode(parseInt(f,c.indexOf("x")>-1?16:10))||c}).replace(e,function(c,f){return String.fromCharCode(parseInt(f,16))});var l=n.indexOf("]]>");return r(n.slice(0,s))+n.slice(s+9,l)+r(n.slice(l+3))}})(),v2=/[&<>'"]/g,aO=/[\u0000-\u0008\u000b-\u001f]/g;function xa(t){var e=t+"";return e.replace(v2,function(r){return g2[r]}).replace(aO,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Ew(t){return xa(t).replace(/ /g,"_x0020_")}var CN=/[\u0000-\u001f]/g;function x2(t){var e=t+"";return e.replace(v2,function(r){return g2[r]}).replace(/\n/g,"<br/>").replace(CN,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function nO(t){var e=t+"";return e.replace(v2,function(r){return g2[r]}).replace(CN,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Aw=(function(){var t=/&#(\d+);/g;function e(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(t,e)}})();function sO(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ua(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function cv(t){for(var e="",r=0,a=0,n=0,s=0,l=0,c=0;r<t.length;){if(a=t.charCodeAt(r++),a<128){e+=String.fromCharCode(a);continue}if(n=t.charCodeAt(r++),a>191&&a<224){l=(a&31)<<6,l|=n&63,e+=String.fromCharCode(l);continue}if(s=t.charCodeAt(r++),a<240){e+=String.fromCharCode((a&15)<<12|(n&63)<<6|s&63);continue}l=t.charCodeAt(r++),c=((a&7)<<18|(n&63)<<12|(s&63)<<6|l&63)-65536,e+=String.fromCharCode(55296+(c>>>10&1023)),e+=String.fromCharCode(56320+(c&1023))}return e}function Cw(t){var e=vu(2*t.length),r,a,n=1,s=0,l=0,c;for(a=0;a<t.length;a+=n)n=1,(c=t.charCodeAt(a))<128?r=c:c<224?(r=(c&31)*64+(t.charCodeAt(a+1)&63),n=2):c<240?(r=(c&15)*4096+(t.charCodeAt(a+1)&63)*64+(t.charCodeAt(a+2)&63),n=3):(n=4,r=(c&7)*262144+(t.charCodeAt(a+1)&63)*4096+(t.charCodeAt(a+2)&63)*64+(t.charCodeAt(a+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(e[s++]=l&255,e[s++]=l>>>8,l=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function Tw(t){return _c(t,"binary").toString("utf8")}var mp="foo bar baz",ka=Pr&&(Tw(mp)==cv(mp)&&Tw||Cw(mp)==cv(mp)&&Cw)||cv,jl=Pr?function(t){return _c(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,a=0,n=0;r<t.length;)switch(a=t.charCodeAt(r++),!0){case a<128:e.push(String.fromCharCode(a));break;case a<2048:e.push(String.fromCharCode(192+(a>>6))),e.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=t.charCodeAt(r++)-56320+(a<<10),e.push(String.fromCharCode(240+(n>>18&7))),e.push(String.fromCharCode(144+(n>>12&63))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)));break;default:e.push(String.fromCharCode(224+(a>>12))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)))}return e.join("")},M0=(function(){var t={};return function(r,a){var n=r+"|"+(a||"");return t[n]?t[n]:t[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}})(),TN=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<t.length;++n)a=a.replace(t[n][0],t[n][1]);return a}})(),iO=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),oO=/<\/?(?:vt:)?variant>/g,lO=/<(?:vt:)([^>]*)>([\s\S]*)</;function Ow(t,e){var r=Sr(t),a=t.match(iO(r.baseType))||[],n=[];if(a.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(s){var l=s.replace(oO,"").match(lO);l&&n.push({v:ka(l[2]),t:l[1]})}),n}var ON=/(^\s|\s$|\n)/;function _s(t,e){return"<"+t+(e.match(ON)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function I0(t){return gn(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Mt(t,e,r){return"<"+t+(r!=null?I0(r):"")+(e!=null?(e.match(ON)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function bx(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function cO(t,e){switch(typeof t){case"string":var r=Mt("vt:lpwstr",xa(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Mt((t|0)==t?"vt:i4":"vt:r8",xa(String(t)));case"boolean":return Mt("vt:bool",t?"true":"false")}if(t instanceof Date)return Mt("vt:filetime",bx(t));throw new Error("Unable to serialize "+t)}function y2(t){if(Pr&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return ka(Su(f2(t)));throw new Error("Bad input format: expected Buffer or string")}var B0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Kn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Df=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Di={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function uO(t,e){for(var r=1-2*(t[e+7]>>>7),a=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),n=t[e+6]&15,s=5;s>=0;--s)n=n*256+t[e+s];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function fO(t,e,r){var a=(e<0||1/e==-1/0?1:0)<<7,n=0,s=0,l=a?-e:e;isFinite(l)?l==0?n=s=0:(n=Math.floor(Math.log(l)/Math.LN2),s=l*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(e)?26985:0);for(var c=0;c<=5;++c,s/=256)t[r+c]=s&255;t[r+6]=(n&15)<<4|s&15,t[r+7]=n>>4|a}var Rw=function(t){for(var e=[],r=10240,a=0;a<t[0].length;++a)if(t[0][a])for(var n=0,s=t[0][a].length;n<s;n+=r)e.push.apply(e,t[0][a].slice(n,n+r));return e},Dw=Pr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:_c(e)})):Rw(t)}:Rw,Fw=function(t,e,r){for(var a=[],n=e;n<r;n+=2)a.push(String.fromCharCode(cc(t,n)));return a.join("").replace(Gs,"")},_2=Pr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Gs,""):Fw(t,e,r)}:Fw,Lw=function(t,e,r){for(var a=[],n=e;n<e+r;++n)a.push(("0"+t[n].toString(16)).slice(-2));return a.join("")},RN=Pr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Lw(t,e,r)}:Lw,Pw=function(t,e,r){for(var a=[],n=e;n<r;n++)a.push(String.fromCharCode(Wd(t,n)));return a.join("")},tm=Pr?function(e,r,a){return Buffer.isBuffer(e)?e.toString("utf8",r,a):Pw(e,r,a)}:Pw,DN=function(t,e){var r=Fi(t,e);return r>0?tm(t,e+4,e+4+r-1):""},FN=DN,LN=function(t,e){var r=Fi(t,e);return r>0?tm(t,e+4,e+4+r-1):""},PN=LN,MN=function(t,e){var r=2*Fi(t,e);return r>0?tm(t,e+4,e+4+r-1):""},IN=MN,BN=function(e,r){var a=Fi(e,r);return a>0?_2(e,r+4,r+4+a):""},UN=BN,qN=function(t,e){var r=Fi(t,e);return r>0?tm(t,e+4,e+4+r):""},zN=qN,HN=function(t,e){return uO(t,e)},t1=HN,b2=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Pr&&(FN=function(e,r){if(!Buffer.isBuffer(e))return DN(e,r);var a=e.readUInt32LE(r);return a>0?e.toString("utf8",r+4,r+4+a-1):""},PN=function(e,r){if(!Buffer.isBuffer(e))return LN(e,r);var a=e.readUInt32LE(r);return a>0?e.toString("utf8",r+4,r+4+a-1):""},IN=function(e,r){if(!Buffer.isBuffer(e))return MN(e,r);var a=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+a-1)},UN=function(e,r){if(!Buffer.isBuffer(e))return BN(e,r);var a=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+a)},zN=function(e,r){if(!Buffer.isBuffer(e))return qN(e,r);var a=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+a)},t1=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):HN(e,r)},b2=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Wd=function(t,e){return t[e]},cc=function(t,e){return t[e+1]*256+t[e]},dO=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Fi=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},ff=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},hO=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function g0(t,e){var r="",a,n,s=[],l,c,f,d;switch(e){case"dbcs":if(d=this.l,Pr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(f=0;f<t;++f)r+=String.fromCharCode(cc(this,d)),d+=2;t*=2;break;case"utf8":r=tm(this,this.l,this.l+t);break;case"utf16le":t*=2,r=_2(this,this.l,this.l+t);break;case"wstr":return g0.call(this,t,"dbcs");case"lpstr-ansi":r=FN(this,this.l),t=4+Fi(this,this.l);break;case"lpstr-cp":r=PN(this,this.l),t=4+Fi(this,this.l);break;case"lpwstr":r=IN(this,this.l),t=4+2*Fi(this,this.l);break;case"lpp4":t=4+Fi(this,this.l),r=UN(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Fi(this,this.l),r=zN(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(l=Wd(this,this.l+t++))!==0;)s.push(hp(l));r=s.join("");break;case"_wstr":for(t=0,r="";(l=cc(this,this.l+t))!==0;)s.push(hp(l)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",d=this.l,f=0;f<t;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Wd(this,d),this.l=d+1,c=g0.call(this,t-f,l?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(hp(cc(this,d))),d+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,f=0;f!=t;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Wd(this,d),this.l=d+1,c=g0.call(this,t-f,l?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(hp(Wd(this,d))),d+=1}r=s.join("");break;default:switch(t){case 1:return a=Wd(this,this.l),this.l++,a;case 2:return a=(e==="i"?dO:cc)(this,this.l),this.l+=2,a;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(a=(t>0?ff:hO)(this,this.l),this.l+=4,a):(n=Fi(this,this.l),this.l+=4,n);case 8:case-8:if(e==="f")return t==8?n=t1(this,this.l):n=t1([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;t=8;case 16:r=RN(this,this.l,t);break}}return this.l+=t,r}var mO=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},pO=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},gO=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function vO(t,e,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=e.length;++n)gO(this,e.charCodeAt(n),this.l+2*n);a=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=e.length;++n)this[this.l+n]=e.charCodeAt(n)&255;a=e.length}else if(r==="hex"){for(;n<t;++n)this[this.l++]=parseInt(e.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(n=0;n<Math.min(e.length,t);++n){var l=e.charCodeAt(n);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:a=1,this[this.l]=e&255;break;case 2:a=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:a=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:a=4,mO(this,e,this.l);break;case 8:if(a=8,r==="f"){fO(this,e,this.l);break}case 16:break;case-4:a=4,pO(this,e,this.l);break}return this.l+=a,this}function $N(t,e){var r=RN(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function ys(t,e){t.l=e,t.read_shift=g0,t.chk=$N,t.write_shift=vO}function Ps(t,e){t.l+=e}function ft(t){var e=vu(t);return ys(e,0),e}function bc(t,e,r){if(t){var a,n,s;ys(t,t.l||0);for(var l=t.length,c=0,f=0;t.l<l;){c=t.read_shift(1),c&128&&(c=(c&127)+((t.read_shift(1)&127)<<7));var d=W0[c]||W0[65535];for(a=t.read_shift(1),s=a&127,n=1;n<4&&a&128;++n)s+=((a=t.read_shift(1))&127)<<7*n;f=t.l+s;var m=d.f&&d.f(t,s,r);if(t.l=f,e(m,d,c))return}}}function hi(){var t=[],e=Pr?256:2048,r=function(d){var m=ft(d);return ys(m,0),m},a=r(e),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&t.push(a),a=null)},s=function(d){return a&&d<a.length-a.l?a:(n(),a=r(Math.max(d+1,e)))},l=function(){return n(),is(t)},c=function(d){n(),a=d,a.l==null&&(a.l=a.length),s(e)};return{next:s,push:c,end:l,_bufs:t}}function bt(t,e,r,a){var n=+e,s;if(!isNaN(n)){a||(a=W0[n].p||(r||[]).length||0),s=1+(n>=128?1:0)+1,a>=128&&++s,a>=16384&&++s,a>=2097152&&++s;var l=t.next(s);n<=127?l.write_shift(1,n):(l.write_shift(1,(n&127)+128),l.write_shift(1,n>>7));for(var c=0;c!=4;++c)if(a>=128)l.write_shift(1,(a&127)+128),a>>=7;else{l.write_shift(1,a);break}a>0&&b2(r)&&t.push(r)}}function v0(t,e,r){var a=Ha(t);if(e.s?(a.cRel&&(a.c+=e.s.c),a.rRel&&(a.r+=e.s.r)):(a.cRel&&(a.c+=e.c),a.rRel&&(a.r+=e.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function Mw(t,e,r){var a=Ha(t);return a.s=v0(a.s,e.s,r),a.e=v0(a.e,e.s,r),a}function x0(t,e){if(t.cRel&&t.c<0)for(t=Ha(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Ha(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=wr(t);return!t.cRel&&t.cRel!=null&&(r=_O(r)),!t.rRel&&t.rRel!=null&&(r=xO(r)),r}function uv(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+tn(t.s.c)+":"+(t.e.cRel?"":"$")+tn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+An(t.s.r)+":"+(t.e.rRel?"":"$")+An(t.e.r):x0(t.s,e.biff)+":"+x0(t.e,e.biff)}function w2(t){return parseInt(yO(t),10)-1}function An(t){return""+(t+1)}function xO(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function yO(t){return t.replace(/\$(\d+)$/,"$1")}function S2(t){for(var e=bO(t),r=0,a=0;a!==e.length;++a)r=26*r+e.charCodeAt(a)-64;return r-1}function tn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function _O(t){return t.replace(/^([A-Z])/,"$$$1")}function bO(t){return t.replace(/^\$([A-Z])/,"$1")}function wO(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function rn(t){for(var e=0,r=0,a=0;a<t.length;++a){var n=t.charCodeAt(a);n>=48&&n<=57?e=10*e+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:e-1}}function wr(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function mi(t){var e=t.indexOf(":");return e==-1?{s:rn(t),e:rn(t)}:{s:rn(t.slice(0,e)),e:rn(t.slice(e+1))}}function Or(t,e){return typeof e>"u"||typeof e=="number"?Or(t.s,t.e):(typeof t!="string"&&(t=wr(t)),typeof e!="string"&&(e=wr(e)),t==e?t:t+":"+e)}function ta(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,s=t.length;for(r=0;a<s&&!((n=t.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(e.s.c=--r,r=0;a<s&&!((n=t.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(e.s.r=--r,a===s||n!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++a,r=0;a!=s&&!((n=t.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(e.e.c=--r,r=0;a!=s&&!((n=t.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return e.e.r=--r,e}function Iw(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=fo(t.z,r?Jn(e):e)}catch{}try{return t.w=fo((t.XF||{}).numFmtId||(r?14:0),r?Jn(e):e)}catch{return""+e}}function pc(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?wc[t.v]||t.v:e==null?Iw(t,t.v):Iw(t,e))}function Nu(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",a={};return a[r]=t,{SheetNames:[r],Sheets:a}}function WN(t,e,r){var a=r||{},n=t?Array.isArray(t):a.dense,s=t||(n?[]:{}),l=0,c=0;if(s&&a.origin!=null){if(typeof a.origin=="number")l=a.origin;else{var f=typeof a.origin=="string"?rn(a.origin):a.origin;l=f.r,c=f.c}s["!ref"]||(s["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var m=ta(s["!ref"]);d.s.c=m.s.c,d.s.r=m.s.r,d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),l==-1&&(d.e.r=l=m.e.r+1)}for(var v=0;v!=e.length;++v)if(e[v]){if(!Array.isArray(e[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=e[v].length;++x)if(!(typeof e[v][x]>"u")){var g={v:e[v][x]},b=l+v,_=c+x;if(d.s.r>b&&(d.s.r=b),d.s.c>_&&(d.s.c=_),d.e.r<b&&(d.e.r=b),d.e.c<_&&(d.e.c=_),e[v][x]&&typeof e[v][x]=="object"&&!Array.isArray(e[v][x])&&!(e[v][x]instanceof Date))g=e[v][x];else if(Array.isArray(g.v)&&(g.f=e[v][x][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(a.nullError)g.t="e",g.v=0;else if(a.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=a.dateNF||br[14],a.cellDates?(g.t="d",g.w=fo(g.z,Jn(g.v))):(g.t="n",g.v=Jn(g.v),g.w=fo(g.z,g.v))):g.t="s";if(n)s[b]||(s[b]=[]),s[b][_]&&s[b][_].z&&(g.z=s[b][_].z),s[b][_]=g;else{var w=wr({c:_,r:b});s[w]&&s[w].z&&(g.z=s[w].z),s[w]=g}}}return d.s.c<1e7&&(s["!ref"]=Or(d)),s}function xh(t,e){return WN(null,t,e)}function SO(t){return t.read_shift(4,"i")}function Ko(t,e){return e||(e=ft(4)),e.write_shift(4,t),e}function Ls(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function os(t,e){var r=!1;return e==null&&(r=!0,e=ft(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function NO(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function jO(t,e){return e||(e=ft(4)),e.write_shift(2,0),e.write_shift(2,0),e}function N2(t,e){var r=t.l,a=t.read_shift(1),n=Ls(t),s=[],l={t:n,h:n};if((a&1)!==0){for(var c=t.read_shift(4),f=0;f!=c;++f)s.push(NO(t));l.r=s}else l.r=[{ich:0,ifnt:0}];return t.l=r+e,l}function kO(t,e){var r=!1;return e==null&&(r=!0,e=ft(15+4*t.t.length)),e.write_shift(1,0),os(t.t,e),r?e.slice(0,e.l):e}var EO=N2;function AO(t,e){var r=!1;return e==null&&(r=!0,e=ft(23+4*t.t.length)),e.write_shift(1,1),os(t.t,e),e.write_shift(4,1),jO({},e),r?e.slice(0,e.l):e}function mo(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Ff(t,e){return e==null&&(e=ft(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Lf(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Pf(t,e){return e==null&&(e=ft(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var CO=Ls,VN=os;function j2(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function r1(t,e){var r=!1;return e==null&&(r=!0,e=ft(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var TO=Ls,wx=j2,k2=r1;function E2(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,a=e[0]&2;t.l+=4;var n=a===0?t1([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):ff(e,0)>>2;return r?n/100:n}function GN(t,e){e==null&&(e=ft(4));var r=0,a=0,n=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?a=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(a=1,r=1),a)e.write_shift(-4,((r?n:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function YN(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function OO(t,e){return e||(e=ft(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Mf=YN,yh=OO;function Fs(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Nf(t,e){return(e||ft(8)).write_shift(8,t,"f")}function RO(t){var e={},r=t.read_shift(1),a=r>>>1,n=t.read_shift(1),s=t.read_shift(2,"i"),l=t.read_shift(1),c=t.read_shift(1),f=t.read_shift(1);switch(t.l++,a){case 0:e.auto=1;break;case 1:e.index=n;var d=vf[n];d&&(e.rgb=q0(d));break;case 2:e.rgb=q0([l,c,f]);break;case 3:e.theme=n;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function a1(t,e){if(e||(e=ft(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var a=t.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),e.write_shift(1,parseInt(a.slice(0,2),16)),e.write_shift(1,parseInt(a.slice(2,4),16)),e.write_shift(1,parseInt(a.slice(4,6),16)),e.write_shift(1,255)}return e}function DO(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function FO(t,e){e||(e=ft(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function XN(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=t.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function LO(t){return XN(t,1)}function PO(t){return XN(t,2)}var A2=2,di=3,pp=11,Bw=12,n1=19,gp=64,MO=65,IO=71,BO=4108,UO=4126,ns=80,KN=81,qO=[ns,KN],Sx={1:{n:"CodePage",t:A2},2:{n:"Category",t:ns},3:{n:"PresentationFormat",t:ns},4:{n:"ByteCount",t:di},5:{n:"LineCount",t:di},6:{n:"ParagraphCount",t:di},7:{n:"SlideCount",t:di},8:{n:"NoteCount",t:di},9:{n:"HiddenCount",t:di},10:{n:"MultimediaClipCount",t:di},11:{n:"ScaleCrop",t:pp},12:{n:"HeadingPairs",t:BO},13:{n:"TitlesOfParts",t:UO},14:{n:"Manager",t:ns},15:{n:"Company",t:ns},16:{n:"LinksUpToDate",t:pp},17:{n:"CharacterCount",t:di},19:{n:"SharedDoc",t:pp},22:{n:"HyperlinksChanged",t:pp},23:{n:"AppVersion",t:di,p:"version"},24:{n:"DigSig",t:MO},26:{n:"ContentType",t:ns},27:{n:"ContentStatus",t:ns},28:{n:"Language",t:ns},29:{n:"Version",t:ns},255:{},2147483648:{n:"Locale",t:n1},2147483651:{n:"Behavior",t:n1},1919054434:{}},Nx={1:{n:"CodePage",t:A2},2:{n:"Title",t:ns},3:{n:"Subject",t:ns},4:{n:"Author",t:ns},5:{n:"Keywords",t:ns},6:{n:"Comments",t:ns},7:{n:"Template",t:ns},8:{n:"LastAuthor",t:ns},9:{n:"RevNumber",t:ns},10:{n:"EditTime",t:gp},11:{n:"LastPrinted",t:gp},12:{n:"CreatedDate",t:gp},13:{n:"ModifiedDate",t:gp},14:{n:"PageCount",t:di},15:{n:"WordCount",t:di},16:{n:"CharCount",t:di},17:{n:"Thumbnail",t:IO},18:{n:"Application",t:ns},19:{n:"DocSecurity",t:di},255:{},2147483648:{n:"Locale",t:n1},2147483651:{n:"Behavior",t:n1},1919054434:{}},Uw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},zO=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function HO(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var $O=HO([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),vf=Ha($O),wc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},JN={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},jx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},vp={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function C2(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function WO(t){var e=C2();if(!t||!t.match)return e;var r={};if((t.match(Ms)||[]).forEach(function(a){var n=Sr(a);switch(n[0].replace(tO,"<")){case"<?xml":break;case"<Types":e.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":e[jx[n.ContentType]]!==void 0&&e[jx[n.ContentType]].push(n.PartName);break}}),e.xmlns!==Kn.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function ZN(t,e){var r=W8(jx),a=[],n;a[a.length]=Cn,a[a.length]=Mt("Types",null,{xmlns:Kn.CT,"xmlns:xsd":Kn.xsd,"xmlns:xsi":Kn.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Mt("Default",null,{Extension:f[0],ContentType:f[1]})}));var s=function(f){t[f]&&t[f].length>0&&(n=t[f][0],a[a.length]=Mt("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:vp[f][e.bookType]||vp[f].xlsx}))},l=function(f){(t[f]||[]).forEach(function(d){a[a.length]=Mt("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:vp[f][e.bookType]||vp[f].xlsx})})},c=function(f){(t[f]||[]).forEach(function(d){a[a.length]=Mt("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[f][0]})})};return s("workbooks"),l("sheets"),l("charts"),c("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),l("metadata"),c("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var Ir={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function U0(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function y0(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var a={};return(t.match(Ms)||[]).forEach(function(n){var s=Sr(n);if(s[0]==="<Relationship"){var l={};l.Type=s.Type,l.Target=s.Target,l.Id=s.Id,s.TargetMode&&(l.TargetMode=s.TargetMode);var c=s.TargetMode==="External"?s.Target:d0(s.Target,e);r[c]=l,a[s.Id]=l}}),r["!id"]=a,r}function Qd(t){var e=[Cn,Mt("Relationships",null,{xmlns:Kn.RELS})];return gn(t["!id"]).forEach(function(r){e[e.length]=Mt("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function ga(t,e,r,a,n,s){if(n||(n={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,n.Id="rId"+e,n.Type=a,n.Target=r,[Ir.HLINK,Ir.XPATH,Ir.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),t["!id"][n.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][n.Id]=n,t[("/"+n.Target).replace("//","/")]=n,e}var VO="application/vnd.oasis.opendocument.spreadsheet";function GO(t,e){for(var r=y2(t),a,n;a=B0.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=Sr(a[0],!1),n.path=="/"&&n.type!==VO)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw a}}function YO(t){var e=[Cn];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function qw(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function XO(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function KO(t){var e=[Cn];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(qw(t[r][0],t[r][1])),e.push(XO("",t[r][0]));return e.push(qw("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function QN(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Kp.version+"</meta:generator></office:meta></office:document-meta>"}var uo=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],JO=(function(){for(var t=new Array(uo.length),e=0;e<uo.length;++e){var r=uo[e],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return t})();function e3(t){var e={};t=ka(t);for(var r=0;r<uo.length;++r){var a=uo[r],n=t.match(JO[r]);n!=null&&n.length>0&&(e[a[1]]=ea(n[1])),a[2]==="date"&&e[a[1]]&&(e[a[1]]=za(e[a[1]]))}return e}function fv(t,e,r,a,n){n[t]!=null||e==null||e===""||(n[t]=e,e=xa(e),a[a.length]=r?Mt(t,e,r):_s(t,e))}function t3(t,e){var r=e||{},a=[Cn,Mt("cp:coreProperties",null,{"xmlns:cp":Kn.CORE_PROPS,"xmlns:dc":Kn.dc,"xmlns:dcterms":Kn.dcterms,"xmlns:dcmitype":Kn.dcmitype,"xmlns:xsi":Kn.xsi})],n={};if(!t&&!r.Props)return a.join("");t&&(t.CreatedDate!=null&&fv("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:bx(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),t.ModifiedDate!=null&&fv("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:bx(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var s=0;s!=uo.length;++s){var l=uo[s],c=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:t?t[l[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&fv(l[0],c,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var xf=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],r3=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function a3(t,e,r,a){var n=[];if(typeof t=="string")n=Ow(t,a);else for(var s=0;s<t.length;++s)n=n.concat(t[s].map(function(m){return{v:m}}));var l=typeof e=="string"?Ow(e,a).map(function(m){return m.v}):e,c=0,f=0;if(l.length>0)for(var d=0;d!==n.length;d+=2){switch(f=+n[d+1].v,n[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=f,r.SheetNames=l.slice(c,c+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=f,r.DefinedNames=l.slice(c,c+f);break;case"Charts":case"Diagramme":r.Chartsheets=f,r.ChartNames=l.slice(c,c+f);break}c+=f}}function ZO(t,e,r){var a={};return e||(e={}),t=ka(t),xf.forEach(function(n){var s=(t.match(M0(n[0]))||[])[1];switch(n[2]){case"string":s&&(e[n[1]]=ea(s));break;case"bool":e[n[1]]=s==="true";break;case"raw":var l=t.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));l&&l.length>0&&(a[n[1]]=l[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&a3(a.HeadingPairs,a.TitlesOfParts,e,r),e}function n3(t){var e=[],r=Mt;return t||(t={}),t.Application="SheetJS",e[e.length]=Cn,e[e.length]=Mt("Properties",null,{xmlns:Kn.EXT_PROPS,"xmlns:vt":Kn.vt}),xf.forEach(function(a){if(t[a[1]]!==void 0){var n;switch(a[2]){case"string":n=xa(String(t[a[1]]));break;case"bool":n=t[a[1]]?"true":"false";break}n!==void 0&&(e[e.length]=r(a[0],n))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(a){return"<vt:lpstr>"+xa(a)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var QO=/<[^>]+>[^<]*/g;function e7(t,e){var r={},a="",n=t.match(QO);if(n)for(var s=0;s!=n.length;++s){var l=n[s],c=Sr(l);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":a=ea(c.name);break;case"</property>":a=null;break;default:if(l.indexOf("<vt:")===0){var f=l.split(">"),d=f[0].slice(4),m=f[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[a]=ea(m);break;case"bool":r[a]=Ua(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(m,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(m);break;case"filetime":case"date":r[a]=za(m);break;case"cy":case"error":r[a]=ea(m);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",l,d,f)}}else if(l.slice(0,2)!=="</"){if(e.WTF)throw new Error(l)}}}return r}function s3(t){var e=[Cn,Mt("Properties",null,{xmlns:Kn.CUST_PROPS,"xmlns:vt":Kn.vt})];if(!t)return e.join("");var r=1;return gn(t).forEach(function(n){++r,e[e.length]=Mt("property",cO(t[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:xa(n)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var kx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},dv;function t7(t,e,r){dv||(dv=w1(kx)),e=dv[e]||e,t[e]=r}function r7(t,e){var r=[];return gn(kx).map(function(a){for(var n=0;n<uo.length;++n)if(uo[n][1]==a)return uo[n];for(n=0;n<xf.length;++n)if(xf[n][1]==a)return xf[n];throw a}).forEach(function(a){if(t[a[1]]!=null){var n=e&&e.Props&&e.Props[a[1]]!=null?e.Props[a[1]]:t[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(_s(kx[a[1]]||a[1],n))}}),Mt("DocumentProperties",r.join(""),{xmlns:Di.o})}function a7(t,e){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return t&&gn(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var l=0;l<uo.length;++l)if(s==uo[l][1])return;for(l=0;l<xf.length;++l)if(s==xf[l][1])return;for(l=0;l<r.length;++l)if(s==r[l])return;var c=t[s],f="string";typeof c=="number"?(f="float",c=String(c)):c===!0||c===!1?(f="boolean",c=c?"1":"0"):c=String(c),n.push(Mt(Ew(s),c,{"dt:dt":f}))}}),e&&gn(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var l=e[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l instanceof Date?(c="dateTime.tz",l=l.toISOString()):l=String(l),n.push(Mt(Ew(s),l,{"dt:dt":c}))}}),"<"+a+' xmlns="'+Di.o+'">'+n.join("")+"</"+a+">"}function T2(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function n7(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var s=a/Math.pow(2,32)|0;s>0&&(a=a%Math.pow(2,32),n+=s);var l=ft(8);return l.write_shift(4,a),l.write_shift(4,n),l}function i3(t,e,r){var a=t.l,n=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-a&3;)++t.l;return n}function o3(t,e,r){var a=t.read_shift(0,"lpwstr");return a}function l3(t,e,r){return e===31?o3(t):i3(t,e,r)}function Ex(t,e,r){return l3(t,e,r===!1?0:4)}function s7(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return l3(t,e,0)}function i7(t){for(var e=t.read_shift(4),r=[],a=0;a!=e;++a){var n=t.l;r[a]=t.read_shift(0,"lpwstr").replace(Gs,""),t.l-n&2&&(t.l+=2)}return r}function o7(t){for(var e=t.read_shift(4),r=[],a=0;a!=e;++a)r[a]=t.read_shift(0,"lpstr-cp").replace(Gs,"");return r}function l7(t){var e=t.l,r=s1(t,KN);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var a=s1(t,di);return[r,a]}function c7(t){for(var e=t.read_shift(4),r=[],a=0;a<e/2;++a)r.push(l7(t));return r}function zw(t,e){for(var r=t.read_shift(4),a={},n=0;n!=r;++n){var s=t.read_shift(4),l=t.read_shift(4);a[s]=t.read_shift(l,e===1200?"utf16le":"utf8").replace(Gs,"").replace(f0,"!"),e===1200&&l%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),a}function c3(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function u7(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function s1(t,e,r){var a=t.read_shift(2),n,s=r||{};if(t.l+=2,e!==Bw&&a!==e&&qO.indexOf(e)===-1&&!((e&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+e+" saw "+a);switch(e===Bw?a:e){case 2:return n=t.read_shift(2,"i"),s.raw||(t.l+=2),n;case 3:return n=t.read_shift(4,"i"),n;case 11:return t.read_shift(4)!==0;case 19:return n=t.read_shift(4),n;case 30:return i3(t,a,4).replace(Gs,"");case 31:return o3(t);case 64:return T2(t);case 65:return c3(t);case 71:return u7(t);case 80:return Ex(t,a,!s.raw).replace(Gs,"");case 81:return s7(t,a).replace(Gs,"");case 4108:return c7(t);case 4126:case 4127:return a==4127?i7(t):o7(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+a)}}function Hw(t,e){var r=ft(4),a=ft(4);switch(r.write_shift(4,t==80?31:t),t){case 3:a.write_shift(-4,e);break;case 5:a=ft(8),a.write_shift(8,e,"f");break;case 11:a.write_shift(4,e?1:0);break;case 64:a=n7(e);break;case 31:case 80:for(a=ft(4+2*(e.length+1)+(e.length%2?0:2)),a.write_shift(4,e.length+1),a.write_shift(0,e,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return is([r,a])}function $w(t,e){var r=t.l,a=t.read_shift(4),n=t.read_shift(4),s=[],l=0,c=0,f=-1,d={};for(l=0;l!=n;++l){var m=t.read_shift(4),v=t.read_shift(4);s[l]=[m,v+r]}s.sort(function(C,A){return C[1]-A[1]});var x={};for(l=0;l!=n;++l){if(t.l!==s[l][1]){var g=!0;if(l>0&&e)switch(e[s[l-1][0]].t){case 2:t.l+2===s[l][1]&&(t.l+=2,g=!1);break;case 80:t.l<=s[l][1]&&(t.l=s[l][1],g=!1);break;case 4108:t.l<=s[l][1]&&(t.l=s[l][1],g=!1);break}if((!e||l==0)&&t.l<=s[l][1]&&(g=!1,t.l=s[l][1]),g)throw new Error("Read Error: Expected address "+s[l][1]+" at "+t.l+" :"+l)}if(e){var b=e[s[l][0]];if(x[b.n]=s1(t,b.t,{raw:!0}),b.p==="version"&&(x[b.n]=String(x[b.n]>>16)+"."+("0000"+String(x[b.n]&65535)).slice(-4)),b.n=="CodePage")switch(x[b.n]){case 0:x[b.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Go(c=x[b.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[b.n])}}else if(s[l][0]===1){if(c=x.CodePage=s1(t,A2),Go(c),f!==-1){var _=t.l;t.l=s[f][1],d=zw(t,c),t.l=_}}else if(s[l][0]===0){if(c===0){f=l,t.l=s[l+1][1];continue}d=zw(t,c)}else{var w=d[s[l][0]],E;switch(t[t.l]){case 65:t.l+=4,E=c3(t);break;case 30:t.l+=4,E=Ex(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,E=Ex(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,E=t.read_shift(4,"i");break;case 19:t.l+=4,E=t.read_shift(4);break;case 5:t.l+=4,E=t.read_shift(8,"f");break;case 11:t.l+=4,E=wn(t,4);break;case 64:t.l+=4,E=za(T2(t));break;default:throw new Error("unparsed value: "+t[t.l])}x[w]=E}}return t.l=r+a,x}var u3=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function f7(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function Ww(t,e,r){var a=ft(8),n=[],s=[],l=8,c=0,f=ft(8),d=ft(8);if(f.write_shift(4,2),f.write_shift(4,1200),d.write_shift(4,1),s.push(f),n.push(d),l+=8+f.length,!e){d=ft(8),d.write_shift(4,0),n.unshift(d);var m=[ft(4)];for(m[0].write_shift(4,t.length),c=0;c<t.length;++c){var v=t[c][0];for(f=ft(8+2*(v.length+1)+(v.length%2?0:2)),f.write_shift(4,c+2),f.write_shift(4,v.length+1),f.write_shift(0,v,"dbcs");f.l!=f.length;)f.write_shift(1,0);m.push(f)}f=is(m),s.unshift(f),l+=8+f.length}for(c=0;c<t.length;++c)if(!(e&&!e[t[c][0]])&&!(u3.indexOf(t[c][0])>-1||r3.indexOf(t[c][0])>-1)&&t[c][1]!=null){var x=t[c][1],g=0;if(e){g=+e[t[c][0]];var b=r[g];if(b.p=="version"&&typeof x=="string"){var _=x.split(".");x=(+_[0]<<16)+(+_[1]||0)}f=Hw(b.t,x)}else{var w=f7(x);w==-1&&(w=31,x=String(x)),f=Hw(w,x)}s.push(f),d=ft(8),d.write_shift(4,e?g:2+c),n.push(d),l+=8+f.length}var E=8*(s.length+1);for(c=0;c<s.length;++c)n[c].write_shift(4,E),E+=s[c].length;return a.write_shift(4,l),a.write_shift(4,s.length),is([a].concat(n).concat(s))}function Vw(t,e,r){var a=t.content;if(!a)return{};ys(a,0);var n,s,l,c,f=0;a.chk("feff","Byte Order: "),a.read_shift(2);var d=a.read_shift(4),m=a.read_shift(16);if(m!==hr.utils.consts.HEADER_CLSID&&m!==r)throw new Error("Bad PropertySet CLSID "+m);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(s=a.read_shift(16),c=a.read_shift(4),n===1&&c!==a.l)throw new Error("Length mismatch: "+c+" !== "+a.l);n===2&&(l=a.read_shift(16),f=a.read_shift(4));var v=$w(a,e),x={SystemIdentifier:d};for(var g in v)x[g]=v[g];if(x.FMTID=s,n===1)return x;if(f-a.l==2&&(a.l+=2),a.l!==f)throw new Error("Length mismatch 2: "+a.l+" !== "+f);var b;try{b=$w(a,null)}catch{}for(g in b)x[g]=b[g];return x.FMTID=[s,l],x}function Gw(t,e,r,a,n,s){var l=ft(n?68:48),c=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,hr.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,n?2:1),l.write_shift(16,e,"hex"),l.write_shift(4,n?68:48);var f=Ww(t,r,a);if(c.push(f),n){var d=Ww(n,null,null);l.write_shift(16,s,"hex"),l.write_shift(4,68+f.length),c.push(d)}return is(c)}function nu(t,e){return t.read_shift(e),null}function d7(t,e){e||(e=ft(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function h7(t,e,r){for(var a=[],n=t.l+e;t.l<n;)a.push(r(t,n-t.l));if(n!==t.l)throw new Error("Slurp error");return a}function wn(t,e){return t.read_shift(e)===1}function Vs(t,e){return e||(e=ft(2)),e.write_shift(2,+!!t),e}function Mn(t){return t.read_shift(2,"u")}function co(t,e){return e||(e=ft(2)),e.write_shift(2,t),e}function f3(t,e){return h7(t,e,Mn)}function m7(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function d3(t,e,r){return r||(r=ft(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function rm(t,e,r){var a=t.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var l=a?t.read_shift(a,n):"";return l}function p7(t){var e=t.read_shift(2),r=t.read_shift(1),a=r&4,n=r&8,s=1+(r&1),l=0,c,f={};n&&(l=t.read_shift(2)),a&&(c=t.read_shift(4));var d=s==2?"dbcs-cont":"sbcs-cont",m=e===0?"":t.read_shift(e,d);return n&&(t.l+=4*l),a&&(t.l+=c),f.t=m,n||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function g7(t){var e=t.t||"",r=ft(3);r.write_shift(2,e.length),r.write_shift(1,1);var a=ft(2*e.length);a.write_shift(2*e.length,e,"utf16le");var n=[r,a];return is(n)}function jf(t,e,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var n=t.read_shift(1);return n===0?a=t.read_shift(e,"sbcs-cont"):a=t.read_shift(e,"dbcs-cont"),a}function am(t,e,r){var a=t.read_shift(r&&r.biff==2?1:2);return a===0?(t.l++,""):jf(t,a,r)}function If(t,e,r){if(r.biff>5)return am(t,e,r);var a=t.read_shift(1);return a===0?(t.l++,""):t.read_shift(a,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function h3(t,e,r){return r||(r=ft(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function v7(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function x7(t){var e=t.read_shift(4),r=t.l,a=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),t.l=r);var n=t.read_shift((a?e-24:e)>>1,"utf16le").replace(Gs,"");return a&&(t.l+=24),n}function y7(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var a=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=t.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=t.read_shift(s>>1,"utf16le").replace(Gs,"");return r+l}function _7(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return x7(t);case"0303000000000000c000000000000046":return y7(t);default:throw new Error("Unsupported Moniker "+r)}}function xp(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Gs,""):"";return r}function Yw(t,e){e||(e=ft(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function b7(t,e){var r=t.l+e,a=t.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=t.read_shift(2);t.l+=2;var s,l,c,f,d="",m,v;n&16&&(s=xp(t,r-t.l)),n&128&&(l=xp(t,r-t.l)),(n&257)===257&&(c=xp(t,r-t.l)),(n&257)===1&&(f=_7(t,r-t.l)),n&8&&(d=xp(t,r-t.l)),n&32&&(m=t.read_shift(16)),n&64&&(v=T2(t)),t.l=r;var x=l||c||f||"";x&&d&&(x+="#"+d),x||(x="#"+d),n&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var g={Target:x};return m&&(g.guid=m),v&&(g.time=v),s&&(g.Tooltip=s),g}function w7(t){var e=ft(512),r=0,a=t.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),s=n>-1?31:23;switch(a.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)e.write_shift(4,l[r]);if(s==28)a=a.slice(1),Yw(a,e);else if(s&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)e.write_shift(1,parseInt(l[r],16));var c=n>-1?a.slice(0,n):a;for(e.write_shift(4,2*(c.length+1)),r=0;r<c.length;++r)e.write_shift(2,c.charCodeAt(r));e.write_shift(2,0),s&8&&Yw(n>-1?a.slice(n+1):"",e)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)e.write_shift(1,parseInt(l[r],16));for(var f=0;a.slice(f*3,f*3+3)=="../"||a.slice(f*3,f*3+3)=="..\\";)++f;for(e.write_shift(2,f),e.write_shift(4,a.length-3*f+1),r=0;r<a.length-3*f;++r)e.write_shift(1,a.charCodeAt(r+3*f)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function m3(t){var e=t.read_shift(1),r=t.read_shift(1),a=t.read_shift(1),n=t.read_shift(1);return[e,r,a,n]}function p3(t,e){var r=m3(t);return r[3]=0,r}function Cl(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);return{r:e,c:r,ixfe:a}}function kf(t,e,r,a){return a||(a=ft(6)),a.write_shift(2,t),a.write_shift(2,e),a.write_shift(2,r||0),a}function S7(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function N7(t,e,r){return e===0?"":If(t,e,r)}function j7(t,e,r){var a=r.biff>8?4:2,n=t.read_shift(a),s=t.read_shift(a,"i"),l=t.read_shift(a,"i");return[n,s,l]}function g3(t){var e=t.read_shift(2),r=E2(t);return[e,r]}function k7(t,e,r){t.l+=4,e-=4;var a=t.l+e,n=rm(t,e,r),s=t.read_shift(2);if(a-=t.l,s!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+s);return t.l+=s,n}function j1(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),n=t.read_shift(2);return{s:{c:a,r:e},e:{c:n,r}}}function v3(t,e){return e||(e=ft(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function x3(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(1),n=t.read_shift(1);return{s:{c:a,r:e},e:{c:n,r}}}var E7=x3;function y3(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);return t.l+=12,[r,e,a]}function A7(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function C7(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function ks(t){t.l+=2,t.l+=t.read_shift(2)}var T7={0:ks,4:ks,5:ks,6:ks,7:C7,8:ks,9:ks,10:ks,11:ks,12:ks,13:A7,14:ks,15:ks,16:ks,17:ks,18:ks,19:ks,20:ks,21:y3};function O7(t,e){for(var r=t.l+e,a=[];t.l<r;){var n=t.read_shift(2);t.l-=2;try{a.push(T7[n](t,r-t.l))}catch{return t.l=r,a}}return t.l!=r&&(t.l=r),a}function yp(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function O2(t,e,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ft(n);return s.write_shift(2,a),s.write_shift(2,e),n>4&&s.write_shift(2,29282),n>6&&s.write_shift(2,1997),n>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function R7(t,e){return e===0||t.read_shift(2),1200}function D7(t,e,r){if(r.enc)return t.l+=e,"";var a=t.l,n=If(t,0,r);return t.read_shift(e+a-t.l),n}function F7(t,e){var r=!e||e.biff==8,a=ft(r?112:54);for(a.write_shift(e.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function L7(t,e,r){var a=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function P7(t,e,r){var a=t.read_shift(4),n=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var l=rm(t,0,r);return l.length===0&&(l="Sheet1"),{pos:a,hs:n,dt:s,name:l}}function M7(t,e){var r=!e||e.biff>=8?2:1,a=ft(8+r*t.name.length);a.write_shift(4,t.pos),a.write_shift(1,t.hs||0),a.write_shift(1,t.dt),a.write_shift(1,t.name.length),e.biff>=8&&a.write_shift(1,1),a.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function I7(t,e){for(var r=t.l+e,a=t.read_shift(4),n=t.read_shift(4),s=[],l=0;l!=n&&t.l<r;++l)s.push(p7(t));return s.Count=a,s.Unique=n,s}function B7(t,e){var r=ft(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var a=[],n=0;n<t.length;++n)a[n]=g7(t[n]);var s=is([r].concat(a));return s.parts=[r.length].concat(a.map(function(l){return l.length})),s}function U7(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function q7(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var a=t.read_shift(1);return t.l+=3,a&7&&(e.level=a&7),a&32&&(e.hidden=!0),a&64&&(e.hpt=r/20),e}function z7(t){var e=S7(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function H7(t){return t.read_shift(2),t.read_shift(4)}function Xw(t,e,r){var a=0;r&&r.biff==2||(a=t.read_shift(2));var n=t.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var s={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[s,n]}function $7(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),f=t.read_shift(2),d=t.read_shift(2);return{Pos:[e,r],Dim:[a,n],Flags:s,CurTab:l,FirstTab:c,Selected:f,TabRatio:d}}function W7(){var t=ft(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function V7(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=t.read_shift(2);return{RTL:a&64}}function G7(t){var e=ft(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function Y7(){}function X7(t,e,r){var a={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return a.name=rm(t,0,r),a}function K7(t,e){var r=t.name||"Arial",a=e&&e.biff==5,n=a?15+r.length:16+2*r.length,s=ft(n);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),a||s.write_shift(1,1),s.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),s}function J7(t){var e=Cl(t);return e.isst=t.read_shift(4),e}function Z7(t,e,r,a){var n=ft(10);return kf(t,e,a,n),n.write_shift(4,r),n}function Q7(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=t.l+e,n=Cl(t);r.biff==2&&t.l++;var s=am(t,a-t.l,r);return n.val=s,n}function eR(t,e,r,a,n){var s=!n||n.biff==8,l=ft(8+ +s+(1+s)*r.length);return kf(t,e,a,l),l.write_shift(2,r.length),s&&l.write_shift(1,1),l.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),l}function tR(t,e,r){var a=t.read_shift(2),n=If(t,0,r);return[a,n]}function rR(t,e,r,a){var n=r&&r.biff==5;a||(a=ft(n?3+e.length:5+2*e.length)),a.write_shift(2,t),a.write_shift(n?1:2,e.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*e.length,e,n?"sbcs":"utf16le");var s=a.length>a.l?a.slice(0,a.l):a;return s.l==null&&(s.l=s.length),s}var aR=If;function Kw(t,e,r){var a=t.l+e,n=r.biff==8||!r.biff?4:2,s=t.read_shift(n),l=t.read_shift(n),c=t.read_shift(2),f=t.read_shift(2);return t.l=a,{s:{r:s,c},e:{r:l,c:f}}}function nR(t,e){var r=e.biff==8||!e.biff?4:2,a=ft(2*r+6);return a.write_shift(r,t.s.r),a.write_shift(r,t.e.r+1),a.write_shift(2,t.s.c),a.write_shift(2,t.e.c+1),a.write_shift(2,0),a}function sR(t){var e=t.read_shift(2),r=t.read_shift(2),a=g3(t);return{r:e,c:r,ixfe:a[0],rknum:a[1]}}function iR(t,e){for(var r=t.l+e-2,a=t.read_shift(2),n=t.read_shift(2),s=[];t.l<r;)s.push(g3(t));if(t.l!==r)throw new Error("MulRK read error");var l=t.read_shift(2);if(s.length!=l-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:l,rkrec:s}}function oR(t,e){for(var r=t.l+e-2,a=t.read_shift(2),n=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var l=t.read_shift(2);if(s.length!=l-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:l,ixfe:s}}function lR(t,e,r,a){var n={},s=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(4),f=t.read_shift(2);return n.patternType=zO[c>>26],a.cellStyles&&(n.alc=s&7,n.fWrap=s>>3&1,n.alcV=s>>4&7,n.fJustLast=s>>7&1,n.trot=s>>8&255,n.cIndent=s>>16&15,n.fShrinkToFit=s>>20&1,n.iReadOrder=s>>22&2,n.fAtrNum=s>>26&1,n.fAtrFnt=s>>27&1,n.fAtrAlc=s>>28&1,n.fAtrBdr=s>>29&1,n.fAtrPat=s>>30&1,n.fAtrProt=s>>31&1,n.dgLeft=l&15,n.dgRight=l>>4&15,n.dgTop=l>>8&15,n.dgBottom=l>>12&15,n.icvLeft=l>>16&127,n.icvRight=l>>23&127,n.grbitDiag=l>>30&3,n.icvTop=c&127,n.icvBottom=c>>7&127,n.icvDiag=c>>14&127,n.dgDiag=c>>21&15,n.icvFore=f&127,n.icvBack=f>>7&127,n.fsxButton=f>>14&1),n}function cR(t,e,r){var a={};return a.ifnt=t.read_shift(2),a.numFmtId=t.read_shift(2),a.flags=t.read_shift(2),a.fStyle=a.flags>>2&1,e-=6,a.data=lR(t,e,a.fStyle,r),a}function Jw(t,e,r,a){var n=r&&r.biff==5;a||(a=ft(n?16:20)),a.write_shift(2,0),t.style?(a.write_shift(2,t.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,t.numFmtId||0),a.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&n&&(s|=1024),a.write_shift(4,s),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function uR(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function fR(t){var e=ft(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function Zw(t,e,r){var a=Cl(t);(r.biff==2||e==9)&&++t.l;var n=m7(t);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function dR(t,e,r,a,n,s){var l=ft(8);return kf(t,e,a,l),d3(r,s,l),l}function hR(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=Cl(t),n=Fs(t);return a.val=n,a}function mR(t,e,r,a){var n=ft(14);return kf(t,e,a,n),Nf(r,n),n}var Qw=N7;function pR(t,e,r){var a=t.l+e,n=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,n];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var l=jf(t,s),c=[];a>t.l;)c.push(am(t));return[s,n,l,c]}function e5(t,e,r){var a=t.read_shift(2),n,s={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=k7(t,e-2,r)),s.body=n||t.read_shift(e-2),typeof n=="string"&&(s.Name=n),s}var gR=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function t5(t,e,r){var a=t.l+e,n=t.read_shift(2),s=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(r&&r.biff==2?1:2),f=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),f=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var d=jf(t,l,r);n&32&&(d=gR[d.charCodeAt(0)]);var m=a-t.l;r&&r.biff==2&&--m;var v=a==t.l||c===0||!(m>0)?[]:OP(t,m,r,c);return{chKey:s,Name:d,itab:f,rgce:v}}function _3(t,e,r){if(r.biff<8)return vR(t,e,r);for(var a=[],n=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)a.push(j7(t,r.biff>8?12:6,r));if(t.l!=n)throw new Error("Bad ExternSheet: "+t.l+" != "+n);return a}function vR(t,e,r){t[t.l+1]==3&&t[t.l]++;var a=rm(t,e,r);return a.charCodeAt(0)==3?a.slice(1):a}function xR(t,e,r){if(r.biff<8){t.l+=e;return}var a=t.read_shift(2),n=t.read_shift(2),s=jf(t,a,r),l=jf(t,n,r);return[s,l]}function yR(t,e,r){var a=x3(t);t.l++;var n=t.read_shift(1);return e-=8,[RP(t,e,r),n,a]}function r5(t,e,r){var a=E7(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[a,CP(t,e,r)]}function _R(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,a=t.read_shift(4);return[e,r,a]}function bR(t,e,r){if(!(r.biff<8)){var a=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),l=t.read_shift(2),c=If(t,0,r);return r.biff<8&&t.read_shift(1),[{r:a,c:n},c,l,s]}}function wR(t,e,r){return bR(t,e,r)}function SR(t,e){for(var r=[],a=t.read_shift(2);a--;)r.push(j1(t));return r}function NR(t){var e=ft(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)v3(t[r],e);return e}function jR(t,e,r){if(r&&r.biff<8)return ER(t,e,r);var a=y3(t),n=O7(t,e-22,a[1]);return{cmo:a,ft:n}}var kR={8:function(t,e){var r=t.l+e;t.l+=10;var a=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var n=t.read_shift(1);return t.l+=n,t.l=r,{fmt:a}}};function ER(t,e,r){t.l+=4;var a=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var l=[];return l.push((kR[a]||Ps)(t,e,r)),{cmo:[n,a,s],ft:l}}function AR(t,e,r){var a=t.l,n="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:l=v7(t,6,r);var c=t.read_shift(2);t.read_shift(2),Mn(t,2);var f=t.read_shift(2);t.l+=f;for(var d=1;d<t.lens.length-1;++d){if(t.l-a!=t.lens[d])throw new Error("TxO: bad continue record");var m=t[t.l],v=jf(t,t.lens[d+1]-t.lens[d]-1);if(n+=v,n.length>=(m?c:2*c))break}if(n.length!==c&&n.length!==c*2)throw new Error("cchText: "+c+" != "+n.length);return t.l=a+e,{t:n}}catch{return t.l=a+e,{t:n}}}function CR(t,e){var r=j1(t);t.l+=16;var a=b7(t,e-24);return[r,a]}function TR(t){var e=ft(24),r=rn(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)e.write_shift(1,parseInt(a[n],16));return is([e,w7(t[1])])}function OR(t,e){t.read_shift(2);var r=j1(t),a=t.read_shift((e-10)/2,"dbcs-cont");return a=a.replace(Gs,""),[r,a]}function RR(t){var e=t[1].Tooltip,r=ft(10+2*(e.length+1));r.write_shift(2,2048);var a=rn(t[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<e.length;++n)r.write_shift(2,e.charCodeAt(n));return r.write_shift(2,0),r}function DR(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=Uw[r]||r,r=t.read_shift(2),e[1]=Uw[r]||r,e}function FR(t){return t||(t=ft(4)),t.write_shift(2,1),t.write_shift(2,1),t}function LR(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(p3(t));return r}function PR(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(p3(t));return r}function MR(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function b3(t,e,r){if(!r.cellStyles)return Ps(t,e);var a=r&&r.biff>=12?4:2,n=t.read_shift(a),s=t.read_shift(a),l=t.read_shift(a),c=t.read_shift(a),f=t.read_shift(2);a==2&&(t.l+=2);var d={s:n,e:s,w:l,ixfe:c,flags:f};return(r.biff>=5||!r.biff)&&(d.level=f>>8&7),d}function IR(t,e){var r=ft(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var a=0;return t.hidden&&(a|=1),r.write_shift(1,a),a=t.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function BR(t,e){var r={};return e<32||(t.l+=16,r.header=Fs(t),r.footer=Fs(t),t.l+=2),r}function UR(t,e,r){var a={area:!1};if(r.biff!=5)return t.l+=e,a;var n=t.read_shift(1);return t.l+=3,n&16&&(a.area=!0),a}function qR(t){for(var e=ft(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var zR=Cl,HR=f3,$R=am;function WR(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(4),n={fmt:e,env:r,len:a,data:t.slice(t.l,t.l+a)};return t.l+=a,n}function VR(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=Cl(t);++t.l;var n=If(t,e-7,r);return a.t="str",a.val=n,a}function GR(t){var e=Cl(t);++t.l;var r=Fs(t);return e.t="n",e.val=r,e}function YR(t,e,r){var a=ft(15);return om(a,t,e),a.write_shift(8,r,"f"),a}function XR(t){var e=Cl(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function KR(t,e,r){var a=ft(9);return om(a,t,e),a.write_shift(2,r),a}function JR(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function ZR(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function QR(t,e,r){var a=t.l+e,n=Cl(t),s=t.read_shift(2),l=jf(t,s,r);return t.l=a,n.t="str",n.val=l,n}var eD=[2,3,48,49,131,139,140,245],Ax=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=w1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,f){var d=[],m=vu(1);switch(f.type){case"base64":m=Mi(qi(c));break;case"binary":m=Mi(c);break;case"buffer":case"array":m=c;break}ys(m,0);var v=m.read_shift(1),x=!!(v&136),g=!1,b=!1;switch(v){case 2:break;case 3:break;case 48:g=!0,x=!0;break;case 49:g=!0,x=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var _=0,w=521;v==2&&(_=m.read_shift(2)),m.l+=3,v!=2&&(_=m.read_shift(4)),_>1048576&&(_=1e6),v!=2&&(w=m.read_shift(2));var E=m.read_shift(2),C=f.codepage||1252;v!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(C=t[m[m.l]]),m.l+=1,m.l+=2),b&&(m.l+=36);for(var A=[],T={},G=Math.min(m.length,v==2?521:w-10-(g?264:0)),W=b?32:11;m.l<G&&m[m.l]!=13;)switch(T={},T.name=F0.utils.decode(C,m.slice(m.l,m.l+W)).replace(/[\u0000\r\n].*$/g,""),m.l+=W,T.type=String.fromCharCode(m.read_shift(1)),v!=2&&!b&&(T.offset=m.read_shift(4)),T.len=m.read_shift(1),v==2&&(T.offset=m.read_shift(2)),T.dec=m.read_shift(1),T.name.length&&A.push(T),v!=2&&(m.l+=b?13:14),T.type){case"B":(!g||T.len!=8)&&f.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+T.type)}if(m[m.l]!==13&&(m.l=w-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=w;var B=0,q=0;for(d[0]=[],q=0;q!=A.length;++q)d[0][q]=A[q].name;for(;_-- >0;){if(m[m.l]===42){m.l+=E;continue}for(++m.l,d[++B]=[],q=0,q=0;q!=A.length;++q){var L=m.slice(m.l,m.l+A[q].len);m.l+=A[q].len,ys(L,0);var J=F0.utils.decode(C,L);switch(A[q].type){case"C":J.trim().length&&(d[B][q]=J.replace(/\s+$/,""));break;case"D":J.length===8?d[B][q]=new Date(+J.slice(0,4),+J.slice(4,6)-1,+J.slice(6,8)):d[B][q]=J;break;case"F":d[B][q]=parseFloat(J.trim());break;case"+":case"I":d[B][q]=b?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(J.trim().toUpperCase()){case"Y":case"T":d[B][q]=!0;break;case"N":case"F":d[B][q]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+J+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));d[B][q]="##MEMO##"+(b?parseInt(J.trim(),10):L.read_shift(4));break;case"N":J=J.replace(/\u0000/g,"").trim(),J&&J!="."&&(d[B][q]=+J||0);break;case"@":d[B][q]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":d[B][q]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":d[B][q]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[B][q]=-L.read_shift(-8,"f");break;case"B":if(g&&A[q].len==8){d[B][q]=L.read_shift(8,"f");break}case"G":case"P":L.l+=A[q].len;break;case"0":if(A[q].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+A[q].type)}}}if(v!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return f&&f.sheetRows&&(d=d.slice(0,f.sheetRows)),f.DBF=A,d}function a(c,f){var d=f||{};d.dateNF||(d.dateNF="yyyymmdd");var m=xh(r(c,d),d);return m["!cols"]=d.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete d.DBF,m}function n(c,f){try{return Nu(a(c,f),f)}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,f){var d=f||{};if(+d.codepage>=0&&Go(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var m=hi(),v=l1(c,{header:1,raw:!0,cellDates:!0}),x=v[0],g=v.slice(1),b=c["!cols"]||[],_=0,w=0,E=0,C=1;for(_=0;_<x.length;++_){if(((b[_]||{}).DBF||{}).name){x[_]=b[_].DBF.name,++E;continue}if(x[_]!=null){if(++E,typeof x[_]=="number"&&(x[_]=x[_].toString(10)),typeof x[_]!="string")throw new Error("DBF Invalid column name "+x[_]+" |"+typeof x[_]+"|");if(x.indexOf(x[_])!==_){for(w=0;w<1024;++w)if(x.indexOf(x[_]+"_"+w)==-1){x[_]+="_"+w;break}}}}var A=ta(c["!ref"]),T=[],G=[],W=[];for(_=0;_<=A.e.c-A.s.c;++_){var B="",q="",L=0,J=[];for(w=0;w<g.length;++w)g[w][_]!=null&&J.push(g[w][_]);if(J.length==0||x[_]==null){T[_]="?";continue}for(w=0;w<J.length;++w){switch(typeof J[w]){case"number":q="B";break;case"string":q="C";break;case"boolean":q="L";break;case"object":q=J[w]instanceof Date?"D":"C";break;default:q="C"}L=Math.max(L,String(J[w]).length),B=B&&B!=q?"C":q}L>250&&(L=250),q=((b[_]||{}).DBF||{}).type,q=="C"&&b[_].DBF.len>L&&(L=b[_].DBF.len),B=="B"&&q=="N"&&(B="N",W[_]=b[_].DBF.dec,L=b[_].DBF.len),G[_]=B=="C"||q=="N"?L:s[B]||0,C+=G[_],T[_]=B}var D=m.next(32);for(D.write_shift(4,318902576),D.write_shift(4,g.length),D.write_shift(2,296+32*E),D.write_shift(2,C),_=0;_<4;++_)D.write_shift(4,0);for(D.write_shift(4,0|(+e[uN]||3)<<8),_=0,w=0;_<x.length;++_)if(x[_]!=null){var O=m.next(32),M=(x[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);O.write_shift(1,M,"sbcs"),O.write_shift(1,T[_]=="?"?"C":T[_],"sbcs"),O.write_shift(4,w),O.write_shift(1,G[_]||s[T[_]]||0),O.write_shift(1,W[_]||0),O.write_shift(1,2),O.write_shift(4,0),O.write_shift(1,0),O.write_shift(4,0),O.write_shift(4,0),w+=G[_]||s[T[_]]||0}var V=m.next(264);for(V.write_shift(4,13),_=0;_<65;++_)V.write_shift(4,0);for(_=0;_<g.length;++_){var ie=m.next(C);for(ie.write_shift(1,0),w=0;w<x.length;++w)if(x[w]!=null)switch(T[w]){case"L":ie.write_shift(1,g[_][w]==null?63:g[_][w]?84:70);break;case"B":ie.write_shift(8,g[_][w]||0,"f");break;case"N":var X="0";for(typeof g[_][w]=="number"&&(X=g[_][w].toFixed(W[w]||0)),E=0;E<G[w]-X.length;++E)ie.write_shift(1,32);ie.write_shift(1,X,"sbcs");break;case"D":g[_][w]?(ie.write_shift(4,("0000"+g[_][w].getFullYear()).slice(-4),"sbcs"),ie.write_shift(2,("00"+(g[_][w].getMonth()+1)).slice(-2),"sbcs"),ie.write_shift(2,("00"+g[_][w].getDate()).slice(-2),"sbcs")):ie.write_shift(8,"00000000","sbcs");break;case"C":var Z=String(g[_][w]!=null?g[_][w]:"").slice(0,G[w]);for(ie.write_shift(1,Z,"sbcs"),E=0;E<G[w]-Z.length;++E)ie.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:n,to_sheet:a,from_sheet:l}})(),w3=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+gn(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,g){var b=t[g];return typeof b=="number"?hw(b):b},a=function(x,g,b){var _=g.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return _==59?x:hw(_)};t["|"]=254;function n(x,g){switch(g.type){case"base64":return s(qi(x),g);case"binary":return s(x,g);case"buffer":return s(Pr&&Buffer.isBuffer(x)?x.toString("binary"):Su(x),g);case"array":return s(Sf(x),g)}throw new Error("Unrecognized type "+g.type)}function s(x,g){var b=x.split(/[\n\r]+/),_=-1,w=-1,E=0,C=0,A=[],T=[],G=null,W={},B=[],q=[],L=[],J=0,D;for(+g.codepage>=0&&Go(+g.codepage);E!==b.length;++E){J=0;var O=b[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(e,r),M=O.replace(/;;/g,"\0").split(";").map(function(z){return z.replace(/\u0000/g,";")}),V=M[0],ie;if(O.length>0)switch(V){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":M[1].charAt(0)=="P"&&T.push(O.slice(3).replace(/;;/g,";"));break;case"C":var X=!1,Z=!1,K=!1,ae=!1,fe=-1,U=-1;for(C=1;C<M.length;++C)switch(M[C].charAt(0)){case"A":break;case"X":w=parseInt(M[C].slice(1))-1,Z=!0;break;case"Y":for(_=parseInt(M[C].slice(1))-1,Z||(w=0),D=A.length;D<=_;++D)A[D]=[];break;case"K":ie=M[C].slice(1),ie.charAt(0)==='"'?ie=ie.slice(1,ie.length-1):ie==="TRUE"?ie=!0:ie==="FALSE"?ie=!1:isNaN(Xo(ie))?isNaN(lh(ie).getDate())||(ie=za(ie)):(ie=Xo(ie),G!==null&&gh(G)&&(ie=N1(ie))),X=!0;break;case"E":ae=!0;var j=eh(M[C].slice(1),{r:_,c:w});A[_][w]=[A[_][w],j];break;case"S":K=!0,A[_][w]=[A[_][w],"S5S"];break;case"G":break;case"R":fe=parseInt(M[C].slice(1))-1;break;case"C":U=parseInt(M[C].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+O)}if(X&&(A[_][w]&&A[_][w].length==2?A[_][w][0]=ie:A[_][w]=ie,G=null),K){if(ae)throw new Error("SYLK shared formula cannot have own formula");var F=fe>-1&&A[fe][U];if(!F||!F[1])throw new Error("SYLK shared formula cannot find base");A[_][w][1]=U3(F[1],{r:_-fe,c:w-U})}break;case"F":var I=0;for(C=1;C<M.length;++C)switch(M[C].charAt(0)){case"X":w=parseInt(M[C].slice(1))-1,++I;break;case"Y":for(_=parseInt(M[C].slice(1))-1,D=A.length;D<=_;++D)A[D]=[];break;case"M":J=parseInt(M[C].slice(1))/20;break;case"F":break;case"G":break;case"P":G=T[parseInt(M[C].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=M[C].slice(1).split(" "),D=parseInt(L[0],10);D<=parseInt(L[1],10);++D)J=parseInt(L[2],10),q[D-1]=J===0?{hidden:!0}:{wch:J},xu(q[D-1]);break;case"C":w=parseInt(M[C].slice(1))-1,q[w]||(q[w]={});break;case"R":_=parseInt(M[C].slice(1))-1,B[_]||(B[_]={}),J>0?(B[_].hpt=J,B[_].hpx=uh(J)):J===0&&(B[_].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+O)}I<1&&(G=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+O)}}return B.length>0&&(W["!rows"]=B),q.length>0&&(W["!cols"]=q),g&&g.sheetRows&&(A=A.slice(0,g.sheetRows)),[A,W]}function l(x,g){var b=n(x,g),_=b[0],w=b[1],E=xh(_,g);return gn(w).forEach(function(C){E[C]=w[C]}),E}function c(x,g){return Nu(l(x,g),g)}function f(x,g,b,_){var w="C;Y"+(b+1)+";X"+(_+1)+";K";switch(x.t){case"n":w+=x.v||0,x.f&&!x.F&&(w+=";E"+M2(x.f,{r:b,c:_}));break;case"b":w+=x.v?"TRUE":"FALSE";break;case"e":w+=x.w||x.v;break;case"d":w+='"'+(x.w||x.v)+'"';break;case"s":w+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function d(x,g){g.forEach(function(b,_){var w="F;W"+(_+1)+" "+(_+1)+" ";b.hidden?w+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=z0(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=H0(b.wpx)),typeof b.wch=="number"&&(w+=Math.round(b.wch))),w.charAt(w.length-1)!=" "&&x.push(w)})}function m(x,g){g.forEach(function(b,_){var w="F;";b.hidden?w+="M0;":b.hpt?w+="M"+20*b.hpt+";":b.hpx&&(w+="M"+20*$0(b.hpx)+";"),w.length>2&&x.push(w+"R"+(_+1))})}function v(x,g){var b=["ID;PWXL;N;E"],_=[],w=ta(x["!ref"]),E,C=Array.isArray(x),A=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),x["!cols"]&&d(b,x["!cols"]),x["!rows"]&&m(b,x["!rows"]),b.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var T=w.s.r;T<=w.e.r;++T)for(var G=w.s.c;G<=w.e.c;++G){var W=wr({r:T,c:G});E=C?(x[T]||[])[G]:x[W],!(!E||E.v==null&&(!E.f||E.F))&&_.push(f(E,x,T,G))}return b.join(A)+A+_.join(A)+A+"E"+A}return{to_workbook:c,to_sheet:l,from_sheet:v}})(),S3=(function(){function t(s,l){switch(l.type){case"base64":return e(qi(s),l);case"binary":return e(s,l);case"buffer":return e(Pr&&Buffer.isBuffer(s)?s.toString("binary"):Su(s),l);case"array":return e(Sf(s),l)}throw new Error("Unrecognized type "+l.type)}function e(s,l){for(var c=s.split(`
`),f=-1,d=-1,m=0,v=[];m!==c.length;++m){if(c[m].trim()==="BOT"){v[++f]=[],d=0;continue}if(!(f<0)){var x=c[m].trim().split(","),g=x[0],b=x[1];++m;for(var _=c[m]||"";(_.match(/["]/g)||[]).length&1&&m<c.length-1;)_+=`
`+c[++m];switch(_=_.trim(),+g){case-1:if(_==="BOT"){v[++f]=[],d=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?v[f][d]=!0:_==="FALSE"?v[f][d]=!1:isNaN(Xo(b))?isNaN(lh(b).getDate())?v[f][d]=b:v[f][d]=za(b):v[f][d]=Xo(b),++d;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),v[f][d++]=_!==""?_:null;break}if(_==="EOD")break}}return l&&l.sheetRows&&(v=v.slice(0,l.sheetRows)),v}function r(s,l){return xh(t(s,l),l)}function a(s,l){return Nu(r(s,l),l)}var n=(function(){var s=function(f,d,m,v,x){f.push(d),f.push(m+","+v),f.push('"'+x.replace(/"/g,'""')+'"')},l=function(f,d,m,v){f.push(d+","+m),f.push(d==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(f){var d=[],m=ta(f["!ref"]),v,x=Array.isArray(f);s(d,"TABLE",0,1,"sheetjs"),s(d,"VECTORS",0,m.e.r-m.s.r+1,""),s(d,"TUPLES",0,m.e.c-m.s.c+1,""),s(d,"DATA",0,0,"");for(var g=m.s.r;g<=m.e.r;++g){l(d,-1,0,"BOT");for(var b=m.s.c;b<=m.e.c;++b){var _=wr({r:g,c:b});if(v=x?(f[g]||[])[b]:f[_],!v){l(d,1,0,"");continue}switch(v.t){case"n":var w=v.w;!w&&v.v!=null&&(w=v.v),w==null?v.f&&!v.F?l(d,1,0,"="+v.f):l(d,1,0,""):l(d,0,w,"V");break;case"b":l(d,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":l(d,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=fo(v.z||br[14],Jn(za(v.v)))),l(d,0,v.w,"V");break;default:l(d,1,0,"")}}}l(d,-1,0,"EOD");var E=`\r
`,C=d.join(E);return C}})();return{to_workbook:a,to_sheet:r,from_sheet:n}})(),N3=(function(){function t(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(v,x){for(var g=v.split(`
`),b=-1,_=-1,w=0,E=[];w!==g.length;++w){var C=g[w].trim().split(":");if(C[0]==="cell"){var A=rn(C[1]);if(E.length<=A.r)for(b=E.length;b<=A.r;++b)E[b]||(E[b]=[]);switch(b=A.r,_=A.c,C[2]){case"t":E[b][_]=t(C[3]);break;case"v":E[b][_]=+C[3];break;case"vtf":var T=C[C.length-1];case"vtc":switch(C[3]){case"nl":E[b][_]=!!+C[4];break;default:E[b][_]=+C[4];break}C[2]=="vtf"&&(E[b][_]=[E[b][_],T])}}}return x&&x.sheetRows&&(E=E.slice(0,x.sheetRows)),E}function a(v,x){return xh(r(v,x),x)}function n(v,x){return Nu(a(v,x),x)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function d(v){if(!v||!v["!ref"])return"";for(var x=[],g=[],b,_="",w=mi(v["!ref"]),E=Array.isArray(v),C=w.s.r;C<=w.e.r;++C)for(var A=w.s.c;A<=w.e.c;++A)if(_=wr({r:C,c:A}),b=E?(v[C]||[])[A]:v[_],!(!b||b.v==null||b.t==="z")){switch(g=["cell",_,"t"],b.t){case"s":case"str":g.push(e(b.v));break;case"n":b.f?(g[2]="vtf",g[3]="n",g[4]=b.v,g[5]=e(b.f)):(g[2]="v",g[3]=b.v);break;case"b":g[2]="vt"+(b.f?"f":"c"),g[3]="nl",g[4]=b.v?"1":"0",g[5]=e(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var T=Jn(za(b.v));g[2]="vtc",g[3]="nd",g[4]=""+T,g[5]=b.w||fo(b.z||br[14],T);break;case"e":continue}x.push(g.join(":"))}return x.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function m(v){return[s,l,c,l,d(v),f].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:m}})(),ch=(function(){function t(m,v,x,g,b){b.raw?v[x][g]=m:m===""||(m==="TRUE"?v[x][g]=!0:m==="FALSE"?v[x][g]=!1:isNaN(Xo(m))?isNaN(lh(m).getDate())?v[x][g]=m:v[x][g]=za(m):v[x][g]=Xo(m))}function e(m,v){var x=v||{},g=[];if(!m||m.length===0)return g;for(var b=m.split(/[\r\n]/),_=b.length-1;_>=0&&b[_].length===0;)--_;for(var w=10,E=0,C=0;C<=_;++C)E=b[C].indexOf(" "),E==-1?E=b[C].length:E++,w=Math.max(w,E);for(C=0;C<=_;++C){g[C]=[];var A=0;for(t(b[C].slice(0,w).trim(),g,C,A,x),A=1;A<=(b[C].length-w)/10+1;++A)t(b[C].slice(w+(A-1)*10,w+A*10).trim(),g,C,A,x)}return x.sheetRows&&(g=g.slice(0,x.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(m){for(var v={},x=!1,g=0,b=0;g<m.length;++g)(b=m.charCodeAt(g))==34?x=!x:!x&&b in r&&(v[b]=(v[b]||0)+1);b=[];for(g in v)Object.prototype.hasOwnProperty.call(v,g)&&b.push([v[g],g]);if(!b.length){v=a;for(g in v)Object.prototype.hasOwnProperty.call(v,g)&&b.push([v[g],g])}return b.sort(function(_,w){return _[0]-w[0]||a[_[1]]-a[w[1]]}),r[b.pop()[1]]||44}function s(m,v){var x=v||{},g="",b=x.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(g=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(g=m.charAt(4),m=m.slice(6)):g=n(m.slice(0,1024)):x&&x.FS?g=x.FS:g=n(m.slice(0,1024));var w=0,E=0,C=0,A=0,T=0,G=g.charCodeAt(0),W=!1,B=0,q=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var L=x.dateNF!=null?U8(x.dateNF):null;function J(){var D=m.slice(A,T),O={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)O.t="z";else if(x.raw)O.t="s",O.v=D;else if(D.trim().length===0)O.t="s",O.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(O.t="s",O.v=D.slice(2,-1).replace(/""/g,'"')):pL(D)?(O.t="n",O.f=D.slice(1)):(O.t="s",O.v=D);else if(D=="TRUE")O.t="b",O.v=!0;else if(D=="FALSE")O.t="b",O.v=!1;else if(!isNaN(C=Xo(D)))O.t="n",x.cellText!==!1&&(O.w=D),O.v=C;else if(!isNaN(lh(D).getDate())||L&&D.match(L)){O.z=x.dateNF||br[14];var M=0;L&&D.match(L)&&(D=q8(D,x.dateNF,D.match(L)||[]),M=1),x.cellDates?(O.t="d",O.v=za(D,M)):(O.t="n",O.v=Jn(za(D,M))),x.cellText!==!1&&(O.w=fo(O.z,O.v instanceof Date?Jn(O.v):O.v)),x.cellNF||delete O.z}else O.t="s",O.v=D;if(O.t=="z"||(x.dense?(b[w]||(b[w]=[]),b[w][E]=O):b[wr({c:E,r:w})]=O),A=T+1,q=m.charCodeAt(A),_.e.c<E&&(_.e.c=E),_.e.r<w&&(_.e.r=w),B==G)++E;else if(E=0,++w,x.sheetRows&&x.sheetRows<=w)return!0}e:for(;T<m.length;++T)switch(B=m.charCodeAt(T)){case 34:q===34&&(W=!W);break;case G:case 10:case 13:if(!W&&J())break e;break}return T-A>0&&J(),b["!ref"]=Or(_),b}function l(m,v){return!(v&&v.PRN)||v.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?s(m,v):xh(e(m,v),v)}function c(m,v){var x="",g=v.type=="string"?[0,0,0,0]:W2(m,v);switch(v.type){case"base64":x=qi(m);break;case"binary":x=m;break;case"buffer":v.codepage==65001?x=m.toString("utf8"):v.codepage&&typeof F0<"u"||(x=Pr&&Buffer.isBuffer(m)?m.toString("binary"):Su(m));break;case"array":x=Sf(m);break;case"string":x=m;break;default:throw new Error("Unrecognized type "+v.type)}return g[0]==239&&g[1]==187&&g[2]==191?x=ka(x.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?x=ka(x):v.type=="binary"&&typeof F0<"u",x.slice(0,19)=="socialcalc:version:"?N3.to_sheet(v.type=="string"?x:ka(x),v):l(x,v)}function f(m,v){return Nu(c(m,v),v)}function d(m){for(var v=[],x=ta(m["!ref"]),g,b=Array.isArray(m),_=x.s.r;_<=x.e.r;++_){for(var w=[],E=x.s.c;E<=x.e.c;++E){var C=wr({r:_,c:E});if(g=b?(m[_]||[])[E]:m[C],!g||g.v==null){w.push("          ");continue}for(var A=(g.w||(pc(g),g.w)||"").slice(0,10);A.length<10;)A+=" ";w.push(A+(E===0?" ":""))}v.push(w.join(""))}return v.join(`
`)}return{to_workbook:f,to_sheet:c,from_sheet:d}})();function tD(t,e){var r=e||{},a=!!r.WTF;r.WTF=!0;try{var n=w3.to_workbook(t,r);return r.WTF=a,n}catch(s){if(r.WTF=a,!s.message.match(/SYLK bad record ID/)&&a)throw s;return ch.to_workbook(t,e)}}var yf=(function(){function t(j,F,I){if(j){ys(j,j.l||0);for(var z=I.Enum||fe;j.l<j.length;){var ne=j.read_shift(2),se=z[ne]||z[65535],pe=j.read_shift(2),ye=j.l+pe,_e=se.f&&se.f(j,pe,I);if(j.l=ye,F(_e,se,ne))return}}}function e(j,F){switch(F.type){case"base64":return r(Mi(qi(j)),F);case"binary":return r(Mi(j),F);case"buffer":case"array":return r(j,F)}throw"Unsupported type "+F.type}function r(j,F){if(!j)return j;var I=F||{},z=I.dense?[]:{},ne="Sheet1",se="",pe=0,ye={},_e=[],Le=[],ue={s:{r:0,c:0},e:{r:0,c:0}},at=I.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)I.Enum=fe,t(j,function(Se,ve,Ie){switch(Ie){case 0:I.vers=Se,Se>=4096&&(I.qpro=!0);break;case 6:ue=Se;break;case 204:Se&&(se=Se);break;case 222:se=Se;break;case 15:case 51:I.qpro||(Se[1].v=Se[1].v.slice(1));case 13:case 14:case 16:Ie==14&&(Se[2]&112)==112&&(Se[2]&15)>1&&(Se[2]&15)<15&&(Se[1].z=I.dateNF||br[14],I.cellDates&&(Se[1].t="d",Se[1].v=N1(Se[1].v))),I.qpro&&Se[3]>pe&&(z["!ref"]=Or(ue),ye[ne]=z,_e.push(ne),z=I.dense?[]:{},ue={s:{r:0,c:0},e:{r:0,c:0}},pe=Se[3],ne=se||"Sheet"+(pe+1),se="");var wt=I.dense?(z[Se[0].r]||[])[Se[0].c]:z[wr(Se[0])];if(wt){wt.t=Se[1].t,wt.v=Se[1].v,Se[1].z!=null&&(wt.z=Se[1].z),Se[1].f!=null&&(wt.f=Se[1].f);break}I.dense?(z[Se[0].r]||(z[Se[0].r]=[]),z[Se[0].r][Se[0].c]=Se[1]):z[wr(Se[0])]=Se[1];break}},I);else if(j[2]==26||j[2]==14)I.Enum=U,j[2]==14&&(I.qpro=!0,j.l=0),t(j,function(Se,ve,Ie){switch(Ie){case 204:ne=Se;break;case 22:Se[1].v=Se[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Se[3]>pe&&(z["!ref"]=Or(ue),ye[ne]=z,_e.push(ne),z=I.dense?[]:{},ue={s:{r:0,c:0},e:{r:0,c:0}},pe=Se[3],ne="Sheet"+(pe+1)),at>0&&Se[0].r>=at)break;I.dense?(z[Se[0].r]||(z[Se[0].r]=[]),z[Se[0].r][Se[0].c]=Se[1]):z[wr(Se[0])]=Se[1],ue.e.c<Se[0].c&&(ue.e.c=Se[0].c),ue.e.r<Se[0].r&&(ue.e.r=Se[0].r);break;case 27:Se[14e3]&&(Le[Se[14e3][0]]=Se[14e3][1]);break;case 1537:Le[Se[0]]=Se[1],Se[0]==pe&&(ne=Se[1]);break}},I);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(z["!ref"]=Or(ue),ye[se||ne]=z,_e.push(se||ne),!Le.length)return{SheetNames:_e,Sheets:ye};for(var ht={},de=[],it=0;it<Le.length;++it)ye[_e[it]]?(de.push(Le[it]||_e[it]),ht[Le[it]]=ye[Le[it]]||ye[_e[it]]):(de.push(Le[it]),ht[Le[it]]={"!ref":"A1"});return{SheetNames:de,Sheets:ht}}function a(j,F){var I=F||{};if(+I.codepage>=0&&Go(+I.codepage),I.type=="string")throw new Error("Cannot write WK1 to JS string");var z=hi(),ne=ta(j["!ref"]),se=Array.isArray(j),pe=[];Ut(z,0,s(1030)),Ut(z,6,f(ne));for(var ye=Math.min(ne.e.r,8191),_e=ne.s.r;_e<=ye;++_e)for(var Le=An(_e),ue=ne.s.c;ue<=ne.e.c;++ue){_e===ne.s.r&&(pe[ue]=tn(ue));var at=pe[ue]+Le,ht=se?(j[_e]||[])[ue]:j[at];if(!(!ht||ht.t=="z"))if(ht.t=="n")(ht.v|0)==ht.v&&ht.v>=-32768&&ht.v<=32767?Ut(z,13,g(_e,ue,ht.v)):Ut(z,14,_(_e,ue,ht.v));else{var de=pc(ht);Ut(z,15,v(_e,ue,de.slice(0,239)))}}return Ut(z,1),z.end()}function n(j,F){var I=F||{};if(+I.codepage>=0&&Go(+I.codepage),I.type=="string")throw new Error("Cannot write WK3 to JS string");var z=hi();Ut(z,0,l(j));for(var ne=0,se=0;ne<j.SheetNames.length;++ne)(j.Sheets[j.SheetNames[ne]]||{})["!ref"]&&Ut(z,27,ae(j.SheetNames[ne],se++));var pe=0;for(ne=0;ne<j.SheetNames.length;++ne){var ye=j.Sheets[j.SheetNames[ne]];if(!(!ye||!ye["!ref"])){for(var _e=ta(ye["!ref"]),Le=Array.isArray(ye),ue=[],at=Math.min(_e.e.r,8191),ht=_e.s.r;ht<=at;++ht)for(var de=An(ht),it=_e.s.c;it<=_e.e.c;++it){ht===_e.s.r&&(ue[it]=tn(it));var Se=ue[it]+de,ve=Le?(ye[ht]||[])[it]:ye[Se];if(!(!ve||ve.t=="z"))if(ve.t=="n")Ut(z,23,J(ht,it,pe,ve.v));else{var Ie=pc(ve);Ut(z,22,B(ht,it,pe,Ie.slice(0,239)))}}++pe}}return Ut(z,1),z.end()}function s(j){var F=ft(2);return F.write_shift(2,j),F}function l(j){var F=ft(26);F.write_shift(2,4096),F.write_shift(2,4),F.write_shift(4,0);for(var I=0,z=0,ne=0,se=0;se<j.SheetNames.length;++se){var pe=j.SheetNames[se],ye=j.Sheets[pe];if(!(!ye||!ye["!ref"])){++ne;var _e=mi(ye["!ref"]);I<_e.e.r&&(I=_e.e.r),z<_e.e.c&&(z=_e.e.c)}}return I>8191&&(I=8191),F.write_shift(2,I),F.write_shift(1,ne),F.write_shift(1,z),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(1,1),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(4,0),F}function c(j,F,I){var z={s:{c:0,r:0},e:{c:0,r:0}};return F==8&&I.qpro?(z.s.c=j.read_shift(1),j.l++,z.s.r=j.read_shift(2),z.e.c=j.read_shift(1),j.l++,z.e.r=j.read_shift(2),z):(z.s.c=j.read_shift(2),z.s.r=j.read_shift(2),F==12&&I.qpro&&(j.l+=2),z.e.c=j.read_shift(2),z.e.r=j.read_shift(2),F==12&&I.qpro&&(j.l+=2),z.s.c==65535&&(z.s.c=z.e.c=z.s.r=z.e.r=0),z)}function f(j){var F=ft(8);return F.write_shift(2,j.s.c),F.write_shift(2,j.s.r),F.write_shift(2,j.e.c),F.write_shift(2,j.e.r),F}function d(j,F,I){var z=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&I.vers!=20768?(z[0].c=j.read_shift(1),z[3]=j.read_shift(1),z[0].r=j.read_shift(2),j.l+=2):(z[2]=j.read_shift(1),z[0].c=j.read_shift(2),z[0].r=j.read_shift(2)),z}function m(j,F,I){var z=j.l+F,ne=d(j,F,I);if(ne[1].t="s",I.vers==20768){j.l++;var se=j.read_shift(1);return ne[1].v=j.read_shift(se,"utf8"),ne}return I.qpro&&j.l++,ne[1].v=j.read_shift(z-j.l,"cstr"),ne}function v(j,F,I){var z=ft(7+I.length);z.write_shift(1,255),z.write_shift(2,F),z.write_shift(2,j),z.write_shift(1,39);for(var ne=0;ne<z.length;++ne){var se=I.charCodeAt(ne);z.write_shift(1,se>=128?95:se)}return z.write_shift(1,0),z}function x(j,F,I){var z=d(j,F,I);return z[1].v=j.read_shift(2,"i"),z}function g(j,F,I){var z=ft(7);return z.write_shift(1,255),z.write_shift(2,F),z.write_shift(2,j),z.write_shift(2,I,"i"),z}function b(j,F,I){var z=d(j,F,I);return z[1].v=j.read_shift(8,"f"),z}function _(j,F,I){var z=ft(13);return z.write_shift(1,255),z.write_shift(2,F),z.write_shift(2,j),z.write_shift(8,I,"f"),z}function w(j,F,I){var z=j.l+F,ne=d(j,F,I);if(ne[1].v=j.read_shift(8,"f"),I.qpro)j.l=z;else{var se=j.read_shift(2);T(j.slice(j.l,j.l+se),ne),j.l+=se}return ne}function E(j,F,I){var z=F&32768;return F&=-32769,F=(z?j:0)+(F>=8192?F-16384:F),(z?"":"$")+(I?tn(F):An(F))}var C={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},A=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function T(j,F){ys(j,0);for(var I=[],z=0,ne="",se="",pe="",ye="";j.l<j.length;){var _e=j[j.l++];switch(_e){case 0:I.push(j.read_shift(8,"f"));break;case 1:se=E(F[0].c,j.read_shift(2),!0),ne=E(F[0].r,j.read_shift(2),!1),I.push(se+ne);break;case 2:{var Le=E(F[0].c,j.read_shift(2),!0),ue=E(F[0].r,j.read_shift(2),!1);se=E(F[0].c,j.read_shift(2),!0),ne=E(F[0].r,j.read_shift(2),!1),I.push(Le+ue+":"+se+ne)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(j.read_shift(2));break;case 6:{for(var at="";_e=j[j.l++];)at+=String.fromCharCode(_e);I.push('"'+at.replace(/"/g,'""')+'"')}break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:ye=I.pop(),pe=I.pop(),I.push(["AND","OR"][_e-20]+"("+pe+","+ye+")");break;default:if(_e<32&&A[_e])ye=I.pop(),pe=I.pop(),I.push(pe+A[_e]+ye);else if(C[_e]){if(z=C[_e][1],z==69&&(z=j[j.l++]),z>I.length){console.error("WK1 bad formula parse 0x"+_e.toString(16)+":|"+I.join("|")+"|");return}var ht=I.slice(-z);I.length-=z,I.push(C[_e][0]+"("+ht.join(",")+")")}else return _e<=7?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=24?console.error("WK1 unsupported op "+_e.toString(16)):_e<=30?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=115?console.error("WK1 unsupported function opcode "+_e.toString(16)):console.error("WK1 unrecognized opcode "+_e.toString(16))}}I.length==1?F[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")}function G(j){var F=[{c:0,r:0},{t:"n",v:0},0];return F[0].r=j.read_shift(2),F[3]=j[j.l++],F[0].c=j[j.l++],F}function W(j,F){var I=G(j);return I[1].t="s",I[1].v=j.read_shift(F-4,"cstr"),I}function B(j,F,I,z){var ne=ft(6+z.length);ne.write_shift(2,j),ne.write_shift(1,I),ne.write_shift(1,F),ne.write_shift(1,39);for(var se=0;se<z.length;++se){var pe=z.charCodeAt(se);ne.write_shift(1,pe>=128?95:pe)}return ne.write_shift(1,0),ne}function q(j,F){var I=G(j);I[1].v=j.read_shift(2);var z=I[1].v>>1;if(I[1].v&1)switch(z&7){case 0:z=(z>>3)*5e3;break;case 1:z=(z>>3)*500;break;case 2:z=(z>>3)/20;break;case 3:z=(z>>3)/200;break;case 4:z=(z>>3)/2e3;break;case 5:z=(z>>3)/2e4;break;case 6:z=(z>>3)/16;break;case 7:z=(z>>3)/64;break}return I[1].v=z,I}function L(j,F){var I=G(j),z=j.read_shift(4),ne=j.read_shift(4),se=j.read_shift(2);if(se==65535)return z===0&&ne===3221225472?(I[1].t="e",I[1].v=15):z===0&&ne===3489660928?(I[1].t="e",I[1].v=42):I[1].v=0,I;var pe=se&32768;return se=(se&32767)-16446,I[1].v=(1-pe*2)*(ne*Math.pow(2,se+32)+z*Math.pow(2,se)),I}function J(j,F,I,z){var ne=ft(14);if(ne.write_shift(2,j),ne.write_shift(1,I),ne.write_shift(1,F),z==0)return ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(2,65535),ne;var se=0,pe=0,ye=0,_e=0;return z<0&&(se=1,z=-z),pe=Math.log2(z)|0,z/=Math.pow(2,pe-31),_e=z>>>0,(_e&2147483648)==0&&(z/=2,++pe,_e=z>>>0),z-=_e,_e|=2147483648,_e>>>=0,z*=Math.pow(2,32),ye=z>>>0,ne.write_shift(4,ye),ne.write_shift(4,_e),pe+=16383+(se?32768:0),ne.write_shift(2,pe),ne}function D(j,F){var I=L(j);return j.l+=F-14,I}function O(j,F){var I=G(j),z=j.read_shift(4);return I[1].v=z>>6,I}function M(j,F){var I=G(j),z=j.read_shift(8,"f");return I[1].v=z,I}function V(j,F){var I=M(j);return j.l+=F-10,I}function ie(j,F){return j[j.l+F-1]==0?j.read_shift(F,"cstr"):""}function X(j,F){var I=j[j.l++];I>F-1&&(I=F-1);for(var z="";z.length<I;)z+=String.fromCharCode(j[j.l++]);return z}function Z(j,F,I){if(!(!I.qpro||F<21)){var z=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var ne=j.read_shift(F-21,"cstr");return[z,ne]}}function K(j,F){for(var I={},z=j.l+F;j.l<z;){var ne=j.read_shift(2);if(ne==14e3){for(I[ne]=[0,""],I[ne][0]=j.read_shift(2);j[j.l];)I[ne][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return I}function ae(j,F){var I=ft(5+j.length);I.write_shift(2,14e3),I.write_shift(2,F);for(var z=0;z<j.length;++z){var ne=j.charCodeAt(z);I[I.l++]=ne>127?95:ne}return I[I.l++]=0,I}var fe={0:{n:"BOF",f:Mn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ie},222:{n:"SHEETNAMELP",f:X},65535:{n:""}},U={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:W},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:q},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:K},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:O},38:{n:"??"},39:{n:"NUMBER27",f:M},40:{n:"FORMULA28",f:V},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ie},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Z},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:e}})();function rD(t){var e={},r=t.match(Ms),a=0,n=!1;if(r)for(;a!=r.length;++a){var s=Sr(r[a]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=l2[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(s[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+s[0])}}return e}var aD=(function(){var t=M0("t"),e=M0("rPr");function r(s){var l=s.match(t);if(!l)return{t:"s",v:""};var c={t:"s",v:ea(l[1])},f=s.match(e);return f&&(c.s=rD(f[1])),c}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(l){return l.replace(a,"").split(n).map(r).filter(function(c){return c.v})}})(),nD=(function(){var e=/(\r\n|\n)/g;function r(n,s,l){var c=[];n.u&&c.push("text-decoration: underline;"),n.uval&&c.push("text-underline-style:"+n.uval+";"),n.sz&&c.push("font-size:"+n.sz+"pt;"),n.outline&&c.push("text-effect: outline;"),n.shadow&&c.push("text-shadow: auto;"),s.push('<span style="'+c.join("")+'">'),n.b&&(s.push("<b>"),l.push("</b>")),n.i&&(s.push("<i>"),l.push("</i>")),n.strike&&(s.push("<s>"),l.push("</s>"));var f=n.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(s.push("<"+f+">"),l.push("</"+f+">")),l.push("</span>"),n}function a(n){var s=[[],n.v,[]];return n.v?(n.s&&r(n.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(a).join("")}})(),sD=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,iD=/<(?:\w+:)?r>/,oD=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function R2(t,e){var r=e?e.cellHTML:!0,a={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=ea(ka(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=ka(t),r&&(a.h=x2(a.t))):t.match(iD)&&(a.r=ka(t),a.t=ea(ka((t.replace(oD,"").match(sD)||[]).join("").replace(Ms,""))),r&&(a.h=nD(aD(a.r)))),a):{t:""}}var lD=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,cD=/<(?:\w+:)?(?:si|sstItem)>/g,uD=/<\/(?:\w+:)?(?:si|sstItem)>/;function fD(t,e){var r=[],a="";if(!t)return r;var n=t.match(lD);if(n){a=n[2].replace(cD,"").split(uD);for(var s=0;s!=a.length;++s){var l=R2(a[s].trim(),e);l!=null&&(r[r.length]=l)}n=Sr(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var dD=/^\s|\s$|[\t\n\r]/;function j3(t,e){if(!e.bookSST)return"";var r=[Cn];r[r.length]=Mt("sst",null,{xmlns:Df[0],count:t.Count,uniqueCount:t.Unique});for(var a=0;a!=t.length;++a)if(t[a]!=null){var n=t[a],s="<si>";n.r?s+=n.r:(s+="<t",n.t||(n.t=""),n.t.match(dD)&&(s+=' xml:space="preserve"'),s+=">"+xa(n.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function hD(t){return[t.read_shift(4),t.read_shift(4)]}function mD(t,e){var r=[],a=!1;return bc(t,function(s,l,c){switch(c){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(l.T,!a||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function pD(t,e){return e||(e=ft(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var gD=kO;function vD(t){var e=hi();bt(e,159,pD(t));for(var r=0;r<t.length;++r)bt(e,19,gD(t[r]));return bt(e,160),e.end()}function k3(t){for(var e=[],r=t.split(""),a=0;a<r.length;++a)e[a]=r[a].charCodeAt(0);return e}function mc(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function xD(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=mc(t,4),e.U=mc(t,4),e.W=mc(t,4),e}function yD(t){for(var e=t.read_shift(4),r=t.l+e-4,a={},n=t.read_shift(4),s=[];n-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(a.name=t.read_shift(0,"lpp4"),a.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return a}function _D(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(yD(t));return e}function bD(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function wD(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=mc(t,4),e.U=mc(t,4),e.W=mc(t,4),e}function SD(t){var e=wD(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function E3(t,e){var r=t.l+e,a={};a.Flags=t.read_shift(4)&63,t.l+=4,a.AlgID=t.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=t.read_shift(4),a.KeySize=t.read_shift(4),a.ProviderType=t.read_shift(4),t.l+=8,a.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,a}function A3(t,e){var r={},a=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,a),t.l=a,r}function ND(t){var e=mc(t);switch(e.Minor){case 2:return[e.Minor,jD(t)];case 3:return[e.Minor,kD()];case 4:return[e.Minor,ED(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function jD(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),a=E3(t,r),n=A3(t,t.length-t.l);return{t:"Std",h:a,v:n}}function kD(){throw new Error("File is password-protected: ECMA-376 Extensible")}function ED(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),a={};return r.replace(Ms,function(s){var l=Sr(s);switch(Al(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(c){a[c]=l[c]});break;case"<dataIntegrity":a.encryptedHmacKey=l.encryptedHmacKey,a.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(l);break;default:throw l[0]}}),a}function AD(t,e){var r={},a=r.EncryptionVersionInfo=mc(t,4);if(e-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=t.read_shift(4),e-=4;var n=t.read_shift(4);return e-=4,r.EncryptionHeader=E3(t,n),e-=n,r.EncryptionVerifier=A3(t,e),r}function CD(t){var e={},r=e.EncryptionVersionInfo=mc(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function D2(t){var e=0,r,a=k3(t),n=a.length+1,s,l,c,f,d;for(r=vu(n),r[0]=a.length,s=1;s!=n;++s)r[s]=a[s-1];for(s=n-1;s>=0;--s)l=r[s],c=(e&16384)===0?0:1,f=e<<1&32767,d=c|f,e=d^l;return e^52811}var C3=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(l){return(l/2|l*128)&255},n=function(l,c){return a(l^c)},s=function(l){for(var c=e[l.length-1],f=104,d=l.length-1;d>=0;--d)for(var m=l[d],v=0;v!=7;++v)m&64&&(c^=r[f]),m*=2,--f;return c};return function(l){for(var c=k3(l),f=s(c),d=c.length,m=vu(16),v=0;v!=16;++v)m[v]=0;var x,g,b;for((d&1)===1&&(x=f>>8,m[d]=n(t[0],x),--d,x=f&255,g=c[c.length-1],m[d]=n(g,x));d>0;)--d,x=f>>8,m[d]=n(c[d],x),--d,x=f&255,m[d]=n(c[d],x);for(d=15,b=15-c.length;b>0;)x=f>>8,m[d]=n(t[b],x),--d,--b,x=f&255,m[d]=n(c[d],x),--d,--b;return m}})(),TD=function(t,e,r,a,n){n||(n=e),a||(a=C3(t));var s,l;for(s=0;s!=e.length;++s)l=e[s],l^=a[r],l=(l>>5|l<<3)&255,n[s]=l,++r;return[n,r,a]},OD=function(t){var e=0,r=C3(t);return function(a){var n=TD("",a,e,r);return e=n[1],n[0]}};function RD(t,e,r,a){var n={key:Mn(t),verificationBytes:Mn(t)};return r.password&&(n.verifier=D2(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=OD(r.password)),n}function DD(t,e,r){var a=r||{};return a.Info=t.read_shift(2),t.l-=2,a.Info===1?a.Data=CD(t):a.Data=AD(t,e),a}function FD(t,e,r){var a={Type:r.biff>=8?t.read_shift(2):0};return a.Type?DD(t,e-2,a):RD(t,r.biff>=8?e:e-2,r,a),a}var T3=(function(){function t(n,s){switch(s.type){case"base64":return e(qi(n),s);case"binary":return e(n,s);case"buffer":return e(Pr&&Buffer.isBuffer(n)?n.toString("binary"):Su(n),s);case"array":return e(Sf(n),s)}throw new Error("Unrecognized type "+s.type)}function e(n,s){var l=s||{},c=l.dense?[]:{},f=n.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(m,v){Array.isArray(c)&&(c[v]=[]);for(var x=/\\\w+\b/g,g=0,b,_=-1;b=x.exec(m);){switch(b[0]){case"\\cell":var w=m.slice(g,x.lastIndex-b[0].length);if(w[0]==" "&&(w=w.slice(1)),++_,w.length){var E={v:w,t:"s"};Array.isArray(c)?c[v][_]=E:c[wr({r:v,c:_})]=E}break}g=x.lastIndex}_>d.e.c&&(d.e.c=_)}),c["!ref"]=Or(d),c}function r(n,s){return Nu(t(n,s),s)}function a(n){for(var s=["{\\rtf1\\ansi"],l=ta(n["!ref"]),c,f=Array.isArray(n),d=l.s.r;d<=l.e.r;++d){s.push("\\trowd\\trautofit1");for(var m=l.s.c;m<=l.e.c;++m)s.push("\\cellx"+(m+1));for(s.push("\\pard\\intbl"),m=l.s.c;m<=l.e.c;++m){var v=wr({r:d,c:m});c=f?(n[d]||[])[m]:n[v],!(!c||c.v==null&&(!c.f||c.F))&&(s.push(" "+(c.w||(pc(c),c.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:a}})();function LD(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function q0(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function PD(t){var e=t[0]/255,r=t[1]/255,a=t[2]/255,n=Math.max(e,r,a),s=Math.min(e,r,a),l=n-s;if(l===0)return[0,0,e];var c=0,f=0,d=n+s;switch(f=l/(d>1?2-d:d),n){case e:c=((r-a)/l+6)%6;break;case r:c=(a-e)/l+2;break;case a:c=(e-r)/l+4;break}return[c/6,f,d/2]}function MD(t){var e=t[0],r=t[1],a=t[2],n=r*2*(a<.5?a:1-a),s=a-n/2,l=[s,s,s],c=6*e,f;if(r!==0)switch(c|0){case 0:case 6:f=n*c,l[0]+=n,l[1]+=f;break;case 1:f=n*(2-c),l[0]+=f,l[1]+=n;break;case 2:f=n*(c-2),l[1]+=n,l[2]+=f;break;case 3:f=n*(4-c),l[1]+=f,l[2]+=n;break;case 4:f=n*(c-4),l[2]+=n,l[0]+=f;break;case 5:f=n*(6-c),l[2]+=f,l[0]+=n;break}for(var d=0;d!=3;++d)l[d]=Math.round(l[d]*255);return l}function i1(t,e){if(e===0)return t;var r=PD(LD(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),q0(MD(r))}var O3=6,ID=15,BD=1,Ds=O3;function z0(t){return Math.floor((t+Math.round(128/Ds)/256)*Ds)}function H0(t){return Math.floor((t-5)/Ds*100+.5)/100}function o1(t){return Math.round((t*Ds+5)/Ds*256)/256}function hv(t){return o1(H0(z0(t)))}function F2(t){var e=Math.abs(t-hv(t)),r=Ds;if(e>.005)for(Ds=BD;Ds<ID;++Ds)Math.abs(t-hv(t))<=e&&(e=Math.abs(t-hv(t)),r=Ds);Ds=r}function xu(t){t.width?(t.wpx=z0(t.width),t.wch=H0(t.wpx),t.MDW=Ds):t.wpx?(t.wch=H0(t.wpx),t.width=o1(t.wch),t.MDW=Ds):typeof t.wch=="number"&&(t.width=o1(t.wch),t.wpx=z0(t.width),t.MDW=Ds),t.customWidth&&delete t.customWidth}var UD=96,R3=UD;function $0(t){return t*96/R3}function uh(t){return t*R3/96}var qD={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function zD(t,e,r,a){e.Borders=[];var n={},s=!1;(t[0].match(Ms)||[]).forEach(function(l){var c=Sr(l);switch(Al(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},c.diagonalUp&&(n.diagonalUp=Ua(c.diagonalUp)),c.diagonalDown&&(n.diagonalDown=Ua(c.diagonalDown)),e.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+c[0]+" in borders")}})}function HD(t,e,r,a){e.Fills=[];var n={},s=!1;(t[0].match(Ms)||[]).forEach(function(l){var c=Sr(l);switch(Al(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},e.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":c.patternType&&(n.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),c.indexed&&(n.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(n.bgColor.theme=parseInt(c.theme,10)),c.tint&&(n.bgColor.tint=parseFloat(c.tint)),c.rgb&&(n.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),c.theme&&(n.fgColor.theme=parseInt(c.theme,10)),c.tint&&(n.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(n.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fills")}})}function $D(t,e,r,a){e.Fonts=[];var n={},s=!1;(t[0].match(Ms)||[]).forEach(function(l){var c=Sr(l);switch(Al(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(n),n={};break;case"<name":c.val&&(n.name=ka(c.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=c.val?Ua(c.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=c.val?Ua(c.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(c.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=c.val?Ua(c.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=c.val?Ua(c.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=c.val?Ua(c.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=c.val?Ua(c.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=c.val?Ua(c.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":c.val&&(n.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(n.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(n.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(n.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=l2[parseInt(c.val,10)];break;case"<color":if(n.color||(n.color={}),c.auto&&(n.color.auto=Ua(c.auto)),c.rgb)n.color.rgb=c.rgb.slice(-6);else if(c.indexed){n.color.index=parseInt(c.indexed,10);var f=vf[n.color.index];n.color.index==81&&(f=vf[1]),f||(f=vf[1]),n.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else c.theme&&(n.color.theme=parseInt(c.theme,10),c.tint&&(n.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=i1(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fonts")}})}function WD(t,e,r){e.NumberFmt=[];for(var a=gn(br),n=0;n<a.length;++n)e.NumberFmt[a[n]]=br[a[n]];var s=t[0].match(Ms);if(s)for(n=0;n<s.length;++n){var l=Sr(s[n]);switch(Al(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=ea(ka(l.formatCode)),f=parseInt(l.numFmtId,10);if(e.NumberFmt[f]=c,f>0){if(f>392){for(f=392;f>60&&e.NumberFmt[f]!=null;--f);e.NumberFmt[f]=c}hc(c,f)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function VD(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)t[a]!=null&&(e[e.length]=Mt("numFmt",null,{numFmtId:a,formatCode:xa(t[a])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Mt("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var _p=["numFmtId","fillId","fontId","borderId","xfId"],bp=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function GD(t,e,r){e.CellXf=[];var a,n=!1;(t[0].match(Ms)||[]).forEach(function(s){var l=Sr(s),c=0;switch(Al(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=l,delete a[0],c=0;c<_p.length;++c)a[_p[c]]&&(a[_p[c]]=parseInt(a[_p[c]],10));for(c=0;c<bp.length;++c)a[bp[c]]&&(a[bp[c]]=Ua(a[bp[c]]));if(e.NumberFmt&&a.numFmtId>392){for(c=392;c>60;--c)if(e.NumberFmt[a.numFmtId]==e.NumberFmt[c]){a.numFmtId=c;break}}e.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};l.vertical&&(f.vertical=l.vertical),l.horizontal&&(f.horizontal=l.horizontal),l.textRotation!=null&&(f.textRotation=l.textRotation),l.indent&&(f.indent=l.indent),l.wrapText&&(f.wrapText=Ua(l.wrapText)),a.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function YD(t){var e=[];return e[e.length]=Mt("cellXfs",null),t.forEach(function(r){e[e.length]=Mt("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Mt("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var XD=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,f,d){var m={};if(!c)return m;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=c.match(e))&&WD(v,m,d),(v=c.match(n))&&$D(v,m,f,d),(v=c.match(a))&&HD(v,m,f,d),(v=c.match(s))&&zD(v,m,f,d),(v=c.match(r))&&GD(v,m,d),m}})();function D3(t,e){var r=[Cn,Mt("styleSheet",null,{xmlns:Df[0],"xmlns:vt":Kn.vt})],a;return t.SSF&&(a=VD(t.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=YD(e.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function KD(t,e){var r=t.read_shift(2),a=Ls(t);return[r,a]}function JD(t,e,r){r||(r=ft(6+4*e.length)),r.write_shift(2,t),os(e,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function ZD(t,e,r){var a={};a.sz=t.read_shift(2)/20;var n=DO(t);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var s=t.read_shift(2);switch(s===700&&(a.bold=1),t.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var l=t.read_shift(1);l!=0&&(a.underline=l);var c=t.read_shift(1);c>0&&(a.family=c);var f=t.read_shift(1);switch(f>0&&(a.charset=f),t.l++,a.color=RO(t),t.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Ls(t),a}function QD(t,e){e||(e=ft(153)),e.write_shift(2,t.sz*20),FO(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),a1(t.color,e);var a=0;return a=2,e.write_shift(1,a),os(t.name,e),e.length>e.l?e.slice(0,e.l):e}var eF=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],mv,tF=Ps;function a5(t,e){e||(e=ft(84)),mv||(mv=w1(eF));var r=mv[t.patternType];r==null&&(r=40),e.write_shift(4,r);var a=0;if(r!=40)for(a1({auto:1},e),a1({auto:1},e);a<12;++a)e.write_shift(4,0);else{for(;a<4;++a)e.write_shift(4,0);for(;a<12;++a)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function rF(t,e){var r=t.l+e,a=t.read_shift(2),n=t.read_shift(2);return t.l=r,{ixfe:a,numFmtId:n}}function F3(t,e,r){r||(r=ft(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function n0(t,e){return e||(e=ft(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var aF=Ps;function nF(t,e){return e||(e=ft(51)),e.write_shift(1,0),n0(null,e),n0(null,e),n0(null,e),n0(null,e),n0(null,e),e.length>e.l?e.slice(0,e.l):e}function sF(t,e){return e||(e=ft(52)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),r1(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function iF(t,e,r){var a=ft(2052);return a.write_shift(4,t),r1(e,a),r1(r,a),a.length>a.l?a.slice(0,a.l):a}function oF(t,e,r){var a={};a.NumberFmt=[];for(var n in br)a.NumberFmt[n]=br[n];a.CellXf=[],a.Fonts=[];var s=[],l=!1;return bc(t,function(f,d,m){switch(m){case 44:a.NumberFmt[f[0]]=f[1],hc(f[1],f[0]);break;case 43:a.Fonts.push(f),f.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(f.color.rgb=i1(e.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&a.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:s.push(m),l=!0;break;case 38:s.pop(),l=!1;break;default:if(d.T>0)s.push(m);else if(d.T<0)s.pop();else if(!l||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),a}function lF(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)e[n]!=null&&++r}),r!=0&&(bt(t,615,Ko(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)e[n]!=null&&bt(t,44,JD(n,e[n]))}),bt(t,616))}}function cF(t){var e=1;bt(t,611,Ko(e)),bt(t,43,QD({sz:12,color:{theme:1},name:"Calibri",family:2})),bt(t,612)}function uF(t){var e=2;bt(t,603,Ko(e)),bt(t,45,a5({patternType:"none"})),bt(t,45,a5({patternType:"gray125"})),bt(t,604)}function fF(t){var e=1;bt(t,613,Ko(e)),bt(t,46,nF()),bt(t,614)}function dF(t){var e=1;bt(t,626,Ko(e)),bt(t,47,F3({numFmtId:0},65535)),bt(t,627)}function hF(t,e){bt(t,617,Ko(e.length)),e.forEach(function(r){bt(t,47,F3(r,0))}),bt(t,618)}function mF(t){var e=1;bt(t,619,Ko(e)),bt(t,48,sF({xfId:0,name:"Normal"})),bt(t,620)}function pF(t){var e=0;bt(t,505,Ko(e)),bt(t,506)}function gF(t){var e=0;bt(t,508,iF(e,"TableStyleMedium9","PivotStyleMedium4")),bt(t,509)}function vF(t,e){var r=hi();return bt(r,278),lF(r,t.SSF),cF(r),uF(r),fF(r),dF(r),hF(r,e.cellXfs),mF(r),pF(r),gF(r),bt(r,279),r.end()}var xF=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function yF(t,e,r){e.themeElements.clrScheme=[];var a={};(t[0].match(Ms)||[]).forEach(function(n){var s=Sr(n);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=s.val;break;case"<a:sysClr":a.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[xF.indexOf(s[0])]=a,a={}):a.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function _F(){}function bF(){}var wF=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,SF=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,NF=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function jF(t,e,r){e.themeElements={};var a;[["clrScheme",wF,yF],["fontScheme",SF,_F],["fmtScheme",NF,bF]].forEach(function(n){if(!(a=t.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,e,r)})}var kF=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function L3(t,e){(!t||t.length===0)&&(t=L2());var r,a={};if(!(r=t.match(kF)))throw new Error("themeElements not found in theme");return jF(r[0],a,e),a.raw=t,a}function L2(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Cn];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function EF(t,e,r){var a=t.l+e,n=t.read_shift(4);if(n!==124226){if(!r.cellStyles){t.l=a;return}var s=t.slice(t.l);t.l=a;var l;try{l=EN(s,{type:"array"})}catch{return}var c=Ii(l,"theme/theme/theme1.xml",!0);if(c)return L3(c,r)}}function AF(t){return t.read_shift(4)}function CF(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=TF(t,4);break;case 2:e.xclrValue=m3(t);break;case 3:e.xclrValue=AF(t);break;case 4:t.l+=4;break}return t.l+=8,e}function TF(t,e){return Ps(t,e)}function OF(t,e){return Ps(t,e)}function RF(t){var e=t.read_shift(2),r=t.read_shift(2)-4,a=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=CF(t);break;case 6:a[1]=OF(t,r);break;case 14:case 15:a[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return a}function DF(t,e){var r=t.l+e;t.l+=2;var a=t.read_shift(2);t.l+=2;for(var n=t.read_shift(2),s=[];n-- >0;)s.push(RF(t,r-t.l));return{ixfe:a,ext:s}}function FF(t,e){e.forEach(function(r){r[0]})}function LF(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Ls(t)}}function PF(t){var e=ft(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),os(t.name,e),e.slice(0,e.l)}function MF(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function IF(t){var e=ft(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function BF(t,e){var r=ft(8+2*e.length);return r.write_shift(4,t),os(e,r),r.slice(0,r.l)}function UF(t){return t.l+=4,t.read_shift(4)!=0}function qF(t,e){var r=ft(8);return r.write_shift(4,t),r.write_shift(4,1),r}function zF(t,e,r){var a={Types:[],Cell:[],Value:[]},n=r||{},s=[],l=!1,c=2;return bc(t,function(f,d,m){switch(m){case 335:a.Types.push({name:f.name});break;case 51:f.forEach(function(v){c==1?a.Cell.push({type:a.Types[v[0]-1].name,index:v[1]}):c==0&&a.Value.push({type:a.Types[v[0]-1].name,index:v[1]})});break;case 337:c=f?1:0;break;case 338:c=2;break;case 35:s.push(m),l=!0;break;case 36:s.pop(),l=!1;break;default:if(!d.T){if(!l||n.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),a}function HF(){var t=hi();return bt(t,332),bt(t,334,Ko(1)),bt(t,335,PF({name:"XLDAPR",version:12e4,flags:3496657072})),bt(t,336),bt(t,339,BF(1,"XLDAPR")),bt(t,52),bt(t,35,Ko(514)),bt(t,4096,Ko(0)),bt(t,4097,co(1)),bt(t,36),bt(t,53),bt(t,340),bt(t,337,qF(1)),bt(t,51,IF([[1,0]])),bt(t,338),bt(t,333),t.end()}function $F(t,e,r){var a={Types:[],Cell:[],Value:[]};if(!t)return a;var n=!1,s=2,l;return t.replace(Ms,function(c){var f=Sr(c);switch(Al(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<a.Types.length;++d)a.Types[d].name==f.name&&(l=a.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?a.Cell.push({type:a.Types[f.t-1].name,index:+f.v}):s==0&&a.Value.push({type:a.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+f.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return c}),a}function P3(){var t=[Cn];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function WF(t){var e=[];if(!t)return e;var r=1;return(t.match(Ms)||[]).forEach(function(a){var n=Sr(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,e.push(n);break}}),e}function VF(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=wr(r);var a=t.read_shift(1);return a&2&&(e.l="1"),a&8&&(e.a="1"),e}function GF(t,e,r){var a=[];return bc(t,function(s,l,c){switch(c){case 63:a.push(s);break;default:if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),a}function YF(t,e,r,a){if(!t)return t;var n=a||{},s=!1;bc(t,function(c,f,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!f.T){if(!s||n.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},n)}function XF(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Yd=1024;function M3(t,e){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[Mt("xml",null,{"xmlns:v":Di.v,"xmlns:o":Di.o,"xmlns:x":Di.x,"xmlns:mv":Di.mv}).replace(/\/>/,">"),Mt("o:shapelayout",Mt("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Mt("v:shapetype",[Mt("v:stroke",null,{joinstyle:"miter"}),Mt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];Yd<t*1e3;)Yd+=1e3;return e.forEach(function(s){var l=rn(s[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var f=c.type=="gradient"?Mt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Mt("v:fill",f,c),m={on:"t",obscured:"t"};++Yd,n=n.concat(["<v:shape"+I0({id:"_x0000_s"+Yd,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Mt("v:shadow",null,m),Mt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",_s("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),_s("x:AutoFill","False"),_s("x:Row",String(l.r)),_s("x:Column",String(l.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function n5(t,e,r,a){var n=Array.isArray(t),s;e.forEach(function(l){var c=rn(l.ref);if(n?(t[c.r]||(t[c.r]=[]),s=t[c.r][c.c]):s=t[l.ref],!s){s={t:"z"},n?t[c.r][c.c]=s:t[l.ref]=s;var f=ta(t["!ref"]||"BDWGO1000001:A1");f.s.r>c.r&&(f.s.r=c.r),f.e.r<c.r&&(f.e.r=c.r),f.s.c>c.c&&(f.s.c=c.c),f.e.c<c.c&&(f.e.c=c.c);var d=Or(f);d!==t["!ref"]&&(t["!ref"]=d)}s.c||(s.c=[]);var m={a:l.author,t:l.t,r:l.r,T:r};l.h&&(m.h=l.h);for(var v=s.c.length-1;v>=0;--v){if(!r&&s.c[v].T)return;r&&!s.c[v].T&&s.c.splice(v,1)}if(r&&a){for(v=0;v<a.length;++v)if(m.a==a[v].id){m.a=a[v].name||m.a;break}}s.c.push(m)})}function KF(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?comment[^>]*>/);if(c){var f=Sr(c[0]),d={author:f.authorId&&r[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},m=rn(f.ref);if(!(e.sheetRows&&e.sheetRows<=m.r)){var v=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!v&&!!v[1]&&R2(v[1])||{r:"",t:"",h:""};d.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),d.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=x.h),a.push(d)}}}}),a}function I3(t){var e=[Cn,Mt("comments",null,{xmlns:Df[0]})],r=[];return e.push("<authors>"),t.forEach(function(a){a[1].forEach(function(n){var s=xa(n.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),e.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(a){var n=0,s=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(f){f.a&&(n=r.indexOf(xa(f.a))),s.push(f.t||"")}),e.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),s.length<=1)e.push(_s("t",xa(s[0]||"")));else{for(var l=`Comment:
    `+s[0]+`
`,c=1;c<s.length;++c)l+=`Reply:
    `+s[c]+`
`;e.push(_s("t",xa(l)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function JF(t,e){var r=[],a=!1,n={},s=0;return t.replace(Ms,function(c,f){var d=Sr(c);switch(Al(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":s=f+c.length;break;case"</text>":n.t=t.slice(s,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return c}),r}function ZF(t,e,r){var a=[Cn,Mt("ThreadedComments",null,{xmlns:Kn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(n){var s="";(n[1]||[]).forEach(function(l,c){if(!l.T){delete l.ID;return}l.a&&e.indexOf(l.a)==-1&&e.push(l.a);var f={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};c==0?s=f.id:f.parentId=s,l.ID=f.id,l.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(l.a)).slice(-12)+"}"),a.push(Mt("threadedComment",_s("text",l.t||""),f))})}),a.push("</ThreadedComments>"),a.join("")}function QF(t,e){var r=[],a=!1;return t.replace(Ms,function(s){var l=Sr(s);switch(Al(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s}),r}function eL(t){var e=[Cn,Mt("personList",null,{xmlns:Kn.TCMNT,"xmlns:x":Df[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,a){e.push(Mt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function tL(t){var e={};e.iauthor=t.read_shift(4);var r=Mf(t);return e.rfx=r.s,e.ref=wr(r.s),t.l+=16,e}function rL(t,e){return e==null&&(e=ft(36)),e.write_shift(4,t[1].iauthor),yh(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var aL=Ls;function nL(t){return os(t.slice(0,54))}function sL(t,e){var r=[],a=[],n={},s=!1;return bc(t,function(c,f,d){switch(d){case 632:a.push(c);break;case 635:n=c;break;case 637:n.t=c.t,n.h=c.h,n.r=c.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,e.sheetRows&&n.rfx&&e.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function iL(t){var e=hi(),r=[];return bt(e,628),bt(e,630),t.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),bt(e,632,nL(n.a)))})}),bt(e,631),bt(e,633),t.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var s={s:rn(a[0]),e:rn(a[0])};bt(e,635,rL([s,n])),n.t&&n.t.length>0&&bt(e,637,AO(n)),bt(e,636),delete n.iauthor})}),bt(e,634),bt(e,629),e.end()}var oL="application/vnd.ms-office.vbaProject";function lL(t){var e=hr.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");hr.utils.cfb_add(e,n,t.FileIndex[a].content)}}),hr.write(e)}function cL(t,e){e.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&hr.utils.cfb_add(t,n,e.FileIndex[a].content)}})}var B3=["xlsb","xlsm","xlam","biff8","xla"];function uL(){return{"!type":"dialog"}}function fL(){return{"!type":"dialog"}}function dL(){return{"!type":"macro"}}function hL(){return{"!type":"macro"}}var eh=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(a,n,s,l){var c=!1,f=!1;s.length==0?f=!0:s.charAt(0)=="["&&(f=!0,s=s.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var d=s.length>0?parseInt(s,10)|0:0,m=l.length>0?parseInt(l,10)|0:0;return c?m+=e.c:--m,f?d+=e.r:--d,n+(c?"":"$")+tn(m)+(f?"":"$")+An(d)}return function(n,s){return e=s,n.replace(t,r)}})(),P2=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,M2=(function(){return function(e,r){return e.replace(P2,function(a,n,s,l,c,f){var d=S2(l)-(s?0:r.c),m=w2(f)-(c?0:r.r),v=m==0?"":c?m+1:"["+m+"]",x=d==0?"":s?d+1:"["+d+"]";return n+"R"+v+"C"+x})}})();function U3(t,e){return t.replace(P2,function(r,a,n,s,l,c){return a+(n=="$"?n+s:tn(S2(s)+e.c))+(l=="$"?l+c:An(w2(c)+e.r))})}function mL(t,e,r){var a=mi(e),n=a.s,s=rn(r),l={r:s.r-n.r,c:s.c-n.c};return U3(t,l)}function pL(t){return t.length!=1}function s5(t){return t.replace(/_xlfn\./g,"")}function Ln(t){t.l+=1}function yu(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function q3(t,e,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return z3(t);r.biff==12&&(a=4)}var n=t.read_shift(a),s=t.read_shift(a),l=yu(t),c=yu(t);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function z3(t){var e=yu(t),r=yu(t),a=t.read_shift(1),n=t.read_shift(1);return{s:{r:e[0],c:a,cRel:e[1],rRel:e[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function gL(t,e,r){if(r.biff<8)return z3(t);var a=t.read_shift(r.biff==12?4:2),n=t.read_shift(r.biff==12?4:2),s=yu(t),l=yu(t);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:l[0],cRel:l[1],rRel:l[2]}}}function H3(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return vL(t);var a=t.read_shift(r&&r.biff==12?4:2),n=yu(t);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function vL(t){var e=yu(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function xL(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function yL(t,e,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return _L(t);var n=t.read_shift(a>=12?4:2),s=t.read_shift(2),l=(s&16384)>>14,c=(s&32768)>>15;if(s&=16383,c==1)for(;n>524287;)n-=1048576;if(l==1)for(;s>8191;)s=s-16384;return{r:n,c:s,cRel:l,rRel:c}}function _L(t){var e=t.read_shift(2),r=t.read_shift(1),a=(e&32768)>>15,n=(e&16384)>>14;return e&=16383,a==1&&e>=8192&&(e=e-16384),n==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:n,rRel:a}}function bL(t,e,r){var a=(t[t.l++]&96)>>5,n=q3(t,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function wL(t,e,r){var a=(t[t.l++]&96)>>5,n=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var l=q3(t,s,r);return[a,n,l]}function SL(t,e,r){var a=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function NL(t,e,r){var a=(t[t.l++]&96)>>5,n=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[a,n]}function jL(t,e,r){var a=(t[t.l++]&96)>>5,n=gL(t,e-1,r);return[a,n]}function kL(t,e,r){var a=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[a]}function i5(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function EL(t,e,r){t.l+=2;for(var a=t.read_shift(r&&r.biff==2?1:2),n=[],s=0;s<=a;++s)n.push(t.read_shift(r&&r.biff==2?1:2));return n}function AL(t,e,r){var a=t[t.l+1]&255?1:0;return t.l+=2,[a,t.read_shift(r&&r.biff==2?1:2)]}function CL(t,e,r){var a=t[t.l+1]&255?1:0;return t.l+=2,[a,t.read_shift(r&&r.biff==2?1:2)]}function TL(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function OL(t,e,r){var a=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[a]}function $3(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function RL(t){return t.read_shift(2),$3(t)}function DL(t){return t.read_shift(2),$3(t)}function FL(t,e,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=H3(t,0,r);return[a,n]}function LL(t,e,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=yL(t,0,r);return[a,n]}function PL(t,e,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=H3(t,0,r);return[a,n,s]}function ML(t,e,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=t.read_shift(r&&r.biff<=3?1:2);return[UP[n],G3[n],a]}function IL(t,e,r){var a=t[t.l++],n=t.read_shift(1),s=r&&r.biff<=3?[a==88?-1:0,t.read_shift(1)]:BL(t);return[n,(s[0]===0?G3:BP)[s[1]]]}function BL(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function UL(t,e,r){t.l+=r&&r.biff==2?3:4}function qL(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var a=t.read_shift(2),n=t.read_shift(r&&r.biff==2?1:2);return[a,n]}function zL(t){return t.l++,wc[t.read_shift(1)]}function HL(t){return t.l++,t.read_shift(2)}function $L(t){return t.l++,t.read_shift(1)!==0}function WL(t){return t.l++,Fs(t)}function VL(t,e,r){return t.l++,rm(t,e-1,r)}function GL(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=wn(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=wc[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Fs(t);break;case 2:r[1]=If(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function YL(t,e,r){for(var a=t.read_shift(r.biff==12?4:2),n=[],s=0;s!=a;++s)n.push((r.biff==12?Mf:j1)(t));return n}function XL(t,e,r){var a=0,n=0;r.biff==12?(a=t.read_shift(4),n=t.read_shift(4)):(n=1+t.read_shift(1),a=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var s=0,l=[];s!=a&&(l[s]=[]);++s)for(var c=0;c!=n;++c)l[s][c]=GL(t,r.biff);return l}function KL(t,e,r){var a=t.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,s=t.read_shift(n);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[a,0,s]}function JL(t,e,r){if(r.biff==5)return ZL(t);var a=t.read_shift(1)>>>5&3,n=t.read_shift(2),s=t.read_shift(4);return[a,n,s]}function ZL(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var a=t.read_shift(2);return t.l+=12,[e,r,a]}function QL(t,e,r){var a=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var n=t.read_shift(r&&r.biff==2?1:2);return[a,n]}function eP(t,e,r){var a=t.read_shift(1)>>>5&3,n=t.read_shift(r&&r.biff==2?1:2);return[a,n]}function tP(t,e,r){var a=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[a]}function rP(t,e,r){var a=(t[t.l++]&96)>>5,n=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[a,n]}var aP=Ps,nP=Ps,sP=Ps;function nm(t,e,r){return t.l+=2,[xL(t)]}function I2(t){return t.l+=6,[]}var iP=nm,oP=I2,lP=I2,cP=nm;function W3(t){return t.l+=2,[Mn(t),t.read_shift(2)&1]}var uP=nm,fP=W3,dP=I2,hP=nm,mP=nm,pP=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function gP(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(4),n=t.read_shift(2),s=t.read_shift(2),l=pP[r>>2&31];return{ixti:e,coltype:r&3,rt:l,idx:a,c:n,C:s}}function vP(t){return t.l+=2,[t.read_shift(4)]}function xP(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function yP(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function _P(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function bP(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function wP(t){return t.l+=4,[0,0]}var o5={1:{n:"PtgExp",f:qL},2:{n:"PtgTbl",f:sP},3:{n:"PtgAdd",f:Ln},4:{n:"PtgSub",f:Ln},5:{n:"PtgMul",f:Ln},6:{n:"PtgDiv",f:Ln},7:{n:"PtgPower",f:Ln},8:{n:"PtgConcat",f:Ln},9:{n:"PtgLt",f:Ln},10:{n:"PtgLe",f:Ln},11:{n:"PtgEq",f:Ln},12:{n:"PtgGe",f:Ln},13:{n:"PtgGt",f:Ln},14:{n:"PtgNe",f:Ln},15:{n:"PtgIsect",f:Ln},16:{n:"PtgUnion",f:Ln},17:{n:"PtgRange",f:Ln},18:{n:"PtgUplus",f:Ln},19:{n:"PtgUminus",f:Ln},20:{n:"PtgPercent",f:Ln},21:{n:"PtgParen",f:Ln},22:{n:"PtgMissArg",f:Ln},23:{n:"PtgStr",f:VL},26:{n:"PtgSheet",f:xP},27:{n:"PtgEndSheet",f:yP},28:{n:"PtgErr",f:zL},29:{n:"PtgBool",f:$L},30:{n:"PtgInt",f:HL},31:{n:"PtgNum",f:WL},32:{n:"PtgArray",f:kL},33:{n:"PtgFunc",f:ML},34:{n:"PtgFuncVar",f:IL},35:{n:"PtgName",f:KL},36:{n:"PtgRef",f:FL},37:{n:"PtgArea",f:bL},38:{n:"PtgMemArea",f:QL},39:{n:"PtgMemErr",f:aP},40:{n:"PtgMemNoMem",f:nP},41:{n:"PtgMemFunc",f:eP},42:{n:"PtgRefErr",f:tP},43:{n:"PtgAreaErr",f:SL},44:{n:"PtgRefN",f:LL},45:{n:"PtgAreaN",f:jL},46:{n:"PtgMemAreaN",f:_P},47:{n:"PtgMemNoMemN",f:bP},57:{n:"PtgNameX",f:JL},58:{n:"PtgRef3d",f:PL},59:{n:"PtgArea3d",f:wL},60:{n:"PtgRefErr3d",f:rP},61:{n:"PtgAreaErr3d",f:NL},255:{}},SP={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},NP={1:{n:"PtgElfLel",f:W3},2:{n:"PtgElfRw",f:hP},3:{n:"PtgElfCol",f:iP},6:{n:"PtgElfRwV",f:mP},7:{n:"PtgElfColV",f:cP},10:{n:"PtgElfRadical",f:uP},11:{n:"PtgElfRadicalS",f:dP},13:{n:"PtgElfColS",f:oP},15:{n:"PtgElfColSV",f:lP},16:{n:"PtgElfRadicalLel",f:fP},25:{n:"PtgList",f:gP},29:{n:"PtgSxName",f:vP},255:{}},jP={0:{n:"PtgAttrNoop",f:wP},1:{n:"PtgAttrSemi",f:OL},2:{n:"PtgAttrIf",f:CL},4:{n:"PtgAttrChoose",f:EL},8:{n:"PtgAttrGoto",f:AL},16:{n:"PtgAttrSum",f:UL},32:{n:"PtgAttrBaxcel",f:i5},33:{n:"PtgAttrBaxcel",f:i5},64:{n:"PtgAttrSpace",f:RL},65:{n:"PtgAttrSpaceSemi",f:DL},128:{n:"PtgAttrIfError",f:TL},255:{}};function sm(t,e,r,a){if(a.biff<8)return Ps(t,e);for(var n=t.l+e,s=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=XL(t,0,a),s.push(r[l][1]);break;case"PtgMemArea":r[l][2]=YL(t,r[l][1],a),s.push(r[l][2]);break;case"PtgExp":a&&a.biff==12&&(r[l][1][1]=t.read_shift(4),s.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return e=n-t.l,e!==0&&s.push(Ps(t,e)),s}function im(t,e,r){for(var a=t.l+e,n,s,l=[];a!=t.l;)e=a-t.l,s=t[t.l],n=o5[s]||o5[SP[s]],(s===24||s===25)&&(n=(s===24?NP:jP)[t[t.l+1]]),!n||!n.f?Ps(t,e):l.push([n.n,n.f(t,e,r)]);return l}function kP(t){for(var e=[],r=0;r<t.length;++r){for(var a=t[r],n=[],s=0;s<a.length;++s){var l=a[s];if(l)switch(l[0]){case 2:n.push('"'+l[1].replace(/"/g,'""')+'"');break;default:n.push(l[1])}else n.push("")}e.push(n.join(","))}return e.join(";")}var EP={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function AP(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function V3(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var a=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(t[a[0]][0]){case 357:return n=a[1]==-1?"#REF":t.SheetNames[a[1]],a[1]==a[2]?n:n+":"+t.SheetNames[a[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[a[0]][0];case 355:default:return"SH33TJSSRC"+t[a[0]][0]}switch(t[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":t.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+t.SheetNames[a[2]];case 14849:return t[a[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[a[0]][0][3]?(n=a[1]==-1?"#REF":t[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+t[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function l5(t,e,r){var a=V3(t,e,r);return a=="#REF"?a:AP(a,r)}function Rs(t,e,r,a,n){var s=n&&n.biff||8,l={s:{c:0,r:0}},c=[],f,d,m,v=0,x=0,g,b="";if(!t[0]||!t[0][0])return"";for(var _=-1,w="",E=0,C=t[0].length;E<C;++E){var A=t[0][E];switch(A[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=c.pop(),d=c.pop(),_>=0){switch(t[0][_][1][0]){case 0:w=mn(" ",t[0][_][1][1]);break;case 1:w=mn("\r",t[0][_][1][1]);break;default:if(w="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][_][1][0])}d=d+w,_=-1}c.push(d+EP[A[0]]+f);break;case"PtgIsect":f=c.pop(),d=c.pop(),c.push(d+" "+f);break;case"PtgUnion":f=c.pop(),d=c.pop(),c.push(d+","+f);break;case"PtgRange":f=c.pop(),d=c.pop(),c.push(d+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=v0(A[1][1],l,n),c.push(x0(m,s));break;case"PtgRefN":m=r?v0(A[1][1],r,n):A[1][1],c.push(x0(m,s));break;case"PtgRef3d":v=A[1][1],m=v0(A[1][2],l,n),b=l5(a,v,n),c.push(b+"!"+x0(m,s));break;case"PtgFunc":case"PtgFuncVar":var T=A[1][0],G=A[1][1];T||(T=0),T&=127;var W=T==0?[]:c.slice(-T);c.length-=T,G==="User"&&(G=W.shift()),c.push(G+"("+W.join(",")+")");break;case"PtgBool":c.push(A[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(A[1]);break;case"PtgNum":c.push(String(A[1]));break;case"PtgStr":c.push('"'+A[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(A[1]);break;case"PtgAreaN":g=Mw(A[1][1],r?{s:r}:l,n),c.push(uv(g,n));break;case"PtgArea":g=Mw(A[1][1],l,n),c.push(uv(g,n));break;case"PtgArea3d":v=A[1][1],g=A[1][2],b=l5(a,v,n),c.push(b+"!"+uv(g,n));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=A[1][2];var B=(a.names||[])[x-1]||(a[0]||[])[x],q=B?B.Name:"SH33TJSNAME"+String(x);q&&q.slice(0,6)=="_xlfn."&&!n.xlfn&&(q=q.slice(6)),c.push(q);break;case"PtgNameX":var L=A[1][1];x=A[1][2];var J;if(n.biff<=5)L<0&&(L=-L),a[L]&&(J=a[L][x]);else{var D="";if(((a[L]||[])[0]||[])[0]==14849||(((a[L]||[])[0]||[])[0]==1025?a[L][x]&&a[L][x].itab>0&&(D=a.SheetNames[a[L][x].itab-1]+"!"):D=a.SheetNames[x-1]+"!"),a[L]&&a[L][x])D+=a[L][x].Name;else if(a[0]&&a[0][x])D+=a[0][x].Name;else{var O=(V3(a,L,n)||"").split(";;");O[x-1]?D=O[x-1]:D+="SH33TJSERRX"}c.push(D);break}J||(J={Name:"SH33TJSERRY"}),c.push(J.Name);break;case"PtgParen":var M="(",V=")";if(_>=0){switch(w="",t[0][_][1][0]){case 2:M=mn(" ",t[0][_][1][1])+M;break;case 3:M=mn("\r",t[0][_][1][1])+M;break;case 4:V=mn(" ",t[0][_][1][1])+V;break;case 5:V=mn("\r",t[0][_][1][1])+V;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][_][1][0])}_=-1}c.push(M+c.pop()+V);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":m={c:A[1][1],r:A[1][0]};var ie={c:r.c,r:r.r};if(a.sharedf[wr(m)]){var X=a.sharedf[wr(m)];c.push(Rs(X,l,ie,a,n))}else{var Z=!1;for(f=0;f!=a.arrayf.length;++f)if(d=a.arrayf[f],!(m.c<d[0].s.c||m.c>d[0].e.c)&&!(m.r<d[0].s.r||m.r>d[0].e.r)){c.push(Rs(d[1],l,ie,a,n)),Z=!0;break}Z||c.push(A[1])}break;case"PtgArray":c.push("{"+kP(A[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+A[1].idx+"[#"+A[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(A));default:throw new Error("Unrecognized Formula Token: "+String(A))}var K=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&_>=0&&K.indexOf(t[0][E][0])==-1){A=t[0][_];var ae=!0;switch(A[1][0]){case 4:ae=!1;case 0:w=mn(" ",A[1][1]);break;case 5:ae=!1;case 1:w=mn("\r",A[1][1]);break;default:if(w="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+A[1][0])}c.push((ae?w:"")+c.pop()+(ae?"":w)),_=-1}}if(c.length>1&&n.WTF)throw new Error("bad formula stack");return c[0]}function CP(t,e,r){var a=t.l+e,n=r.biff==2?1:2,s,l=t.read_shift(n);if(l==65535)return[[],Ps(t,e-2)];var c=im(t,l,r);return e!==l+n&&(s=sm(t,e-l-n,c,r)),t.l=a,[c,s]}function TP(t,e,r){var a=t.l+e,n=r.biff==2?1:2,s,l=t.read_shift(n);if(l==65535)return[[],Ps(t,e-2)];var c=im(t,l,r);return e!==l+n&&(s=sm(t,e-l-n,c,r)),t.l=a,[c,s]}function OP(t,e,r,a){var n=t.l+e,s=im(t,a,r),l;return n!==t.l&&(l=sm(t,n-t.l,s,r)),[s,l]}function RP(t,e,r){var a=t.l+e,n,s=t.read_shift(2),l=im(t,s,r);return s==65535?[[],Ps(t,e-2)]:(e!==s+2&&(n=sm(t,a-s-2,l,r)),[l,n])}function DP(t){var e;if(cc(t,t.l+6)!==65535)return[Fs(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function FP(t){if(t==null){var e=ft(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Nf(t);return Nf(0)}function pv(t,e,r){var a=t.l+e,n=Cl(t);r.biff==2&&++t.l;var s=DP(t),l=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var c=TP(t,a-t.l,r);return{cell:n,val:s[0],formula:c,shared:l>>3&1,tt:s[1]}}function LP(t,e,r,a,n){var s=kf(e,r,n),l=FP(t.v),c=ft(6),f=33;c.write_shift(2,f),c.write_shift(4,0);for(var d=ft(t.bf.length),m=0;m<t.bf.length;++m)d[m]=t.bf[m];var v=is([s,l,c,d]);return v}function k1(t,e,r){var a=t.read_shift(4),n=im(t,a,r),s=t.read_shift(4),l=s>0?sm(t,s,n,r):null;return[n,l]}var PP=k1,E1=k1,MP=k1,IP=k1,BP={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},G3={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},UP={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function c5(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function qP(t){var e="of:="+t.replace(P2,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function gv(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function zP(t){return t.replace(/\./,"!")}var _0={},th={},b0=typeof Map<"u";function B2(t,e,r){var a=0,n=t.length;if(r){if(b0?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=b0?r.get(e):r[e];a<s.length;++a)if(t[s[a]].t===e)return t.Count++,s[a]}}else for(;a<n;++a)if(t[a].t===e)return t.Count++,a;return t[n]={t:e},t.Count++,t.Unique++,r&&(b0?(r.has(e)||r.set(e,[]),r.get(e).push(n)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(n))),n}function A1(t,e){var r={min:t+1,max:t+1},a=-1;return e.MDW&&(Ds=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?a=H0(e.wpx):e.wch!=null&&(a=e.wch),a>-1?(r.width=o1(a),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function _f(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function ju(t,e,r){var a=r.revssf[e.z!=null?e.z:"General"],n=60,s=t.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){hc(e.z,n),r.ssf[n]=e.z,r.revssf[e.z]=a=n;break}}for(n=0;n!=s;++n)if(t[n].numFmtId===a)return n;return t[s]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function Y3(t,e,r,a,n,s){try{a.cellNF&&(t.z=br[e])}catch(c){if(a.WTF)throw c}if(!(t.t==="z"&&!a.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=za(t.v)),(!a||a.cellText!==!1)&&t.t!=="z")try{if(br[e]==null&&hc(B8[e]||"General",e),t.t==="e")t.w=t.w||wc[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=P0(t.v);else if(t.t==="d"){var l=Jn(t.v);(l|0)===l?t.w=l.toString(10):t.w=P0(l)}else{if(t.v===void 0)return"";t.w=wf(t.v,th)}else t.t==="d"?t.w=fo(e,Jn(t.v),th):t.w=fo(e,t.v,th)}catch(c){if(a.WTF)throw c}if(a.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=i1(n.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),a.WTF&&(t.s.fgColor.raw_rgb=n.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=i1(n.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),a.WTF&&(t.s.bgColor.raw_rgb=n.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(c){if(a.WTF&&s.Fills)throw c}}}function HP(t,e,r){if(t&&t["!ref"]){var a=ta(t["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function $P(t,e){var r=ta(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Or(r))}var WP=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,VP=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,GP=/<(?:\w:)?hyperlink [^>]*>/mg,YP=/"(\w*:\w*)"/,XP=/<(?:\w:)?col\b[^>]*[\/]?>/g,KP=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,JP=/<(?:\w:)?pageMargins[^>]*\/>/g,X3=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,ZP=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,QP=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function e9(t,e,r,a,n,s,l){if(!t)return t;a||(a={"!id":{}});var c=e.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",m="",v=t.match(VP);v?(d=t.slice(0,v.index),m=t.slice(v.index+v[0].length)):d=m=t;var x=d.match(X3);x?U2(x[0],c,n,r):(x=d.match(ZP))&&r9(x[0],x[1]||"",c,n,r);var g=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(g>0){var b=d.slice(g,g+50).match(YP);b&&$P(c,b[1])}var _=d.match(QP);_&&_[1]&&p9(_[1],n);var w=[];if(e.cellStyles){var E=d.match(XP);E&&u9(w,E)}v&&x9(v[1],c,e,f,s,l);var C=m.match(KP);C&&(c["!autofilter"]=d9(C[0]));var A=[],T=m.match(WP);if(T)for(g=0;g!=T.length;++g)A[g]=ta(T[g].slice(T[g].indexOf('"')+1));var G=m.match(GP);G&&o9(c,G,a);var W=m.match(JP);if(W&&(c["!margins"]=l9(Sr(W[0]))),!c["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(c["!ref"]=Or(f)),e.sheetRows>0&&c["!ref"]){var B=ta(c["!ref"]);e.sheetRows<=+B.e.r&&(B.e.r=e.sheetRows-1,B.e.r>f.e.r&&(B.e.r=f.e.r),B.e.r<B.s.r&&(B.s.r=B.e.r),B.e.c>f.e.c&&(B.e.c=f.e.c),B.e.c<B.s.c&&(B.s.c=B.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Or(B))}return w.length>0&&(c["!cols"]=w),A.length>0&&(c["!merges"]=A),c}function t9(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Or(t[r])+'"/>';return e+"</mergeCells>"}function U2(t,e,r,a){var n=Sr(t);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=ea(ka(n.codeName)))}function r9(t,e,r,a,n){U2(t.slice(0,t.indexOf(">")),r,a,n)}function a9(t,e,r,a,n){var s=!1,l={},c=null;if(a.bookType!=="xlsx"&&e.vbaraw){var f=e.SheetNames[r];try{e.Workbook&&(f=e.Workbook.Sheets[r].CodeName||f)}catch{}s=!0,l.codeName=jl(xa(f))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),c=(c||"")+Mt("outlinePr",null,d)}!s&&!c||(n[n.length]=Mt("sheetPr",c,l))}var n9=["objects","scenarios","selectLockedCells","selectUnlockedCells"],s9=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function i9(t){var e={sheet:1};return n9.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),s9.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=D2(t.password).toString(16).toUpperCase()),Mt("sheetProtection",null,e)}function o9(t,e,r){for(var a=Array.isArray(t),n=0;n!=e.length;++n){var s=Sr(ka(e[n]),!0);if(!s.ref)return;var l=((r||{})["!id"]||[])[s.id];l?(s.Target=l.Target,s.location&&(s.Target+="#"+ea(s.location))):(s.Target="#"+ea(s.location),l={Target:s.Target,TargetMode:"Internal"}),s.Rel=l,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var c=ta(s.ref),f=c.s.r;f<=c.e.r;++f)for(var d=c.s.c;d<=c.e.c;++d){var m=wr({c:d,r:f});a?(t[f]||(t[f]=[]),t[f][d]||(t[f][d]={t:"z",v:void 0}),t[f][d].l=s):(t[m]||(t[m]={t:"z",v:void 0}),t[m].l=s)}}}function l9(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function c9(t){return _f(t),Mt("pageMargins",null,t)}function u9(t,e){for(var r=!1,a=0;a!=e.length;++a){var n=Sr(e[a],!0);n.hidden&&(n.hidden=Ua(n.hidden));var s=parseInt(n.min,10)-1,l=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,F2(n.width)),xu(n);s<=l;)t[s++]=Ha(n)}}function f9(t,e){for(var r=["<cols>"],a,n=0;n!=e.length;++n)(a=e[n])&&(r[r.length]=Mt("col",null,A1(n,a)));return r[r.length]="</cols>",r.join("")}function d9(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function h9(t,e,r,a){var n=typeof t.ref=="string"?t.ref:Or(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,l=mi(n);l.s.r==l.e.r&&(l.e.r=mi(e["!ref"]).e.r,n=Or(l));for(var c=0;c<s.length;++c){var f=s[c];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==a){f.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),Mt("autoFilter",null,{ref:n})}var m9=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function p9(t,e){e.Views||(e.Views=[{}]),(t.match(m9)||[]).forEach(function(r,a){var n=Sr(r);e.Views[a]||(e.Views[a]={}),+n.zoomScale&&(e.Views[a].zoom=+n.zoomScale),Ua(n.rightToLeft)&&(e.Views[a].RTL=!0)})}function g9(t,e,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Mt("sheetViews",Mt("sheetView",null,n),{})}function v9(t,e,r,a){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var n="",s=t.t,l=t.v;if(t.t!=="z")switch(t.t){case"b":n=t.v?"1":"0";break;case"n":n=""+t.v;break;case"e":n=wc[t.v];break;case"d":a&&a.cellDates?n=za(t.v,-1).toISOString():(t=Ha(t),t.t="n",n=""+(t.v=Jn(za(t.v)))),typeof t.z>"u"&&(t.z=br[14]);break;default:n=t.v;break}var c=_s("v",xa(n)),f={r:e},d=ju(a.cellXfs,t,a);switch(d!==0&&(f.s=d),t.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){c=_s("v",""+B2(a.Strings,t.v,a.revStrings)),f.t="s";break}f.t="str";break}if(t.t!=s&&(t.t=s,t.v=l),typeof t.f=="string"&&t.f){var m=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;c=Mt("f",xa(t.f),m)+(t.v!=null?c:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(f.cm=1),Mt("c",c,f)}var x9=(function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,s=M0("v"),l=M0("f");return function(f,d,m,v,x,g){for(var b=0,_="",w=[],E=[],C=0,A=0,T=0,G="",W,B,q=0,L=0,J,D,O=0,M=0,V=Array.isArray(g.CellXf),ie,X=[],Z=[],K=Array.isArray(d),ae=[],fe={},U=!1,j=!!m.sheetStubs,F=f.split(e),I=0,z=F.length;I!=z;++I){_=F[I].trim();var ne=_.length;if(ne!==0){var se=0;e:for(b=0;b<ne;++b)switch(_[b]){case">":if(_[b-1]!="/"){++b;break e}if(m&&m.cellStyles){if(B=Sr(_.slice(se,b),!0),q=B.r!=null?parseInt(B.r,10):q+1,L=-1,m.sheetRows&&m.sheetRows<q)continue;fe={},U=!1,B.ht&&(U=!0,fe.hpt=parseFloat(B.ht),fe.hpx=uh(fe.hpt)),B.hidden=="1"&&(U=!0,fe.hidden=!0),B.outlineLevel!=null&&(U=!0,fe.level=+B.outlineLevel),U&&(ae[q-1]=fe)}break;case"<":se=b;break}if(se>=b)break;if(B=Sr(_.slice(se,b),!0),q=B.r!=null?parseInt(B.r,10):q+1,L=-1,!(m.sheetRows&&m.sheetRows<q)){v.s.r>q-1&&(v.s.r=q-1),v.e.r<q-1&&(v.e.r=q-1),m&&m.cellStyles&&(fe={},U=!1,B.ht&&(U=!0,fe.hpt=parseFloat(B.ht),fe.hpx=uh(fe.hpt)),B.hidden=="1"&&(U=!0,fe.hidden=!0),B.outlineLevel!=null&&(U=!0,fe.level=+B.outlineLevel),U&&(ae[q-1]=fe)),w=_.slice(b).split(t);for(var pe=0;pe!=w.length&&w[pe].trim().charAt(0)=="<";++pe);for(w=w.slice(pe),b=0;b!=w.length;++b)if(_=w[b].trim(),_.length!==0){if(E=_.match(r),C=b,A=0,T=0,_="<c "+(_.slice(0,1)=="<"?">":"")+_,E!=null&&E.length===2){for(C=0,G=E[1],A=0;A!=G.length&&!((T=G.charCodeAt(A)-64)<1||T>26);++A)C=26*C+T;--C,L=C}else++L;for(A=0;A!=_.length&&_.charCodeAt(A)!==62;++A);if(++A,B=Sr(_.slice(0,A),!0),B.r||(B.r=wr({r:q-1,c:L})),G=_.slice(A),W={t:""},(E=G.match(s))!=null&&E[1]!==""&&(W.v=ea(E[1])),m.cellFormula){if((E=G.match(l))!=null&&E[1]!==""){if(W.f=ea(ka(E[1])).replace(/\r\n/g,`
`),m.xlfn||(W.f=s5(W.f)),E[0].indexOf('t="array"')>-1)W.F=(G.match(n)||[])[1],W.F.indexOf(":")>-1&&X.push([ta(W.F),W.F]);else if(E[0].indexOf('t="shared"')>-1){D=Sr(E[0]);var ye=ea(ka(E[1]));m.xlfn||(ye=s5(ye)),Z[parseInt(D.si,10)]=[D,ye,B.r]}}else(E=G.match(/<f[^>]*\/>/))&&(D=Sr(E[0]),Z[D.si]&&(W.f=mL(Z[D.si][1],Z[D.si][2],B.r)));var _e=rn(B.r);for(A=0;A<X.length;++A)_e.r>=X[A][0].s.r&&_e.r<=X[A][0].e.r&&_e.c>=X[A][0].s.c&&_e.c<=X[A][0].e.c&&(W.F=X[A][1])}if(B.t==null&&W.v===void 0)if(W.f||W.F)W.v=0,W.t="n";else if(j)W.t="z";else continue;else W.t=B.t||"n";switch(v.s.c>L&&(v.s.c=L),v.e.c<L&&(v.e.c=L),W.t){case"n":if(W.v==""||W.v==null){if(!j)continue;W.t="z"}else W.v=parseFloat(W.v);break;case"s":if(typeof W.v>"u"){if(!j)continue;W.t="z"}else J=_0[parseInt(W.v,10)],W.v=J.t,W.r=J.r,m.cellHTML&&(W.h=J.h);break;case"str":W.t="s",W.v=W.v!=null?ka(W.v):"",m.cellHTML&&(W.h=x2(W.v));break;case"inlineStr":E=G.match(a),W.t="s",E!=null&&(J=R2(E[1]))?(W.v=J.t,m.cellHTML&&(W.h=J.h)):W.v="";break;case"b":W.v=Ua(W.v);break;case"d":m.cellDates?W.v=za(W.v,1):(W.v=Jn(za(W.v,1)),W.t="n");break;case"e":(!m||m.cellText!==!1)&&(W.w=W.v),W.v=JN[W.v];break}if(O=M=0,ie=null,V&&B.s!==void 0&&(ie=g.CellXf[B.s],ie!=null&&(ie.numFmtId!=null&&(O=ie.numFmtId),m.cellStyles&&ie.fillId!=null&&(M=ie.fillId))),Y3(W,O,M,m,x,g),m.cellDates&&V&&W.t=="n"&&gh(br[O])&&(W.t="d",W.v=N1(W.v)),B.cm&&m.xlmeta){var Le=(m.xlmeta.Cell||[])[+B.cm-1];Le&&Le.type=="XLDAPR"&&(W.D=!0)}if(K){var ue=rn(B.r);d[ue.r]||(d[ue.r]=[]),d[ue.r][ue.c]=W}else d[B.r]=W}}}}ae.length>0&&(d["!rows"]=ae)}})();function y9(t,e,r,a){var n=[],s=[],l=ta(t["!ref"]),c="",f,d="",m=[],v=0,x=0,g=t["!rows"],b=Array.isArray(t),_={r:d},w,E=-1;for(x=l.s.c;x<=l.e.c;++x)m[x]=tn(x);for(v=l.s.r;v<=l.e.r;++v){for(s=[],d=An(v),x=l.s.c;x<=l.e.c;++x){f=m[x]+d;var C=b?(t[v]||[])[x]:t[f];C!==void 0&&(c=v9(C,f,t,e))!=null&&s.push(c)}(s.length>0||g&&g[v])&&(_={r:d},g&&g[v]&&(w=g[v],w.hidden&&(_.hidden=1),E=-1,w.hpx?E=$0(w.hpx):w.hpt&&(E=w.hpt),E>-1&&(_.ht=E,_.customHeight=1),w.level&&(_.outlineLevel=w.level)),n[n.length]=Mt("row",s.join(""),_))}if(g)for(;v<g.length;++v)g&&g[v]&&(_={r:v+1},w=g[v],w.hidden&&(_.hidden=1),E=-1,w.hpx?E=$0(w.hpx):w.hpt&&(E=w.hpt),E>-1&&(_.ht=E,_.customHeight=1),w.level&&(_.outlineLevel=w.level),n[n.length]=Mt("row","",_));return n.join("")}function K3(t,e,r,a){var n=[Cn,Mt("worksheet",null,{xmlns:Df[0],"xmlns:r":Kn.r})],s=r.SheetNames[t],l=0,c="",f=r.Sheets[s];f==null&&(f={});var d=f["!ref"]||"A1",m=ta(d);if(m.e.c>16383||m.e.r>1048575){if(e.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),d=Or(m)}a||(a={}),f["!comments"]=[];var v=[];a9(f,r,t,e,n),n[n.length]=Mt("dimension",null,{ref:d}),n[n.length]=g9(f,e,t,r),e.sheetFormat&&(n[n.length]=Mt("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(n[n.length]=f9(f,f["!cols"])),n[l=n.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(c=y9(f,e),c.length>0&&(n[n.length]=c)),n.length>l+1&&(n[n.length]="</sheetData>",n[l]=n[l].replace("/>",">")),f["!protect"]&&(n[n.length]=i9(f["!protect"])),f["!autofilter"]!=null&&(n[n.length]=h9(f["!autofilter"],f,r,t)),f["!merges"]!=null&&f["!merges"].length>0&&(n[n.length]=t9(f["!merges"]));var x=-1,g,b=-1;return f["!links"].length>0&&(n[n.length]="<hyperlinks>",f["!links"].forEach(function(_){_[1].Target&&(g={ref:_[0]},_[1].Target.charAt(0)!="#"&&(b=ga(a,-1,xa(_[1].Target).replace(/#.*$/,""),Ir.HLINK),g["r:id"]="rId"+b),(x=_[1].Target.indexOf("#"))>-1&&(g.location=xa(_[1].Target.slice(x+1))),_[1].Tooltip&&(g.tooltip=xa(_[1].Tooltip)),n[n.length]=Mt("hyperlink",null,g))}),n[n.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(n[n.length]=c9(f["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(n[n.length]=_s("ignoredErrors",Mt("ignoredError",null,{numberStoredAsText:1,sqref:d}))),v.length>0&&(b=ga(a,-1,"../drawings/drawing"+(t+1)+".xml",Ir.DRAW),n[n.length]=Mt("drawing",null,{"r:id":"rId"+b}),f["!drawing"]=v),f["!comments"].length>0&&(b=ga(a,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Ir.VML),n[n.length]=Mt("legacyDrawing",null,{"r:id":"rId"+b}),f["!legacy"]=b),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function _9(t,e){var r={},a=t.l+e;r.r=t.read_shift(4),t.l+=4;var n=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=a,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=n/20),r}function b9(t,e,r){var a=ft(145),n=(r["!rows"]||[])[t]||{};a.write_shift(4,t),a.write_shift(4,0);var s=320;n.hpx?s=$0(n.hpx)*20:n.hpt&&(s=n.hpt*20),a.write_shift(2,s),a.write_shift(1,0);var l=0;n.level&&(l|=n.level),n.hidden&&(l|=16),(n.hpx||n.hpt)&&(l|=32),a.write_shift(1,l),a.write_shift(1,0);var c=0,f=a.l;a.l+=4;for(var d={r:t,c:0},m=0;m<16;++m)if(!(e.s.c>m+1<<10||e.e.c<m<<10)){for(var v=-1,x=-1,g=m<<10;g<m+1<<10;++g){d.c=g;var b=Array.isArray(r)?(r[d.r]||[])[d.c]:r[wr(d)];b&&(v<0&&(v=g),x=g)}v<0||(++c,a.write_shift(4,v),a.write_shift(4,x))}var _=a.l;return a.l=f,a.write_shift(4,c),a.l=_,a.length>a.l?a.slice(0,a.l):a}function w9(t,e,r,a){var n=b9(a,r,e);(n.length>17||(e["!rows"]||[])[a])&&bt(t,0,n)}var S9=Mf,N9=yh;function j9(){}function k9(t,e){var r={},a=t[t.l];return++t.l,r.above=!(a&64),r.left=!(a&128),t.l+=18,r.name=CO(t),r}function E9(t,e,r){r==null&&(r=ft(84+4*t.length));var a=192;e&&(e.above&&(a&=-65),e.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return a1({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),VN(t,r),r.slice(0,r.l)}function A9(t){var e=mo(t);return[e]}function C9(t,e,r){return r==null&&(r=ft(8)),Ff(e,r)}function T9(t){var e=Lf(t);return[e]}function O9(t,e,r){return r==null&&(r=ft(4)),Pf(e,r)}function R9(t){var e=mo(t),r=t.read_shift(1);return[e,r,"b"]}function D9(t,e,r){return r==null&&(r=ft(9)),Ff(e,r),r.write_shift(1,t.v?1:0),r}function F9(t){var e=Lf(t),r=t.read_shift(1);return[e,r,"b"]}function L9(t,e,r){return r==null&&(r=ft(5)),Pf(e,r),r.write_shift(1,t.v?1:0),r}function P9(t){var e=mo(t),r=t.read_shift(1);return[e,r,"e"]}function M9(t,e,r){return r==null&&(r=ft(9)),Ff(e,r),r.write_shift(1,t.v),r}function I9(t){var e=Lf(t),r=t.read_shift(1);return[e,r,"e"]}function B9(t,e,r){return r==null&&(r=ft(8)),Pf(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function U9(t){var e=mo(t),r=t.read_shift(4);return[e,r,"s"]}function q9(t,e,r){return r==null&&(r=ft(12)),Ff(e,r),r.write_shift(4,e.v),r}function z9(t){var e=Lf(t),r=t.read_shift(4);return[e,r,"s"]}function H9(t,e,r){return r==null&&(r=ft(8)),Pf(e,r),r.write_shift(4,e.v),r}function $9(t){var e=mo(t),r=Fs(t);return[e,r,"n"]}function W9(t,e,r){return r==null&&(r=ft(16)),Ff(e,r),Nf(t.v,r),r}function J3(t){var e=Lf(t),r=Fs(t);return[e,r,"n"]}function V9(t,e,r){return r==null&&(r=ft(12)),Pf(e,r),Nf(t.v,r),r}function G9(t){var e=mo(t),r=E2(t);return[e,r,"n"]}function Y9(t,e,r){return r==null&&(r=ft(12)),Ff(e,r),GN(t.v,r),r}function X9(t){var e=Lf(t),r=E2(t);return[e,r,"n"]}function K9(t,e,r){return r==null&&(r=ft(8)),Pf(e,r),GN(t.v,r),r}function J9(t){var e=mo(t),r=N2(t);return[e,r,"is"]}function Z9(t){var e=mo(t),r=Ls(t);return[e,r,"str"]}function Q9(t,e,r){return r==null&&(r=ft(12+4*t.v.length)),Ff(e,r),os(t.v,r),r.length>r.l?r.slice(0,r.l):r}function eM(t){var e=Lf(t),r=Ls(t);return[e,r,"str"]}function tM(t,e,r){return r==null&&(r=ft(8+4*t.v.length)),Pf(e,r),os(t.v,r),r.length>r.l?r.slice(0,r.l):r}function rM(t,e,r){var a=t.l+e,n=mo(t);n.r=r["!row"];var s=t.read_shift(1),l=[n,s,"b"];if(r.cellFormula){t.l+=2;var c=E1(t,a-t.l,r);l[3]=Rs(c,null,n,r.supbooks,r)}else t.l=a;return l}function aM(t,e,r){var a=t.l+e,n=mo(t);n.r=r["!row"];var s=t.read_shift(1),l=[n,s,"e"];if(r.cellFormula){t.l+=2;var c=E1(t,a-t.l,r);l[3]=Rs(c,null,n,r.supbooks,r)}else t.l=a;return l}function nM(t,e,r){var a=t.l+e,n=mo(t);n.r=r["!row"];var s=Fs(t),l=[n,s,"n"];if(r.cellFormula){t.l+=2;var c=E1(t,a-t.l,r);l[3]=Rs(c,null,n,r.supbooks,r)}else t.l=a;return l}function sM(t,e,r){var a=t.l+e,n=mo(t);n.r=r["!row"];var s=Ls(t),l=[n,s,"str"];if(r.cellFormula){t.l+=2;var c=E1(t,a-t.l,r);l[3]=Rs(c,null,n,r.supbooks,r)}else t.l=a;return l}var iM=Mf,oM=yh;function lM(t,e){return e==null&&(e=ft(4)),e.write_shift(4,t),e}function cM(t,e){var r=t.l+e,a=Mf(t),n=j2(t),s=Ls(t),l=Ls(t),c=Ls(t);t.l=r;var f={rfx:a,relId:n,loc:s,display:c};return l&&(f.Tooltip=l),f}function uM(t,e){var r=ft(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));yh({s:rn(t[0]),e:rn(t[0])},r),k2("rId"+e,r);var a=t[1].Target.indexOf("#"),n=a==-1?"":t[1].Target.slice(a+1);return os(n||"",r),os(t[1].Tooltip||"",r),os("",r),r.slice(0,r.l)}function fM(){}function dM(t,e,r){var a=t.l+e,n=YN(t),s=t.read_shift(1),l=[n];if(l[2]=s,r.cellFormula){var c=PP(t,a-t.l,r);l[1]=c}else t.l=a;return l}function hM(t,e,r){var a=t.l+e,n=Mf(t),s=[n];if(r.cellFormula){var l=IP(t,a-t.l,r);s[1]=l,t.l=a}else t.l=a;return s}function mM(t,e,r){r==null&&(r=ft(18));var a=A1(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return e.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),e.level&&(n|=e.level<<8),r.write_shift(2,n),r}var Z3=["left","right","top","bottom","header","footer"];function pM(t){var e={};return Z3.forEach(function(r){e[r]=Fs(t)}),e}function gM(t,e){return e==null&&(e=ft(48)),_f(t),Z3.forEach(function(r){Nf(t[r],e)}),e}function vM(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function xM(t,e,r){r==null&&(r=ft(30));var a=924;return(((e||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function yM(t){var e=ft(24);return e.write_shift(4,4),e.write_shift(4,1),yh(t,e),e}function _M(t,e){return e==null&&(e=ft(66)),e.write_shift(2,t.password?D2(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function bM(){}function wM(){}function SM(t,e,r,a,n,s,l){if(!t)return t;var c=e||{};a||(a={"!id":{}});var f=c.dense?[]:{},d,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,x=!1,g,b,_,w,E,C,A,T,G,W=[];c.biff=12,c["!row"]=0;var B=0,q=!1,L=[],J={},D=c.supbooks||n.supbooks||[[]];if(D.sharedf=J,D.arrayf=L,D.SheetNames=n.SheetNames||n.Sheets.map(function(K){return K.name}),!c.supbooks&&(c.supbooks=D,n.Names))for(var O=0;O<n.Names.length;++O)D[0][O+1]=n.Names[O];var M=[],V=[],ie=!1;W0[16]={n:"BrtShortReal",f:J3};var X;if(bc(t,function(ae,fe,U){if(!x)switch(U){case 148:d=ae;break;case 0:g=ae,c.sheetRows&&c.sheetRows<=g.r&&(x=!0),T=An(w=g.r),c["!row"]=g.r,(ae.hidden||ae.hpt||ae.level!=null)&&(ae.hpt&&(ae.hpx=uh(ae.hpt)),V[ae.r]=ae);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(b={t:ae[2]},ae[2]){case"n":b.v=ae[1];break;case"s":A=_0[ae[1]],b.v=A.t,b.r=A.r;break;case"b":b.v=!!ae[1];break;case"e":b.v=ae[1],c.cellText!==!1&&(b.w=wc[b.v]);break;case"str":b.t="s",b.v=ae[1];break;case"is":b.t="s",b.v=ae[1].t;break}if((_=l.CellXf[ae[0].iStyleRef])&&Y3(b,_.numFmtId,null,c,s,l),E=ae[0].c==-1?E+1:ae[0].c,c.dense?(f[w]||(f[w]=[]),f[w][E]=b):f[tn(E)+T]=b,c.cellFormula){for(q=!1,B=0;B<L.length;++B){var j=L[B];g.r>=j[0].s.r&&g.r<=j[0].e.r&&E>=j[0].s.c&&E<=j[0].e.c&&(b.F=Or(j[0]),q=!0)}!q&&ae.length>3&&(b.f=ae[3])}if(m.s.r>g.r&&(m.s.r=g.r),m.s.c>E&&(m.s.c=E),m.e.r<g.r&&(m.e.r=g.r),m.e.c<E&&(m.e.c=E),c.cellDates&&_&&b.t=="n"&&gh(br[_.numFmtId])){var F=gf(b.v);F&&(b.t="d",b.v=new Date(F.y,F.m-1,F.d,F.H,F.M,F.S,F.u))}X&&(X.type=="XLDAPR"&&(b.D=!0),X=void 0);break;case 1:case 12:if(!c.sheetStubs||v)break;b={t:"z",v:void 0},E=ae[0].c==-1?E+1:ae[0].c,c.dense?(f[w]||(f[w]=[]),f[w][E]=b):f[tn(E)+T]=b,m.s.r>g.r&&(m.s.r=g.r),m.s.c>E&&(m.s.c=E),m.e.r<g.r&&(m.e.r=g.r),m.e.c<E&&(m.e.c=E),X&&(X.type=="XLDAPR"&&(b.D=!0),X=void 0);break;case 176:W.push(ae);break;case 49:X=((c.xlmeta||{}).Cell||[])[ae-1];break;case 494:var I=a["!id"][ae.relId];for(I?(ae.Target=I.Target,ae.loc&&(ae.Target+="#"+ae.loc),ae.Rel=I):ae.relId==""&&(ae.Target="#"+ae.loc),w=ae.rfx.s.r;w<=ae.rfx.e.r;++w)for(E=ae.rfx.s.c;E<=ae.rfx.e.c;++E)c.dense?(f[w]||(f[w]=[]),f[w][E]||(f[w][E]={t:"z",v:void 0}),f[w][E].l=ae):(C=wr({c:E,r:w}),f[C]||(f[C]={t:"z",v:void 0}),f[C].l=ae);break;case 426:if(!c.cellFormula)break;L.push(ae),G=c.dense?f[w][E]:f[tn(E)+T],G.f=Rs(ae[1],m,{r:g.r,c:E},D,c),G.F=Or(ae[0]);break;case 427:if(!c.cellFormula)break;J[wr(ae[0].s)]=ae[1],G=c.dense?f[w][E]:f[tn(E)+T],G.f=Rs(ae[1],m,{r:g.r,c:E},D,c);break;case 60:if(!c.cellStyles)break;for(;ae.e>=ae.s;)M[ae.e--]={width:ae.w/256,hidden:!!(ae.flags&1),level:ae.level},ie||(ie=!0,F2(ae.w/256)),xu(M[ae.e+1]);break;case 161:f["!autofilter"]={ref:Or(ae)};break;case 476:f["!margins"]=ae;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),ae.name&&(n.Sheets[r].CodeName=ae.name),(ae.above||ae.left)&&(f["!outline"]={above:ae.above,left:ae.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),ae.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!fe.T){if(!v||c.WTF)throw new Error("Unexpected record 0x"+U.toString(16))}}},c),delete c.supbooks,delete c["!row"],!f["!ref"]&&(m.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(f["!ref"]=Or(d||m)),c.sheetRows&&f["!ref"]){var Z=ta(f["!ref"]);c.sheetRows<=+Z.e.r&&(Z.e.r=c.sheetRows-1,Z.e.r>m.e.r&&(Z.e.r=m.e.r),Z.e.r<Z.s.r&&(Z.s.r=Z.e.r),Z.e.c>m.e.c&&(Z.e.c=m.e.c),Z.e.c<Z.s.c&&(Z.s.c=Z.e.c),f["!fullref"]=f["!ref"],f["!ref"]=Or(Z))}return W.length>0&&(f["!merges"]=W),M.length>0&&(f["!cols"]=M),V.length>0&&(f["!rows"]=V),f}function NM(t,e,r,a,n,s,l){if(e.v===void 0)return!1;var c="";switch(e.t){case"b":c=e.v?"1":"0";break;case"d":e=Ha(e),e.z=e.z||br[14],e.v=Jn(za(e.v)),e.t="n";break;case"n":case"e":c=""+e.v;break;default:c=e.v;break}var f={r,c:a};switch(f.s=ju(n.cellXfs,e,n),e.l&&s["!links"].push([wr(f),e.l]),e.c&&s["!comments"].push([wr(f),e.c]),e.t){case"s":case"str":return n.bookSST?(c=B2(n.Strings,e.v,n.revStrings),f.t="s",f.v=c,l?bt(t,18,H9(e,f)):bt(t,7,q9(e,f))):(f.t="str",l?bt(t,17,tM(e,f)):bt(t,6,Q9(e,f))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?l?bt(t,13,K9(e,f)):bt(t,2,Y9(e,f)):l?bt(t,16,V9(e,f)):bt(t,5,W9(e,f)),!0;case"b":return f.t="b",l?bt(t,15,L9(e,f)):bt(t,4,D9(e,f)),!0;case"e":return f.t="e",l?bt(t,14,B9(e,f)):bt(t,3,M9(e,f)),!0}return l?bt(t,12,O9(e,f)):bt(t,1,C9(e,f)),!0}function jM(t,e,r,a){var n=ta(e["!ref"]||"A1"),s,l="",c=[];bt(t,145);var f=Array.isArray(e),d=n.e.r;e["!rows"]&&(d=Math.max(n.e.r,e["!rows"].length-1));for(var m=n.s.r;m<=d;++m){l=An(m),w9(t,e,n,m);var v=!1;if(m<=n.e.r)for(var x=n.s.c;x<=n.e.c;++x){m===n.s.r&&(c[x]=tn(x)),s=c[x]+l;var g=f?(e[m]||[])[x]:e[s];if(!g){v=!1;continue}v=NM(t,g,m,x,a,e,v)}}bt(t,146)}function kM(t,e){!e||!e["!merges"]||(bt(t,177,lM(e["!merges"].length)),e["!merges"].forEach(function(r){bt(t,176,oM(r))}),bt(t,178))}function EM(t,e){!e||!e["!cols"]||(bt(t,390),e["!cols"].forEach(function(r,a){r&&bt(t,60,mM(a,r))}),bt(t,391))}function AM(t,e){!e||!e["!ref"]||(bt(t,648),bt(t,649,yM(ta(e["!ref"]))),bt(t,650))}function CM(t,e,r){e["!links"].forEach(function(a){if(a[1].Target){var n=ga(r,-1,a[1].Target.replace(/#.*$/,""),Ir.HLINK);bt(t,494,uM(a,n))}}),delete e["!links"]}function TM(t,e,r,a){if(e["!comments"].length>0){var n=ga(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ir.VML);bt(t,551,k2("rId"+n)),e["!legacy"]=n}}function OM(t,e,r,a){if(e["!autofilter"]){var n=e["!autofilter"],s=typeof n.ref=="string"?n.ref:Or(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,c=mi(s);c.s.r==c.e.r&&(c.e.r=mi(e["!ref"]).e.r,s=Or(c));for(var f=0;f<l.length;++f){var d=l[f];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a){d.Ref="'"+r.SheetNames[a]+"'!"+s;break}}f==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),bt(t,161,yh(ta(s))),bt(t,162)}}function RM(t,e,r){bt(t,133),bt(t,137,xM(e,r)),bt(t,138),bt(t,134)}function DM(t,e){e["!protect"]&&bt(t,535,_M(e["!protect"]))}function FM(t,e,r,a){var n=hi(),s=r.SheetNames[t],l=r.Sheets[s]||{},c=s;try{r&&r.Workbook&&(c=r.Workbook.Sheets[t].CodeName||c)}catch{}var f=ta(l["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],bt(n,129),(r.vbaraw||l["!outline"])&&bt(n,147,E9(c,l["!outline"])),bt(n,148,N9(f)),RM(n,l,r.Workbook),EM(n,l),jM(n,l,t,e),DM(n,l),OM(n,l,r,t),kM(n,l),CM(n,l,a),l["!margins"]&&bt(n,476,gM(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&AM(n,l),TM(n,l,t,a),bt(n,130),n.end()}function LM(t){var e=[],r=t.match(/^<c:numCache>/),a;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var l=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(e[+l[1]]=r?+l[2]:l[2])});var n=ea((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){a=s.replace(/<.*?>/g,"")}),[e,n,a]}function PM(t,e,r,a,n,s){var l=s||{"!type":"chart"};if(!t)return s;var c=0,f=0,d="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var x=LM(v);m.s.r=m.s.c=0,m.e.c=c,d=tn(c),x[0].forEach(function(g,b){l[d+An(b)]={t:"n",v:g,z:x[1]},f=b}),m.e.r<f&&(m.e.r=f),++c}),c>0&&(l["!ref"]=Or(m)),l}function MM(t,e,r,a,n){if(!t)return t;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l,c=t.match(X3);return c&&U2(c[0],s,n,r),(l=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=l[1]),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}function IM(t,e){t.l+=10;var r=Ls(t);return{name:r}}function BM(t,e,r,a,n){if(!t)return t;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l=!1;return bc(t,function(f,d,m){switch(m){case 550:s["!rel"]=f;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),f.name&&(n.Sheets[r].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!l||e.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},e),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}var q2=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],UM=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],qM=[],zM=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function u5(t,e){for(var r=0;r!=t.length;++r)for(var a=t[r],n=0;n!=e.length;++n){var s=e[n];if(a[s[0]]==null)a[s[0]]=s[1];else switch(s[2]){case"bool":typeof a[s[0]]=="string"&&(a[s[0]]=Ua(a[s[0]]));break;case"int":typeof a[s[0]]=="string"&&(a[s[0]]=parseInt(a[s[0]],10));break}}}function f5(t,e){for(var r=0;r!=e.length;++r){var a=e[r];if(t[a[0]]==null)t[a[0]]=a[1];else switch(a[2]){case"bool":typeof t[a[0]]=="string"&&(t[a[0]]=Ua(t[a[0]]));break;case"int":typeof t[a[0]]=="string"&&(t[a[0]]=parseInt(t[a[0]],10));break}}}function Q3(t){f5(t.WBProps,q2),f5(t.CalcPr,zM),u5(t.WBView,UM),u5(t.Sheets,qM),th.date1904=Ua(t.WBProps.date1904)}function HM(t){return!t.Workbook||!t.Workbook.WBProps?"false":Ua(t.Workbook.WBProps.date1904)?"true":"false"}var $M="][*?/\\".split("");function ej(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return $M.forEach(function(a){if(t.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function WM(t,e,r){t.forEach(function(a,n){ej(a);for(var s=0;s<n;++s)if(a==t[s])throw new Error("Duplicate Sheet Name: "+a);if(r){var l=e&&e[n]&&e[n].CodeName||a;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function VM(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];WM(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)HP(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var GM=/<\w+:workbook/;function YM(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",s={},l=0;if(t.replace(Ms,function(f,d){var m=Sr(f);switch(Al(m[0])){case"<?xml":break;case"<workbook":f.match(GM)&&(n="xmlns"+f.match(/<(\w+):/)[1]),r.xmlns=m[n];break;case"</workbook>":break;case"<fileVersion":delete m[0],r.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":q2.forEach(function(v){if(m[v[0]]!=null)switch(v[2]){case"bool":r.WBProps[v[0]]=Ua(m[v[0]]);break;case"int":r.WBProps[v[0]]=parseInt(m[v[0]],10);break;default:r.WBProps[v[0]]=m[v[0]]}}),m.codeName&&(r.WBProps.CodeName=ka(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],r.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=ea(ka(m.name)),delete m[0],r.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":s={},s.Name=ka(m.name),m.comment&&(s.Comment=m.comment),m.localSheetId&&(s.Sheet=+m.localSheetId),Ua(m.hidden||"0")&&(s.Hidden=!0),l=d+f.length;break;case"</definedName>":s.Ref=ea(ka(t.slice(l,d))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete m[0],r.CalcPr=m;break;case"<calcPr/>":delete m[0],r.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&e.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return f}),Df.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Q3(r),r}function tj(t){var e=[Cn];e[e.length]=Mt("workbook",null,{xmlns:Df[0],"xmlns:r":Kn.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(q2.forEach(function(c){t.Workbook.WBProps[c[0]]!=null&&t.Workbook.WBProps[c[0]]!=c[1]&&(a[c[0]]=t.Workbook.WBProps[c[0]])}),t.Workbook.WBProps.CodeName&&(a.codeName=t.Workbook.WBProps.CodeName,delete a.CodeName)),e[e.length]=Mt("workbookPr",null,a);var n=t.Workbook&&t.Workbook.Sheets||[],s=0;if(n&&n[0]&&n[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!n[s]||!n[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var l={name:xa(t.SheetNames[s].slice(0,31))};if(l.sheetId=""+(s+1),l["r:id"]="rId"+(s+1),n[s])switch(n[s].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}e[e.length]=Mt("sheet",null,l)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(c){var f={name:c.Name};c.Comment&&(f.comment=c.Comment),c.Sheet!=null&&(f.localSheetId=""+c.Sheet),c.Hidden&&(f.hidden="1"),c.Ref&&(e[e.length]=Mt("definedName",xa(c.Ref),f))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function XM(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=wx(t),r.name=Ls(t),r}function KM(t,e){return e||(e=ft(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),k2(t.strRelID,e),os(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function JM(t,e){var r={},a=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var n=e>8?Ls(t):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function ZM(t,e){e||(e=ft(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),VN(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function QM(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function eI(t,e,r){var a=t.l+e;t.l+=4,t.l+=1;var n=t.read_shift(4),s=TO(t),l=MP(t,0,r),c=j2(t);t.l=a;var f={Name:s,Ptg:l};return n<268435455&&(f.Sheet=n),c&&(f.Comment=c),f}function tI(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;e||(e={}),e.biff=12;var s=[],l=[[]];return l.SheetNames=[],l.XTI=[],W0[16]={n:"BrtFRTArchID$",f:QM},bc(t,function(f,d,m){switch(m){case 156:l.SheetNames.push(f.name),r.Sheets.push(f);break;case 153:r.WBProps=f;break;case 39:f.Sheet!=null&&(e.SID=f.Sheet),f.Ref=Rs(f.Ptg,null,null,l,e),delete e.SID,delete f.Ptg,s.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([m,f]):l[0]=[m,f],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(f),l.XTI=l.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(m),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(m),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!d.T){if(!n||e.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},e),Q3(r),r.Names=s,r.supbooks=l,r}function rI(t,e){bt(t,143);for(var r=0;r!=e.SheetNames.length;++r){var a=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};bt(t,156,KM(n))}bt(t,144)}function aI(t,e){e||(e=ft(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return os("SheetJS",e),os(Kp.version,e),os(Kp.version,e),os("7262",e),e.length>e.l?e.slice(0,e.l):e}function nI(t,e){e||(e=ft(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function sI(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,a=0,n=-1,s=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&s==-1&&(s=a);s>n||(bt(t,135),bt(t,158,nI(n)),bt(t,136))}}function iI(t,e){var r=hi();return bt(r,131),bt(r,128,aI()),bt(r,153,ZM(t.Workbook&&t.Workbook.WBProps||null)),sI(r,t),rI(r,t),bt(r,132),r.end()}function oI(t,e,r){return e.slice(-4)===".bin"?tI(t,r):YM(t,r)}function lI(t,e,r,a,n,s,l,c){return e.slice(-4)===".bin"?SM(t,a,r,n,s,l,c):e9(t,a,r,n,s,l,c)}function cI(t,e,r,a,n,s,l,c){return e.slice(-4)===".bin"?BM(t,a,r,n,s):MM(t,a,r,n,s)}function uI(t,e,r,a,n,s,l,c){return e.slice(-4)===".bin"?dL():hL()}function fI(t,e,r,a,n,s,l,c){return e.slice(-4)===".bin"?uL():fL()}function dI(t,e,r,a){return e.slice(-4)===".bin"?oF(t,r,a):XD(t,r,a)}function hI(t,e,r){return L3(t,r)}function mI(t,e,r){return e.slice(-4)===".bin"?mD(t,r):fD(t,r)}function pI(t,e,r){return e.slice(-4)===".bin"?sL(t,r):KF(t,r)}function gI(t,e,r){return e.slice(-4)===".bin"?GF(t):WF(t)}function vI(t,e,r,a){return r.slice(-4)===".bin"?YF(t,e,r,a):void 0}function xI(t,e,r){return e.slice(-4)===".bin"?zF(t,e,r):$F(t,e,r)}function yI(t,e,r){return(e.slice(-4)===".bin"?iI:tj)(t)}function _I(t,e,r,a,n){return(e.slice(-4)===".bin"?FM:K3)(t,r,a,n)}function bI(t,e,r){return(e.slice(-4)===".bin"?vF:D3)(t,r)}function wI(t,e,r){return(e.slice(-4)===".bin"?vD:j3)(t,r)}function SI(t,e,r){return(e.slice(-4)===".bin"?iL:I3)(t)}function NI(t){return(t.slice(-4)===".bin"?HF:P3)()}var rj=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,aj=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function qo(t,e){var r=t.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var n=t.match(rj),s,l,c,f;if(n)for(f=0;f!=n.length;++f)s=n[f].match(aj),(l=s[1].indexOf(":"))===-1?a[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?c="xmlns"+s[1].slice(6):c=s[1].slice(l+1),a[c]=s[2].slice(1,s[2].length-1));return a}function jI(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var a=t.match(rj),n,s,l,c;if(a)for(c=0;c!=a.length;++c)n=a[c].match(aj),(s=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?l="xmlns"+n[1].slice(6):l=n[1].slice(s+1),r[l]=n[2].slice(1,n[2].length-1));return r}var w0;function kI(t,e){var r=w0[t]||ea(t);return r==="General"?wf(e):fo(r,e)}function EI(t,e,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=Ua(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=za(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[ea(e)]=n}function AI(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||wc[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=P0(t.v):t.w=wf(t.v):t.w=kI(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var a=w0[e]||e||"General";if(r.cellNF&&(t.z=a),r.cellDates&&t.t=="n"&&gh(a)){var n=gf(t.v);n&&(t.t="d",t.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(s){if(r.WTF)throw s}}}function CI(t,e,r){if(r.cellStyles&&e.Interior){var a=e.Interior;a.Pattern&&(a.patternType=qD[a.Pattern]||a.Pattern)}t[e.ID]=e}function TI(t,e,r,a,n,s,l,c,f,d){var m="General",v=a.StyleID,x={};d=d||{};var g=[],b=0;for(v===void 0&&c&&(v=c.StyleID),v===void 0&&l&&(v=l.StyleID);s[v]!==void 0&&(s[v].nf&&(m=s[v].nf),s[v].Interior&&g.push(s[v].Interior),!!s[v].Parent);)v=s[v].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=Ua(t);break;case"String":a.t="s",a.r=Aw(ea(t)),a.v=t.indexOf("<")>-1?ea(e||t).replace(/<.*?>/g,""):a.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),a.v=(za(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=ea(t):a.v<60&&(a.v=a.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+t),a.t||(a.t="n");break;case"Error":a.t="e",a.v=JN[t],d.cellText!==!1&&(a.w=t);break;default:t==""&&e==""?a.t="z":(a.t="s",a.v=Aw(e||t));break}if(AI(a,m,d),d.cellFormula!==!1)if(a.Formula){var _=ea(a.Formula);_.charCodeAt(0)==61&&(_=_.slice(1)),a.f=eh(_,n),delete a.Formula,a.ArrayRange=="RC"?a.F=eh("RC:RC",n):a.ArrayRange&&(a.F=eh(a.ArrayRange,n),f.push([ta(a.F),a.F]))}else for(b=0;b<f.length;++b)n.r>=f[b][0].s.r&&n.r<=f[b][0].e.r&&n.c>=f[b][0].s.c&&n.c<=f[b][0].e.c&&(a.F=f[b][1]);d.cellStyles&&(g.forEach(function(w){!x.patternType&&w.patternType&&(x.patternType=w.patternType)}),a.s=x),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function OI(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function vv(t,e){var r=e||{};vh();var a=u0(y2(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=ka(a));var n=a.slice(0,1024).toLowerCase(),s=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var l=Ha(r);return l.type="string",ch.to_workbook(a,l)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ve){n.indexOf("<"+ve)>=0&&(s=!0)}),s)return gB(a,r);w0={"General Number":"General","General Date":br[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":br[15],"Short Date":br[14],"Long Time":br[19],"Medium Time":br[18],"Short Time":br[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:br[2],Standard:br[4],Percent:br[10],Scientific:br[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,f=[],d,m={},v=[],x=r.dense?[]:{},g="",b={},_={},w=qo('<Data ss:Type="String">'),E=0,C=0,A=0,T={s:{r:2e6,c:2e6},e:{r:0,c:0}},G={},W={},B="",q=0,L=[],J={},D={},O=0,M=[],V=[],ie={},X=[],Z,K=!1,ae=[],fe=[],U={},j=0,F=0,I={Sheets:[],WBProps:{date1904:!1}},z={};B0.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var ne="";c=B0.exec(a);)switch(c[3]=(ne=c[3]).toLowerCase()){case"data":if(ne=="data"){if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break}if(f[f.length-1][1])break;c[1]==="/"?TI(a.slice(E,c.index),B,w,f[f.length-1][0]=="comment"?ie:b,{c:C,r:A},G,X[C],_,ae,r):(B="",w=qo(c[0]),E=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(V.length>0&&(b.c=V),(!r.sheetRows||r.sheetRows>A)&&b.v!==void 0&&(r.dense?(x[A]||(x[A]=[]),x[A][C]=b):x[tn(C)+An(A)]=b),b.HRef&&(b.l={Target:ea(b.HRef)},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(j=C+(parseInt(b.MergeAcross,10)|0),F=A+(parseInt(b.MergeDown,10)|0),L.push({s:{c:C,r:A},e:{c:j,r:F}})),!r.sheetStubs)b.MergeAcross?C=j+1:++C;else if(b.MergeAcross||b.MergeDown){for(var se=C;se<=j;++se)for(var pe=A;pe<=F;++pe)(se>C||pe>A)&&(r.dense?(x[pe]||(x[pe]=[]),x[pe][se]={t:"z"}):x[tn(se)+An(pe)]={t:"z"});C=j+1}else++C;else b=jI(c[0]),b.Index&&(C=+b.Index-1),C<T.s.c&&(T.s.c=C),C>T.e.c&&(T.e.c=C),c[0].slice(-2)==="/>"&&++C,V=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(A<T.s.r&&(T.s.r=A),A>T.e.r&&(T.e.r=A),c[0].slice(-2)==="/>"&&(_=qo(c[0]),_.Index&&(A=+_.Index-1)),C=0,++A):(_=qo(c[0]),_.Index&&(A=+_.Index-1),U={},(_.AutoFitHeight=="0"||_.Height)&&(U.hpx=parseInt(_.Height,10),U.hpt=$0(U.hpx),fe[A]=U),_.Hidden=="1"&&(U.hidden=!0,fe[A]=U));break;case"worksheet":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));v.push(g),T.s.r<=T.e.r&&T.s.c<=T.e.c&&(x["!ref"]=Or(T),r.sheetRows&&r.sheetRows<=T.e.r&&(x["!fullref"]=x["!ref"],T.e.r=r.sheetRows-1,x["!ref"]=Or(T))),L.length&&(x["!merges"]=L),X.length>0&&(x["!cols"]=X),fe.length>0&&(x["!rows"]=fe),m[g]=x}else T={s:{r:2e6,c:2e6},e:{r:0,c:0}},A=C=0,f.push([c[3],!1]),d=qo(c[0]),g=ea(d.Name),x=r.dense?[]:{},L=[],ae=[],fe=[],z={name:g,Hidden:0},I.Sheets.push(z);break;case"table":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else{if(c[0].slice(-2)=="/>")break;f.push([c[3],!1]),X=[],K=!1}break;case"style":c[1]==="/"?CI(G,W,r):W=qo(c[0]);break;case"numberformat":W.nf=ea(qo(c[0]).Format||"General"),w0[W.nf]&&(W.nf=w0[W.nf]);for(var ye=0;ye!=392&&br[ye]!=W.nf;++ye);if(ye==392){for(ye=57;ye!=392;++ye)if(br[ye]==null){hc(W.nf,ye);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(Z=qo(c[0]),Z.Hidden&&(Z.hidden=!0,delete Z.Hidden),Z.Width&&(Z.wpx=parseInt(Z.Width,10)),!K&&Z.wpx>10){K=!0,Ds=O3;for(var _e=0;_e<X.length;++_e)X[_e]&&xu(X[_e])}K&&xu(Z),X[Z.Index-1||X.length]=Z;for(var Le=0;Le<+Z.Span;++Le)X[X.length]=Ha(Z);break;case"namedrange":if(c[1]==="/")break;I.Names||(I.Names=[]);var ue=Sr(c[0]),at={Name:ue.Name,Ref:eh(ue.RefersTo.slice(1),{r:0,c:0})};I.Sheets.length>0&&(at.Sheet=I.Sheets.length-1),I.Names.push(at);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?B+=a.slice(q,c.index):q=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;W.Interior=qo(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?t7(J,ne,a.slice(O,c.index)):O=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else f.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));OI(ie),V.push(ie)}else f.push([c[3],!1]),d=qo(c[0]),ie={a:d.Author};break;case"autofilter":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var ht=qo(c[0]);x["!autofilter"]={ref:eh(ht.Range).replace(/\$/g,"")},f.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"null":break;default:if(f.length==0&&c[3]=="document"||f.length==0&&c[3]=="uof")return g5(a,r);var de=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:de=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:de=!1}break;case"excelworkbook":switch(c[3]){case"date1904":I.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:de=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:de=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(a.slice(O,c.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2;break}else O=c.index+c[0].length;break;case"header":x["!margins"]||_f(x["!margins"]={},"xlml"),isNaN(+Sr(c[0]).Margin)||(x["!margins"].header=+Sr(c[0]).Margin);break;case"footer":x["!margins"]||_f(x["!margins"]={},"xlml"),isNaN(+Sr(c[0]).Margin)||(x["!margins"].footer=+Sr(c[0]).Margin);break;case"pagemargins":var it=Sr(c[0]);x["!margins"]||_f(x["!margins"]={},"xlml"),isNaN(+it.Top)||(x["!margins"].top=+it.Top),isNaN(+it.Left)||(x["!margins"].left=+it.Left),isNaN(+it.Right)||(x["!margins"].right=+it.Right),isNaN(+it.Bottom)||(x["!margins"].bottom=+it.Bottom);break;case"displayrighttoleft":I.Views||(I.Views=[]),I.Views[0]||(I.Views[0]={}),I.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:de=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:de=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:de=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:de=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:de=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:de=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:de=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:de=!1}break;case"smarttags":break;default:de=!1;break}if(de||c[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?EI(D,ne,M,a.slice(O,c.index)):(M=c,O=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+f.join("|")}var Se={};return!r.bookSheets&&!r.bookProps&&(Se.Sheets=m),Se.SheetNames=v,Se.Workbook=I,Se.SSF=Ha(br),Se.Props=J,Se.Custprops=D,Se}function Cx(t,e){switch(H2(e=e||{}),e.type||"base64"){case"base64":return vv(qi(t),e);case"binary":case"buffer":case"file":return vv(t,e);case"array":return vv(Su(t),e)}}function RI(t,e){var r=[];return t.Props&&r.push(r7(t.Props,e)),t.Custprops&&r.push(a7(t.Props,t.Custprops)),r.join("")}function DI(){return""}function FI(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(a,n){var s=[];s.push(Mt("NumberFormat",null,{"ss:Format":xa(br[a.numFmtId])}));var l={"ss:ID":"s"+(21+n)};r.push(Mt("Style",s.join(""),l))}),Mt("Styles",r.join(""))}function nj(t){return Mt("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+M2(t.Ref,{r:0,c:0})})}function LI(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],a=0;a<e.length;++a){var n=e[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(nj(n)))}return Mt("Names",r.join(""))}function PI(t,e,r,a){if(!t||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,s=[],l=0;l<n.length;++l){var c=n[l];c.Sheet==r&&(c.Name.match(/^_xlfn\./)||s.push(nj(c)))}return s.join("")}function MI(t,e,r,a){if(!t)return"";var n=[];if(t["!margins"]&&(n.push("<PageSetup>"),t["!margins"].header&&n.push(Mt("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&n.push(Mt("Footer",null,{"x:Margin":t["!margins"].footer})),n.push(Mt("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(Mt("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(a.Workbook.Sheets[s]&&!a.Workbook.Sheets[s].Hidden);++s);s==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),t["!protect"]&&(n.push(_s("ProtectContents","True")),t["!protect"].objects&&n.push(_s("ProtectObjects","True")),t["!protect"].scenarios&&n.push(_s("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?n.push(_s("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&n.push(_s("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){t["!protect"][l[0]]&&n.push("<"+l[1]+"/>")})),n.length==0?"":Mt("WorksheetOptions",n.join(""),{xmlns:Di.x})}function II(t){return t.map(function(e){var r=sO(e.t||""),a=Mt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Mt("Comment",a,{"ss:Author":e.a})}).join("")}function BI(t,e,r,a,n,s,l){if(!t||t.v==null&&t.f==null)return"";var c={};if(t.f&&(c["ss:Formula"]="="+xa(M2(t.f,l))),t.F&&t.F.slice(0,e.length)==e){var f=rn(t.F.slice(e.length+1));c["ss:ArrayRange"]="RC:R"+(f.r==l.r?"":"["+(f.r-l.r)+"]")+"C"+(f.c==l.c?"":"["+(f.c-l.c)+"]")}if(t.l&&t.l.Target&&(c["ss:HRef"]=xa(t.l.Target),t.l.Tooltip&&(c["x:HRefScreenTip"]=xa(t.l.Tooltip))),r["!merges"])for(var d=r["!merges"],m=0;m!=d.length;++m)d[m].s.c!=l.c||d[m].s.r!=l.r||(d[m].e.c>d[m].s.c&&(c["ss:MergeAcross"]=d[m].e.c-d[m].s.c),d[m].e.r>d[m].s.r&&(c["ss:MergeDown"]=d[m].e.r-d[m].s.r));var v="",x="";switch(t.t){case"z":if(!a.sheetStubs)return"";break;case"n":v="Number",x=String(t.v);break;case"b":v="Boolean",x=t.v?"1":"0";break;case"e":v="Error",x=wc[t.v];break;case"d":v="DateTime",x=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||br[14]);break;case"s":v="String",x=nO(t.v||"");break}var g=ju(a.cellXfs,t,a);c["ss:StyleID"]="s"+(21+g),c["ss:Index"]=l.c+1;var b=t.v!=null?x:"",_=t.t=="z"?"":'<Data ss:Type="'+v+'">'+b+"</Data>";return(t.c||[]).length>0&&(_+=II(t.c)),Mt("Cell",_,c)}function UI(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=uh(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function qI(t,e,r,a){if(!t["!ref"])return"";var n=ta(t["!ref"]),s=t["!merges"]||[],l=0,c=[];t["!cols"]&&t["!cols"].forEach(function(w,E){xu(w);var C=!!w.width,A=A1(E,w),T={"ss:Index":E+1};C&&(T["ss:Width"]=z0(A.width)),w.hidden&&(T["ss:Hidden"]="1"),c.push(Mt("Column",null,T))});for(var f=Array.isArray(t),d=n.s.r;d<=n.e.r;++d){for(var m=[UI(d,(t["!rows"]||[])[d])],v=n.s.c;v<=n.e.c;++v){var x=!1;for(l=0;l!=s.length;++l)if(!(s[l].s.c>v)&&!(s[l].s.r>d)&&!(s[l].e.c<v)&&!(s[l].e.r<d)){(s[l].s.c!=v||s[l].s.r!=d)&&(x=!0);break}if(!x){var g={r:d,c:v},b=wr(g),_=f?(t[d]||[])[v]:t[b];m.push(BI(_,b,t,e,r,a,g))}}m.push("</Row>"),m.length>2&&c.push(m.join(""))}return c.join("")}function zI(t,e,r){var a=[],n=r.SheetNames[t],s=r.Sheets[n],l=s?PI(s,e,t,r):"";return l.length>0&&a.push("<Names>"+l+"</Names>"),l=s?qI(s,e,t,r):"",l.length>0&&a.push("<Table>"+l+"</Table>"),a.push(MI(s,e,t,r)),a.join("")}function HI(t,e){e||(e={}),t.SSF||(t.SSF=Ha(br)),t.SSF&&(vh(),b1(t.SSF),e.revssf=S1(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],ju(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(RI(t,e)),r.push(DI()),r.push(""),r.push("");for(var a=0;a<t.SheetNames.length;++a)r.push(Mt("Worksheet",zI(a,e,t),{"ss:Name":xa(t.SheetNames[a])}));return r[2]=FI(t,e),r[3]=LI(t),Cn+Mt("Workbook",r.join(""),{xmlns:Di.ss,"xmlns:o":Di.o,"xmlns:x":Di.x,"xmlns:ss":Di.ss,"xmlns:dt":Di.dt,"xmlns:html":Di.html})}function $I(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=LO(r),r.length-r.l<=4)return e;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(e.UnicodeClipboardFormat=PO(r),a=r.read_shift(4),a==0||a>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var WI=[60,1084,2066,2165,2175];function VI(t,e,r,a,n){var s=a,l=[],c=r.slice(r.l,r.l+s);if(n&&n.enc&&n.enc.insitu&&c.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(c)}l.push(c),r.l+=s;for(var f=cc(r,r.l),d=Tx[f],m=0;d!=null&&WI.indexOf(f)>-1;)s=cc(r,r.l+2),m=r.l+4,f==2066?m+=4:(f==2165||f==2175)&&(m+=12),c=r.slice(m,r.l+4+s),l.push(c),r.l+=4+s,d=Tx[f=cc(r,r.l)];var v=is(l);ys(v,0);var x=0;v.lens=[];for(var g=0;g<l.length;++g)v.lens.push(x),x+=l[g].length;if(v.length<a)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+v.length+" < "+a;return e.f(v,v.length,n)}function yl(t,e,r){if(t.t!=="z"&&t.XF){var a=0;try{a=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=br[a])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||wc[t.v]:a===0||a=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=P0(t.v):t.w=wf(t.v):t.w=fo(a,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&a&&t.t=="n"&&gh(br[a]||String(a))){var n=gf(t.v);n&&(t.t="d",t.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function wp(t,e,r){return{v:t,ixfe:e,t:r}}function GI(t,e){var r={opts:{}},a={},n=e.dense?[]:{},s={},l={},c=null,f=[],d="",m={},v,x="",g,b,_,w,E={},C=[],A,T,G=[],W=[],B={Sheets:[],WBProps:{date1904:!1},Views:[{}]},q={},L=function(qe){return qe<8?vf[qe]:qe<64&&W[qe-8]||vf[qe]},J=function(qe,Ye,Pt){var Et=Ye.XF.data;if(!(!Et||!Et.patternType||!Pt||!Pt.cellStyles)){Ye.s={},Ye.s.patternType=Et.patternType;var Dt;(Dt=q0(L(Et.icvFore)))&&(Ye.s.fgColor={rgb:Dt}),(Dt=q0(L(Et.icvBack)))&&(Ye.s.bgColor={rgb:Dt})}},D=function(qe,Ye,Pt){if(!(U>1)&&!(Pt.sheetRows&&qe.r>=Pt.sheetRows)){if(Pt.cellStyles&&Ye.XF&&Ye.XF.data&&J(qe,Ye,Pt),delete Ye.ixfe,delete Ye.XF,v=qe,x=wr(qe),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),qe.r<l.s.r&&(l.s.r=qe.r),qe.c<l.s.c&&(l.s.c=qe.c),qe.r+1>l.e.r&&(l.e.r=qe.r+1),qe.c+1>l.e.c&&(l.e.c=qe.c+1),Pt.cellFormula&&Ye.f){for(var Et=0;Et<C.length;++Et)if(!(C[Et][0].s.c>qe.c||C[Et][0].s.r>qe.r)&&!(C[Et][0].e.c<qe.c||C[Et][0].e.r<qe.r)){Ye.F=Or(C[Et][0]),(C[Et][0].s.c!=qe.c||C[Et][0].s.r!=qe.r)&&delete Ye.f,Ye.f&&(Ye.f=""+Rs(C[Et][1],l,qe,ae,O));break}}Pt.dense?(n[qe.r]||(n[qe.r]=[]),n[qe.r][qe.c]=Ye):n[x]=Ye}},O={enc:!1,sbcch:0,snames:[],sharedf:E,arrayf:C,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(O.password=e.password);var M,V=[],ie=[],X=[],Z=[],K=!1,ae=[];ae.SheetNames=O.snames,ae.sharedf=O.sharedf,ae.arrayf=O.arrayf,ae.names=[],ae.XTI=[];var fe=0,U=0,j=0,F=[],I=[],z;O.codepage=1200,Go(1200);for(var ne=!1;t.l<t.length-1;){var se=t.l,pe=t.read_shift(2);if(pe===0&&fe===10)break;var ye=t.l===t.length?0:t.read_shift(2),_e=Tx[pe];if(_e&&_e.f){if(e.bookSheets&&fe===133&&pe!==133)break;if(fe=pe,_e.r===2||_e.r==12){var Le=t.read_shift(2);if(ye-=2,!O.enc&&Le!==pe&&((Le&255)<<8|Le>>8)!==pe)throw new Error("rt mismatch: "+Le+"!="+pe);_e.r==12&&(t.l+=10,ye-=10)}var ue={};if(pe===10?ue=_e.f(t,ye,O):ue=VI(pe,_e,t,ye,O),U==0&&[9,521,1033,2057].indexOf(fe)===-1)continue;switch(pe){case 34:r.opts.Date1904=B.WBProps.date1904=ue;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(O.enc||(t.l=0),O.enc=ue,!e.password)throw new Error("File is password-protected");if(ue.valid==null)throw new Error("Encryption scheme unsupported");if(!ue.valid)throw new Error("Password is incorrect");break;case 92:O.lastuser=ue;break;case 66:var at=Number(ue);switch(at){case 21010:at=1200;break;case 32768:at=1e4;break;case 32769:at=1252;break}Go(O.codepage=at),ne=!0;break;case 317:O.rrtabid=ue;break;case 25:O.winlocked=ue;break;case 439:r.opts.RefreshAll=ue;break;case 12:r.opts.CalcCount=ue;break;case 16:r.opts.CalcDelta=ue;break;case 17:r.opts.CalcIter=ue;break;case 13:r.opts.CalcMode=ue;break;case 14:r.opts.CalcPrecision=ue;break;case 95:r.opts.CalcSaveRecalc=ue;break;case 15:O.CalcRefMode=ue;break;case 2211:r.opts.FullCalc=ue;break;case 129:ue.fDialog&&(n["!type"]="dialog"),ue.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),ue.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:G.push(ue);break;case 430:ae.push([ue]),ae[ae.length-1].XTI=[];break;case 35:case 547:ae[ae.length-1].push(ue);break;case 24:case 536:z={Name:ue.Name,Ref:Rs(ue.rgce,l,null,ae,O)},ue.itab>0&&(z.Sheet=ue.itab-1),ae.names.push(z),ae[0]||(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].push(ue),ue.Name=="_xlnm._FilterDatabase"&&ue.itab>0&&ue.rgce&&ue.rgce[0]&&ue.rgce[0][0]&&ue.rgce[0][0][0]=="PtgArea3d"&&(I[ue.itab-1]={ref:Or(ue.rgce[0][0][1][2])});break;case 22:O.ExternCount=ue;break;case 23:ae.length==0&&(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].XTI=ae[ae.length-1].XTI.concat(ue),ae.XTI=ae.XTI.concat(ue);break;case 2196:if(O.biff<8)break;z!=null&&(z.Comment=ue[1]);break;case 18:n["!protect"]=ue;break;case 19:ue!==0&&O.WTF&&console.error("Password verifier: "+ue);break;case 133:s[ue.pos]=ue,O.snames.push(ue.name);break;case 10:{if(--U)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,n["!ref"]=Or(l),e.sheetRows&&e.sheetRows<=l.e.r){var ht=l.e.r;l.e.r=e.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Or(l),l.e.r=ht}l.e.r++,l.e.c++}V.length>0&&(n["!merges"]=V),ie.length>0&&(n["!objects"]=ie),X.length>0&&(n["!cols"]=X),Z.length>0&&(n["!rows"]=Z),B.Sheets.push(q)}d===""?m=n:a[d]=n,n=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(O.biff===8&&(O.biff={9:2,521:3,1033:4}[pe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ue.BIFFVer]||8),O.biffguess=ue.BIFFVer==0,ue.BIFFVer==0&&ue.dt==4096&&(O.biff=5,ne=!0,Go(O.codepage=28591)),O.biff==8&&ue.BIFFVer==0&&ue.dt==16&&(O.biff=2),U++)break;if(n=e.dense?[]:{},O.biff<8&&!ne&&(ne=!0,Go(O.codepage=e.codepage||1252)),O.biff<5||ue.BIFFVer==0&&ue.dt==4096){d===""&&(d="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var de={pos:t.l-ye,name:d};s[de.pos]=de,O.snames.push(d)}else d=(s[se]||{name:""}).name;ue.dt==32&&(n["!type"]="chart"),ue.dt==64&&(n["!type"]="macro"),V=[],ie=[],O.arrayf=C=[],X=[],Z=[],K=!1,q={Hidden:(s[se]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(e.dense?(n[ue.r]||[])[ue.c]:n[wr({c:ue.c,r:ue.r})])&&++ue.c,A={ixfe:ue.ixfe,XF:G[ue.ixfe]||{},v:ue.val,t:"n"},j>0&&(A.z=F[A.ixfe>>8&63]),yl(A,e,r.opts.Date1904),D({c:ue.c,r:ue.r},A,e);break;case 5:case 517:A={ixfe:ue.ixfe,XF:G[ue.ixfe],v:ue.val,t:ue.t},j>0&&(A.z=F[A.ixfe>>8&63]),yl(A,e,r.opts.Date1904),D({c:ue.c,r:ue.r},A,e);break;case 638:A={ixfe:ue.ixfe,XF:G[ue.ixfe],v:ue.rknum,t:"n"},j>0&&(A.z=F[A.ixfe>>8&63]),yl(A,e,r.opts.Date1904),D({c:ue.c,r:ue.r},A,e);break;case 189:for(var it=ue.c;it<=ue.C;++it){var Se=ue.rkrec[it-ue.c][0];A={ixfe:Se,XF:G[Se],v:ue.rkrec[it-ue.c][1],t:"n"},j>0&&(A.z=F[A.ixfe>>8&63]),yl(A,e,r.opts.Date1904),D({c:it,r:ue.r},A,e)}break;case 6:case 518:case 1030:{if(ue.val=="String"){c=ue;break}if(A=wp(ue.val,ue.cell.ixfe,ue.tt),A.XF=G[A.ixfe],e.cellFormula){var ve=ue.formula;if(ve&&ve[0]&&ve[0][0]&&ve[0][0][0]=="PtgExp"){var Ie=ve[0][0][1][0],wt=ve[0][0][1][1],Xe=wr({r:Ie,c:wt});E[Xe]?A.f=""+Rs(ue.formula,l,ue.cell,ae,O):A.F=((e.dense?(n[Ie]||[])[wt]:n[Xe])||{}).F}else A.f=""+Rs(ue.formula,l,ue.cell,ae,O)}j>0&&(A.z=F[A.ixfe>>8&63]),yl(A,e,r.opts.Date1904),D(ue.cell,A,e),c=ue}break;case 7:case 519:if(c)c.val=ue,A=wp(ue,c.cell.ixfe,"s"),A.XF=G[A.ixfe],e.cellFormula&&(A.f=""+Rs(c.formula,l,c.cell,ae,O)),j>0&&(A.z=F[A.ixfe>>8&63]),yl(A,e,r.opts.Date1904),D(c.cell,A,e),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{C.push(ue);var ct=wr(ue[0].s);if(g=e.dense?(n[ue[0].s.r]||[])[ue[0].s.c]:n[ct],e.cellFormula&&g){if(!c||!ct||!g)break;g.f=""+Rs(ue[1],l,ue[0],ae,O),g.F=Or(ue[0])}}break;case 1212:{if(!e.cellFormula)break;if(x){if(!c)break;E[wr(c.cell)]=ue[0],g=e.dense?(n[c.cell.r]||[])[c.cell.c]:n[wr(c.cell)],(g||{}).f=""+Rs(ue[0],l,v,ae,O)}}break;case 253:A=wp(f[ue.isst].t,ue.ixfe,"s"),f[ue.isst].h&&(A.h=f[ue.isst].h),A.XF=G[A.ixfe],j>0&&(A.z=F[A.ixfe>>8&63]),yl(A,e,r.opts.Date1904),D({c:ue.c,r:ue.r},A,e);break;case 513:e.sheetStubs&&(A={ixfe:ue.ixfe,XF:G[ue.ixfe],t:"z"},j>0&&(A.z=F[A.ixfe>>8&63]),yl(A,e,r.opts.Date1904),D({c:ue.c,r:ue.r},A,e));break;case 190:if(e.sheetStubs)for(var jt=ue.c;jt<=ue.C;++jt){var Lt=ue.ixfe[jt-ue.c];A={ixfe:Lt,XF:G[Lt],t:"z"},j>0&&(A.z=F[A.ixfe>>8&63]),yl(A,e,r.opts.Date1904),D({c:jt,r:ue.r},A,e)}break;case 214:case 516:case 4:A=wp(ue.val,ue.ixfe,"s"),A.XF=G[A.ixfe],j>0&&(A.z=F[A.ixfe>>8&63]),yl(A,e,r.opts.Date1904),D({c:ue.c,r:ue.r},A,e);break;case 0:case 512:U===1&&(l=ue);break;case 252:f=ue;break;case 1054:if(O.biff==4){F[j++]=ue[1];for(var Vt=0;Vt<j+163&&br[Vt]!=ue[1];++Vt);Vt>=163&&hc(ue[1],j+163)}else hc(ue[1],ue[0]);break;case 30:{F[j++]=ue;for(var $t=0;$t<j+163&&br[$t]!=ue;++$t);$t>=163&&hc(ue,j+163)}break;case 229:V=V.concat(ue);break;case 93:ie[ue.cmo[0]]=O.lastobj=ue;break;case 438:O.lastobj.TxO=ue;break;case 127:O.lastobj.ImData=ue;break;case 440:for(w=ue[0].s.r;w<=ue[0].e.r;++w)for(_=ue[0].s.c;_<=ue[0].e.c;++_)g=e.dense?(n[w]||[])[_]:n[wr({c:_,r:w})],g&&(g.l=ue[1]);break;case 2048:for(w=ue[0].s.r;w<=ue[0].e.r;++w)for(_=ue[0].s.c;_<=ue[0].e.c;++_)g=e.dense?(n[w]||[])[_]:n[wr({c:_,r:w})],g&&g.l&&(g.l.Tooltip=ue[1]);break;case 28:{if(O.biff<=5&&O.biff>=2)break;g=e.dense?(n[ue[0].r]||[])[ue[0].c]:n[wr(ue[0])];var Wt=ie[ue[2]];g||(e.dense?(n[ue[0].r]||(n[ue[0].r]=[]),g=n[ue[0].r][ue[0].c]={t:"z"}):g=n[wr(ue[0])]={t:"z"},l.e.r=Math.max(l.e.r,ue[0].r),l.s.r=Math.min(l.s.r,ue[0].r),l.e.c=Math.max(l.e.c,ue[0].c),l.s.c=Math.min(l.s.c,ue[0].c)),g.c||(g.c=[]),b={a:ue[1],t:Wt.TxO.t},g.c.push(b)}break;case 2173:FF(G[ue.ixfe],ue.ext);break;case 125:{if(!O.cellStyles)break;for(;ue.e>=ue.s;)X[ue.e--]={width:ue.w/256,level:ue.level||0,hidden:!!(ue.flags&1)},K||(K=!0,F2(ue.w/256)),xu(X[ue.e+1])}break;case 520:{var Ot={};ue.level!=null&&(Z[ue.r]=Ot,Ot.level=ue.level),ue.hidden&&(Z[ue.r]=Ot,Ot.hidden=!0),ue.hpt&&(Z[ue.r]=Ot,Ot.hpt=ue.hpt,Ot.hpx=uh(ue.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||_f(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[pe]]=ue;break;case 161:n["!margins"]||_f(n["!margins"]={}),n["!margins"].header=ue.header,n["!margins"].footer=ue.footer;break;case 574:ue.RTL&&(B.Views[0].RTL=!0);break;case 146:W=ue;break;case 2198:M=ue;break;case 140:T=ue;break;case 442:d?q.CodeName=ue||q.name:B.WBProps.CodeName=ue||"ThisWorkbook";break}}else _e||console.error("Missing Info for XLS Record 0x"+pe.toString(16)),t.l+=ye}return r.SheetNames=gn(s).sort(function(kt,qe){return Number(kt)-Number(qe)}).map(function(kt){return s[kt].name}),e.bookSheets||(r.Sheets=a),!r.SheetNames.length&&m["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=m)):r.Preamble=m,r.Sheets&&I.forEach(function(kt,qe){r.Sheets[r.SheetNames[qe]]["!autofilter"]=kt}),r.Strings=f,r.SSF=Ha(br),O.enc&&(r.Encryption=O.enc),M&&(r.Themes=M),r.Metadata={},T!==void 0&&(r.Metadata.Country=T),ae.names.length>0&&(B.Names=ae.names),r.Workbook=B,r}var S0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function YI(t,e,r){var a=hr.find(t,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=Vw(a,Sx,S0.DSI);for(var s in n)e[s]=n[s]}catch(d){if(r.WTF)throw d}var l=hr.find(t,"/!SummaryInformation");if(l&&l.size>0)try{var c=Vw(l,Nx,S0.SI);for(var f in c)e[f]==null&&(e[f]=c[f])}catch(d){if(r.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(a3(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function XI(t,e){var r=[],a=[],n=[],s=0,l,c=ww(Sx,"n"),f=ww(Nx,"n");if(t.Props)for(l=gn(t.Props),s=0;s<l.length;++s)(Object.prototype.hasOwnProperty.call(c,l[s])?r:Object.prototype.hasOwnProperty.call(f,l[s])?a:n).push([l[s],t.Props[l[s]]]);if(t.Custprops)for(l=gn(t.Custprops),s=0;s<l.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},l[s])||(Object.prototype.hasOwnProperty.call(c,l[s])?r:Object.prototype.hasOwnProperty.call(f,l[s])?a:n).push([l[s],t.Custprops[l[s]]]);var d=[];for(s=0;s<n.length;++s)u3.indexOf(n[s][0])>-1||r3.indexOf(n[s][0])>-1||n[s][1]!=null&&d.push(n[s]);a.length&&hr.utils.cfb_add(e,"/SummaryInformation",Gw(a,S0.SI,f,Nx)),(r.length||d.length)&&hr.utils.cfb_add(e,"/DocumentSummaryInformation",Gw(r,S0.DSI,c,Sx,d.length?d:null,S0.UDI))}function sj(t,e){e||(e={}),H2(e),u2(),e.codepage&&c2(e.codepage);var r,a;if(t.FullPaths){if(hr.find(t,"/encryption"))throw new Error("File is password-protected");r=hr.find(t,"!CompObj"),a=hr.find(t,"/Workbook")||hr.find(t,"/Book")}else{switch(e.type){case"base64":t=Mi(qi(t));break;case"binary":t=Mi(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}ys(t,0),a={content:t}}var n,s;if(r&&$I(r),e.bookProps&&!e.bookSheets)n={};else{var l=Pr?"buffer":"array";if(a&&a.content)n=GI(a.content,e);else if((s=hr.find(t,"PerfectOffice_MAIN"))&&s.content)n=yf.to_workbook(s.content,(e.type=l,e));else if((s=hr.find(t,"NativeContent_MAIN"))&&s.content)n=yf.to_workbook(s.content,(e.type=l,e));else throw(s=hr.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&hr.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=lL(t))}var c={};return t.FullPaths&&YI(t,c,e),n.Props=n.Custprops=c,e.bookFiles&&(n.cfb=t),n}function KI(t,e){var r=e||{},a=hr.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return hr.utils.cfb_add(a,n,ij(t,r)),r.biff==8&&(t.Props||t.Custprops)&&XI(t,a),r.biff==8&&t.vbaraw&&cL(a,hr.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),a}var W0={0:{f:_9},1:{f:A9},2:{f:G9},3:{f:P9},4:{f:R9},5:{f:$9},6:{f:Z9},7:{f:U9},8:{f:sM},9:{f:nM},10:{f:rM},11:{f:aM},12:{f:T9},13:{f:X9},14:{f:I9},15:{f:F9},16:{f:J3},17:{f:eM},18:{f:z9},19:{f:N2},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:eI},40:{},42:{},43:{f:ZD},44:{f:KD},45:{f:tF},46:{f:aF},47:{f:rF},48:{},49:{f:SO},50:{},51:{f:MF},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:b3},62:{f:J9},63:{f:VF},64:{f:bM},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ps,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:vM},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:k9},148:{f:S9,p:16},151:{f:fM},152:{},153:{f:JM},154:{},155:{},156:{f:XM},157:{},158:{},159:{T:1,f:hD},160:{T:-1},161:{T:1,f:Mf},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:iM},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:LF},336:{T:-1},337:{f:UF,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:wx},357:{},358:{},359:{},360:{T:1},361:{},362:{f:_3},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:dM},427:{f:hM},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:pM},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:j9},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:cM},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:wx},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:aL},633:{T:1},634:{T:-1},635:{T:1,f:tL},636:{T:-1},637:{f:EO},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:IM},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:wM},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Tx={6:{f:pv},10:{f:nu},12:{f:Mn},13:{f:Mn},14:{f:wn},15:{f:wn},16:{f:Fs},17:{f:wn},18:{f:wn},19:{f:Mn},20:{f:Qw},21:{f:Qw},23:{f:_3},24:{f:t5},25:{f:wn},26:{},27:{},28:{f:wR},29:{},34:{f:wn},35:{f:e5},38:{f:Fs},39:{f:Fs},40:{f:Fs},41:{f:Fs},42:{f:wn},43:{f:wn},47:{f:FD},49:{f:X7},51:{f:Mn},60:{},61:{f:$7},64:{f:wn},65:{f:Y7},66:{f:Mn},77:{},80:{},81:{},82:{},85:{f:Mn},89:{},90:{},91:{},92:{f:D7},93:{f:jR},94:{},95:{f:wn},96:{},97:{},99:{f:wn},125:{f:b3},128:{f:uR},129:{f:L7},130:{f:Mn},131:{f:wn},132:{f:wn},133:{f:P7},134:{},140:{f:DR},141:{f:Mn},144:{},146:{f:PR},151:{},152:{},153:{},154:{},155:{},156:{f:Mn},157:{},158:{},160:{f:HR},161:{f:BR},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:iR},190:{f:oR},193:{f:nu},197:{},198:{},199:{},200:{},201:{},202:{f:wn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Mn},220:{},221:{f:wn},222:{},224:{f:cR},225:{f:R7},226:{f:nu},227:{},229:{f:SR},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:I7},253:{f:J7},255:{f:U7},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:f3},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:wn},353:{f:nu},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:pR},431:{f:wn},432:{},433:{},434:{},437:{},438:{f:AR},439:{f:wn},440:{f:CR},441:{},442:{f:am},443:{},444:{f:Mn},445:{},446:{},448:{f:nu},449:{f:H7,r:2},450:{f:nu},512:{f:Kw},513:{f:zR},515:{f:hR},516:{f:Q7},517:{f:Zw},519:{f:$R},520:{f:q7},523:{},545:{f:r5},549:{f:Xw},566:{},574:{f:V7},638:{f:sR},659:{},1048:{},1054:{f:tR},1084:{},1212:{f:yR},2048:{f:OR},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:yp},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:nu},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:MR,r:12},2173:{f:DF,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:wn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:xR,r:12},2197:{},2198:{f:EF,r:12},2199:{},2200:{},2201:{},2202:{f:_R,r:12},2203:{f:nu},2204:{},2205:{},2206:{},2207:{},2211:{f:z7},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Mn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:UR},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:LR},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Kw},1:{},2:{f:XR},3:{f:GR},4:{f:VR},5:{f:Zw},7:{f:JR},8:{},9:{f:yp},11:{},22:{f:Mn},30:{f:aR},31:{},32:{},33:{f:r5},36:{},37:{f:Xw},50:{f:ZR},62:{},52:{},67:{},68:{f:Mn},69:{},86:{},126:{},127:{f:WR},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:QR},223:{},234:{},354:{},421:{},518:{f:pv},521:{f:yp},536:{f:t5},547:{f:e5},561:{},579:{},1030:{f:pv},1033:{f:yp},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ut(t,e,r,a){var n=e;if(!isNaN(n)){var s=a||(r||[]).length||0,l=t.next(4);l.write_shift(2,n),l.write_shift(2,s),s>0&&b2(r)&&t.push(r)}}function JI(t,e,r,a){var n=(r||[]).length||0;if(n<=8224)return Ut(t,e,r,n);var s=e;if(!isNaN(s)){for(var l=r.parts||[],c=0,f=0,d=0;d+(l[c]||8224)<=8224;)d+=l[c]||8224,c++;var m=t.next(4);for(m.write_shift(2,s),m.write_shift(2,d),t.push(r.slice(f,f+d)),f+=d;f<n;){for(m=t.next(4),m.write_shift(2,60),d=0;d+(l[c]||8224)<=8224;)d+=l[c]||8224,c++;m.write_shift(2,d),t.push(r.slice(f,f+d)),f+=d}}}function om(t,e,r){return t||(t=ft(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function ZI(t,e,r,a){var n=ft(9);return om(n,t,e),d3(r,a||"b",n),n}function QI(t,e,r){var a=ft(8+2*r.length);return om(a,t,e),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function eB(t,e,r,a){if(e.v!=null)switch(e.t){case"d":case"n":var n=e.t=="d"?Jn(za(e.v)):e.v;n==(n|0)&&n>=0&&n<65536?Ut(t,2,KR(r,a,n)):Ut(t,3,YR(r,a,n));return;case"b":case"e":Ut(t,5,ZI(r,a,e.v,e.t));return;case"s":case"str":Ut(t,4,QI(r,a,(e.v||"").slice(0,255)));return}Ut(t,1,om(null,r,a))}function tB(t,e,r,a){var n=Array.isArray(e),s=ta(e["!ref"]||"A1"),l,c="",f=[];if(s.e.c>255||s.e.r>16383){if(a.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),l=Or(s)}for(var d=s.s.r;d<=s.e.r;++d){c=An(d);for(var m=s.s.c;m<=s.e.c;++m){d===s.s.r&&(f[m]=tn(m)),l=f[m]+c;var v=n?(e[d]||[])[m]:e[l];v&&eB(t,v,d,m)}}}function rB(t,e){for(var r=e||{},a=hi(),n=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(n=s);if(n==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ut(a,r.biff==4?1033:r.biff==3?521:9,O2(t,16,r)),tB(a,t.Sheets[t.SheetNames[n]],n,r),Ut(a,10),a.end()}function aB(t,e,r){Ut(t,49,K7({sz:12,name:"Arial"},r))}function nB(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)e[n]!=null&&Ut(t,1054,rR(n,e[n],r))})}function sB(t,e){var r=ft(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ut(t,2151,r),r=ft(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),v3(ta(e["!ref"]||"A1"),r),r.write_shift(4,4),Ut(t,2152,r)}function iB(t,e){for(var r=0;r<16;++r)Ut(t,224,Jw({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(a){Ut(t,224,Jw(a,0,e))})}function oB(t,e){for(var r=0;r<e["!links"].length;++r){var a=e["!links"][r];Ut(t,440,TR(a)),a[1].Tooltip&&Ut(t,2048,RR(a))}delete e["!links"]}function lB(t,e){if(e){var r=0;e.forEach(function(a,n){++r<=256&&a&&Ut(t,125,IR(A1(n,a),n))})}}function cB(t,e,r,a,n){var s=16+ju(n.cellXfs,e,n);if(e.v==null&&!e.bf){Ut(t,513,kf(r,a,s));return}if(e.bf)Ut(t,6,LP(e,r,a,n,s));else switch(e.t){case"d":case"n":var l=e.t=="d"?Jn(za(e.v)):e.v;Ut(t,515,mR(r,a,l,s));break;case"b":case"e":Ut(t,517,dR(r,a,e.v,s,n,e.t));break;case"s":case"str":if(n.bookSST){var c=B2(n.Strings,e.v,n.revStrings);Ut(t,253,Z7(r,a,c,s))}else Ut(t,516,eR(r,a,(e.v||"").slice(0,255),s,n));break;default:Ut(t,513,kf(r,a,s))}}function uB(t,e,r){var a=hi(),n=r.SheetNames[t],s=r.Sheets[n]||{},l=(r||{}).Workbook||{},c=(l.Sheets||[])[t]||{},f=Array.isArray(s),d=e.biff==8,m,v="",x=[],g=ta(s["!ref"]||"A1"),b=d?65536:16384;if(g.e.c>255||g.e.r>=b){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,b-1)}Ut(a,2057,O2(r,16,e)),Ut(a,13,co(1)),Ut(a,12,co(100)),Ut(a,15,Vs(!0)),Ut(a,17,Vs(!1)),Ut(a,16,Nf(.001)),Ut(a,95,Vs(!0)),Ut(a,42,Vs(!1)),Ut(a,43,Vs(!1)),Ut(a,130,co(1)),Ut(a,128,fR()),Ut(a,131,Vs(!1)),Ut(a,132,Vs(!1)),d&&lB(a,s["!cols"]),Ut(a,512,nR(g,e)),d&&(s["!links"]=[]);for(var _=g.s.r;_<=g.e.r;++_){v=An(_);for(var w=g.s.c;w<=g.e.c;++w){_===g.s.r&&(x[w]=tn(w)),m=x[w]+v;var E=f?(s[_]||[])[w]:s[m];E&&(cB(a,E,_,w,e),d&&E.l&&s["!links"].push([m,E.l]))}}var C=c.CodeName||c.name||n;return d&&Ut(a,574,G7((l.Views||[])[0])),d&&(s["!merges"]||[]).length&&Ut(a,229,NR(s["!merges"])),d&&oB(a,s),Ut(a,442,h3(C)),d&&sB(a,s),Ut(a,10),a.end()}function fB(t,e,r){var a=hi(),n=(t||{}).Workbook||{},s=n.Sheets||[],l=n.WBProps||{},c=r.biff==8,f=r.biff==5;if(Ut(a,2057,O2(t,5,r)),r.bookType=="xla"&&Ut(a,135),Ut(a,225,c?co(1200):null),Ut(a,193,d7(2)),f&&Ut(a,191),f&&Ut(a,192),Ut(a,226),Ut(a,92,F7("SheetJS",r)),Ut(a,66,co(c?1200:1252)),c&&Ut(a,353,co(0)),c&&Ut(a,448),Ut(a,317,qR(t.SheetNames.length)),c&&t.vbaraw&&Ut(a,211),c&&t.vbaraw){var d=l.CodeName||"ThisWorkbook";Ut(a,442,h3(d))}Ut(a,156,co(17)),Ut(a,25,Vs(!1)),Ut(a,18,Vs(!1)),Ut(a,19,co(0)),c&&Ut(a,431,Vs(!1)),c&&Ut(a,444,co(0)),Ut(a,61,W7()),Ut(a,64,Vs(!1)),Ut(a,141,co(0)),Ut(a,34,Vs(HM(t)=="true")),Ut(a,14,Vs(!0)),c&&Ut(a,439,Vs(!1)),Ut(a,218,co(0)),aB(a,t,r),nB(a,t.SSF,r),iB(a,r),c&&Ut(a,352,Vs(!1));var m=a.end(),v=hi();c&&Ut(v,140,FR()),c&&r.Strings&&JI(v,252,B7(r.Strings)),Ut(v,10);var x=v.end(),g=hi(),b=0,_=0;for(_=0;_<t.SheetNames.length;++_)b+=(c?12:11)+(c?2:1)*t.SheetNames[_].length;var w=m.length+b+x.length;for(_=0;_<t.SheetNames.length;++_){var E=s[_]||{};Ut(g,133,M7({pos:w,hs:E.Hidden||0,dt:0,name:t.SheetNames[_]},r)),w+=e[_].length}var C=g.end();if(b!=C.length)throw new Error("BS8 "+b+" != "+C.length);var A=[];return m.length&&A.push(m),C.length&&A.push(C),x.length&&A.push(x),is(A)}function dB(t,e){var r=e||{},a=[];t&&!t.SSF&&(t.SSF=Ha(br)),t&&t.SSF&&(vh(),b1(t.SSF),r.revssf=S1(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,$2(r),r.cellXfs=[],ju(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var n=0;n<t.SheetNames.length;++n)a[a.length]=uB(n,r,t);return a.unshift(fB(t,a,r)),is(a)}function ij(t,e){for(var r=0;r<=t.SheetNames.length;++r){var a=t.Sheets[t.SheetNames[r]];if(!(!a||!a["!ref"])){var n=mi(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return dB(t,e);case 4:case 3:case 2:return rB(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function d5(t,e){var r=e||{},a=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var n=t.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),l=n.index,c=s&&s.index||t.length,f=K8(t.slice(l,c),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,m=0,v=0,x=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},b=[];for(l=0;l<f.length;++l){var _=f[l].trim(),w=_.slice(0,3).toLowerCase();if(w=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}m=0;continue}if(!(w!="<td"&&w!="<th")){var E=_.split(/<\/t[dh]>/i);for(c=0;c<E.length;++c){var C=E[c].trim();if(C.match(/<t[dh]/i)){for(var A=C,T=0;A.charAt(0)=="<"&&(T=A.indexOf(">"))>-1;)A=A.slice(T+1);for(var G=0;G<b.length;++G){var W=b[G];W.s.c==m&&W.s.r<d&&d<=W.e.r&&(m=W.e.c+1,G=-1)}var B=Sr(C.slice(0,C.indexOf(">")));x=B.colspan?+B.colspan:1,((v=+B.rowspan)>1||x>1)&&b.push({s:{r:d,c:m},e:{r:d+(v||1)-1,c:m+x-1}});var q=B.t||B["data-t"]||"";if(!A.length){m+=x;continue}if(A=TN(A),g.s.r>d&&(g.s.r=d),g.e.r<d&&(g.e.r=d),g.s.c>m&&(g.s.c=m),g.e.c<m&&(g.e.c=m),!A.length){m+=x;continue}var L={t:"s",v:A};r.raw||!A.trim().length||q=="s"||(A==="TRUE"?L={t:"b",v:!0}:A==="FALSE"?L={t:"b",v:!1}:isNaN(Xo(A))?isNaN(lh(A).getDate())||(L={t:"d",v:za(A)},r.cellDates||(L={t:"n",v:Jn(L.v)}),L.z=r.dateNF||br[14]):L={t:"n",v:Xo(A)}),r.dense?(a[d]||(a[d]=[]),a[d][m]=L):a[wr({r:d,c:m})]=L,m+=x}}}}return a["!ref"]=Or(g),b.length&&(a["!merges"]=b),a}function hB(t,e,r,a){for(var n=t["!merges"]||[],s=[],l=e.s.c;l<=e.e.c;++l){for(var c=0,f=0,d=0;d<n.length;++d)if(!(n[d].s.r>r||n[d].s.c>l)&&!(n[d].e.r<r||n[d].e.c<l)){if(n[d].s.r<r||n[d].s.c<l){c=-1;break}c=n[d].e.r-n[d].s.r+1,f=n[d].e.c-n[d].s.c+1;break}if(!(c<0)){var m=wr({r,c:l}),v=a.dense?(t[r]||[])[l]:t[m],x=v&&v.v!=null&&(v.h||x2(v.w||(pc(v),v.w)||""))||"",g={};c>1&&(g.rowspan=c),f>1&&(g.colspan=f),a.editable?x='<span contenteditable="true">'+x+"</span>":v&&(g["data-t"]=v&&v.t||"z",v.v!=null&&(g["data-v"]=v.v),v.z!=null&&(g["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+v.l.Target+'">'+x+"</a>")),g.id=(a.id||"sjs")+"-"+m,s.push(Mt("td",x,g))}}var b="<tr>";return b+s.join("")+"</tr>"}var mB='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',pB="</body></html>";function gB(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Nu(d5(r[0],e),e);var a=G2();return r.forEach(function(n,s){Y2(a,d5(n,e),"Sheet"+(s+1))}),a}function vB(t,e,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function oj(t,e){var r=e||{},a=r.header!=null?r.header:mB,n=r.footer!=null?r.footer:pB,s=[a],l=mi(t["!ref"]);r.dense=Array.isArray(t),s.push(vB(t,l,r));for(var c=l.s.r;c<=l.e.r;++c)s.push(hB(t,l,c,r));return s.push("</table>"+n),s.join("")}function lj(t,e,r){var a=r||{},n=0,s=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var l=typeof a.origin=="string"?rn(a.origin):a.origin;n=l.r,s=l.c}var c=e.getElementsByTagName("tr"),f=Math.min(a.sheetRows||1e7,c.length),d={s:{r:0,c:0},e:{r:n,c:s}};if(t["!ref"]){var m=mi(t["!ref"]);d.s.r=Math.min(d.s.r,m.s.r),d.s.c=Math.min(d.s.c,m.s.c),d.e.r=Math.max(d.e.r,m.e.r),d.e.c=Math.max(d.e.c,m.e.c),n==-1&&(d.e.r=n=m.e.r+1)}var v=[],x=0,g=t["!rows"]||(t["!rows"]=[]),b=0,_=0,w=0,E=0,C=0,A=0;for(t["!cols"]||(t["!cols"]=[]);b<c.length&&_<f;++b){var T=c[b];if(h5(T)){if(a.display)continue;g[_]={hidden:!0}}var G=T.children;for(w=E=0;w<G.length;++w){var W=G[w];if(!(a.display&&h5(W))){var B=W.hasAttribute("data-v")?W.getAttribute("data-v"):W.hasAttribute("v")?W.getAttribute("v"):TN(W.innerHTML),q=W.getAttribute("data-z")||W.getAttribute("z");for(x=0;x<v.length;++x){var L=v[x];L.s.c==E+s&&L.s.r<_+n&&_+n<=L.e.r&&(E=L.e.c+1-s,x=-1)}A=+W.getAttribute("colspan")||1,((C=+W.getAttribute("rowspan")||1)>1||A>1)&&v.push({s:{r:_+n,c:E+s},e:{r:_+n+(C||1)-1,c:E+s+(A||1)-1}});var J={t:"s",v:B},D=W.getAttribute("data-t")||W.getAttribute("t")||"";B!=null&&(B.length==0?J.t=D||"z":a.raw||B.trim().length==0||D=="s"||(B==="TRUE"?J={t:"b",v:!0}:B==="FALSE"?J={t:"b",v:!1}:isNaN(Xo(B))?isNaN(lh(B).getDate())||(J={t:"d",v:za(B)},a.cellDates||(J={t:"n",v:Jn(J.v)}),J.z=a.dateNF||br[14]):J={t:"n",v:Xo(B)})),J.z===void 0&&q!=null&&(J.z=q);var O="",M=W.getElementsByTagName("A");if(M&&M.length)for(var V=0;V<M.length&&!(M[V].hasAttribute("href")&&(O=M[V].getAttribute("href"),O.charAt(0)!="#"));++V);O&&O.charAt(0)!="#"&&(J.l={Target:O}),a.dense?(t[_+n]||(t[_+n]=[]),t[_+n][E+s]=J):t[wr({c:E+s,r:_+n})]=J,d.e.c<E+s&&(d.e.c=E+s),E+=A}}++_}return v.length&&(t["!merges"]=(t["!merges"]||[]).concat(v)),d.e.r=Math.max(d.e.r,_-1+n),t["!ref"]=Or(d),_>=f&&(t["!fullref"]=Or((d.e.r=c.length-b+_-1+n,d))),t}function cj(t,e){var r=e||{},a=r.dense?[]:{};return lj(a,t,e)}function xB(t,e){return Nu(cj(t,e),e)}function h5(t){var e="",r=yB(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function yB(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function _B(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ea(e.replace(/<[^>]*>/g,""));return[r]}var m5={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function uj(t,e){var r=e||{},a=y2(t),n=[],s,l,c={name:""},f="",d=0,m,v,x={},g=[],b=r.dense?[]:{},_,w,E={value:""},C="",A=0,T=[],G=-1,W=-1,B={s:{r:1e6,c:1e7},e:{r:0,c:0}},q=0,L={},J=[],D={},O=0,M=0,V=[],ie=1,X=1,Z=[],K={Names:[]},ae={},fe=["",""],U=[],j={},F="",I=0,z=!1,ne=!1,se=0;for(B0.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");_=B0.exec(a);)switch(_[3]=_[3].replace(/_.*$/,"")){case"table":case"":_[1]==="/"?(B.e.c>=B.s.c&&B.e.r>=B.s.r?b["!ref"]=Or(B):b["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=B.e.r&&(b["!fullref"]=b["!ref"],B.e.r=r.sheetRows-1,b["!ref"]=Or(B)),J.length&&(b["!merges"]=J),V.length&&(b["!rows"]=V),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),g.push(m.name),x[m.name]=b,ne=!1):_[0].charAt(_[0].length-2)!=="/"&&(m=Sr(_[0],!1),G=W=-1,B.s.r=B.s.c=1e7,B.e.r=B.e.c=0,b=r.dense?[]:{},J=[],V=[],ne=!0);break;case"table-row-group":_[1]==="/"?--q:++q;break;case"table-row":case"":if(_[1]==="/"){G+=ie,ie=1;break}if(v=Sr(_[0],!1),v.?G=v.-1:G==-1&&(G=0),ie=+v["number-rows-repeated"]||1,ie<10)for(se=0;se<ie;++se)q>0&&(V[G+se]={level:q});W=-1;break;case"covered-table-cell":_[1]!=="/"&&++W,r.sheetStubs&&(r.dense?(b[G]||(b[G]=[]),b[G][W]={t:"z"}):b[wr({r:G,c:W})]={t:"z"}),C="",T=[];break;case"table-cell":case"":if(_[0].charAt(_[0].length-2)==="/")++W,E=Sr(_[0],!1),X=parseInt(E["number-columns-repeated"]||"1",10),w={t:"z",v:null},E.formula&&r.cellFormula!=!1&&(w.f=c5(ea(E.formula))),(E.||E["value-type"])=="string"&&(w.t="s",w.v=ea(E["string-value"]||""),r.dense?(b[G]||(b[G]=[]),b[G][W]=w):b[wr({r:G,c:W})]=w),W+=X-1;else if(_[1]!=="/"){++W,C="",A=0,T=[],X=1;var pe=ie?G+ie-1:G;if(W>B.e.c&&(B.e.c=W),W<B.s.c&&(B.s.c=W),G<B.s.r&&(B.s.r=G),pe>B.e.r&&(B.e.r=pe),E=Sr(_[0],!1),U=[],j={},w={t:E.||E["value-type"],v:null},r.cellFormula)if(E.formula&&(E.formula=ea(E.formula)),E["number-matrix-columns-spanned"]&&E["number-matrix-rows-spanned"]&&(O=parseInt(E["number-matrix-rows-spanned"],10)||0,M=parseInt(E["number-matrix-columns-spanned"],10)||0,D={s:{r:G,c:W},e:{r:G+O-1,c:W+M-1}},w.F=Or(D),Z.push([D,w.F])),E.formula)w.f=c5(E.formula);else for(se=0;se<Z.length;++se)G>=Z[se][0].s.r&&G<=Z[se][0].e.r&&W>=Z[se][0].s.c&&W<=Z[se][0].e.c&&(w.F=Z[se][1]);switch((E["number-columns-spanned"]||E["number-rows-spanned"])&&(O=parseInt(E["number-rows-spanned"],10)||0,M=parseInt(E["number-columns-spanned"],10)||0,D={s:{r:G,c:W},e:{r:G+O-1,c:W+M-1}},J.push(D)),E["number-columns-repeated"]&&(X=parseInt(E["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Ua(E["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(E.value);break;case"percentage":w.t="n",w.v=parseFloat(E.value);break;case"currency":w.t="n",w.v=parseFloat(E.value);break;case"date":w.t="d",w.v=za(E["date-value"]),r.cellDates||(w.t="n",w.v=Jn(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=G8(E["time-value"])/86400,r.cellDates&&(w.t="d",w.v=N1(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(E.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",E["string-value"]!=null&&(C=ea(E["string-value"]),T=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(z=!1,w.t==="s"&&(w.v=C||"",T.length&&(w.R=T),z=A==0),ae.Target&&(w.l=ae),U.length>0&&(w.c=U,U=[]),C&&r.cellText!==!1&&(w.w=C),z&&(w.t="z",delete w.v),(!z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=G))for(var ye=0;ye<ie;++ye){if(X=parseInt(E["number-columns-repeated"]||"1",10),r.dense)for(b[G+ye]||(b[G+ye]=[]),b[G+ye][W]=ye==0?w:Ha(w);--X>0;)b[G+ye][W+X]=Ha(w);else for(b[wr({r:G+ye,c:W})]=w;--X>0;)b[wr({r:G+ye,c:W+X})]=Ha(w);B.e.c<=W&&(B.e.c=W)}X=parseInt(E["number-columns-repeated"]||"1",10),W+=X-1,X=0,w={},C="",T=[]}ae={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(_[1]==="/"){if((s=n.pop())[0]!==_[3])throw"Bad state: "+s}else _[0].charAt(_[0].length-2)!=="/"&&n.push([_[3],!0]);break;case"annotation":if(_[1]==="/"){if((s=n.pop())[0]!==_[3])throw"Bad state: "+s;j.t=C,T.length&&(j.R=T),j.a=F,U.push(j)}else _[0].charAt(_[0].length-2)!=="/"&&n.push([_[3],!1]);F="",I=0,C="",A=0,T=[];break;case"creator":_[1]==="/"?F=a.slice(I,_.index):I=_.index+_[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(_[1]==="/"){if((s=n.pop())[0]!==_[3])throw"Bad state: "+s}else _[0].charAt(_[0].length-2)!=="/"&&n.push([_[3],!1]);C="",A=0,T=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(_[1]==="/"){if(L[c.name]=f,(s=n.pop())[0]!==_[3])throw"Bad state: "+s}else _[0].charAt(_[0].length-2)!=="/"&&(f="",c=Sr(_[0],!1),n.push([_[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":l=Sr(_[0],!1),f+=m5[_[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":l=Sr(_[0],!1),f+=m5[_[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(_[0].slice(-2)==="/>")break;if(_[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":f+=a.slice(d,_.index);break}else d=_.index+_[0].length;break;case"named-range":l=Sr(_[0],!1),fe=gv(l["cell-range-address"]);var _e={Name:l.name,Ref:fe[0]+"!"+fe[1]};ne&&(_e.Sheet=g.length),K.Names.push(_e);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(_[1]==="/"&&(!E||!E["string-value"])){var Le=_B(a.slice(A,_.index));C=(C.length>0?C+`
`:"")+Le[0]}else Sr(_[0],!1),A=_.index+_[0].length;break;case"s":break;case"database-range":if(_[1]==="/")break;try{fe=gv(Sr(_[0])["target-range-address"]),x[fe[0]]["!autofilter"]={ref:fe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(_[1]!=="/"){if(ae=Sr(_[0],!1),!ae.href)break;ae.Target=ea(ae.href),delete ae.href,ae.Target.charAt(0)=="#"&&ae.Target.indexOf(".")>-1?(fe=gv(ae.Target.slice(1)),ae.Target="#"+fe[0]+"!"+fe[1]):ae.Target.match(/^\.\.[\\\/]/)&&(ae.Target=ae.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(_[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(_)}}var ue={Sheets:x,SheetNames:g,Workbook:K};return r.bookSheets&&delete ue.Sheets,ue}function p5(t,e){e=e||{},lo(t,"META-INF/manifest.xml")&&GO(Pn(t,"META-INF/manifest.xml"),e);var r=Ii(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=uj(ka(r),e);return lo(t,"meta.xml")&&(a.Props=e3(Pn(t,"meta.xml"))),a}function g5(t,e){return uj(t,e)}var bB=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+I0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Cn+e}})(),v5=(function(){var t=function(s){return xa(s).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(s,l,c){var f=[];f.push('      <table:table table:name="'+xa(l.SheetNames[c])+`" table:style-name="ta1">
`);var d=0,m=0,v=mi(s["!ref"]||"A1"),x=s["!merges"]||[],g=0,b=Array.isArray(s);if(s["!cols"])for(m=0;m<=v.e.c;++m)f.push("        <table:table-column"+(s["!cols"][m]?' table:style-name="co'+s["!cols"][m].ods+'"':"")+`></table:table-column>
`);var _="",w=s["!rows"]||[];for(d=0;d<v.s.r;++d)_=w[d]?' table:style-name="ro'+w[d].ods+'"':"",f.push("        <table:table-row"+_+`></table:table-row>
`);for(;d<=v.e.r;++d){for(_=w[d]?' table:style-name="ro'+w[d].ods+'"':"",f.push("        <table:table-row"+_+`>
`),m=0;m<v.s.c;++m)f.push(e);for(;m<=v.e.c;++m){var E=!1,C={},A="";for(g=0;g!=x.length;++g)if(!(x[g].s.c>m)&&!(x[g].s.r>d)&&!(x[g].e.c<m)&&!(x[g].e.r<d)){(x[g].s.c!=m||x[g].s.r!=d)&&(E=!0),C["table:number-columns-spanned"]=x[g].e.c-x[g].s.c+1,C["table:number-rows-spanned"]=x[g].e.r-x[g].s.r+1;break}if(E){f.push(r);continue}var T=wr({r:d,c:m}),G=b?(s[d]||[])[m]:s[T];if(G&&G.f&&(C["table:formula"]=xa(qP(G.f)),G.F&&G.F.slice(0,T.length)==T)){var W=mi(G.F);C["table:number-matrix-columns-spanned"]=W.e.c-W.s.c+1,C["table:number-matrix-rows-spanned"]=W.e.r-W.s.r+1}if(!G){f.push(e);continue}switch(G.t){case"b":A=G.v?"TRUE":"FALSE",C["office:value-type"]="boolean",C["office:boolean-value"]=G.v?"true":"false";break;case"n":A=G.w||String(G.v||0),C["office:value-type"]="float",C["office:value"]=G.v||0;break;case"s":case"str":A=G.v==null?"":G.v,C["office:value-type"]="string";break;case"d":A=G.w||za(G.v).toISOString(),C["office:value-type"]="date",C["office:date-value"]=za(G.v).toISOString(),C["table:style-name"]="ce1";break;default:f.push(e);continue}var B=t(A);if(G.l&&G.l.Target){var q=G.l.Target;q=q.charAt(0)=="#"?"#"+zP(q.slice(1)):q,q.charAt(0)!="#"&&!q.match(/^\w+:/)&&(q="../"+q),B=Mt("text:a",B,{"xlink:href":q.replace(/&/g,"&amp;")})}f.push("          "+Mt("table:table-cell",Mt("text:p",B,{}),C)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},n=function(s,l){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var c=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var m=0;m<d["!cols"].length;++m)if(d["!cols"][m]){var v=d["!cols"][m];if(v.width==null&&v.wpx==null&&v.wch==null)continue;xu(v),v.ods=c;var x=d["!cols"][m].wpx+"px";s.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),s.push(`  </style:style>
`),++c}}});var f=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var m=0;m<d["!rows"].length;++m)if(d["!rows"][m]){d["!rows"][m].ods=f;var v=d["!rows"][m].hpx+"px";s.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+`"/>
`),s.push(`  </style:style>
`),++f}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(l,c){var f=[Cn],d=I0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=I0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(f.push("<office:document"+d+m+`>
`),f.push(QN().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+d+`>
`),n(f,l),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var v=0;v!=l.SheetNames.length;++v)f.push(a(l.Sheets[l.SheetNames[v]],l,v));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),c.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}})();function fj(t,e){if(e.bookType=="fods")return v5(t,e);var r=p2(),a="",n=[],s=[];return a="mimetype",Dr(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",Dr(r,a,v5(t,e)),n.push([a,"text/xml"]),s.push([a,"ContentFile"]),a="styles.xml",Dr(r,a,bB(t,e)),n.push([a,"text/xml"]),s.push([a,"StylesFile"]),a="meta.xml",Dr(r,a,Cn+QN()),n.push([a,"text/xml"]),s.push([a,"MetadataFile"]),a="manifest.rdf",Dr(r,a,KO(s)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",Dr(r,a,YO(n)),r}function Ef(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Ox(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):ka(Su(t))}function wB(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Mi(jl(t))}function SB(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var a=0;a<e.length;++a)if(t[r+a]!=e[a])continue e;return!0}return!1}function _u(t){var e=t.reduce(function(n,s){return n+s.length},0),r=new Uint8Array(e),a=0;return t.forEach(function(n){r.set(n,a),a+=n.length}),r}function x5(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function NB(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,a=t[e+14]&1,n=e+13;n>=e;--n)a=a*256+t[n];return(t[e+15]&128?-a:a)*Math.pow(10,r-6176)}function jB(t,e,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);t[e+15]|=a>>7,t[e+14]|=(a&127)<<1;for(var s=0;n>=1;++s,n/=256)t[e+s]=n&255;t[e+15]|=r>=0?0:128}function V0(t,e){var r=e?e[0]:0,a=t[r]&127;e:if(t[r++]>=128&&(a|=(t[r]&127)<<7,t[r++]<128||(a|=(t[r]&127)<<14,t[r++]<128)||(a|=(t[r]&127)<<21,t[r++]<128)||(a+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(a+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(a+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),a}function pa(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function pn(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function na(t){for(var e=[],r=[0];r[0]<t.length;){var a=r[0],n=V0(t,r),s=n&7;n=Math.floor(n/8);var l=0,c;if(n==0)break;switch(s){case 0:{for(var f=r[0];t[r[0]++]>=128;);c=t.slice(f,r[0])}break;case 5:l=4,c=t.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,c=t.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=V0(t,r),c=t.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(n," at offset ").concat(a))}var d={data:c,type:s};e[n]==null?e[n]=[d]:e[n].push(d)}return e}function xs(t){var e=[];return t.forEach(function(r,a){r.forEach(function(n){n.data&&(e.push(pa(a*8+n.type)),n.type==2&&e.push(pa(n.data.length)),e.push(n.data))})}),_u(e)}function z2(t,e){return t?.map(function(r){return e(r.data)})||[]}function io(t){for(var e,r=[],a=[0];a[0]<t.length;){var n=V0(t,a),s=na(t.slice(a[0],a[0]+n));a[0]+=n;var l={id:pn(s[1][0].data),messages:[]};s[2].forEach(function(c){var f=na(c.data),d=pn(f[3][0].data);l.messages.push({meta:f,data:t.slice(a[0],a[0]+d)}),a[0]+=d}),(e=s[3])!=null&&e[0]&&(l.merge=pn(s[3][0].data)>>>0>0),r.push(l)}return r}function Id(t){var e=[];return t.forEach(function(r){var a=[];a[1]=[{data:pa(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:pa(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(l){n.push(l.data),l.meta[3]=[{type:0,data:pa(l.data.length)}],a[2].push({data:xs(l.meta),type:2})});var s=xs(a);e.push(pa(s.length)),e.push(s),n.forEach(function(l){return e.push(l)})}),_u(e)}function kB(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],a=V0(e,r),n=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var l=e[r[0]++]>>2;if(l<60)++l;else{var c=l-59;l=e[r[0]],c>1&&(l|=e[r[0]+1]<<8),c>2&&(l|=e[r[0]+2]<<16),c>3&&(l|=e[r[0]+3]<<24),l>>>=0,l++,r[0]+=c}n.push(e.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var f=0,d=0;if(s==1?(d=(e[r[0]]>>2&7)+4,f=(e[r[0]++]&224)<<3,f|=e[r[0]++]):(d=(e[r[0]++]>>2)+1,s==2?(f=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(f=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),n=[_u(n)],f==0)throw new Error("Invalid offset 0");if(f>n[0].length)throw new Error("Invalid offset beyond length");if(d>=f)for(n.push(n[0].slice(-f)),d-=f;d>=n[n.length-1].length;)n.push(n[n.length-1]),d-=n[n.length-1].length;n.push(n[0].slice(-f,-f+d))}}var m=_u(n);if(m.length!=a)throw new Error("Unexpected length: ".concat(m.length," != ").concat(a));return m}function oo(t){for(var e=[],r=0;r<t.length;){var a=t[r++],n=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(kB(a,t.slice(r,r+n))),r+=n}if(r!==t.length)throw new Error("data is not a valid framed stream!");return _u(e)}function Bd(t){for(var e=[],r=0;r<t.length;){var a=Math.min(t.length-r,268435455),n=new Uint8Array(4);e.push(n);var s=pa(a),l=s.length;e.push(s),a<=60?(l++,e.push(new Uint8Array([a-1<<2]))):a<=256?(l+=2,e.push(new Uint8Array([240,a-1&255]))):a<=65536?(l+=3,e.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(l+=4,e.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(l+=5,e.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),e.push(t.slice(r,r+a)),l+=a,n[0]=0,n[1]=l&255,n[2]=l>>8&255,n[3]=l>>16&255,r+=a}return _u(e)}function EB(t,e,r,a){var n=Ef(t),s=n.getUint32(4,!0),l=(a>1?12:8)+x5(s&(a>1?3470:398))*4,c=-1,f=-1,d=NaN,m=new Date(2001,0,1);s&512&&(c=n.getUint32(l,!0),l+=4),l+=x5(s&(a>1?12288:4096))*4,s&16&&(f=n.getUint32(l,!0),l+=4),s&32&&(d=n.getFloat64(l,!0),l+=8),s&64&&(m.setTime(m.getTime()+n.getFloat64(l,!0)*1e3),l+=8);var v;switch(t[2]){case 0:break;case 2:v={t:"n",v:d};break;case 3:v={t:"s",v:e[f]};break;case 5:v={t:"d",v:m};break;case 6:v={t:"b",v:d>0};break;case 7:v={t:"n",v:d/86400};break;case 8:v={t:"e",v:0};break;case 9:if(c>-1)v={t:"s",v:r[c]};else if(f>-1)v={t:"s",v:e[f]};else if(!isNaN(d))v={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return v}function AB(t,e,r){var a=Ef(t),n=a.getUint32(8,!0),s=12,l=-1,c=-1,f=NaN,d=NaN,m=new Date(2001,0,1);n&1&&(f=NB(t,s),s+=16),n&2&&(d=a.getFloat64(s,!0),s+=8),n&4&&(m.setTime(m.getTime()+a.getFloat64(s,!0)*1e3),s+=8),n&8&&(c=a.getUint32(s,!0),s+=4),n&16&&(l=a.getUint32(s,!0),s+=4);var v;switch(t[1]){case 0:break;case 2:v={t:"n",v:f};break;case 3:v={t:"s",v:e[c]};break;case 5:v={t:"d",v:m};break;case 6:v={t:"b",v:d>0};break;case 7:v={t:"n",v:d/86400};break;case 8:v={t:"e",v:0};break;case 9:if(l>-1)v={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(n&31," : ").concat(t.slice(0,4)));break;case 10:v={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(n&31," : ").concat(t.slice(0,4)))}return v}function xv(t,e){var r=new Uint8Array(32),a=Ef(r),n=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,jB(r,n,t.v),s|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,t.v?1:0,!0),s|=2,n+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,a.setUint32(n,e.indexOf(t.v),!0),s|=8,n+=4;break;default:throw"unsupported cell type "+t.t}return a.setUint32(8,s,!0),r.slice(0,n)}function yv(t,e){var r=new Uint8Array(32),a=Ef(r),n=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,a.setFloat64(n,t.v,!0),s|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,t.v?1:0,!0),s|=32,n+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,a.setUint32(n,e.indexOf(t.v),!0),s|=16,n+=4;break;default:throw"unsupported cell type "+t.t}return a.setUint32(4,s,!0),r.slice(0,n)}function CB(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return EB(t,e,r,t[0]);case 5:return AB(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Os(t){var e=na(t);return V0(e[1][0].data)}function y5(t,e){var r=na(e.data),a=pn(r[1][0].data),n=r[3],s=[];return(n||[]).forEach(function(l){var c=na(l.data),f=pn(c[1][0].data)>>>0;switch(a){case 1:s[f]=Ox(c[3][0].data);break;case 8:{var d=t[Os(c[9][0].data)][0],m=na(d.data),v=t[Os(m[1][0].data)][0],x=pn(v.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var g=na(v.data);s[f]=g[3].map(function(b){return Ox(b.data)}).join("")}break}}),s}function TB(t,e){var r,a,n,s,l,c,f,d,m,v,x,g,b,_,w=na(t),E=pn(w[1][0].data)>>>0,C=pn(w[2][0].data)>>>0,A=((a=(r=w[8])==null?void 0:r[0])==null?void 0:a.data)&&pn(w[8][0].data)>0||!1,T,G;if((s=(n=w[7])==null?void 0:n[0])!=null&&s.data&&e!=0)T=(c=(l=w[7])==null?void 0:l[0])==null?void 0:c.data,G=(d=(f=w[6])==null?void 0:f[0])==null?void 0:d.data;else if((v=(m=w[4])==null?void 0:m[0])!=null&&v.data&&e!=1)T=(g=(x=w[4])==null?void 0:x[0])==null?void 0:g.data,G=(_=(b=w[3])==null?void 0:b[0])==null?void 0:_.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var W=A?4:1,B=Ef(T),q=[],L=0;L<T.length/2;++L){var J=B.getUint16(L*2,!0);J<65535&&q.push([L,J])}if(q.length!=C)throw"Expected ".concat(C," cells, found ").concat(q.length);var D=[];for(L=0;L<q.length-1;++L)D[q[L][0]]=G.subarray(q[L][1]*W,q[L+1][1]*W);return q.length>=1&&(D[q[q.length-1][0]]=G.subarray(q[q.length-1][1]*W)),{R:E,cells:D}}function OB(t,e){var r,a=na(e.data),n=(r=a?.[7])!=null&&r[0]?pn(a[7][0].data)>>>0>0?1:0:-1,s=z2(a[5],function(l){return TB(l,n)});return{nrows:pn(a[4][0].data)>>>0,data:s.reduce(function(l,c){return l[c.R]||(l[c.R]=[]),c.cells.forEach(function(f,d){if(l[c.R][d])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(d));l[c.R][d]=f}),l},[])}}function RB(t,e,r){var a,n=na(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(pn(n[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(s.e.c=(pn(n[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=Or(s);var l=na(n[4][0].data),c=y5(t,t[Os(l[4][0].data)][0]),f=(a=l[17])!=null&&a[0]?y5(t,t[Os(l[17][0].data)][0]):[],d=na(l[3][0].data),m=0;d[1].forEach(function(v){var x=na(v.data),g=t[Os(x[2][0].data)][0],b=pn(g.meta[1][0].data);if(b!=6002)throw new Error("6001 unexpected reference to ".concat(b));var _=OB(t,g);_.data.forEach(function(w,E){w.forEach(function(C,A){var T=wr({r:m+E,c:A}),G=CB(C,c,f);G&&(r[T]=G)})}),m+=_.nrows})}function DB(t,e){var r=na(e.data),a={"!ref":"A1"},n=t[Os(r[2][0].data)],s=pn(n[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return RB(t,n[0],a),a}function FB(t,e){var r,a=na(e.data),n={name:(r=a[1])!=null&&r[0]?Ox(a[1][0].data):"",sheets:[]},s=z2(a[2],Os);return s.forEach(function(l){t[l].forEach(function(c){var f=pn(c.meta[1][0].data);f==6e3&&n.sheets.push(DB(t,c))})}),n}function LB(t,e){var r=G2(),a=na(e.data),n=z2(a[1],Os);if(n.forEach(function(s){t[s].forEach(function(l){var c=pn(l.meta[1][0].data);if(c==2){var f=FB(t,l);f.sheets.forEach(function(d,m){Y2(r,d,m==0?f.name:f.name+"_"+m,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function _v(t){var e,r,a,n,s={},l=[];if(t.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var d;try{d=oo(f.content)}catch(v){return console.log("?? "+f.content.length+" "+(v.message||v))}var m;try{m=io(d)}catch(v){return console.log("## "+(v.message||v))}m.forEach(function(v){s[v.id]=v.messages,l.push(v.id)})}}),!l.length)throw new Error("File has no messages");var c=((n=(a=(r=(e=s?.[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&pn(s[1][0].meta[1][0].data)==1&&s[1][0];if(c||l.forEach(function(f){s[f].forEach(function(d){var m=pn(d.meta[1][0].data)>>>0;if(m==1)if(!c)c=d;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return LB(s,c)}function PB(t,e,r){var a,n,s,l;if(!((a=t[6])!=null&&a[0])||!((n=t[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var c=((l=(s=t[8])==null?void 0:s[0])==null?void 0:l.data)&&pn(t[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var f=0,d=Ef(t[7][0].data),m=0,v=[],x=Ef(t[4][0].data),g=0,b=[],_=0;_<e.length;++_){if(e[_]==null){d.setUint16(_*2,65535,!0),x.setUint16(_*2,65535);continue}d.setUint16(_*2,m,!0),x.setUint16(_*2,g,!0);var w,E;switch(typeof e[_]){case"string":w=xv({t:"s",v:e[_]},r),E=yv({t:"s",v:e[_]},r);break;case"number":w=xv({t:"n",v:e[_]},r),E=yv({t:"n",v:e[_]},r);break;case"boolean":w=xv({t:"b",v:e[_]},r),E=yv({t:"b",v:e[_]},r);break;default:throw new Error("Unsupported value "+e[_])}v.push(w),m+=w.length,b.push(E),g+=E.length,++f}for(t[2][0].data=pa(f);_<t[7][0].data.length/2;++_)d.setUint16(_*2,65535,!0),x.setUint16(_*2,65535,!0);return t[6][0].data=_u(v),t[3][0].data=_u(b),f}function MB(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=mi(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Or(a)));var s=l1(r,{range:a,header:1}),l=["~Sh33tJ5~"];s.forEach(function(F){return F.forEach(function(I){typeof I=="string"&&l.push(I)})});var c={},f=[],d=hr.read(e.numbers,{type:"base64"});d.FileIndex.map(function(F,I){return[F,d.FullPaths[I]]}).forEach(function(F){var I=F[0],z=F[1];if(I.type==2&&I.name.match(/\.iwa/)){var ne=I.content,se=oo(ne),pe=io(se);pe.forEach(function(ye){f.push(ye.id),c[ye.id]={deps:[],location:z,type:pn(ye.messages[0].meta[1][0].data)}})}}),f.sort(function(F,I){return F-I});var m=f.filter(function(F){return F>1}).map(function(F){return[F,pa(F)]});d.FileIndex.map(function(F,I){return[F,d.FullPaths[I]]}).forEach(function(F){var I=F[0];if(F[1],!!I.name.match(/\.iwa/)){var z=io(oo(I.content));z.forEach(function(ne){ne.messages.forEach(function(se){m.forEach(function(pe){ne.messages.some(function(ye){return pn(ye.meta[1][0].data)!=11006&&SB(ye.data,pe[1])})&&c[pe[0]].deps.push(ne.id)})})})}});for(var v=hr.find(d,c[1].location),x=io(oo(v.content)),g,b=0;b<x.length;++b){var _=x[b];_.id==1&&(g=_)}var w=Os(na(g.messages[0].data)[1][0].data);for(v=hr.find(d,c[w].location),x=io(oo(v.content)),b=0;b<x.length;++b)_=x[b],_.id==w&&(g=_);for(w=Os(na(g.messages[0].data)[2][0].data),v=hr.find(d,c[w].location),x=io(oo(v.content)),b=0;b<x.length;++b)_=x[b],_.id==w&&(g=_);for(w=Os(na(g.messages[0].data)[2][0].data),v=hr.find(d,c[w].location),x=io(oo(v.content)),b=0;b<x.length;++b)_=x[b],_.id==w&&(g=_);var E=na(g.messages[0].data);{E[6][0].data=pa(a.e.r+1),E[7][0].data=pa(a.e.c+1);var C=Os(E[46][0].data),A=hr.find(d,c[C].location),T=io(oo(A.content));{for(var G=0;G<T.length&&T[G].id!=C;++G);if(T[G].id!=C)throw"Bad ColumnRowUIDMapArchive";var W=na(T[G].messages[0].data);W[1]=[],W[2]=[],W[3]=[];for(var B=0;B<=a.e.c;++B){var q=[];q[1]=q[2]=[{type:0,data:pa(B+420690)}],W[1].push({type:2,data:xs(q)}),W[2].push({type:0,data:pa(B)}),W[3].push({type:0,data:pa(B)})}W[4]=[],W[5]=[],W[6]=[];for(var L=0;L<=a.e.r;++L)q=[],q[1]=q[2]=[{type:0,data:pa(L+726270)}],W[4].push({type:2,data:xs(q)}),W[5].push({type:0,data:pa(L)}),W[6].push({type:0,data:pa(L)});T[G].messages[0].data=xs(W)}A.content=Bd(Id(T)),A.size=A.content.length,delete E[46];var J=na(E[4][0].data);{J[7][0].data=pa(a.e.r+1);var D=na(J[1][0].data),O=Os(D[2][0].data);A=hr.find(d,c[O].location),T=io(oo(A.content));{if(T[0].id!=O)throw"Bad HeaderStorageBucket";var M=na(T[0].messages[0].data);for(L=0;L<s.length;++L){var V=na(M[2][0].data);V[1][0].data=pa(L),V[4][0].data=pa(s[L].length),M[2][L]={type:M[2][0].type,data:xs(V)}}T[0].messages[0].data=xs(M)}A.content=Bd(Id(T)),A.size=A.content.length;var ie=Os(J[2][0].data);A=hr.find(d,c[ie].location),T=io(oo(A.content));{if(T[0].id!=ie)throw"Bad HeaderStorageBucket";for(M=na(T[0].messages[0].data),B=0;B<=a.e.c;++B)V=na(M[2][0].data),V[1][0].data=pa(B),V[4][0].data=pa(a.e.r+1),M[2][B]={type:M[2][0].type,data:xs(V)};T[0].messages[0].data=xs(M)}A.content=Bd(Id(T)),A.size=A.content.length;var X=Os(J[4][0].data);(function(){for(var F=hr.find(d,c[X].location),I=io(oo(F.content)),z,ne=0;ne<I.length;++ne){var se=I[ne];se.id==X&&(z=se)}var pe=na(z.messages[0].data);{pe[3]=[];var ye=[];l.forEach(function(ue,at){ye[1]=[{type:0,data:pa(at)}],ye[2]=[{type:0,data:pa(1)}],ye[3]=[{type:2,data:wB(ue)}],pe[3].push({type:2,data:xs(ye)})})}z.messages[0].data=xs(pe);var _e=Id(I),Le=Bd(_e);F.content=Le,F.size=F.content.length})();var Z=na(J[3][0].data);{var K=Z[1][0];delete Z[2];var ae=na(K.data);{var fe=Os(ae[2][0].data);(function(){for(var F=hr.find(d,c[fe].location),I=io(oo(F.content)),z,ne=0;ne<I.length;++ne){var se=I[ne];se.id==fe&&(z=se)}var pe=na(z.messages[0].data);{delete pe[6],delete Z[7];var ye=new Uint8Array(pe[5][0].data);pe[5]=[];for(var _e=0,Le=0;Le<=a.e.r;++Le){var ue=na(ye);_e+=PB(ue,s[Le],l),ue[1][0].data=pa(Le),pe[5].push({data:xs(ue),type:2})}pe[1]=[{type:0,data:pa(a.e.c+1)}],pe[2]=[{type:0,data:pa(a.e.r+1)}],pe[3]=[{type:0,data:pa(_e)}],pe[4]=[{type:0,data:pa(a.e.r+1)}]}z.messages[0].data=xs(pe);var at=Id(I),ht=Bd(at);F.content=ht,F.size=F.content.length})()}K.data=xs(ae)}J[3][0].data=xs(Z)}E[4][0].data=xs(J)}g.messages[0].data=xs(E);var U=Id(x),j=Bd(U);return v.content=j,v.size=v.content.length,d}function dj(t){return function(r){for(var a=0;a!=t.length;++a){var n=t[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function H2(t){dj([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function $2(t){dj([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function IB(t){return Ir.WS.indexOf(t)>-1?"sheet":t==Ir.CS?"chart":t==Ir.DS?"dialog":t==Ir.MS?"macro":t&&t.length?t:"sheet"}function BB(t,e){if(!t)return 0;try{t=e.map(function(a){return a.id||(a.id=a.strRelID),[a.name,t["!id"][a.id].Target,IB(t["!id"][a.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function UB(t,e,r,a,n,s,l,c,f,d,m,v){try{s[a]=y0(Ii(t,r,!0),e);var x=Pn(t,e),g;switch(c){case"sheet":g=lI(x,e,n,f,s[a],d,m,v);break;case"chart":if(g=cI(x,e,n,f,s[a],d,m,v),!g||!g["!drawel"])break;var b=d0(g["!drawel"].Target,e),_=U0(b),w=XF(Ii(t,b,!0),y0(Ii(t,_,!0),b)),E=d0(w,b),C=U0(E);g=PM(Ii(t,E,!0),E,f,y0(Ii(t,C,!0),E),d,g);break;case"macro":g=uI(x,e,n,f,s[a],d,m,v);break;case"dialog":g=fI(x,e,n,f,s[a],d,m,v);break;default:throw new Error("Unrecognized sheet type "+c)}l[a]=g;var A=[];s&&s[a]&&gn(s[a]).forEach(function(T){var G="";if(s[a][T].Type==Ir.CMNT){G=d0(s[a][T].Target,e);var W=pI(Pn(t,G,!0),G,f);if(!W||!W.length)return;n5(g,W,!1)}s[a][T].Type==Ir.TCMNT&&(G=d0(s[a][T].Target,e),A=A.concat(JF(Pn(t,G,!0),f)))}),A&&A.length&&n5(g,A,!0,f.people||[])}catch(T){if(f.WTF)throw T}}function no(t){return t.charAt(0)=="/"?t.slice(1):t}function qB(t,e){if(vh(),e=e||{},H2(e),lo(t,"META-INF/manifest.xml")||lo(t,"objectdata.xml"))return p5(t,e);if(lo(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof _v<"u"){if(t.FileIndex)return _v(t);var r=hr.utils.cfb_new();return jw(t).forEach(function(V){Dr(r,V,Z8(t,V))}),_v(r)}throw new Error("Unsupported NUMBERS file")}if(!lo(t,"[Content_Types].xml"))throw lo(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):lo(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=jw(t),n=WO(Ii(t,"[Content_Types].xml")),s=!1,l,c;if(n.workbooks.length===0&&(c="xl/workbook.xml",Pn(t,c,!0)&&n.workbooks.push(c)),n.workbooks.length===0){if(c="xl/workbook.bin",!Pn(t,c,!0))throw new Error("Could not find workbook");n.workbooks.push(c),s=!0}n.workbooks[0].slice(-3)=="bin"&&(s=!0);var f={},d={};if(!e.bookSheets&&!e.bookProps){if(_0=[],n.sst)try{_0=mI(Pn(t,no(n.sst)),n.sst,e)}catch(V){if(e.WTF)throw V}e.cellStyles&&n.themes.length&&(f=hI(Ii(t,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],e)),n.style&&(d=dI(Pn(t,no(n.style)),n.style,f,e))}n.links.map(function(V){try{var ie=y0(Ii(t,U0(no(V))),V);return vI(Pn(t,no(V)),ie,V,e)}catch{}});var m=oI(Pn(t,no(n.workbooks[0])),n.workbooks[0],e),v={},x="";n.coreprops.length&&(x=Pn(t,no(n.coreprops[0]),!0),x&&(v=e3(x)),n.extprops.length!==0&&(x=Pn(t,no(n.extprops[0]),!0),x&&ZO(x,v,e)));var g={};(!e.bookSheets||e.bookProps)&&n.custprops.length!==0&&(x=Ii(t,no(n.custprops[0]),!0),x&&(g=e7(x,e)));var b={};if((e.bookSheets||e.bookProps)&&(m.Sheets?l=m.Sheets.map(function(ie){return ie.name}):v.Worksheets&&v.SheetNames.length>0&&(l=v.SheetNames),e.bookProps&&(b.Props=v,b.Custprops=g),e.bookSheets&&typeof l<"u"&&(b.SheetNames=l),e.bookSheets?b.SheetNames:e.bookProps))return b;l={};var _={};e.bookDeps&&n.calcchain&&(_=gI(Pn(t,no(n.calcchain)),n.calcchain));var w=0,E={},C,A;{var T=m.Sheets;v.Worksheets=T.length,v.SheetNames=[];for(var G=0;G!=T.length;++G)v.SheetNames[G]=T[G].name}var W=s?"bin":"xml",B=n.workbooks[0].lastIndexOf("/"),q=(n.workbooks[0].slice(0,B+1)+"_rels/"+n.workbooks[0].slice(B+1)+".rels").replace(/^\//,"");lo(t,q)||(q="xl/_rels/workbook."+W+".rels");var L=y0(Ii(t,q,!0),q.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(e.xlmeta=xI(Pn(t,no(n.metadata[0])),n.metadata[0],e)),(n.people||[]).length>=1&&(e.people=QF(Pn(t,no(n.people[0])),e)),L&&(L=BB(L,m.Sheets));var J=Pn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=v.Worksheets;++w){var D="sheet";if(L&&L[w]?(C="xl/"+L[w][1].replace(/[\/]?xl\//,""),lo(t,C)||(C=L[w][1]),lo(t,C)||(C=q.replace(/_rels\/.*$/,"")+L[w][1]),D=L[w][2]):(C="xl/worksheets/sheet"+(w+1-J)+"."+W,C=C.replace(/sheet0\./,"sheet.")),A=C.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(w!=e.sheets)continue e;break;case"string":if(v.SheetNames[w].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var O=!1,M=0;M!=e.sheets.length;++M)typeof e.sheets[M]=="number"&&e.sheets[M]==w&&(O=1),typeof e.sheets[M]=="string"&&e.sheets[M].toLowerCase()==v.SheetNames[w].toLowerCase()&&(O=1);if(!O)continue e}}UB(t,C,A,v.SheetNames[w],w,E,l,D,e,m,f,d)}return b={Directory:n,Workbook:m,Props:v,Custprops:g,Deps:_,Sheets:l,SheetNames:v.SheetNames,Strings:_0,Styles:d,Themes:f,SSF:Ha(br)},e&&e.bookFiles&&(t.files?(b.keys=a,b.files=t.files):(b.keys=[],b.files={},t.FullPaths.forEach(function(V,ie){V=V.replace(/^Root Entry[\/]/,""),b.keys.push(V),b.files[V]=t.FileIndex[ie]}))),e&&e.bookVBA&&(n.vba.length>0?b.vbaraw=Pn(t,no(n.vba[0]),!0):n.defaults&&n.defaults.bin===oL&&(b.vbaraw=Pn(t,"xl/vbaProject.bin",!0))),b}function zB(t,e){var r=e||{},a="Workbook",n=hr.find(t,a);try{if(a="/!DataSpaces/Version",n=hr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(xD(n.content),a="/!DataSpaces/DataSpaceMap",n=hr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var s=_D(n.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=hr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=bD(n.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=hr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);SD(n.content)}catch{}if(a="/EncryptionInfo",n=hr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=ND(n.content);if(a="/EncryptedPackage",n=hr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],n.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function HB(t,e){return e.bookType=="ods"?fj(t,e):e.bookType=="numbers"?MB(t,e):e.bookType=="xlsb"?$B(t,e):WB(t,e)}function $B(t,e){Yd=1024,t&&!t.SSF&&(t.SSF=Ha(br)),t&&t.SSF&&(vh(),b1(t.SSF),e.revssf=S1(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,b0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",a=B3.indexOf(e.bookType)>-1,n=C2();$2(e=e||{});var s=p2(),l="",c=0;if(e.cellXfs=[],ju(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",Dr(s,l,t3(t.Props,e)),n.coreprops.push(l),ga(e.rels,2,l,Ir.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(t.SheetNames[d]);t.Props.SheetNames=f}for(t.Props.Worksheets=t.Props.SheetNames.length,Dr(s,l,n3(t.Props)),n.extprops.push(l),ga(e.rels,3,l,Ir.EXT_PROPS),t.Custprops!==t.Props&&gn(t.Custprops||{}).length>0&&(l="docProps/custom.xml",Dr(s,l,s3(t.Custprops)),n.custprops.push(l),ga(e.rels,4,l,Ir.CUST_PROPS)),c=1;c<=t.SheetNames.length;++c){var m={"!id":{}},v=t.Sheets[t.SheetNames[c-1]],x=(v||{})["!type"]||"sheet";switch(x){case"chart":default:l="xl/worksheets/sheet"+c+"."+r,Dr(s,l,_I(c-1,l,e,t,m)),n.sheets.push(l),ga(e.wbrels,-1,"worksheets/sheet"+c+"."+r,Ir.WS[0])}if(v){var g=v["!comments"],b=!1,_="";g&&g.length>0&&(_="xl/comments"+c+"."+r,Dr(s,_,SI(g,_)),n.comments.push(_),ga(m,-1,"../comments"+c+"."+r,Ir.CMNT),b=!0),v["!legacy"]&&b&&Dr(s,"xl/drawings/vmlDrawing"+c+".vml",M3(c,v["!comments"])),delete v["!comments"],delete v["!legacy"]}m["!id"].rId1&&Dr(s,U0(l),Qd(m))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+r,Dr(s,l,wI(e.Strings,l,e)),n.strs.push(l),ga(e.wbrels,-1,"sharedStrings."+r,Ir.SST)),l="xl/workbook."+r,Dr(s,l,yI(t,l)),n.workbooks.push(l),ga(e.rels,1,l,Ir.WB),l="xl/theme/theme1.xml",Dr(s,l,L2(t.Themes,e)),n.themes.push(l),ga(e.wbrels,-1,"theme/theme1.xml",Ir.THEME),l="xl/styles."+r,Dr(s,l,bI(t,l,e)),n.styles.push(l),ga(e.wbrels,-1,"styles."+r,Ir.STY),t.vbaraw&&a&&(l="xl/vbaProject.bin",Dr(s,l,t.vbaraw),n.vba.push(l),ga(e.wbrels,-1,"vbaProject.bin",Ir.VBA)),l="xl/metadata."+r,Dr(s,l,NI(l)),n.metadata.push(l),ga(e.wbrels,-1,"metadata."+r,Ir.XLMETA),Dr(s,"[Content_Types].xml",ZN(n,e)),Dr(s,"_rels/.rels",Qd(e.rels)),Dr(s,"xl/_rels/workbook."+r+".rels",Qd(e.wbrels)),delete e.revssf,delete e.ssf,s}function WB(t,e){Yd=1024,t&&!t.SSF&&(t.SSF=Ha(br)),t&&t.SSF&&(vh(),b1(t.SSF),e.revssf=S1(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,b0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",a=B3.indexOf(e.bookType)>-1,n=C2();$2(e=e||{});var s=p2(),l="",c=0;if(e.cellXfs=[],ju(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",Dr(s,l,t3(t.Props,e)),n.coreprops.push(l),ga(e.rels,2,l,Ir.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(t.SheetNames[d]);t.Props.SheetNames=f}t.Props.Worksheets=t.Props.SheetNames.length,Dr(s,l,n3(t.Props)),n.extprops.push(l),ga(e.rels,3,l,Ir.EXT_PROPS),t.Custprops!==t.Props&&gn(t.Custprops||{}).length>0&&(l="docProps/custom.xml",Dr(s,l,s3(t.Custprops)),n.custprops.push(l),ga(e.rels,4,l,Ir.CUST_PROPS));var m=["SheetJ5"];for(e.tcid=0,c=1;c<=t.SheetNames.length;++c){var v={"!id":{}},x=t.Sheets[t.SheetNames[c-1]],g=(x||{})["!type"]||"sheet";switch(g){case"chart":default:l="xl/worksheets/sheet"+c+"."+r,Dr(s,l,K3(c-1,e,t,v)),n.sheets.push(l),ga(e.wbrels,-1,"worksheets/sheet"+c+"."+r,Ir.WS[0])}if(x){var b=x["!comments"],_=!1,w="";if(b&&b.length>0){var E=!1;b.forEach(function(C){C[1].forEach(function(A){A.T==!0&&(E=!0)})}),E&&(w="xl/threadedComments/threadedComment"+c+"."+r,Dr(s,w,ZF(b,m,e)),n.threadedcomments.push(w),ga(v,-1,"../threadedComments/threadedComment"+c+"."+r,Ir.TCMNT)),w="xl/comments"+c+"."+r,Dr(s,w,I3(b)),n.comments.push(w),ga(v,-1,"../comments"+c+"."+r,Ir.CMNT),_=!0}x["!legacy"]&&_&&Dr(s,"xl/drawings/vmlDrawing"+c+".vml",M3(c,x["!comments"])),delete x["!comments"],delete x["!legacy"]}v["!id"].rId1&&Dr(s,U0(l),Qd(v))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+r,Dr(s,l,j3(e.Strings,e)),n.strs.push(l),ga(e.wbrels,-1,"sharedStrings."+r,Ir.SST)),l="xl/workbook."+r,Dr(s,l,tj(t)),n.workbooks.push(l),ga(e.rels,1,l,Ir.WB),l="xl/theme/theme1.xml",Dr(s,l,L2(t.Themes,e)),n.themes.push(l),ga(e.wbrels,-1,"theme/theme1.xml",Ir.THEME),l="xl/styles."+r,Dr(s,l,D3(t,e)),n.styles.push(l),ga(e.wbrels,-1,"styles."+r,Ir.STY),t.vbaraw&&a&&(l="xl/vbaProject.bin",Dr(s,l,t.vbaraw),n.vba.push(l),ga(e.wbrels,-1,"vbaProject.bin",Ir.VBA)),l="xl/metadata."+r,Dr(s,l,P3()),n.metadata.push(l),ga(e.wbrels,-1,"metadata."+r,Ir.XLMETA),m.length>1&&(l="xl/persons/person.xml",Dr(s,l,eL(m)),n.people.push(l),ga(e.wbrels,-1,"persons/person.xml",Ir.PEOPLE)),Dr(s,"[Content_Types].xml",ZN(n,e)),Dr(s,"_rels/.rels",Qd(e.rels)),Dr(s,"xl/_rels/workbook."+r+".rels",Qd(e.wbrels)),delete e.revssf,delete e.ssf,s}function W2(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=qi(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function VB(t,e){return hr.find(t,"EncryptedPackage")?zB(t,e):sj(t,e)}function GB(t,e){var r,a=t,n=e||{};return n.type||(n.type=Pr&&Buffer.isBuffer(t)?"buffer":"base64"),r=EN(a,n),qB(r,n)}function hj(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Cx(t.slice(r),e);default:break e}return ch.to_workbook(t,e)}function YB(t,e){var r="",a=W2(t,e);switch(e.type){case"base64":r=qi(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Sf(t);break;default:throw new Error("Unrecognized type "+e.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=ka(r)),e.type="binary",hj(r,e)}function XB(t,e){var r=t;return e.type=="base64"&&(r=qi(r)),r=F0.utils.decode(1200,r.slice(2),"str"),e.type="binary",hj(r,e)}function KB(t){return t.match(/[^\x00-\x7F]/)?jl(t):t}function bv(t,e,r,a){return a?(r.type="string",ch.to_workbook(t,r)):ch.to_workbook(e,r)}function Rx(t,e){u2();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Rx(new Uint8Array(t),(r=Ha(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=t,n=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),th={},r.dateNF&&(th.dateNF=r.dateNF),r.type||(r.type=Pr&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Pr?"buffer":"binary",a=$8(t),typeof Uint8Array<"u"&&!Pr&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,a=KB(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),c=new Uint8Array(l);if(c.foo="bar",!c.foo)return r=Ha(r),r.type="array",Rx(f2(a),r)}switch((n=W2(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return VB(hr.read(a,r),r);break;case 9:if(n[1]<=8)return sj(a,r);break;case 60:return Cx(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return tD(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return S3.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?GB(a,r):bv(t,a,r,s);case 239:return n[3]===60?Cx(a,r):bv(t,a,r,s);case 255:if(n[1]===254)return XB(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return yf.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return yf.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return Ax.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return T3.to_workbook(a,r);break;case 10:case 13:case 32:return YB(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return eD.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Ax.to_workbook(a,r):bv(t,a,r,s)}function mj(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return em(e.file,hr.write(t,{type:Pr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return hr.write(t,e)}function JB(t,e){var r=Ha(e||{}),a=HB(t,r);return ZB(a,r)}function ZB(t,e){var r={},a=Pr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=a;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+e.type)}var n=t.FullPaths?hr.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(e.type=="binary"||e.type=="base64")return n;n=new Uint8Array(_1(n))}return e.password&&typeof encrypt_agile<"u"?mj(encrypt_agile(n,e.password),e):e.type==="file"?em(e.file,n):e.type=="string"?ka(n):n}function QB(t,e){var r=e||{},a=KI(t,r);return mj(a,r)}function wl(t,e,r){r||(r="");var a=r+t;switch(e.type){case"base64":return L0(jl(a));case"binary":return jl(a);case"string":return t;case"file":return em(e.file,a,"utf8");case"buffer":return Pr?_c(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):wl(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function eU(t,e){switch(e.type){case"base64":return L0(t);case"binary":return t;case"string":return t;case"file":return em(e.file,t,"binary");case"buffer":return Pr?_c(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Sp(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",a=0;a<t.length;++a)r+=String.fromCharCode(t[a]);return e.type=="base64"?L0(r):e.type=="string"?ka(r):r;case"file":return em(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function pj(t,e){u2(),VM(t);var r=Ha(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=pj(t,r);return r.type="array",_1(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=t.SheetNames.indexOf(r.sheet),!t.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return wl(HI(t,r),r);case"slk":case"sylk":return wl(w3.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"htm":case"html":return wl(oj(t.Sheets[t.SheetNames[n]],r),r);case"txt":return eU(gj(t.Sheets[t.SheetNames[n]],r),r);case"csv":return wl(V2(t.Sheets[t.SheetNames[n]],r),r,"\uFEFF");case"dif":return wl(S3.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"dbf":return Sp(Ax.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"prn":return wl(ch.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"rtf":return wl(T3.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"eth":return wl(N3.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"fods":return wl(fj(t,r),r);case"wk1":return Sp(yf.sheet_to_wk1(t.Sheets[t.SheetNames[n]],r),r);case"wk3":return Sp(yf.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Sp(ij(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),QB(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return JB(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function tU(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function rU(t,e,r){var a={};return a.type="file",a.file=e,tU(a),pj(t,a)}function aU(t,e,r,a,n,s,l,c){var f=An(r),d=c.defval,m=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),v=!0,x=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!l||t[r])for(var g=e.s.c;g<=e.e.c;++g){var b=l?t[r][g]:t[a[g]+f];if(b===void 0||b.t===void 0){if(d===void 0)continue;s[g]!=null&&(x[s[g]]=d);continue}var _=b.v;switch(b.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(s[g]!=null){if(_==null)if(b.t=="e"&&_===null)x[s[g]]=null;else if(d!==void 0)x[s[g]]=d;else if(m&&_===null)x[s[g]]=null;else continue;else x[s[g]]=m&&(b.t!=="n"||b.t==="n"&&c.rawNumbers!==!1)?_:pc(b,_,c);_!=null&&(v=!1)}}return{row:x,isempty:v}}function l1(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,s=[],l=0,c="",f={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},m=d.range!=null?d.range:t["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)?a=3:d.header==null&&(a=0),typeof m){case"string":f=ta(m);break;case"number":f=ta(t["!ref"]),f.s.r=m;break;default:f=m}a>0&&(n=0);var v=An(f.s.r),x=[],g=[],b=0,_=0,w=Array.isArray(t),E=f.s.r,C=0,A={};w&&!t[E]&&(t[E]=[]);var T=d.skipHidden&&t["!cols"]||[],G=d.skipHidden&&t["!rows"]||[];for(C=f.s.c;C<=f.e.c;++C)if(!(T[C]||{}).hidden)switch(x[C]=tn(C),r=w?t[E][C]:t[x[C]+v],a){case 1:s[C]=C-f.s.c;break;case 2:s[C]=x[C];break;case 3:s[C]=d.header[C-f.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=l=pc(r,null,d),_=A[l]||0,!_)A[l]=1;else{do c=l+"_"+_++;while(A[c]);A[l]=_,A[c]=1}s[C]=c}for(E=f.s.r+n;E<=f.e.r;++E)if(!(G[E]||{}).hidden){var W=aU(t,f,E,x,a,s,w,d);(W.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows))&&(g[b++]=W.row)}return g.length=b,g}var _5=/"/g;function nU(t,e,r,a,n,s,l,c){for(var f=!0,d=[],m="",v=An(r),x=e.s.c;x<=e.e.c;++x)if(a[x]){var g=c.dense?(t[r]||[])[x]:t[a[x]+v];if(g==null)m="";else if(g.v!=null){f=!1,m=""+(c.rawNumbers&&g.t=="n"?g.v:pc(g,null,c));for(var b=0,_=0;b!==m.length;++b)if((_=m.charCodeAt(b))===n||_===s||_===34||c.forceQuotes){m='"'+m.replace(_5,'""')+'"';break}m=="ID"&&(m='"ID"')}else g.f!=null&&!g.F?(f=!1,m="="+g.f,m.indexOf(",")>=0&&(m='"'+m.replace(_5,'""')+'"')):m="";d.push(m)}return c.blankrows===!1&&f?null:d.join(l)}function V2(t,e){var r=[],a=e??{};if(t==null||t["!ref"]==null)return"";var n=ta(t["!ref"]),s=a.FS!==void 0?a.FS:",",l=s.charCodeAt(0),c=a.RS!==void 0?a.RS:`
`,f=c.charCodeAt(0),d=new RegExp((s=="|"?"\\|":s)+"+$"),m="",v=[];a.dense=Array.isArray(t);for(var x=a.skipHidden&&t["!cols"]||[],g=a.skipHidden&&t["!rows"]||[],b=n.s.c;b<=n.e.c;++b)(x[b]||{}).hidden||(v[b]=tn(b));for(var _=0,w=n.s.r;w<=n.e.r;++w)(g[w]||{}).hidden||(m=nU(t,n,w,v,l,f,s,a),m!=null&&(a.strip&&(m=m.replace(d,"")),(m||a.blankrows!==!1)&&r.push((_++?c:"")+m)));return delete a.dense,r.join("")}function gj(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=V2(t,e);return r}function sU(t){var e="",r,a="";if(t==null||t["!ref"]==null)return[];var n=ta(t["!ref"]),s="",l=[],c,f=[],d=Array.isArray(t);for(c=n.s.c;c<=n.e.c;++c)l[c]=tn(c);for(var m=n.s.r;m<=n.e.r;++m)for(s=An(m),c=n.s.c;c<=n.e.c;++c)if(e=l[c]+s,r=d?(t[m]||[])[c]:t[e],a="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;a=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}f[f.length]=e+"="+a}return f}function vj(t,e,r){var a=r||{},n=+!a.skipHeader,s=t||{},l=0,c=0;if(s&&a.origin!=null)if(typeof a.origin=="number")l=a.origin;else{var f=typeof a.origin=="string"?rn(a.origin):a.origin;l=f.r,c=f.c}var d,m={s:{c:0,r:0},e:{c,r:l+e.length-1+n}};if(s["!ref"]){var v=ta(s["!ref"]);m.e.c=Math.max(m.e.c,v.e.c),m.e.r=Math.max(m.e.r,v.e.r),l==-1&&(l=v.e.r+1,m.e.r=l+e.length-1+n)}else l==-1&&(l=0,m.e.r=e.length-1+n);var x=a.header||[],g=0;e.forEach(function(_,w){gn(_).forEach(function(E){(g=x.indexOf(E))==-1&&(x[g=x.length]=E);var C=_[E],A="z",T="",G=wr({c:c+g,r:l+w+n});d=G0(s,G),C&&typeof C=="object"&&!(C instanceof Date)?s[G]=C:(typeof C=="number"?A="n":typeof C=="boolean"?A="b":typeof C=="string"?A="s":C instanceof Date?(A="d",a.cellDates||(A="n",C=Jn(C)),T=a.dateNF||br[14]):C===null&&a.nullError&&(A="e",C=0),d?(d.t=A,d.v=C,delete d.w,delete d.R,T&&(d.z=T)):s[G]=d={t:A,v:C},T&&(d.z=T))})}),m.e.c=Math.max(m.e.c,c+x.length-1);var b=An(l);if(n)for(g=0;g<x.length;++g)s[tn(g+c)+b]={t:"s",v:x[g]};return s["!ref"]=Or(m),s}function iU(t,e){return vj(null,t,e)}function G0(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var a=rn(e);return t[a.r]||(t[a.r]=[]),t[a.r][a.c]||(t[a.r][a.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?G0(t,wr(e)):G0(t,wr({r:e,c:r||0}))}function oU(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function G2(){return{SheetNames:[],Sheets:{}}}function Y2(t,e,r,a){var n=1;if(!r)for(;n<=65535&&t.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var l=s&&s[1]||r;for(++n;n<=65535&&t.SheetNames.indexOf(r=l+n)!=-1;++n);}if(ej(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function lU(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var a=oU(t,e);switch(t.Workbook.Sheets[a]||(t.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[a].Hidden=r}function cU(t,e){return t.z=e,t}function xj(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function uU(t,e,r){return xj(t,"#"+e,r)}function fU(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function dU(t,e,r,a){for(var n=typeof e!="string"?e:ta(e),s=typeof e=="string"?e:Or(e),l=n.s.r;l<=n.e.r;++l)for(var c=n.s.c;c<=n.e.c;++c){var f=G0(t,l,c);f.t="n",f.F=s,delete f.v,l==n.s.r&&c==n.s.c&&(f.f=r,a&&(f.D=!0))}return t}var lu={encode_col:tn,encode_row:An,encode_cell:wr,encode_range:Or,decode_col:S2,decode_row:w2,split_cell:wO,decode_cell:rn,decode_range:mi,format_cell:pc,sheet_add_aoa:WN,sheet_add_json:vj,sheet_add_dom:lj,aoa_to_sheet:xh,json_to_sheet:iU,table_to_sheet:cj,table_to_book:xB,sheet_to_csv:V2,sheet_to_txt:gj,sheet_to_json:l1,sheet_to_html:oj,sheet_to_formulae:sU,sheet_to_row_object_array:l1,sheet_get_cell:G0,book_new:G2,book_append_sheet:Y2,book_set_sheet_visibility:lU,cell_set_number_format:cU,cell_set_hyperlink:xj,cell_set_internal_link:uU,cell_add_comment:fU,sheet_set_array_formula:dU,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const hU="modulepreload",mU=function(t){return"/"+t},b5={},wv=function(e,r,a){let n=Promise.resolve();if(r&&r.length>0){let f=function(d){return Promise.all(d.map(m=>Promise.resolve(m).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");n=f(r.map(d=>{if(d=mU(d),d in b5)return;b5[d]=!0;const m=d.endsWith(".css"),v=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${v}`))return;const x=document.createElement("link");if(x.rel=m?"stylesheet":hU,m||(x.as="script"),x.crossOrigin="",x.href=d,c&&x.setAttribute("nonce",c),document.head.appendChild(x),m)return new Promise((g,b)=>{x.addEventListener("load",g),x.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${d}`)))})}))}function s(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return n.then(l=>{for(const c of l||[])c.status==="rejected"&&s(c.reason);return e().catch(s)})};function va(t){"@babel/helpers - typeof";return va=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},va(t)}var Jo=Uint8Array,Ui=Uint16Array,X2=Int32Array,K2=new Jo([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),J2=new Jo([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),w5=new Jo([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),yj=function(t,e){for(var r=new Ui(31),a=0;a<31;++a)r[a]=e+=1<<t[a-1];for(var n=new X2(r[30]),a=1;a<30;++a)for(var s=r[a];s<r[a+1];++s)n[s]=s-r[a]<<5|a;return{b:r,r:n}},_j=yj(K2,2),pU=_j.b,Dx=_j.r;pU[28]=258,Dx[258]=28;var gU=yj(J2,0),S5=gU.r,Fx=new Ui(32768);for(var qa=0;qa<32768;++qa){var su=(qa&43690)>>1|(qa&21845)<<1;su=(su&52428)>>2|(su&13107)<<2,su=(su&61680)>>4|(su&3855)<<4,Fx[qa]=((su&65280)>>8|(su&255)<<8)>>1}var N0=(function(t,e,r){for(var a=t.length,n=0,s=new Ui(e);n<a;++n)t[n]&&++s[t[n]-1];var l=new Ui(e);for(n=1;n<e;++n)l[n]=l[n-1]+s[n-1]<<1;var c;if(r){c=new Ui(1<<e);var f=15-e;for(n=0;n<a;++n)if(t[n])for(var d=n<<4|t[n],m=e-t[n],v=l[t[n]-1]++<<m,x=v|(1<<m)-1;v<=x;++v)c[Fx[v]>>f]=d}else for(c=new Ui(a),n=0;n<a;++n)t[n]&&(c[n]=Fx[l[t[n]-1]++]>>15-t[n]);return c}),Af=new Jo(288);for(var qa=0;qa<144;++qa)Af[qa]=8;for(var qa=144;qa<256;++qa)Af[qa]=9;for(var qa=256;qa<280;++qa)Af[qa]=7;for(var qa=280;qa<288;++qa)Af[qa]=8;var c1=new Jo(32);for(var qa=0;qa<32;++qa)c1[qa]=5;var vU=N0(Af,9,0),xU=N0(c1,5,0),bj=function(t){return(t+7)/8|0},yU=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new Jo(t.subarray(e,r))},ac=function(t,e,r){r<<=e&7;var a=e/8|0;t[a]|=r,t[a+1]|=r>>8},s0=function(t,e,r){r<<=e&7;var a=e/8|0;t[a]|=r,t[a+1]|=r>>8,t[a+2]|=r>>16},Sv=function(t,e){for(var r=[],a=0;a<t.length;++a)t[a]&&r.push({s:a,f:t[a]});var n=r.length,s=r.slice();if(!n)return{t:Sj,l:0};if(n==1){var l=new Jo(r[0].s+1);return l[r[0].s]=1,{t:l,l:1}}r.sort(function(G,W){return G.f-W.f}),r.push({s:-1,f:25001});var c=r[0],f=r[1],d=0,m=1,v=2;for(r[0]={s:-1,f:c.f+f.f,l:c,r:f};m!=n-1;)c=r[r[d].f<r[v].f?d++:v++],f=r[d!=m&&r[d].f<r[v].f?d++:v++],r[m++]={s:-1,f:c.f+f.f,l:c,r:f};for(var x=s[0].s,a=1;a<n;++a)s[a].s>x&&(x=s[a].s);var g=new Ui(x+1),b=Lx(r[m-1],g,0);if(b>e){var a=0,_=0,w=b-e,E=1<<w;for(s.sort(function(W,B){return g[B.s]-g[W.s]||W.f-B.f});a<n;++a){var C=s[a].s;if(g[C]>e)_+=E-(1<<b-g[C]),g[C]=e;else break}for(_>>=w;_>0;){var A=s[a].s;g[A]<e?_-=1<<e-g[A]++-1:++a}for(;a>=0&&_;--a){var T=s[a].s;g[T]==e&&(--g[T],++_)}b=e}return{t:new Jo(g),l:b}},Lx=function(t,e,r){return t.s==-1?Math.max(Lx(t.l,e,r+1),Lx(t.r,e,r+1)):e[t.s]=r},N5=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new Ui(++e),a=0,n=t[0],s=1,l=function(f){r[a++]=f},c=1;c<=e;++c)if(t[c]==n&&c!=e)++s;else{if(!n&&s>2){for(;s>138;s-=138)l(32754);s>2&&(l(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(l(n),--s;s>6;s-=6)l(8304);s>2&&(l(s-3<<5|8208),s=0)}for(;s--;)l(n);s=1,n=t[c]}return{c:r.subarray(0,a),n:e}},i0=function(t,e){for(var r=0,a=0;a<e.length;++a)r+=t[a]*e[a];return r},wj=function(t,e,r){var a=r.length,n=bj(e+2);t[n]=a&255,t[n+1]=a>>8,t[n+2]=t[n]^255,t[n+3]=t[n+1]^255;for(var s=0;s<a;++s)t[n+s+4]=r[s];return(n+4+a)*8},j5=function(t,e,r,a,n,s,l,c,f,d,m){ac(e,m++,r),++n[256];for(var v=Sv(n,15),x=v.t,g=v.l,b=Sv(s,15),_=b.t,w=b.l,E=N5(x),C=E.c,A=E.n,T=N5(_),G=T.c,W=T.n,B=new Ui(19),q=0;q<C.length;++q)++B[C[q]&31];for(var q=0;q<G.length;++q)++B[G[q]&31];for(var L=Sv(B,7),J=L.t,D=L.l,O=19;O>4&&!J[w5[O-1]];--O);var M=d+5<<3,V=i0(n,Af)+i0(s,c1)+l,ie=i0(n,x)+i0(s,_)+l+14+3*O+i0(B,J)+2*B[16]+3*B[17]+7*B[18];if(f>=0&&M<=V&&M<=ie)return wj(e,m,t.subarray(f,f+d));var X,Z,K,ae;if(ac(e,m,1+(ie<V)),m+=2,ie<V){X=N0(x,g,0),Z=x,K=N0(_,w,0),ae=_;var fe=N0(J,D,0);ac(e,m,A-257),ac(e,m+5,W-1),ac(e,m+10,O-4),m+=14;for(var q=0;q<O;++q)ac(e,m+3*q,J[w5[q]]);m+=3*O;for(var U=[C,G],j=0;j<2;++j)for(var F=U[j],q=0;q<F.length;++q){var I=F[q]&31;ac(e,m,fe[I]),m+=J[I],I>15&&(ac(e,m,F[q]>>5&127),m+=F[q]>>12)}}else X=vU,Z=Af,K=xU,ae=c1;for(var q=0;q<c;++q){var z=a[q];if(z>255){var I=z>>18&31;s0(e,m,X[I+257]),m+=Z[I+257],I>7&&(ac(e,m,z>>23&31),m+=K2[I]);var ne=z&31;s0(e,m,K[ne]),m+=ae[ne],ne>3&&(s0(e,m,z>>5&8191),m+=J2[ne])}else s0(e,m,X[z]),m+=Z[z]}return s0(e,m,X[256]),m+Z[256]},_U=new X2([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Sj=new Jo(0),bU=function(t,e,r,a,n,s){var l=s.z||t.length,c=new Jo(a+l+5*(1+Math.ceil(l/7e3))+n),f=c.subarray(a,c.length-n),d=s.l,m=(s.r||0)&7;if(e){m&&(f[0]=s.r>>3);for(var v=_U[e-1],x=v>>13,g=v&8191,b=(1<<r)-1,_=s.p||new Ui(32768),w=s.h||new Ui(b+1),E=Math.ceil(r/3),C=2*E,A=function(ht){return(t[ht]^t[ht+1]<<E^t[ht+2]<<C)&b},T=new X2(25e3),G=new Ui(288),W=new Ui(32),B=0,q=0,L=s.i||0,J=0,D=s.w||0,O=0;L+2<l;++L){var M=A(L),V=L&32767,ie=w[M];if(_[V]=ie,w[M]=V,D<=L){var X=l-L;if((B>7e3||J>24576)&&(X>423||!d)){m=j5(t,f,0,T,G,W,q,J,O,L-O,m),J=B=q=0,O=L;for(var Z=0;Z<286;++Z)G[Z]=0;for(var Z=0;Z<30;++Z)W[Z]=0}var K=2,ae=0,fe=g,U=V-ie&32767;if(X>2&&M==A(L-U))for(var j=Math.min(x,X)-1,F=Math.min(32767,L),I=Math.min(258,X);U<=F&&--fe&&V!=ie;){if(t[L+K]==t[L+K-U]){for(var z=0;z<I&&t[L+z]==t[L+z-U];++z);if(z>K){if(K=z,ae=U,z>j)break;for(var ne=Math.min(U,z-2),se=0,Z=0;Z<ne;++Z){var pe=L-U+Z&32767,ye=_[pe],_e=pe-ye&32767;_e>se&&(se=_e,ie=pe)}}}V=ie,ie=_[V],U+=V-ie&32767}if(ae){T[J++]=268435456|Dx[K]<<18|S5[ae];var Le=Dx[K]&31,ue=S5[ae]&31;q+=K2[Le]+J2[ue],++G[257+Le],++W[ue],D=L+K,++B}else T[J++]=t[L],++G[t[L]]}}for(L=Math.max(L,D);L<l;++L)T[J++]=t[L],++G[t[L]];m=j5(t,f,d,T,G,W,q,J,O,L-O,m),d||(s.r=m&7|f[m/8|0]<<3,m-=7,s.h=w,s.p=_,s.i=L,s.w=D)}else{for(var L=s.w||0;L<l+d;L+=65535){var at=L+65535;at>=l&&(f[m/8|0]=d,at=l),m=wj(f,m+1,t.subarray(L,at))}s.i=l}return yU(c,0,a+bj(m)+n)},Nj=function(){var t=1,e=0;return{p:function(r){for(var a=t,n=e,s=r.length|0,l=0;l!=s;){for(var c=Math.min(l+2655,s);l<c;++l)n+=a+=r[l];a=(a&65535)+15*(a>>16),n=(n&65535)+15*(n>>16)}t=a,e=n},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},wU=function(t,e,r,a,n){if(!n&&(n={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),l=new Jo(s.length+t.length);l.set(s),l.set(t,s.length),t=l,n.w=s.length}return bU(t,e.level==null?6:e.level,e.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,a,n)},jj=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},SU=function(t,e){var r=e.level,a=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=a<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var n=Nj();n.p(e.dictionary),jj(t,2,n.d())}};function Px(t,e){e||(e={});var r=Nj();r.p(t);var a=wU(t,e,e.dictionary?6:2,4);return SU(a,e),jj(a,a.length-4,r.d()),a}var NU=typeof TextDecoder<"u"&&new TextDecoder,jU=0;try{NU.decode(Sj,{stream:!0}),jU=1}catch{}function kU(t){if(Array.isArray(t))return t}function EU(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var a,n,s,l,c=[],f=!0,d=!1;try{if(s=(r=r.call(t)).next,e!==0)for(;!(f=(a=s.call(r)).done)&&(c.push(a.value),c.length!==e);f=!0);}catch(m){d=!0,n=m}finally{try{if(!f&&r.return!=null&&(l=r.return(),Object(l)!==l))return}finally{if(d)throw n}}return c}}function k5(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,a=Array(e);r<e;r++)a[r]=t[r];return a}function AU(t,e){if(t){if(typeof t=="string")return k5(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?k5(t,e):void 0}}function CU(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E5(t,e){return kU(t)||EU(t,e)||AU(t,e)||CU()}function A5(t,e="utf8"){return new TextDecoder(e).decode(t)}const TU=new TextEncoder;function OU(t){return TU.encode(t)}const RU=1024*8,DU=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),Nv={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Z2{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=RU,r={}){let a=!1;typeof e=="number"?e=new ArrayBuffer(e):(a=!0,this.lastWrittenByte=e.byteLength);const n=r.offset?r.offset>>>0:0,s=e.byteLength-n;let l=n;(ArrayBuffer.isView(e)||e instanceof Z2)&&(e.byteLength!==e.buffer.byteLength&&(l=e.byteOffset+n),e=e.buffer),a?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=e,this.length=s,this.byteLength=s,this.byteOffset=l,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,l,s),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const a=(this.offset+e)*2,n=new Uint8Array(a);n.set(new Uint8Array(this.buffer)),this.buffer=n.buffer,this.length=a,this.byteLength=a,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,r){const a=Nv[r].BYTES_PER_ELEMENT*e,n=this.byteOffset+this.offset,s=this.buffer.slice(n,n+a);if(this.littleEndian===DU&&r!=="uint8"&&r!=="int8"){const c=new Uint8Array(this.buffer.slice(n,n+a));c.reverse();const f=new Nv[r](c.buffer);return this.offset+=a,f.reverse(),f}const l=new Nv[r](s);return this.offset+=a,l}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let r="";for(let a=0;a<e;a++)r+=this.readChar();return r}readUtf8(e=1){return A5(this.readBytes(e))}decodeText(e=1,r="utf8"){return A5(this.readBytes(e),r)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let r=0;r<e.length;r++)this._data.setUint8(this.offset++,e[r]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let r=0;r<e.length;r++)this.writeUint8(e.charCodeAt(r));return this}writeUtf8(e){return this.writeBytes(OU(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function _h(t){let e=t.length;for(;--e>=0;)t[e]=0}const FU=3,LU=258,kj=29,PU=256,MU=PU+1+kj,Ej=30,IU=512,BU=new Array((MU+2)*2);_h(BU);const UU=new Array(Ej*2);_h(UU);const qU=new Array(IU);_h(qU);const zU=new Array(LU-FU+1);_h(zU);const HU=new Array(kj);_h(HU);const $U=new Array(Ej);_h($U);const WU=(t,e,r,a)=>{let n=t&65535|0,s=t>>>16&65535|0,l=0;for(;r!==0;){l=r>2e3?2e3:r,r-=l;do n=n+e[a++]|0,s=s+n|0;while(--l);n%=65521,s%=65521}return n|s<<16|0};var Mx=WU;const VU=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var a=0;a<8;a++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},GU=new Uint32Array(VU()),YU=(t,e,r,a)=>{const n=GU,s=a+r;t^=-1;for(let l=a;l<s;l++)t=t>>>8^n[(t^e[l])&255];return t^-1};var _l=YU,Ix={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Aj={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const XU=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var KU=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const a in r)XU(r,a)&&(t[a]=r[a])}}return t},JU=t=>{let e=0;for(let a=0,n=t.length;a<n;a++)e+=t[a].length;const r=new Uint8Array(e);for(let a=0,n=0,s=t.length;a<s;a++){let l=t[a];r.set(l,n),n+=l.length}return r},Cj={assign:KU,flattenChunks:JU};let Tj=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Tj=!1}const Y0=new Uint8Array(256);for(let t=0;t<256;t++)Y0[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Y0[254]=Y0[254]=1;var ZU=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,a,n,s,l=t.length,c=0;for(n=0;n<l;n++)r=t.charCodeAt(n),(r&64512)===55296&&n+1<l&&(a=t.charCodeAt(n+1),(a&64512)===56320&&(r=65536+(r-55296<<10)+(a-56320),n++)),c+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(c),s=0,n=0;s<c;n++)r=t.charCodeAt(n),(r&64512)===55296&&n+1<l&&(a=t.charCodeAt(n+1),(a&64512)===56320&&(r=65536+(r-55296<<10)+(a-56320),n++)),r<128?e[s++]=r:r<2048?(e[s++]=192|r>>>6,e[s++]=128|r&63):r<65536?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|r&63):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|r&63);return e};const QU=(t,e)=>{if(e<65534&&t.subarray&&Tj)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let a=0;a<e;a++)r+=String.fromCharCode(t[a]);return r};var eq=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let a,n;const s=new Array(r*2);for(n=0,a=0;a<r;){let l=t[a++];if(l<128){s[n++]=l;continue}let c=Y0[l];if(c>4){s[n++]=65533,a+=c-1;continue}for(l&=c===2?31:c===3?15:7;c>1&&a<r;)l=l<<6|t[a++]&63,c--;if(c>1){s[n++]=65533;continue}l<65536?s[n++]=l:(l-=65536,s[n++]=55296|l>>10&1023,s[n++]=56320|l&1023)}return QU(s,n)},tq=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+Y0[t[r]]>e?r:e},Bx={string2buf:ZU,buf2string:eq,utf8border:tq};function rq(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var aq=rq;const Np=16209,nq=16191;var sq=function(e,r){let a,n,s,l,c,f,d,m,v,x,g,b,_,w,E,C,A,T,G,W,B,q,L,J;const D=e.state;a=e.next_in,L=e.input,n=a+(e.avail_in-5),s=e.next_out,J=e.output,l=s-(r-e.avail_out),c=s+(e.avail_out-257),f=D.dmax,d=D.wsize,m=D.whave,v=D.wnext,x=D.window,g=D.hold,b=D.bits,_=D.lencode,w=D.distcode,E=(1<<D.lenbits)-1,C=(1<<D.distbits)-1;e:do{b<15&&(g+=L[a++]<<b,b+=8,g+=L[a++]<<b,b+=8),A=_[g&E];t:for(;;){if(T=A>>>24,g>>>=T,b-=T,T=A>>>16&255,T===0)J[s++]=A&65535;else if(T&16){G=A&65535,T&=15,T&&(b<T&&(g+=L[a++]<<b,b+=8),G+=g&(1<<T)-1,g>>>=T,b-=T),b<15&&(g+=L[a++]<<b,b+=8,g+=L[a++]<<b,b+=8),A=w[g&C];r:for(;;){if(T=A>>>24,g>>>=T,b-=T,T=A>>>16&255,T&16){if(W=A&65535,T&=15,b<T&&(g+=L[a++]<<b,b+=8,b<T&&(g+=L[a++]<<b,b+=8)),W+=g&(1<<T)-1,W>f){e.msg="invalid distance too far back",D.mode=Np;break e}if(g>>>=T,b-=T,T=s-l,W>T){if(T=W-T,T>m&&D.sane){e.msg="invalid distance too far back",D.mode=Np;break e}if(B=0,q=x,v===0){if(B+=d-T,T<G){G-=T;do J[s++]=x[B++];while(--T);B=s-W,q=J}}else if(v<T){if(B+=d+v-T,T-=v,T<G){G-=T;do J[s++]=x[B++];while(--T);if(B=0,v<G){T=v,G-=T;do J[s++]=x[B++];while(--T);B=s-W,q=J}}}else if(B+=v-T,T<G){G-=T;do J[s++]=x[B++];while(--T);B=s-W,q=J}for(;G>2;)J[s++]=q[B++],J[s++]=q[B++],J[s++]=q[B++],G-=3;G&&(J[s++]=q[B++],G>1&&(J[s++]=q[B++]))}else{B=s-W;do J[s++]=J[B++],J[s++]=J[B++],J[s++]=J[B++],G-=3;while(G>2);G&&(J[s++]=J[B++],G>1&&(J[s++]=J[B++]))}}else if((T&64)===0){A=w[(A&65535)+(g&(1<<T)-1)];continue r}else{e.msg="invalid distance code",D.mode=Np;break e}break}}else if((T&64)===0){A=_[(A&65535)+(g&(1<<T)-1)];continue t}else if(T&32){D.mode=nq;break e}else{e.msg="invalid literal/length code",D.mode=Np;break e}break}}while(a<n&&s<c);G=b>>3,a-=G,b-=G<<3,g&=(1<<b)-1,e.next_in=a,e.next_out=s,e.avail_in=a<n?5+(n-a):5-(a-n),e.avail_out=s<c?257+(c-s):257-(s-c),D.hold=g,D.bits=b};const Ud=15,C5=852,T5=592,O5=0,jv=1,R5=2,iq=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),oq=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),lq=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),cq=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),uq=(t,e,r,a,n,s,l,c)=>{const f=c.bits;let d=0,m=0,v=0,x=0,g=0,b=0,_=0,w=0,E=0,C=0,A,T,G,W,B,q=null,L;const J=new Uint16Array(Ud+1),D=new Uint16Array(Ud+1);let O=null,M,V,ie;for(d=0;d<=Ud;d++)J[d]=0;for(m=0;m<a;m++)J[e[r+m]]++;for(g=f,x=Ud;x>=1&&J[x]===0;x--);if(g>x&&(g=x),x===0)return n[s++]=1<<24|64<<16|0,n[s++]=1<<24|64<<16|0,c.bits=1,0;for(v=1;v<x&&J[v]===0;v++);for(g<v&&(g=v),w=1,d=1;d<=Ud;d++)if(w<<=1,w-=J[d],w<0)return-1;if(w>0&&(t===O5||x!==1))return-1;for(D[1]=0,d=1;d<Ud;d++)D[d+1]=D[d]+J[d];for(m=0;m<a;m++)e[r+m]!==0&&(l[D[e[r+m]]++]=m);if(t===O5?(q=O=l,L=20):t===jv?(q=iq,O=oq,L=257):(q=lq,O=cq,L=0),C=0,m=0,d=v,B=s,b=g,_=0,G=-1,E=1<<g,W=E-1,t===jv&&E>C5||t===R5&&E>T5)return 1;for(;;){M=d-_,l[m]+1<L?(V=0,ie=l[m]):l[m]>=L?(V=O[l[m]-L],ie=q[l[m]-L]):(V=96,ie=0),A=1<<d-_,T=1<<b,v=T;do T-=A,n[B+(C>>_)+T]=M<<24|V<<16|ie|0;while(T!==0);for(A=1<<d-1;C&A;)A>>=1;if(A!==0?(C&=A-1,C+=A):C=0,m++,--J[d]===0){if(d===x)break;d=e[r+l[m]]}if(d>g&&(C&W)!==G){for(_===0&&(_=g),B+=v,b=d-_,w=1<<b;b+_<x&&(w-=J[b+_],!(w<=0));)b++,w<<=1;if(E+=1<<b,t===jv&&E>C5||t===R5&&E>T5)return 1;G=C&W,n[G]=g<<24|b<<16|B-s|0}}return C!==0&&(n[B+C]=d-_<<24|64<<16|0),c.bits=g,0};var j0=uq;const fq=0,Oj=1,Rj=2,{Z_FINISH:D5,Z_BLOCK:dq,Z_TREES:jp,Z_OK:Cf,Z_STREAM_END:hq,Z_NEED_DICT:mq,Z_STREAM_ERROR:ho,Z_DATA_ERROR:Dj,Z_MEM_ERROR:Fj,Z_BUF_ERROR:pq,Z_DEFLATED:F5}=Aj,C1=16180,L5=16181,P5=16182,M5=16183,I5=16184,B5=16185,U5=16186,q5=16187,z5=16188,H5=16189,u1=16190,nc=16191,kv=16192,$5=16193,Ev=16194,W5=16195,V5=16196,G5=16197,Y5=16198,kp=16199,Ep=16200,X5=16201,K5=16202,J5=16203,Z5=16204,Q5=16205,Av=16206,eS=16207,tS=16208,Ya=16209,Lj=16210,Pj=16211,gq=852,vq=592,xq=15,yq=xq,rS=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function _q(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Bf=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<C1||e.mode>Pj?1:0},Mj=t=>{if(Bf(t))return ho;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=C1,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(gq),e.distcode=e.distdyn=new Int32Array(vq),e.sane=1,e.back=-1,Cf},Ij=t=>{if(Bf(t))return ho;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Mj(t)},Bj=(t,e)=>{let r;if(Bf(t))return ho;const a=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?ho:(a.window!==null&&a.wbits!==e&&(a.window=null),a.wrap=r,a.wbits=e,Ij(t))},Uj=(t,e)=>{if(!t)return ho;const r=new _q;t.state=r,r.strm=t,r.window=null,r.mode=C1;const a=Bj(t,e);return a!==Cf&&(t.state=null),a},bq=t=>Uj(t,yq);let aS=!0,Cv,Tv;const wq=t=>{if(aS){Cv=new Int32Array(512),Tv=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(j0(Oj,t.lens,0,288,Cv,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;j0(Rj,t.lens,0,32,Tv,0,t.work,{bits:5}),aS=!1}t.lencode=Cv,t.lenbits=9,t.distcode=Tv,t.distbits=5},qj=(t,e,r,a)=>{let n;const s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),a>=s.wsize?(s.window.set(e.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>a&&(n=a),s.window.set(e.subarray(r-a,r-a+n),s.wnext),a-=n,a?(s.window.set(e.subarray(r-a,r),0),s.wnext=a,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0},Sq=(t,e)=>{let r,a,n,s,l,c,f,d,m,v,x,g,b,_,w=0,E,C,A,T,G,W,B,q;const L=new Uint8Array(4);let J,D;const O=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Bf(t)||!t.output||!t.input&&t.avail_in!==0)return ho;r=t.state,r.mode===nc&&(r.mode=kv),l=t.next_out,n=t.output,f=t.avail_out,s=t.next_in,a=t.input,c=t.avail_in,d=r.hold,m=r.bits,v=c,x=f,q=Cf;e:for(;;)switch(r.mode){case C1:if(r.wrap===0){r.mode=kv;break}for(;m<16;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}if(r.wrap&2&&d===35615){r.wbits===0&&(r.wbits=15),r.check=0,L[0]=d&255,L[1]=d>>>8&255,r.check=_l(r.check,L,2,0),d=0,m=0,r.mode=L5;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((d&255)<<8)+(d>>8))%31){t.msg="incorrect header check",r.mode=Ya;break}if((d&15)!==F5){t.msg="unknown compression method",r.mode=Ya;break}if(d>>>=4,m-=4,B=(d&15)+8,r.wbits===0&&(r.wbits=B),B>15||B>r.wbits){t.msg="invalid window size",r.mode=Ya;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=d&512?H5:nc,d=0,m=0;break;case L5:for(;m<16;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}if(r.flags=d,(r.flags&255)!==F5){t.msg="unknown compression method",r.mode=Ya;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=Ya;break}r.head&&(r.head.text=d>>8&1),r.flags&512&&r.wrap&4&&(L[0]=d&255,L[1]=d>>>8&255,r.check=_l(r.check,L,2,0)),d=0,m=0,r.mode=P5;case P5:for(;m<32;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}r.head&&(r.head.time=d),r.flags&512&&r.wrap&4&&(L[0]=d&255,L[1]=d>>>8&255,L[2]=d>>>16&255,L[3]=d>>>24&255,r.check=_l(r.check,L,4,0)),d=0,m=0,r.mode=M5;case M5:for(;m<16;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}r.head&&(r.head.xflags=d&255,r.head.os=d>>8),r.flags&512&&r.wrap&4&&(L[0]=d&255,L[1]=d>>>8&255,r.check=_l(r.check,L,2,0)),d=0,m=0,r.mode=I5;case I5:if(r.flags&1024){for(;m<16;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}r.length=d,r.head&&(r.head.extra_len=d),r.flags&512&&r.wrap&4&&(L[0]=d&255,L[1]=d>>>8&255,r.check=_l(r.check,L,2,0)),d=0,m=0}else r.head&&(r.head.extra=null);r.mode=B5;case B5:if(r.flags&1024&&(g=r.length,g>c&&(g=c),g&&(r.head&&(B=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(a.subarray(s,s+g),B)),r.flags&512&&r.wrap&4&&(r.check=_l(r.check,a,g,s)),c-=g,s+=g,r.length-=g),r.length))break e;r.length=0,r.mode=U5;case U5:if(r.flags&2048){if(c===0)break e;g=0;do B=a[s+g++],r.head&&B&&r.length<65536&&(r.head.name+=String.fromCharCode(B));while(B&&g<c);if(r.flags&512&&r.wrap&4&&(r.check=_l(r.check,a,g,s)),c-=g,s+=g,B)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=q5;case q5:if(r.flags&4096){if(c===0)break e;g=0;do B=a[s+g++],r.head&&B&&r.length<65536&&(r.head.comment+=String.fromCharCode(B));while(B&&g<c);if(r.flags&512&&r.wrap&4&&(r.check=_l(r.check,a,g,s)),c-=g,s+=g,B)break e}else r.head&&(r.head.comment=null);r.mode=z5;case z5:if(r.flags&512){for(;m<16;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}if(r.wrap&4&&d!==(r.check&65535)){t.msg="header crc mismatch",r.mode=Ya;break}d=0,m=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=nc;break;case H5:for(;m<32;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}t.adler=r.check=rS(d),d=0,m=0,r.mode=u1;case u1:if(r.havedict===0)return t.next_out=l,t.avail_out=f,t.next_in=s,t.avail_in=c,r.hold=d,r.bits=m,mq;t.adler=r.check=1,r.mode=nc;case nc:if(e===dq||e===jp)break e;case kv:if(r.last){d>>>=m&7,m-=m&7,r.mode=Av;break}for(;m<3;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}switch(r.last=d&1,d>>>=1,m-=1,d&3){case 0:r.mode=$5;break;case 1:if(wq(r),r.mode=kp,e===jp){d>>>=2,m-=2;break e}break;case 2:r.mode=V5;break;case 3:t.msg="invalid block type",r.mode=Ya}d>>>=2,m-=2;break;case $5:for(d>>>=m&7,m-=m&7;m<32;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}if((d&65535)!==(d>>>16^65535)){t.msg="invalid stored block lengths",r.mode=Ya;break}if(r.length=d&65535,d=0,m=0,r.mode=Ev,e===jp)break e;case Ev:r.mode=W5;case W5:if(g=r.length,g){if(g>c&&(g=c),g>f&&(g=f),g===0)break e;n.set(a.subarray(s,s+g),l),c-=g,s+=g,f-=g,l+=g,r.length-=g;break}r.mode=nc;break;case V5:for(;m<14;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}if(r.nlen=(d&31)+257,d>>>=5,m-=5,r.ndist=(d&31)+1,d>>>=5,m-=5,r.ncode=(d&15)+4,d>>>=4,m-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=Ya;break}r.have=0,r.mode=G5;case G5:for(;r.have<r.ncode;){for(;m<3;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}r.lens[O[r.have++]]=d&7,d>>>=3,m-=3}for(;r.have<19;)r.lens[O[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,J={bits:r.lenbits},q=j0(fq,r.lens,0,19,r.lencode,0,r.work,J),r.lenbits=J.bits,q){t.msg="invalid code lengths set",r.mode=Ya;break}r.have=0,r.mode=Y5;case Y5:for(;r.have<r.nlen+r.ndist;){for(;w=r.lencode[d&(1<<r.lenbits)-1],E=w>>>24,C=w>>>16&255,A=w&65535,!(E<=m);){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}if(A<16)d>>>=E,m-=E,r.lens[r.have++]=A;else{if(A===16){for(D=E+2;m<D;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}if(d>>>=E,m-=E,r.have===0){t.msg="invalid bit length repeat",r.mode=Ya;break}B=r.lens[r.have-1],g=3+(d&3),d>>>=2,m-=2}else if(A===17){for(D=E+3;m<D;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}d>>>=E,m-=E,B=0,g=3+(d&7),d>>>=3,m-=3}else{for(D=E+7;m<D;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}d>>>=E,m-=E,B=0,g=11+(d&127),d>>>=7,m-=7}if(r.have+g>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=Ya;break}for(;g--;)r.lens[r.have++]=B}}if(r.mode===Ya)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=Ya;break}if(r.lenbits=9,J={bits:r.lenbits},q=j0(Oj,r.lens,0,r.nlen,r.lencode,0,r.work,J),r.lenbits=J.bits,q){t.msg="invalid literal/lengths set",r.mode=Ya;break}if(r.distbits=6,r.distcode=r.distdyn,J={bits:r.distbits},q=j0(Rj,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,J),r.distbits=J.bits,q){t.msg="invalid distances set",r.mode=Ya;break}if(r.mode=kp,e===jp)break e;case kp:r.mode=Ep;case Ep:if(c>=6&&f>=258){t.next_out=l,t.avail_out=f,t.next_in=s,t.avail_in=c,r.hold=d,r.bits=m,sq(t,x),l=t.next_out,n=t.output,f=t.avail_out,s=t.next_in,a=t.input,c=t.avail_in,d=r.hold,m=r.bits,r.mode===nc&&(r.back=-1);break}for(r.back=0;w=r.lencode[d&(1<<r.lenbits)-1],E=w>>>24,C=w>>>16&255,A=w&65535,!(E<=m);){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}if(C&&(C&240)===0){for(T=E,G=C,W=A;w=r.lencode[W+((d&(1<<T+G)-1)>>T)],E=w>>>24,C=w>>>16&255,A=w&65535,!(T+E<=m);){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}d>>>=T,m-=T,r.back+=T}if(d>>>=E,m-=E,r.back+=E,r.length=A,C===0){r.mode=Q5;break}if(C&32){r.back=-1,r.mode=nc;break}if(C&64){t.msg="invalid literal/length code",r.mode=Ya;break}r.extra=C&15,r.mode=X5;case X5:if(r.extra){for(D=r.extra;m<D;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}r.length+=d&(1<<r.extra)-1,d>>>=r.extra,m-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=K5;case K5:for(;w=r.distcode[d&(1<<r.distbits)-1],E=w>>>24,C=w>>>16&255,A=w&65535,!(E<=m);){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}if((C&240)===0){for(T=E,G=C,W=A;w=r.distcode[W+((d&(1<<T+G)-1)>>T)],E=w>>>24,C=w>>>16&255,A=w&65535,!(T+E<=m);){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}d>>>=T,m-=T,r.back+=T}if(d>>>=E,m-=E,r.back+=E,C&64){t.msg="invalid distance code",r.mode=Ya;break}r.offset=A,r.extra=C&15,r.mode=J5;case J5:if(r.extra){for(D=r.extra;m<D;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}r.offset+=d&(1<<r.extra)-1,d>>>=r.extra,m-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=Ya;break}r.mode=Z5;case Z5:if(f===0)break e;if(g=x-f,r.offset>g){if(g=r.offset-g,g>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=Ya;break}g>r.wnext?(g-=r.wnext,b=r.wsize-g):b=r.wnext-g,g>r.length&&(g=r.length),_=r.window}else _=n,b=l-r.offset,g=r.length;g>f&&(g=f),f-=g,r.length-=g;do n[l++]=_[b++];while(--g);r.length===0&&(r.mode=Ep);break;case Q5:if(f===0)break e;n[l++]=r.length,f--,r.mode=Ep;break;case Av:if(r.wrap){for(;m<32;){if(c===0)break e;c--,d|=a[s++]<<m,m+=8}if(x-=f,t.total_out+=x,r.total+=x,r.wrap&4&&x&&(t.adler=r.check=r.flags?_l(r.check,n,x,l-x):Mx(r.check,n,x,l-x)),x=f,r.wrap&4&&(r.flags?d:rS(d))!==r.check){t.msg="incorrect data check",r.mode=Ya;break}d=0,m=0}r.mode=eS;case eS:if(r.wrap&&r.flags){for(;m<32;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}if(r.wrap&4&&d!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=Ya;break}d=0,m=0}r.mode=tS;case tS:q=hq;break e;case Ya:q=Dj;break e;case Lj:return Fj;case Pj:default:return ho}return t.next_out=l,t.avail_out=f,t.next_in=s,t.avail_in=c,r.hold=d,r.bits=m,(r.wsize||x!==t.avail_out&&r.mode<Ya&&(r.mode<Av||e!==D5))&&qj(t,t.output,t.next_out,x-t.avail_out),v-=t.avail_in,x-=t.avail_out,t.total_in+=v,t.total_out+=x,r.total+=x,r.wrap&4&&x&&(t.adler=r.check=r.flags?_l(r.check,n,x,t.next_out-x):Mx(r.check,n,x,t.next_out-x)),t.data_type=r.bits+(r.last?64:0)+(r.mode===nc?128:0)+(r.mode===kp||r.mode===Ev?256:0),(v===0&&x===0||e===D5)&&q===Cf&&(q=pq),q},Nq=t=>{if(Bf(t))return ho;let e=t.state;return e.window&&(e.window=null),t.state=null,Cf},jq=(t,e)=>{if(Bf(t))return ho;const r=t.state;return(r.wrap&2)===0?ho:(r.head=e,e.done=!1,Cf)},kq=(t,e)=>{const r=e.length;let a,n,s;return Bf(t)||(a=t.state,a.wrap!==0&&a.mode!==u1)?ho:a.mode===u1&&(n=1,n=Mx(n,e,r,0),n!==a.check)?Dj:(s=qj(t,e,r,r),s?(a.mode=Lj,Fj):(a.havedict=1,Cf))};var Eq=Ij,Aq=Bj,Cq=Mj,Tq=bq,Oq=Uj,Rq=Sq,Dq=Nq,Fq=jq,Lq=kq,Pq="pako inflate (from Nodeca project)",ic={inflateReset:Eq,inflateReset2:Aq,inflateResetKeep:Cq,inflateInit:Tq,inflateInit2:Oq,inflate:Rq,inflateEnd:Dq,inflateGetHeader:Fq,inflateSetDictionary:Lq,inflateInfo:Pq};function Mq(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Iq=Mq;const zj=Object.prototype.toString,{Z_NO_FLUSH:Bq,Z_FINISH:Uq,Z_OK:X0,Z_STREAM_END:Ov,Z_NEED_DICT:Rv,Z_STREAM_ERROR:qq,Z_DATA_ERROR:nS,Z_MEM_ERROR:zq}=Aj;function lm(t){this.options=Cj.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new aq,this.strm.avail_out=0;let r=ic.inflateInit2(this.strm,e.windowBits);if(r!==X0)throw new Error(Ix[r]);if(this.header=new Iq,ic.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Bx.string2buf(e.dictionary):zj.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=ic.inflateSetDictionary(this.strm,e.dictionary),r!==X0)))throw new Error(Ix[r])}lm.prototype.push=function(t,e){const r=this.strm,a=this.options.chunkSize,n=this.options.dictionary;let s,l,c;if(this.ended)return!1;for(e===~~e?l=e:l=e===!0?Uq:Bq,zj.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(a),r.next_out=0,r.avail_out=a),s=ic.inflate(r,l),s===Rv&&n&&(s=ic.inflateSetDictionary(r,n),s===X0?s=ic.inflate(r,l):s===nS&&(s=Rv));r.avail_in>0&&s===Ov&&r.state.wrap>0&&t[r.next_in]!==0;)ic.inflateReset(r),s=ic.inflate(r,l);switch(s){case qq:case nS:case Rv:case zq:return this.onEnd(s),this.ended=!0,!1}if(c=r.avail_out,r.next_out&&(r.avail_out===0||s===Ov))if(this.options.to==="string"){let f=Bx.utf8border(r.output,r.next_out),d=r.next_out-f,m=Bx.buf2string(r.output,f);r.next_out=d,r.avail_out=a-d,d&&r.output.set(r.output.subarray(f,f+d),0),this.onData(m)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(s===X0&&c===0)){if(s===Ov)return s=ic.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};lm.prototype.onData=function(t){this.chunks.push(t)};lm.prototype.onEnd=function(t){t===X0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Cj.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function Hq(t,e){const r=new lm(e);if(r.push(t),r.err)throw r.msg||Ix[r.err];return r.result}var $q=lm,Wq=Hq,Vq={Inflate:$q,inflate:Wq};const{Inflate:Gq,inflate:Yq}=Vq;var sS=Gq,Xq=Yq;const Hj=[];for(let t=0;t<256;t++){let e=t;for(let r=0;r<8;r++)e&1?e=3988292384^e>>>1:e=e>>>1;Hj[t]=e}const iS=4294967295;function Kq(t,e,r){let a=t;for(let n=0;n<r;n++)a=Hj[(a^e[n])&255]^a>>>8;return a}function Jq(t,e){return(Kq(iS,t,e)^iS)>>>0}function oS(t,e,r){const a=t.readUint32(),n=Jq(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(n!==a)throw new Error(`CRC mismatch for chunk ${r}. Expected ${a}, found ${n}`)}function $j(t,e,r){for(let a=0;a<r;a++)e[a]=t[a]}function Wj(t,e,r,a){let n=0;for(;n<a;n++)e[n]=t[n];for(;n<r;n++)e[n]=t[n]+e[n-a]&255}function Vj(t,e,r,a){let n=0;if(r.length===0)for(;n<a;n++)e[n]=t[n];else for(;n<a;n++)e[n]=t[n]+r[n]&255}function Gj(t,e,r,a,n){let s=0;if(r.length===0){for(;s<n;s++)e[s]=t[s];for(;s<a;s++)e[s]=t[s]+(e[s-n]>>1)&255}else{for(;s<n;s++)e[s]=t[s]+(r[s]>>1)&255;for(;s<a;s++)e[s]=t[s]+(e[s-n]+r[s]>>1)&255}}function Yj(t,e,r,a,n){let s=0;if(r.length===0){for(;s<n;s++)e[s]=t[s];for(;s<a;s++)e[s]=t[s]+e[s-n]&255}else{for(;s<n;s++)e[s]=t[s]+r[s]&255;for(;s<a;s++)e[s]=t[s]+Zq(e[s-n],r[s],r[s-n])&255}}function Zq(t,e,r){const a=t+e-r,n=Math.abs(a-t),s=Math.abs(a-e),l=Math.abs(a-r);return n<=s&&n<=l?t:s<=l?e:r}function Qq(t,e,r,a,n,s){switch(t){case 0:$j(e,r,n);break;case 1:Wj(e,r,n,s);break;case 2:Vj(e,r,a,n);break;case 3:Gj(e,r,a,n,s);break;case 4:Yj(e,r,a,n,s);break;default:throw new Error(`Unsupported filter: ${t}`)}}const ez=new Uint16Array([255]),tz=new Uint8Array(ez.buffer),rz=tz[0]===255;function az(t){const{data:e,width:r,height:a,channels:n,depth:s}=t,l=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],c=Math.ceil(s/8)*n,f=new Uint8Array(a*r*c);let d=0;for(let m=0;m<7;m++){const v=l[m],x=Math.ceil((r-v.x)/v.xStep),g=Math.ceil((a-v.y)/v.yStep);if(x<=0||g<=0)continue;const b=x*c,_=new Uint8Array(b);for(let w=0;w<g;w++){const E=e[d++],C=e.subarray(d,d+b);d+=b;const A=new Uint8Array(b);Qq(E,C,A,_,b,c),_.set(A);for(let T=0;T<x;T++){const G=v.x+T*v.xStep,W=v.y+w*v.yStep;if(!(G>=r||W>=a))for(let B=0;B<c;B++)f[(W*r+G)*c+B]=A[T*c+B]}}}if(s===16){const m=new Uint16Array(f.buffer);if(rz)for(let v=0;v<m.length;v++)m[v]=nz(m[v]);return m}else return f}function nz(t){return(t&255)<<8|t>>8&255}const sz=new Uint16Array([255]),iz=new Uint8Array(sz.buffer),oz=iz[0]===255,lz=new Uint8Array(0);function lS(t){const{data:e,width:r,height:a,channels:n,depth:s}=t,l=Math.ceil(s/8)*n,c=Math.ceil(s/8*n*r),f=new Uint8Array(a*c);let d=lz,m=0,v,x;for(let g=0;g<a;g++){switch(v=e.subarray(m+1,m+1+c),x=f.subarray(g*c,(g+1)*c),e[m]){case 0:$j(v,x,c);break;case 1:Wj(v,x,c,l);break;case 2:Vj(v,x,d,c);break;case 3:Gj(v,x,d,c,l);break;case 4:Yj(v,x,d,c,l);break;default:throw new Error(`Unsupported filter: ${e[m]}`)}d=x,m+=c+1}if(s===16){const g=new Uint16Array(f.buffer);if(oz)for(let b=0;b<g.length;b++)g[b]=cz(g[b]);return g}else return f}function cz(t){return(t&255)<<8|t>>8&255}const Ip=Uint8Array.of(137,80,78,71,13,10,26,10);function cS(t){if(!uz(t.readBytes(Ip.length)))throw new Error("wrong PNG signature")}function uz(t){if(t.length<Ip.length)return!1;for(let e=0;e<Ip.length;e++)if(t[e]!==Ip[e])return!1;return!0}const fz="tEXt",dz=0,Xj=new TextDecoder("latin1");function hz(t){if(pz(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const mz=/^[\u0000-\u00FF]*$/;function pz(t){if(!mz.test(t))throw new Error("invalid latin1 text")}function gz(t,e,r){const a=Kj(e);t[a]=vz(e,r-a.length-1)}function Kj(t){for(t.mark();t.readByte()!==dz;);const e=t.offset;t.reset();const r=Xj.decode(t.readBytes(e-t.offset-1));return t.skip(1),hz(r),r}function vz(t,e){return Xj.decode(t.readBytes(e))}const Oi={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Dv={UNKNOWN:-1,DEFLATE:0},uS={UNKNOWN:-1,ADAPTIVE:0},Fv={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Ap={NONE:0,BACKGROUND:1,PREVIOUS:2},Lv={SOURCE:0,OVER:1};class xz extends Z2{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,r={}){super(e);const{checkCrc:a=!1}=r;this._checkCrc=a,this._inflator=new sS,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Dv.UNKNOWN,this._filterMethod=uS.UNKNOWN,this._interlaceMethod=Fv.UNKNOWN,this._colorType=Oi.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(cS(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeChunk(e,r)}return this.decodeImage(),this._png}decodeApng(){for(cS(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(e,r)}return this.decodeApngImage(),this._apng}decodeChunk(e,r){const a=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case fz:gz(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-a!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?oS(this,e+4,r):this.skip(4)}decodeApngChunk(e,r){const a=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,r),this.offset=a+e;break}if(this.offset-a!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?oS(this,e+4,r):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=yz(this.readUint8());const r=this.readUint8();this._colorType=r;let a;switch(r){case Oi.GREYSCALE:a=1;break;case Oi.TRUECOLOUR:a=3;break;case Oi.INDEXED_COLOUR:a=1;break;case Oi.GREYSCALE_ALPHA:a=2;break;case Oi.TRUECOLOUR_ALPHA:a=4;break;case Oi.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==Dv.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const r=e/3;this._hasPalette=!0;const a=[];this._palette=a;for(let n=0;n<r;n++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const r=e,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let r=e,a=this.offset+this.byteOffset;if(a+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,a,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case Oi.GREYSCALE:case Oi.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let r=0;r<e/2;r++)this._transparency[r]=this.readUint16();break}case Oi.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let r=0;for(;r<e;r++){const a=this.readByte();this._palette[r].push(a)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case Oi.UNKNOWN:case Oi.GREYSCALE_ALPHA:case Oi.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const r=Kj(this),a=this.readUint8();if(a!==Dv.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const n=this.readBytes(e-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:Xq(n)}}decodepHYs(){const e=this.readUint32(),r=this.readUint32(),a=this.readByte();this._png.resolution={x:e,y:r,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const r={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(e);if(a){if(a.data=lS({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)r.data=a.data;else{const n=this._apng.frames.at(e-1);this.disposeFrame(a,n,r),this.addFrameDataToCanvas(r,a)}this._apng.frames.push(r)}}return this._apng}disposeFrame(e,r,a){switch(e.disposeOp){case Ap.NONE:break;case Ap.BACKGROUND:for(let n=0;n<this._png.height;n++)for(let s=0;s<this._png.width;s++){const l=(n*e.width+s)*this._png.channels;for(let c=0;c<this._png.channels;c++)a.data[l+c]=0}break;case Ap.PREVIOUS:a.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,r){const a=1<<this._png.depth,n=(s,l)=>{const c=((s+r.yOffset)*this._png.width+r.xOffset+l)*this._png.channels,f=(s*r.width+l)*this._png.channels;return{index:c,frameIndex:f}};switch(r.blendOp){case Lv.SOURCE:for(let s=0;s<r.height;s++)for(let l=0;l<r.width;l++){const{index:c,frameIndex:f}=n(s,l);for(let d=0;d<this._png.channels;d++)e.data[c+d]=r.data[f+d]}break;case Lv.OVER:for(let s=0;s<r.height;s++)for(let l=0;l<r.width;l++){const{index:c,frameIndex:f}=n(s,l);for(let d=0;d<this._png.channels;d++){const m=r.data[f+this._png.channels-1]/a,v=d%(this._png.channels-1)===0?1:r.data[f+d],x=Math.floor(m*v+(1-m)*e.data[c+d]);e.data[c+d]+=x}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==uS.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Fv.NO_INTERLACE)this._png.data=lS({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Fv.ADAM7)this._png.data=az({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,r=this._frames.at(-1);r?r.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Ap.NONE,blendOp:Lv.SOURCE,data:e}),this._inflator=new sS,this._writingDataChunks=!1}}function yz(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var fS;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(fS||(fS={}));function _z(t,e){return new xz(t,e).decode()}var jr=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function Pv(){jr.console&&typeof jr.console.log=="function"&&jr.console.log.apply(jr.console,arguments)}var Oa={log:Pv,warn:function(t){jr.console&&(typeof jr.console.warn=="function"?jr.console.warn.apply(jr.console,arguments):Pv.call(null,arguments))},error:function(t){jr.console&&(typeof jr.console.error=="function"?jr.console.error.apply(jr.console,arguments):Pv(t))}};function Mv(t,e,r){var a=new XMLHttpRequest;a.open("GET",t),a.responseType="blob",a.onload=function(){of(a.response,e,r)},a.onerror=function(){Oa.error("could not download file")},a.send()}function dS(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Cp(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var of=jr.saveAs||((typeof window>"u"?"undefined":va(window))!=="object"||window!==jr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var a=jr.URL||jr.webkitURL,n=document.createElement("a");e=e||t.name||"download",n.download=e,n.rel="noopener",typeof t=="string"?(n.href=t,n.origin!==location.origin?dS(n.href)?Mv(t,e,r):Cp(n,n.target="_blank"):Cp(n)):(n.href=a.createObjectURL(t),setTimeout(function(){a.revokeObjectURL(n.href)},4e4),setTimeout(function(){Cp(n)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(dS(t))Mv(t,e,r);else{var a=document.createElement("a");a.href=t,a.target="_blank",setTimeout(function(){Cp(a)})}else navigator.msSaveOrOpenBlob((function(n,s){return s===void 0?s={autoBom:!1}:va(s)!=="object"&&(Oa.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n})(t,r),e)}:function(t,e,r,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),typeof t=="string")return Mv(t,e,r);var n=t.type==="application/octet-stream",s=/constructor/i.test(jr.HTMLElement)||jr.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||n&&s)&&(typeof FileReader>"u"?"undefined":va(FileReader))==="object"){var c=new FileReader;c.onloadend=function(){var m=c.result;m=l?m:m.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=m:location=m,a=null},c.readAsDataURL(t)}else{var f=jr.URL||jr.webkitURL,d=f.createObjectURL(t);a?a.location=d:location.href=d,a=null,setTimeout(function(){f.revokeObjectURL(d)},4e4)}});function Jj(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(c){return[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(c){return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(c){return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]}}],a=0;a<r.length;a++){var n=r[a].re,s=r[a].process,l=n.exec(t);l&&(e=s(l),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var c=this.r.toString(16),f=this.g.toString(16),d=this.b.toString(16);return c.length==1&&(c="0"+c),f.length==1&&(f="0"+f),d.length==1&&(d="0"+d),"#"+c+f+d}}var Bp=jr.atob.bind(jr),hS=jr.btoa.bind(jr);function Iv(t,e){var r=t[0],a=t[1],n=t[2],s=t[3];r=Es(r,a,n,s,e[0],7,-680876936),s=Es(s,r,a,n,e[1],12,-389564586),n=Es(n,s,r,a,e[2],17,606105819),a=Es(a,n,s,r,e[3],22,-1044525330),r=Es(r,a,n,s,e[4],7,-176418897),s=Es(s,r,a,n,e[5],12,1200080426),n=Es(n,s,r,a,e[6],17,-1473231341),a=Es(a,n,s,r,e[7],22,-45705983),r=Es(r,a,n,s,e[8],7,1770035416),s=Es(s,r,a,n,e[9],12,-1958414417),n=Es(n,s,r,a,e[10],17,-42063),a=Es(a,n,s,r,e[11],22,-1990404162),r=Es(r,a,n,s,e[12],7,1804603682),s=Es(s,r,a,n,e[13],12,-40341101),n=Es(n,s,r,a,e[14],17,-1502002290),r=As(r,a=Es(a,n,s,r,e[15],22,1236535329),n,s,e[1],5,-165796510),s=As(s,r,a,n,e[6],9,-1069501632),n=As(n,s,r,a,e[11],14,643717713),a=As(a,n,s,r,e[0],20,-373897302),r=As(r,a,n,s,e[5],5,-701558691),s=As(s,r,a,n,e[10],9,38016083),n=As(n,s,r,a,e[15],14,-660478335),a=As(a,n,s,r,e[4],20,-405537848),r=As(r,a,n,s,e[9],5,568446438),s=As(s,r,a,n,e[14],9,-1019803690),n=As(n,s,r,a,e[3],14,-187363961),a=As(a,n,s,r,e[8],20,1163531501),r=As(r,a,n,s,e[13],5,-1444681467),s=As(s,r,a,n,e[2],9,-51403784),n=As(n,s,r,a,e[7],14,1735328473),r=Cs(r,a=As(a,n,s,r,e[12],20,-1926607734),n,s,e[5],4,-378558),s=Cs(s,r,a,n,e[8],11,-2022574463),n=Cs(n,s,r,a,e[11],16,1839030562),a=Cs(a,n,s,r,e[14],23,-35309556),r=Cs(r,a,n,s,e[1],4,-1530992060),s=Cs(s,r,a,n,e[4],11,1272893353),n=Cs(n,s,r,a,e[7],16,-155497632),a=Cs(a,n,s,r,e[10],23,-1094730640),r=Cs(r,a,n,s,e[13],4,681279174),s=Cs(s,r,a,n,e[0],11,-358537222),n=Cs(n,s,r,a,e[3],16,-722521979),a=Cs(a,n,s,r,e[6],23,76029189),r=Cs(r,a,n,s,e[9],4,-640364487),s=Cs(s,r,a,n,e[12],11,-421815835),n=Cs(n,s,r,a,e[15],16,530742520),r=Ts(r,a=Cs(a,n,s,r,e[2],23,-995338651),n,s,e[0],6,-198630844),s=Ts(s,r,a,n,e[7],10,1126891415),n=Ts(n,s,r,a,e[14],15,-1416354905),a=Ts(a,n,s,r,e[5],21,-57434055),r=Ts(r,a,n,s,e[12],6,1700485571),s=Ts(s,r,a,n,e[3],10,-1894986606),n=Ts(n,s,r,a,e[10],15,-1051523),a=Ts(a,n,s,r,e[1],21,-2054922799),r=Ts(r,a,n,s,e[8],6,1873313359),s=Ts(s,r,a,n,e[15],10,-30611744),n=Ts(n,s,r,a,e[6],15,-1560198380),a=Ts(a,n,s,r,e[13],21,1309151649),r=Ts(r,a,n,s,e[4],6,-145523070),s=Ts(s,r,a,n,e[11],10,-1120210379),n=Ts(n,s,r,a,e[2],15,718787259),a=Ts(a,n,s,r,e[9],21,-343485551),t[0]=pu(r,t[0]),t[1]=pu(a,t[1]),t[2]=pu(n,t[2]),t[3]=pu(s,t[3])}function T1(t,e,r,a,n,s){return e=pu(pu(e,t),pu(a,s)),pu(e<<n|e>>>32-n,r)}function Es(t,e,r,a,n,s,l){return T1(e&r|~e&a,t,e,n,s,l)}function As(t,e,r,a,n,s,l){return T1(e&a|r&~a,t,e,n,s,l)}function Cs(t,e,r,a,n,s,l){return T1(e^r^a,t,e,n,s,l)}function Ts(t,e,r,a,n,s,l){return T1(r^(e|~a),t,e,n,s,l)}function Zj(t){var e,r=t.length,a=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)Iv(a,bz(t.substring(e-64,e)));t=t.substring(e-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)n[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(n[e>>2]|=128<<(e%4<<3),e>55)for(Iv(a,n),e=0;e<16;e++)n[e]=0;return n[14]=8*r,Iv(a,n),a}function bz(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}var mS="0123456789abcdef".split("");function wz(t){for(var e="",r=0;r<4;r++)e+=mS[t>>8*r+4&15]+mS[t>>8*r&15];return e}function Sz(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Ux(t){return Zj(t).map(Sz).join("")}var Nz=(function(t){for(var e=0;e<t.length;e++)t[e]=wz(t[e]);return t.join("")})(Zj("hello"))!="5d41402abc4b2a76b9719d911017c592";function pu(t,e){if(Nz){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}function qx(t,e){var r,a,n,s;if(t!==r){for(var l=(n=t,s=1+(256/t.length|0),new Array(s+1).join(n)),c=[],f=0;f<256;f++)c[f]=f;var d=0;for(f=0;f<256;f++){var m=c[f];d=(d+m+l.charCodeAt(f))%256,c[f]=c[d],c[d]=m}r=t,a=c}else c=a;var v=e.length,x=0,g=0,b="";for(f=0;f<v;f++)g=(g+(m=c[x=(x+1)%256]))%256,c[x]=c[g],c[g]=m,l=c[(c[x]+c[g])%256],b+=String.fromCharCode(e.charCodeAt(f)^l);return b}var pS={print:4,modify:8,copy:16,"annot-forms":32};function Vd(t,e,r,a){this.v=1,this.r=2;var n=192;t.forEach(function(c){if(pS.perm!==void 0)throw new Error("Invalid permission: "+c);n+=pS[c]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(e+this.padding).substr(0,32),l=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,l),this.P=-(1+(255^n)),this.encryptionKey=Ux(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(a)).substr(0,5),this.U=qx(this.encryptionKey,this.padding)}function Gd(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,a=0;a<r;a++){var n=t.charCodeAt(a);e+=n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?"#"+("0"+n.toString(16)).slice(-2):t[a]}return e}function gS(t){if(va(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,a,n){if(n=n||!1,typeof r!="string"||typeof a!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var s=Math.random().toString(35);return e[r][s]=[a,!!n],s},this.unsubscribe=function(r){for(var a in e)if(e[a][r])return delete e[a][r],Object.keys(e[a]).length===0&&delete e[a],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var a=Array.prototype.slice.call(arguments,1),n=[];for(var s in e[r]){var l=e[r][s];try{l[0].apply(t,a)}catch(c){jr.console&&Oa.error("jsPDF PubSub Error",c.message,c)}l[1]&&n.push(s)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function f1(t){if(!(this instanceof f1))return new f1(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function Qj(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function df(t,e,r,a,n){if(!(this instanceof df))return new df(t,e,r,a,n);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,Qj.call(this,a,n)}function Xd(t,e,r,a,n){if(!(this instanceof Xd))return new Xd(t,e,r,a,n);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,Qj.call(this,a,n)}function lr(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",a=arguments[1],n=arguments[2],s=arguments[3],l=[],c=1,f=16,d="S",m=null;va(t=t||{})==="object"&&(r=t.orientation,a=t.unit||a,n=t.format||n,s=t.compress||t.compressPdf||s,(m=t.encryption||null)!==null&&(m.userPassword=m.userPassword||"",m.ownerPassword=m.ownerPassword||"",m.userPermissions=m.userPermissions||[]),c=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(f=t.floatPrecision),d=t.defaultPathOperation||"S"),l=t.filters||(s===!0?["FlateEncode"]:l),a=a||"mm",r=(""+(r||"P")).toLowerCase();var v=t.putOnlyUsedFonts||!1,x={},g={internal:{},__private__:{}};g.__private__.PubSub=gS;var b="1.3",_=g.__private__.getPdfVersion=function(){return b};g.__private__.setPdfVersion=function(R){b=R};var w={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};g.__private__.getPageFormats=function(){return w};var E=g.__private__.getPageFormat=function(R){return w[R]};n=n||"a4";var C="compat",A="advanced",T=C;function G(){this.saveGraphicsState(),de(new rr(qe,0,0,-qe,0,wo()*qe).toString()+" cm"),this.setFontSize(this.getFontSize()/qe),d="n",T=A}function W(){this.restoreGraphicsState(),d="S",T=C}var B=g.__private__.combineFontStyleAndFontWeight=function(R,Q){if(R=="bold"&&Q=="normal"||R=="bold"&&Q==400||R=="normal"&&Q=="italic"||R=="bold"&&Q=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Q&&(R=Q==400||Q==="normal"?R==="italic"?"italic":"normal":Q!=700&&Q!=="bold"||R!=="normal"?(Q==700?"bold":Q)+""+R:"bold"),R};g.advancedAPI=function(R){var Q=T===C;return Q&&G.call(this),typeof R!="function"||(R(this),Q&&W.call(this)),this},g.compatAPI=function(R){var Q=T===A;return Q&&W.call(this),typeof R!="function"||(R(this),Q&&G.call(this)),this},g.isAdvancedAPI=function(){return T===A};var q,L=function(R){if(T!==A)throw new Error(R+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},J=g.roundToPrecision=g.__private__.roundToPrecision=function(R,Q){var Ae=e||Q;if(isNaN(R)||isNaN(Ae))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return R.toFixed(Ae).replace(/0+$/,"")};q=g.hpf=g.__private__.hpf=typeof f=="number"?function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.hpf");return J(R,f)}:f==="smart"?function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.hpf");return J(R,R>-1&&R<1?16:5)}:function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.hpf");return J(R,16)};var D=g.f2=g.__private__.f2=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.f2");return J(R,2)},O=g.__private__.f3=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.f3");return J(R,3)},M=g.scale=g.__private__.scale=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.scale");return T===C?R*qe:T===A?R:void 0},V=function(R){return M((function(Q){return T===C?wo()-Q:T===A?Q:void 0})(R))};g.__private__.setPrecision=g.setPrecision=function(R){typeof parseInt(R,10)=="number"&&(e=parseInt(R,10))};var ie,X="00000000000000000000000000000000",Z=g.__private__.getFileId=function(){return X},K=g.__private__.setFileId=function(R){return X=R!==void 0&&/^[a-fA-F0-9]{32}$/.test(R)?R.toUpperCase():X.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),m!==null&&(xn=new Vd(m.userPermissions,m.userPassword,m.ownerPassword,X)),X};g.setFileId=function(R){return K(R),this},g.getFileId=function(){return Z()};var ae=g.__private__.convertDateToPDFDate=function(R){var Q=R.getTimezoneOffset(),Ae=Q<0?"+":"-",Oe=Math.floor(Math.abs(Q/60)),ze=Math.abs(Q%60),mt=[Ae,I(Oe),"'",I(ze),"'"].join("");return["D:",R.getFullYear(),I(R.getMonth()+1),I(R.getDate()),I(R.getHours()),I(R.getMinutes()),I(R.getSeconds()),mt].join("")},fe=g.__private__.convertPDFDateToDate=function(R){var Q=parseInt(R.substr(2,4),10),Ae=parseInt(R.substr(6,2),10)-1,Oe=parseInt(R.substr(8,2),10),ze=parseInt(R.substr(10,2),10),mt=parseInt(R.substr(12,2),10),_t=parseInt(R.substr(14,2),10);return new Date(Q,Ae,Oe,ze,mt,_t,0)},U=g.__private__.setCreationDate=function(R){var Q;if(R===void 0&&(R=new Date),R instanceof Date)Q=ae(R);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(R))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Q=R}return ie=Q},j=g.__private__.getCreationDate=function(R){var Q=ie;return R==="jsDate"&&(Q=fe(ie)),Q};g.setCreationDate=function(R){return U(R),this},g.getCreationDate=function(R){return j(R)};var F,I=g.__private__.padd2=function(R){return("0"+parseInt(R)).slice(-2)},z=g.__private__.padd2Hex=function(R){return("00"+(R=R.toString())).substr(R.length)},ne=0,se=[],pe=[],ye=0,_e=[],Le=[],ue=!1,at=pe;g.__private__.setCustomOutputDestination=function(R){ue=!0,at=R};var ht=function(R){ue||(at=R)};g.__private__.resetCustomOutputDestination=function(){ue=!1,at=pe};var de=g.__private__.out=function(R){return R=R.toString(),ye+=R.length+1,at.push(R),at},it=g.__private__.write=function(R){return de(arguments.length===1?R.toString():Array.prototype.join.call(arguments," "))},Se=g.__private__.getArrayBuffer=function(R){for(var Q=R.length,Ae=new ArrayBuffer(Q),Oe=new Uint8Array(Ae);Q--;)Oe[Q]=R.charCodeAt(Q);return Ae},ve=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];g.__private__.getStandardFonts=function(){return ve};var Ie=t.fontSize||16;g.__private__.setFontSize=g.setFontSize=function(R){return Ie=T===A?R/qe:R,this};var wt,Xe=g.__private__.getFontSize=g.getFontSize=function(){return T===C?Ie:Ie*qe},ct=t.R2L||!1;g.__private__.setR2L=g.setR2L=function(R){return ct=R,this},g.__private__.getR2L=g.getR2L=function(){return ct};var jt,Lt=g.__private__.setZoomMode=function(R){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(R))wt=R;else if(isNaN(R)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(R)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+R+'" is not recognized.');wt=R}else wt=parseInt(R,10)};g.__private__.getZoomMode=function(){return wt};var Vt,$t=g.__private__.setPageMode=function(R){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(R)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+R+'" is not recognized.');jt=R};g.__private__.getPageMode=function(){return jt};var Wt=g.__private__.setLayoutMode=function(R){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(R)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+R+'" is not recognized.');Vt=R};g.__private__.getLayoutMode=function(){return Vt},g.__private__.setDisplayMode=g.setDisplayMode=function(R,Q,Ae){return Lt(R),Wt(Q),$t(Ae),this};var Ot={title:"",subject:"",author:"",keywords:"",creator:""};g.__private__.getDocumentProperty=function(R){if(Object.keys(Ot).indexOf(R)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ot[R]},g.__private__.getDocumentProperties=function(){return Ot},g.__private__.setDocumentProperties=g.setProperties=g.setDocumentProperties=function(R){for(var Q in Ot)Ot.hasOwnProperty(Q)&&R[Q]&&(Ot[Q]=R[Q]);return this},g.__private__.setDocumentProperty=function(R,Q){if(Object.keys(Ot).indexOf(R)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ot[R]=Q};var kt,qe,Ye,Pt,Et,Dt={},Ce={},$e=[],xe={},Be={},Pe={},Ct={},gt=null,Rt=0,It=[],pr=new gS(g),sa=t.hotfixes||[],fa={},Nt={},Ea=[],rr=function R(Q,Ae,Oe,ze,mt,_t){if(!(this instanceof R))return new R(Q,Ae,Oe,ze,mt,_t);isNaN(Q)&&(Q=1),isNaN(Ae)&&(Ae=0),isNaN(Oe)&&(Oe=0),isNaN(ze)&&(ze=1),isNaN(mt)&&(mt=0),isNaN(_t)&&(_t=0),this._matrix=[Q,Ae,Oe,ze,mt,_t]};Object.defineProperty(rr.prototype,"sx",{get:function(){return this._matrix[0]},set:function(R){this._matrix[0]=R}}),Object.defineProperty(rr.prototype,"shy",{get:function(){return this._matrix[1]},set:function(R){this._matrix[1]=R}}),Object.defineProperty(rr.prototype,"shx",{get:function(){return this._matrix[2]},set:function(R){this._matrix[2]=R}}),Object.defineProperty(rr.prototype,"sy",{get:function(){return this._matrix[3]},set:function(R){this._matrix[3]=R}}),Object.defineProperty(rr.prototype,"tx",{get:function(){return this._matrix[4]},set:function(R){this._matrix[4]=R}}),Object.defineProperty(rr.prototype,"ty",{get:function(){return this._matrix[5]},set:function(R){this._matrix[5]=R}}),Object.defineProperty(rr.prototype,"a",{get:function(){return this._matrix[0]},set:function(R){this._matrix[0]=R}}),Object.defineProperty(rr.prototype,"b",{get:function(){return this._matrix[1]},set:function(R){this._matrix[1]=R}}),Object.defineProperty(rr.prototype,"c",{get:function(){return this._matrix[2]},set:function(R){this._matrix[2]=R}}),Object.defineProperty(rr.prototype,"d",{get:function(){return this._matrix[3]},set:function(R){this._matrix[3]=R}}),Object.defineProperty(rr.prototype,"e",{get:function(){return this._matrix[4]},set:function(R){this._matrix[4]=R}}),Object.defineProperty(rr.prototype,"f",{get:function(){return this._matrix[5]},set:function(R){this._matrix[5]=R}}),Object.defineProperty(rr.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(rr.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(rr.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(rr.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),rr.prototype.join=function(R){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(q).join(R)},rr.prototype.multiply=function(R){var Q=R.sx*this.sx+R.shy*this.shx,Ae=R.sx*this.shy+R.shy*this.sy,Oe=R.shx*this.sx+R.sy*this.shx,ze=R.shx*this.shy+R.sy*this.sy,mt=R.tx*this.sx+R.ty*this.shx+this.tx,_t=R.tx*this.shy+R.ty*this.sy+this.ty;return new rr(Q,Ae,Oe,ze,mt,_t)},rr.prototype.decompose=function(){var R=this.sx,Q=this.shy,Ae=this.shx,Oe=this.sy,ze=this.tx,mt=this.ty,_t=Math.sqrt(R*R+Q*Q),Qt=(R/=_t)*Ae+(Q/=_t)*Oe;Ae-=R*Qt,Oe-=Q*Qt;var sr=Math.sqrt(Ae*Ae+Oe*Oe);return Qt/=sr,R*(Oe/=sr)<Q*(Ae/=sr)&&(R=-R,Q=-Q,Qt=-Qt,_t=-_t),{scale:new rr(_t,0,0,sr,0,0),translate:new rr(1,0,0,1,ze,mt),rotate:new rr(R,Q,-Q,R,0,0),skew:new rr(1,0,Qt,1,0,0)}},rr.prototype.toString=function(R){return this.join(" ")},rr.prototype.inversed=function(){var R=this.sx,Q=this.shy,Ae=this.shx,Oe=this.sy,ze=this.tx,mt=this.ty,_t=1/(R*Oe-Q*Ae),Qt=Oe*_t,sr=-Q*_t,yr=-Ae*_t,kr=R*_t;return new rr(Qt,sr,yr,kr,-Qt*ze-yr*mt,-sr*ze-kr*mt)},rr.prototype.applyToPoint=function(R){var Q=R.x*this.sx+R.y*this.shx+this.tx,Ae=R.x*this.shy+R.y*this.sy+this.ty;return new Ks(Q,Ae)},rr.prototype.applyToRectangle=function(R){var Q=this.applyToPoint(R),Ae=this.applyToPoint(new Ks(R.x+R.w,R.y+R.h));return new vo(Q.x,Q.y,Ae.x-Q.x,Ae.y-Q.y)},rr.prototype.clone=function(){var R=this.sx,Q=this.shy,Ae=this.shx,Oe=this.sy,ze=this.tx,mt=this.ty;return new rr(R,Q,Ae,Oe,ze,mt)},g.Matrix=rr;var ya=g.matrixMult=function(R,Q){return Q.multiply(R)},vn=new rr(1,0,0,1,0,0);g.unitMatrix=g.identityMatrix=vn;var Da=function(R,Q){if(!Be[R]){var Ae=(Q instanceof df?"Sh":"P")+(Object.keys(xe).length+1).toString(10);Q.id=Ae,Be[R]=Ae,xe[Ae]=Q,pr.publish("addPattern",Q)}};g.ShadingPattern=df,g.TilingPattern=Xd,g.addShadingPattern=function(R,Q){return L("addShadingPattern()"),Da(R,Q),this},g.beginTilingPattern=function(R){L("beginTilingPattern()"),Ll(R.boundingBox[0],R.boundingBox[1],R.boundingBox[2]-R.boundingBox[0],R.boundingBox[3]-R.boundingBox[1],R.matrix)},g.endTilingPattern=function(R,Q){L("endTilingPattern()"),Q.stream=Le[F].join(`
`),Da(R,Q),pr.publish("endTilingPattern",Q),Ea.pop().restore()};var an,qt=g.__private__.newObject=function(){var R=Kt();return re(R,!0),R},Kt=g.__private__.newObjectDeferred=function(){return ne++,se[ne]=function(){return ye},ne},re=function(R,Q){return Q=typeof Q=="boolean"&&Q,se[R]=ye,Q&&de(R+" 0 obj"),R},Ne=g.__private__.newAdditionalObject=function(){var R={objId:Kt(),content:""};return _e.push(R),R},me=Kt(),ge=Kt(),we=g.__private__.decodeColorString=function(R){var Q=R.split(" ");if(Q.length!==2||Q[1]!=="g"&&Q[1]!=="G")Q.length!==5||Q[4]!=="k"&&Q[4]!=="K"||(Q=[(1-Q[0])*(1-Q[3]),(1-Q[1])*(1-Q[3]),(1-Q[2])*(1-Q[3]),"r"]);else{var Ae=parseFloat(Q[0]);Q=[Ae,Ae,Ae,"r"]}for(var Oe="#",ze=0;ze<3;ze++)Oe+=("0"+Math.floor(255*parseFloat(Q[ze])).toString(16)).slice(-2);return Oe},je=g.__private__.encodeColorString=function(R){var Q;typeof R=="string"&&(R={ch1:R});var Ae=R.ch1,Oe=R.ch2,ze=R.ch3,mt=R.ch4,_t=R.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Ae=="string"&&Ae.charAt(0)!=="#"){var Qt=new Jj(Ae);if(Qt.ok)Ae=Qt.toHex();else if(!/^\d*\.?\d*$/.test(Ae))throw new Error('Invalid color "'+Ae+'" passed to jsPDF.encodeColorString.')}if(typeof Ae=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Ae)&&(Ae="#"+Ae[1]+Ae[1]+Ae[2]+Ae[2]+Ae[3]+Ae[3]),typeof Ae=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Ae)){var sr=parseInt(Ae.substr(1),16);Ae=sr>>16&255,Oe=sr>>8&255,ze=255&sr}if(Oe===void 0||mt===void 0&&Ae===Oe&&Oe===ze)Q=typeof Ae=="string"?Ae+" "+_t[0]:R.precision===2?D(Ae/255)+" "+_t[0]:O(Ae/255)+" "+_t[0];else if(mt===void 0||va(mt)==="object"){if(mt&&!isNaN(mt.a)&&mt.a===0)return["1.","1.","1.",_t[1]].join(" ");Q=typeof Ae=="string"?[Ae,Oe,ze,_t[1]].join(" "):R.precision===2?[D(Ae/255),D(Oe/255),D(ze/255),_t[1]].join(" "):[O(Ae/255),O(Oe/255),O(ze/255),_t[1]].join(" ")}else Q=typeof Ae=="string"?[Ae,Oe,ze,mt,_t[2]].join(" "):R.precision===2?[D(Ae),D(Oe),D(ze),D(mt),_t[2]].join(" "):[O(Ae),O(Oe),O(ze),O(mt),_t[2]].join(" ");return Q},We=g.__private__.getFilters=function(){return l},st=g.__private__.putStream=function(R){var Q=(R=R||{}).data||"",Ae=R.filters||We(),Oe=R.alreadyAppliedFilters||[],ze=R.addLength1||!1,mt=Q.length,_t=R.objectId,Qt=function(yn){return yn};if(m!==null&&_t===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");m!==null&&(Qt=xn.encryptor(_t,0));var sr={};Ae===!0&&(Ae=["FlateEncode"]);var yr=R.additionalKeyValues||[],kr=(sr=lr.API.processDataByFilters!==void 0?lr.API.processDataByFilters(Q,Ae):{data:Q,reverseChain:[]}).reverseChain+(Array.isArray(Oe)?Oe.join(" "):Oe.toString());if(sr.data.length!==0&&(yr.push({key:"Length",value:sr.data.length}),ze===!0&&yr.push({key:"Length1",value:mt})),kr.length!=0)if(kr.split("/").length-1==1)yr.push({key:"Filter",value:kr});else{yr.push({key:"Filter",value:"["+kr+"]"});for(var $r=0;$r<yr.length;$r+=1)if(yr[$r].key==="DecodeParms"){for(var La=[],Xa=0;Xa<sr.reverseChain.split("/").length-1;Xa+=1)La.push("null");La.push(yr[$r].value),yr[$r].value="["+La.join(" ")+"]"}}de("<<");for(var _a=0;_a<yr.length;_a++)de("/"+yr[_a].key+" "+yr[_a].value);de(">>"),sr.data.length!==0&&(de("stream"),de(Qt(sr.data)),de("endstream"))},Ke=g.__private__.putPage=function(R){var Q=R.number,Ae=R.data,Oe=R.objId,ze=R.contentsObjId;re(Oe,!0),de("<</Type /Page"),de("/Parent "+R.rootDictionaryObjId+" 0 R"),de("/Resources "+R.resourceDictionaryObjId+" 0 R"),de("/MediaBox ["+parseFloat(q(R.mediaBox.bottomLeftX))+" "+parseFloat(q(R.mediaBox.bottomLeftY))+" "+q(R.mediaBox.topRightX)+" "+q(R.mediaBox.topRightY)+"]"),R.cropBox!==null&&de("/CropBox ["+q(R.cropBox.bottomLeftX)+" "+q(R.cropBox.bottomLeftY)+" "+q(R.cropBox.topRightX)+" "+q(R.cropBox.topRightY)+"]"),R.bleedBox!==null&&de("/BleedBox ["+q(R.bleedBox.bottomLeftX)+" "+q(R.bleedBox.bottomLeftY)+" "+q(R.bleedBox.topRightX)+" "+q(R.bleedBox.topRightY)+"]"),R.trimBox!==null&&de("/TrimBox ["+q(R.trimBox.bottomLeftX)+" "+q(R.trimBox.bottomLeftY)+" "+q(R.trimBox.topRightX)+" "+q(R.trimBox.topRightY)+"]"),R.artBox!==null&&de("/ArtBox ["+q(R.artBox.bottomLeftX)+" "+q(R.artBox.bottomLeftY)+" "+q(R.artBox.topRightX)+" "+q(R.artBox.topRightY)+"]"),typeof R.userUnit=="number"&&R.userUnit!==1&&de("/UserUnit "+R.userUnit),pr.publish("putPage",{objId:Oe,pageContext:It[Q],pageNumber:Q,page:Ae}),de("/Contents "+ze+" 0 R"),de(">>"),de("endobj");var mt=Ae.join(`
`);return T===A&&(mt+=`
Q`),re(ze,!0),st({data:mt,filters:We(),objectId:ze}),de("endobj"),Oe},Je=g.__private__.putPages=function(){var R,Q,Ae=[];for(R=1;R<=Rt;R++)It[R].objId=Kt(),It[R].contentsObjId=Kt();for(R=1;R<=Rt;R++)Ae.push(Ke({number:R,data:Le[R],objId:It[R].objId,contentsObjId:It[R].contentsObjId,mediaBox:It[R].mediaBox,cropBox:It[R].cropBox,bleedBox:It[R].bleedBox,trimBox:It[R].trimBox,artBox:It[R].artBox,userUnit:It[R].userUnit,rootDictionaryObjId:me,resourceDictionaryObjId:ge}));re(me,!0),de("<</Type /Pages");var Oe="/Kids [";for(Q=0;Q<Rt;Q++)Oe+=Ae[Q]+" 0 R ";de(Oe+"]"),de("/Count "+Rt),de(">>"),de("endobj"),pr.publish("postPutPages")},Qe=function(R){pr.publish("putFont",{font:R,out:de,newObject:qt,putStream:st}),R.isAlreadyPutted!==!0&&(R.objectNumber=qt(),de("<<"),de("/Type /Font"),de("/BaseFont /"+Gd(R.postScriptName)),de("/Subtype /Type1"),typeof R.encoding=="string"&&de("/Encoding /"+R.encoding),de("/FirstChar 32"),de("/LastChar 255"),de(">>"),de("endobj"))},St=function(R){R.objectNumber=qt();var Q=[];Q.push({key:"Type",value:"/XObject"}),Q.push({key:"Subtype",value:"/Form"}),Q.push({key:"BBox",value:"["+[q(R.x),q(R.y),q(R.x+R.width),q(R.y+R.height)].join(" ")+"]"}),Q.push({key:"Matrix",value:"["+R.matrix.toString()+"]"});var Ae=R.pages[1].join(`
`);st({data:Ae,additionalKeyValues:Q,objectId:R.objectNumber}),de("endobj")},Ft=function(R,Q){Q||(Q=21);var Ae=qt(),Oe=(function(_t,Qt){var sr,yr=[],kr=1/(Qt-1);for(sr=0;sr<1;sr+=kr)yr.push(sr);if(yr.push(1),_t[0].offset!=0){var $r={offset:0,color:_t[0].color};_t.unshift($r)}if(_t[_t.length-1].offset!=1){var La={offset:1,color:_t[_t.length-1].color};_t.push(La)}for(var Xa="",_a=0,yn=0;yn<yr.length;yn++){for(sr=yr[yn];sr>_t[_a+1].offset;)_a++;var sn=_t[_a].offset,Un=(sr-sn)/(_t[_a+1].offset-sn),So=_t[_a].color,bi=_t[_a+1].color;Xa+=z(Math.round((1-Un)*So[0]+Un*bi[0]).toString(16))+z(Math.round((1-Un)*So[1]+Un*bi[1]).toString(16))+z(Math.round((1-Un)*So[2]+Un*bi[2]).toString(16))}return Xa.trim()})(R.colors,Q),ze=[];ze.push({key:"FunctionType",value:"0"}),ze.push({key:"Domain",value:"[0.0 1.0]"}),ze.push({key:"Size",value:"["+Q+"]"}),ze.push({key:"BitsPerSample",value:"8"}),ze.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ze.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),st({data:Oe,additionalKeyValues:ze,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Ae}),de("endobj"),R.objectNumber=qt(),de("<< /ShadingType "+R.type),de("/ColorSpace /DeviceRGB");var mt="/Coords ["+q(parseFloat(R.coords[0]))+" "+q(parseFloat(R.coords[1]))+" ";R.type===2?mt+=q(parseFloat(R.coords[2]))+" "+q(parseFloat(R.coords[3])):mt+=q(parseFloat(R.coords[2]))+" "+q(parseFloat(R.coords[3]))+" "+q(parseFloat(R.coords[4]))+" "+q(parseFloat(R.coords[5])),de(mt+="]"),R.matrix&&de("/Matrix ["+R.matrix.toString()+"]"),de("/Function "+Ae+" 0 R"),de("/Extend [true true]"),de(">>"),de("endobj")},Ht=function(R,Q){var Ae=Kt(),Oe=qt();Q.push({resourcesOid:Ae,objectOid:Oe}),R.objectNumber=Oe;var ze=[];ze.push({key:"Type",value:"/Pattern"}),ze.push({key:"PatternType",value:"1"}),ze.push({key:"PaintType",value:"1"}),ze.push({key:"TilingType",value:"1"}),ze.push({key:"BBox",value:"["+R.boundingBox.map(q).join(" ")+"]"}),ze.push({key:"XStep",value:q(R.xStep)}),ze.push({key:"YStep",value:q(R.yStep)}),ze.push({key:"Resources",value:Ae+" 0 R"}),R.matrix&&ze.push({key:"Matrix",value:"["+R.matrix.toString()+"]"}),st({data:R.stream,additionalKeyValues:ze,objectId:R.objectNumber}),de("endobj")},Tt=function(R){for(var Q in R.objectNumber=qt(),de("<<"),R)switch(Q){case"opacity":de("/ca "+D(R[Q]));break;case"stroke-opacity":de("/CA "+D(R[Q]))}de(">>"),de("endobj")},Bt=function(R){re(R.resourcesOid,!0),de("<<"),de("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var Q in de("/Font <<"),Dt)Dt.hasOwnProperty(Q)&&(v===!1||v===!0&&x.hasOwnProperty(Q))&&de("/"+Q+" "+Dt[Q].objectNumber+" 0 R");de(">>")})(),(function(){if(Object.keys(xe).length>0){for(var Q in de("/Shading <<"),xe)xe.hasOwnProperty(Q)&&xe[Q]instanceof df&&xe[Q].objectNumber>=0&&de("/"+Q+" "+xe[Q].objectNumber+" 0 R");pr.publish("putShadingPatternDict"),de(">>")}})(),(function(Q){if(Object.keys(xe).length>0){for(var Ae in de("/Pattern <<"),xe)xe.hasOwnProperty(Ae)&&xe[Ae]instanceof g.TilingPattern&&xe[Ae].objectNumber>=0&&xe[Ae].objectNumber<Q&&de("/"+Ae+" "+xe[Ae].objectNumber+" 0 R");pr.publish("putTilingPatternDict"),de(">>")}})(R.objectOid),(function(){if(Object.keys(Pe).length>0){var Q;for(Q in de("/ExtGState <<"),Pe)Pe.hasOwnProperty(Q)&&Pe[Q].objectNumber>=0&&de("/"+Q+" "+Pe[Q].objectNumber+" 0 R");pr.publish("putGStateDict"),de(">>")}})(),(function(){for(var Q in de("/XObject <<"),fa)fa.hasOwnProperty(Q)&&fa[Q].objectNumber>=0&&de("/"+Q+" "+fa[Q].objectNumber+" 0 R");pr.publish("putXobjectDict"),de(">>")})(),de(">>"),de("endobj")},Jt=function(R){Ce[R.fontName]=Ce[R.fontName]||{},Ce[R.fontName][R.fontStyle]=R.id},ia=function(R,Q,Ae,Oe,ze){var mt={id:"F"+(Object.keys(Dt).length+1).toString(10),postScriptName:R,fontName:Q,fontStyle:Ae,encoding:Oe,isStandardFont:ze||!1,metadata:{}};return pr.publish("addFont",{font:mt,instance:this}),Dt[mt.id]=mt,Jt(mt),mt.id},Lr=g.__private__.pdfEscape=g.pdfEscape=function(R,Q){return(function(Ae,Oe){var ze,mt,_t,Qt,sr,yr,kr,$r,La;if(_t=(Oe=Oe||{}).sourceEncoding||"Unicode",sr=Oe.outputEncoding,(Oe.autoencode||sr)&&Dt[kt].metadata&&Dt[kt].metadata[_t]&&Dt[kt].metadata[_t].encoding&&(Qt=Dt[kt].metadata[_t].encoding,!sr&&Dt[kt].encoding&&(sr=Dt[kt].encoding),!sr&&Qt.codePages&&(sr=Qt.codePages[0]),typeof sr=="string"&&(sr=Qt[sr]),sr)){for(kr=!1,yr=[],ze=0,mt=Ae.length;ze<mt;ze++)($r=sr[Ae.charCodeAt(ze)])?yr.push(String.fromCharCode($r)):yr.push(Ae[ze]),yr[ze].charCodeAt(0)>>8&&(kr=!0);Ae=yr.join("")}for(ze=Ae.length;kr===void 0&&ze!==0;)Ae.charCodeAt(ze-1)>>8&&(kr=!0),ze--;if(!kr)return Ae;for(yr=Oe.noBOM?[]:[254,255],ze=0,mt=Ae.length;ze<mt;ze++){if((La=($r=Ae.charCodeAt(ze))>>8)>>8)throw new Error("Character at position "+ze+" of string '"+Ae+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");yr.push(La),yr.push($r-(La<<8))}return String.fromCharCode.apply(void 0,yr)})(R,Q).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ua=g.__private__.beginPage=function(R){Le[++Rt]=[],It[Rt]={objId:0,contentsObjId:0,userUnit:Number(c),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(R[0]),topRightY:Number(R[1])}},vi(Rt),ht(Le[F])},ls=function(R,Q){var Ae,Oe,ze;switch(r=Q||r,typeof R=="string"&&(Ae=E(R.toLowerCase()),Array.isArray(Ae)&&(Oe=Ae[0],ze=Ae[1])),Array.isArray(R)&&(Oe=R[0]*qe,ze=R[1]*qe),isNaN(Oe)&&(Oe=n[0],ze=n[1]),(Oe>14400||ze>14400)&&(Oa.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Oe=Math.min(14400,Oe),ze=Math.min(14400,ze)),n=[Oe,ze],r.substr(0,1)){case"l":ze>Oe&&(n=[ze,Oe]);break;case"p":Oe>ze&&(n=[ze,Oe])}ua(n),gr(Rl),de(Us),jc!==0&&de(jc+" J"),Tn!==0&&de(Tn+" j"),pr.publish("addPage",{pageNumber:Rt})},gi=function(R){R>0&&R<=Rt&&(Le.splice(R,1),It.splice(R,1),Rt--,F>Rt&&(F=Rt),this.setPage(F))},vi=function(R){R>0&&R<=Rt&&(F=R)},Is=g.__private__.getNumberOfPages=g.getNumberOfPages=function(){return Le.length-1},el=function(R,Q,Ae){var Oe,ze=void 0;return Ae=Ae||{},R=R!==void 0?R:Dt[kt].fontName,Q=Q!==void 0?Q:Dt[kt].fontStyle,Oe=R.toLowerCase(),Ce[Oe]!==void 0&&Ce[Oe][Q]!==void 0?ze=Ce[Oe][Q]:Ce[R]!==void 0&&Ce[R][Q]!==void 0?ze=Ce[R][Q]:Ae.disableWarning===!1&&Oa.warn("Unable to look up font label for font '"+R+"', '"+Q+"'. Refer to getFontList() for available fonts."),ze||Ae.noFallback||(ze=Ce.times[Q])==null&&(ze=Ce.times.normal),ze},Fa=g.__private__.putInfo=function(){var R=qt(),Q=function(Oe){return Oe};for(var Ae in m!==null&&(Q=xn.encryptor(R,0)),de("<<"),de("/Producer ("+Lr(Q("jsPDF "+lr.version))+")"),Ot)Ot.hasOwnProperty(Ae)&&Ot[Ae]&&de("/"+Ae.substr(0,1).toUpperCase()+Ae.substr(1)+" ("+Lr(Q(Ot[Ae]))+")");de("/CreationDate ("+Lr(Q(ie))+")"),de(">>"),de("endobj")},po=g.__private__.putCatalog=function(R){var Q=(R=R||{}).rootDictionaryObjId||me;switch(qt(),de("<<"),de("/Type /Catalog"),de("/Pages "+Q+" 0 R"),wt||(wt="fullwidth"),wt){case"fullwidth":de("/OpenAction [3 0 R /FitH null]");break;case"fullheight":de("/OpenAction [3 0 R /FitV null]");break;case"fullpage":de("/OpenAction [3 0 R /Fit]");break;case"original":de("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Ae=""+wt;Ae.substr(Ae.length-1)==="%"&&(wt=parseInt(wt)/100),typeof wt=="number"&&de("/OpenAction [3 0 R /XYZ null null "+D(wt)+"]")}switch(Vt||(Vt="continuous"),Vt){case"continuous":de("/PageLayout /OneColumn");break;case"single":de("/PageLayout /SinglePage");break;case"two":case"twoleft":de("/PageLayout /TwoColumnLeft");break;case"tworight":de("/PageLayout /TwoColumnRight")}jt&&de("/PageMode /"+jt),pr.publish("putCatalog"),de(">>"),de("endobj")},xi=g.__private__.putTrailer=function(){de("trailer"),de("<<"),de("/Size "+(ne+1)),de("/Root "+ne+" 0 R"),de("/Info "+(ne-1)+" 0 R"),m!==null&&de("/Encrypt "+xn.oid+" 0 R"),de("/ID [ <"+X+"> <"+X+"> ]"),de(">>")},Jr=g.__private__.putHeader=function(){de("%PDF-"+b),de("%")},ku=g.__private__.putXRef=function(){var R="0000000000";de("xref"),de("0 "+(ne+1)),de("0000000000 65535 f ");for(var Q=1;Q<=ne;Q++)typeof se[Q]=="function"?de((R+se[Q]()).slice(-10)+" 00000 n "):se[Q]!==void 0?de((R+se[Q]).slice(-10)+" 00000 n "):de("0000000000 00000 n ")},zi=g.__private__.buildDocument=function(){var R;ne=0,ye=0,pe=[],se=[],_e=[],me=Kt(),ge=Kt(),ht(pe),pr.publish("buildDocument"),Jr(),Je(),(function(){pr.publish("putAdditionalObjects");for(var Ae=0;Ae<_e.length;Ae++){var Oe=_e[Ae];re(Oe.objId,!0),de(Oe.content),de("endobj")}pr.publish("postPutAdditionalObjects")})(),R=[],(function(){for(var Ae in Dt)Dt.hasOwnProperty(Ae)&&(v===!1||v===!0&&x.hasOwnProperty(Ae))&&Qe(Dt[Ae])})(),(function(){var Ae;for(Ae in Pe)Pe.hasOwnProperty(Ae)&&Tt(Pe[Ae])})(),(function(){for(var Ae in fa)fa.hasOwnProperty(Ae)&&St(fa[Ae])})(),(function(Ae){var Oe;for(Oe in xe)xe.hasOwnProperty(Oe)&&(xe[Oe]instanceof df?Ft(xe[Oe]):xe[Oe]instanceof Xd&&Ht(xe[Oe],Ae))})(R),pr.publish("putResources"),R.forEach(Bt),Bt({resourcesOid:ge,objectOid:Number.MAX_SAFE_INTEGER}),pr.publish("postPutResources"),m!==null&&(xn.oid=qt(),de("<<"),de("/Filter /Standard"),de("/V "+xn.v),de("/R "+xn.r),de("/U <"+xn.toHexString(xn.U)+">"),de("/O <"+xn.toHexString(xn.O)+">"),de("/P "+xn.P),de(">>"),de("endobj")),Fa(),po();var Q=ye;return ku(),xi(),de("startxref"),de(""+Q),de("%%EOF"),ht(Le[F]),pe.join(`
`)},tl=g.__private__.getBlob=function(R){return new Blob([Se(R)],{type:"application/pdf"})},Eu=g.output=g.__private__.output=(an=function(R,Q){switch(typeof(Q=Q||{})=="string"?Q={filename:Q}:Q.filename=Q.filename||"generated.pdf",R){case void 0:return zi();case"save":g.save(Q.filename);break;case"arraybuffer":return Se(zi());case"blob":return tl(zi());case"bloburi":case"bloburl":if(jr.URL!==void 0&&typeof jr.URL.createObjectURL=="function")return jr.URL&&jr.URL.createObjectURL(tl(zi()))||void 0;Oa.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Ae="",Oe=zi();try{Ae=hS(Oe)}catch{Ae=hS(unescape(encodeURIComponent(Oe)))}return"data:application/pdf;filename="+Q.filename+";base64,"+Ae;case"pdfobjectnewwindow":if(Object.prototype.toString.call(jr)==="[object Window]"){var ze="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",mt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Q.pdfObjectUrl&&(ze=Q.pdfObjectUrl,mt="");var _t='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ze+'"'+mt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Q)+");<\/script></body></html>",Qt=jr.open();return Qt!==null&&Qt.document.write(_t),Qt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(jr)==="[object Window]"){var sr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Q.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Q.filename+'" width="500px" height="400px" /></body></html>',yr=jr.open();if(yr!==null){yr.document.write(sr);var kr=this;yr.document.documentElement.querySelector("#pdfViewer").onload=function(){yr.document.title=Q.filename,yr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(kr.output("bloburl"))}}return yr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(jr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var $r='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Q)+'"></iframe></body></html>',La=jr.open();if(La!==null&&(La.document.write($r),La.document.title=Q.filename),La||typeof safari>"u")return La;break;case"datauri":case"dataurl":return jr.document.location.href=this.output("datauristring",Q);default:return null}},an.foo=function(){try{return an.apply(this,arguments)}catch(Ae){var R=Ae.stack||"";~R.indexOf(" at ")&&(R=R.split(" at ")[1]);var Q="Error in function "+R.split(`
`)[0].split("<")[0]+": "+Ae.message;if(!jr.console)throw new Error(Q);jr.console.error(Q,Ae),jr.alert&&alert(Q)}},an.foo.bar=an,an.foo),cs=function(R){return Array.isArray(sa)===!0&&sa.indexOf(R)>-1};switch(a){case"pt":qe=1;break;case"mm":qe=72/25.4;break;case"cm":qe=72/2.54;break;case"in":qe=72;break;case"px":qe=cs("px_scaling")==1?.75:96/72;break;case"pc":case"em":qe=12;break;case"ex":qe=6;break;default:if(typeof a!="number")throw new Error("Invalid unit: "+a);qe=a}var xn=null;U(),K();var nn=g.__private__.getPageInfo=g.getPageInfo=function(R){if(isNaN(R)||R%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:It[R].objId,pageNumber:R,pageContext:It[R]}},Sc=g.__private__.getPageInfoByObjId=function(R){if(isNaN(R)||R%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Q in It)if(It[Q].objId===R)break;return nn(Q)},qf=g.__private__.getCurrentPageInfo=g.getCurrentPageInfo=function(){return{objId:It[F].objId,pageNumber:F,pageContext:It[F]}};g.addPage=function(){return ls.apply(this,arguments),this},g.setPage=function(){return vi.apply(this,arguments),ht.call(this,Le[F]),this},g.insertPage=function(R){return this.addPage(),this.movePage(F,R),this},g.movePage=function(R,Q){var Ae,Oe;if(R>Q){Ae=Le[R],Oe=It[R];for(var ze=R;ze>Q;ze--)Le[ze]=Le[ze-1],It[ze]=It[ze-1];Le[Q]=Ae,It[Q]=Oe,this.setPage(Q)}else if(R<Q){Ae=Le[R],Oe=It[R];for(var mt=R;mt<Q;mt++)Le[mt]=Le[mt+1],It[mt]=It[mt+1];Le[Q]=Ae,It[Q]=Oe,this.setPage(Q)}return this},g.deletePage=function(){return gi.apply(this,arguments),this},g.__private__.text=g.text=function(R,Q,Ae,Oe,ze){var mt,_t,Qt,sr,yr,kr,$r,La,Xa,_a=(Oe=Oe||{}).scope||this;if(typeof R=="number"&&typeof Q=="number"&&(typeof Ae=="string"||Array.isArray(Ae))){var yn=Ae;Ae=Q,Q=R,R=yn}if(arguments[3]instanceof rr==0?(Qt=arguments[4],sr=arguments[5],va($r=arguments[3])==="object"&&$r!==null||(typeof Qt=="string"&&(sr=Qt,Qt=null),typeof $r=="string"&&(sr=$r,$r=null),typeof $r=="number"&&(Qt=$r,$r=null),Oe={flags:$r,angle:Qt,align:sr})):(L("The transform parameter of text() with a Matrix value"),Xa=ze),isNaN(Q)||isNaN(Ae)||R==null)throw new Error("Invalid arguments passed to jsPDF.text");if(R.length===0)return _a;var sn,Un="",So=typeof Oe.lineHeightFactor=="number"?Oe.lineHeightFactor:go,bi=_a.internal.scaleFactor;function No(Zr){return Zr=Zr.split("	").join(Array(Oe.TabLen||9).join(" ")),Lr(Zr,$r)}function Pu(Zr){for(var Wr,ba=Zr.concat(),Ja=[],Zi=ba.length;Zi--;)typeof(Wr=ba.shift())=="string"?Ja.push(Wr):Array.isArray(Zr)&&(Wr.length===1||Wr[1]===void 0&&Wr[2]===void 0)?Ja.push(Wr[0]):Ja.push([Wr[0],Wr[1],Wr[2]]);return Ja}function Ec(Zr,Wr){var ba;if(typeof Zr=="string")ba=Wr(Zr)[0];else if(Array.isArray(Zr)){for(var Ja,Zi,ji=Zr.concat(),Bl=[],Bu=ji.length;Bu--;)typeof(Ja=ji.shift())=="string"?Bl.push(Wr(Ja)[0]):Array.isArray(Ja)&&typeof Ja[0]=="string"&&(Zi=Wr(Ja[0],Ja[1],Ja[2]),Bl.push([Zi[0],Zi[1],Zi[2]]));ba=Bl}return ba}var Wi=!1,wi=!0;if(typeof R=="string")Wi=!0;else if(Array.isArray(R)){var Ml=R.concat();_t=[];for(var jo,On=Ml.length;On--;)(typeof(jo=Ml.shift())!="string"||Array.isArray(jo)&&typeof jo[0]!="string")&&(wi=!1);Wi=wi}if(Wi===!1)throw new Error('Type of text must be string or Array. "'+R+'" is not recognized.');typeof R=="string"&&(R=R.match(/[\r?\n]/)?R.split(/\r\n|\r|\n/g):[R]);var al=Ie/_a.internal.scaleFactor,nl=al*(So-1);switch(Oe.baseline){case"bottom":Ae-=nl;break;case"top":Ae+=al-nl;break;case"hanging":Ae+=al-2*nl;break;case"middle":Ae+=al/2-nl}if((kr=Oe.maxWidth||0)>0&&(typeof R=="string"?R=_a.splitTextToSize(R,kr):Object.prototype.toString.call(R)==="[object Array]"&&(R=R.reduce(function(Zr,Wr){return Zr.concat(_a.splitTextToSize(Wr,kr))},[]))),mt={text:R,x:Q,y:Ae,options:Oe,mutex:{pdfEscape:Lr,activeFontKey:kt,fonts:Dt,activeFontSize:Ie}},pr.publish("preProcessText",mt),R=mt.text,Qt=(Oe=mt.options).angle,Xa instanceof rr==0&&Qt&&typeof Qt=="number"){Qt*=Math.PI/180,Oe.rotationDirection===0&&(Qt=-Qt),T===A&&(Qt=-Qt);var Ac=Math.cos(Qt),Vi=Math.sin(Qt);Xa=new rr(Ac,Vi,-Vi,Ac,0,0)}else Qt&&Qt instanceof rr&&(Xa=Qt);T!==A||Xa||(Xa=vn),(yr=Oe.charSpace||Xs)!==void 0&&(Un+=q(M(yr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(La=Oe.horizontalScale)!==void 0&&(Un+=q(100*La)+` Tz
`),Oe.lang;var fs=-1,ko=Oe.renderingMode!==void 0?Oe.renderingMode:Oe.stroke,Cc=_a.internal.getCurrentPageInfo().pageContext;switch(ko){case 0:case!1:case"fill":fs=0;break;case 1:case!0:case"stroke":fs=1;break;case 2:case"fillThenStroke":fs=2;break;case 3:case"invisible":fs=3;break;case 4:case"fillAndAddForClipping":fs=4;break;case 5:case"strokeAndAddPathForClipping":fs=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":fs=6;break;case 7:case"addToPathForClipping":fs=7}var Mu=Cc.usedRenderingMode!==void 0?Cc.usedRenderingMode:-1;fs!==-1?Un+=fs+` Tr
`:Mu!==-1&&(Un+=`0 Tr
`),fs!==-1&&(Cc.usedRenderingMode=fs),sr=Oe.align||"left";var qs,Si=Ie*So,Eo=_a.internal.pageSize.getWidth(),Iu=Dt[kt];yr=Oe.charSpace||Xs,kr=Oe.maxWidth||0,$r=Object.assign({autoencode:!0,noBOM:!0},Oe.flags);var Ni=[],sl=function(Zr){return _a.getStringUnitWidth(Zr,{font:Iu,charSpace:yr,fontSize:Ie,doKerning:!1})*Ie/bi};if(Object.prototype.toString.call(R)==="[object Array]"){var ws;_t=Pu(R),sr!=="left"&&(qs=_t.map(sl));var ds,Gi=0;if(sr==="right"){Q-=qs[0],R=[],On=_t.length;for(var Yi=0;Yi<On;Yi++)Yi===0?(ds=Bs(Q),ws=Bn(Ae)):(ds=M(Gi-qs[Yi]),ws=-Si),R.push([_t[Yi],ds,ws]),Gi=qs[Yi]}else if(sr==="center"){Q-=qs[0]/2,R=[],On=_t.length;for(var Ao=0;Ao<On;Ao++)Ao===0?(ds=Bs(Q),ws=Bn(Ae)):(ds=M((Gi-qs[Ao])/2),ws=-Si),R.push([_t[Ao],ds,ws]),Gi=qs[Ao]}else if(sr==="left"){R=[],On=_t.length;for(var Tc=0;Tc<On;Tc++)R.push(_t[Tc])}else if(sr==="justify"&&Iu.encoding==="Identity-H"){R=[],On=_t.length,kr=kr!==0?kr:Eo;for(var Oc=0,Ka=0;Ka<On;Ka++)if(ws=Ka===0?Bn(Ae):-Si,ds=Ka===0?Bs(Q):Oc,Ka<On-1){var Kf=M((kr-qs[Ka])/(_t[Ka].split(" ").length-1)),Xi=_t[Ka].split(" ");R.push([Xi[0]+" ",ds,ws]),Oc=0;for(var Ki=1;Ki<Xi.length;Ki++){var qn=(sl(Xi[Ki-1]+" "+Xi[Ki])-sl(Xi[Ki]))*bi+Kf;Ki==Xi.length-1?R.push([Xi[Ki],qn,0]):R.push([Xi[Ki]+" ",qn,0]),Oc-=qn}}else R.push([_t[Ka],ds,ws]);R.push(["",Oc,0])}else{if(sr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(R=[],On=_t.length,kr=kr!==0?kr:Eo,Ka=0;Ka<On;Ka++){ws=Ka===0?Bn(Ae):-Si,ds=Ka===0?Bs(Q):0;var Co=_t[Ka].split(" ").length-1,Rc=Co>0?(kr-qs[Ka])/Co:0;Ka<On-1?Ni.push(q(M(Rc))):Ni.push(0),R.push([_t[Ka],ds,ws])}}}(typeof Oe.R2L=="boolean"?Oe.R2L:ct)===!0&&(R=Ec(R,function(Zr,Wr,ba){return[Zr.split("").reverse().join(""),Wr,ba]})),mt={text:R,x:Q,y:Ae,options:Oe,mutex:{pdfEscape:Lr,activeFontKey:kt,fonts:Dt,activeFontSize:Ie}},pr.publish("postProcessText",mt),R=mt.text,sn=mt.mutex.isHex||!1;var Dc=Dt[kt].encoding;Dc!=="WinAnsiEncoding"&&Dc!=="StandardEncoding"||(R=Ec(R,function(Zr,Wr,ba){return[No(Zr),Wr,ba]})),_t=Pu(R),R=[];for(var To,Oo,Ji,Il=Array.isArray(_t[0])?1:0,zs="",Ro=function(Zr,Wr,ba){var Ja="";return ba instanceof rr?(ba=typeof Oe.angle=="number"?ya(ba,new rr(1,0,0,1,Zr,Wr)):ya(new rr(1,0,0,1,Zr,Wr),ba),T===A&&(ba=ya(new rr(1,0,0,-1,0,0),ba)),Ja=ba.join(" ")+` Tm
`):Ja=q(Zr)+" "+q(Wr)+` Td
`,Ja},Zn=0;Zn<_t.length;Zn++){switch(zs="",Il){case 1:Ji=(sn?"<":"(")+_t[Zn][0]+(sn?">":")"),To=parseFloat(_t[Zn][1]),Oo=parseFloat(_t[Zn][2]);break;case 0:Ji=(sn?"<":"(")+_t[Zn]+(sn?">":")"),To=Bs(Q),Oo=Bn(Ae)}Ni!==void 0&&Ni[Zn]!==void 0&&(zs=Ni[Zn]+` Tw
`),Zn===0?R.push(zs+Ro(To,Oo,Xa)+Ji):Il===0?R.push(zs+Ji):Il===1&&R.push(zs+Ro(To,Oo,Xa)+Ji)}R=Il===0?R.join(` Tj
T* `):R.join(` Tj
`),R+=` Tj
`;var Js=`BT
/`;return Js+=kt+" "+Ie+` Tf
`,Js+=q(Ie*So)+` TL
`,Js+=Hi+`
`,Js+=Un,Js+=R,de(Js+="ET"),x[kt]=!0,_a};var Au=g.__private__.clip=g.clip=function(R){return de(R==="evenodd"?"W*":"W"),this};g.clipEvenOdd=function(){return Au("evenodd")},g.__private__.discardPath=g.discardPath=function(){return de("n"),this};var us=g.__private__.isValidStyle=function(R){var Q=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(R)!==-1&&(Q=!0),Q};g.__private__.setDefaultPathOperation=g.setDefaultPathOperation=function(R){return us(R)&&(d=R),this};var Cu=g.__private__.getStyle=g.getStyle=function(R){var Q=d;switch(R){case"D":case"S":Q="S";break;case"F":Q="f";break;case"FD":case"DF":Q="B";break;case"f":case"f*":case"B":case"B*":Q=R}return Q},Tu=g.close=function(){return de("h"),this};g.stroke=function(){return de("S"),this},g.fill=function(R){return yi("f",R),this},g.fillEvenOdd=function(R){return yi("f*",R),this},g.fillStroke=function(R){return yi("B",R),this},g.fillStrokeEvenOdd=function(R){return yi("B*",R),this};var yi=function(R,Q){va(Q)==="object"?Hf(Q,R):de(R)},Ol=function(R){R===null||T===A&&R===void 0||(R=Cu(R),de(R))};function zf(R,Q,Ae,Oe,ze){var mt=new Xd(Q||this.boundingBox,Ae||this.xStep,Oe||this.yStep,this.gState,ze||this.matrix);mt.stream=this.stream;var _t=R+"$$"+this.cloneIndex+++"$$";return Da(_t,mt),mt}var Hf=function(R,Q){var Ae=Be[R.key],Oe=xe[Ae];if(Oe instanceof df)de("q"),de(Ou(Q)),Oe.gState&&g.setGState(Oe.gState),de(R.matrix.toString()+" cm"),de("/"+Ae+" sh"),de("Q");else if(Oe instanceof Xd){var ze=new rr(1,0,0,-1,0,wo());R.matrix&&(ze=ze.multiply(R.matrix||vn),Ae=zf.call(Oe,R.key,R.boundingBox,R.xStep,R.yStep,ze).id),de("q"),de("/Pattern cs"),de("/"+Ae+" scn"),Oe.gState&&g.setGState(Oe.gState),de(Q),de("Q")}},Ou=function(R){switch(R){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Ru=g.moveTo=function(R,Q){return de(q(M(R))+" "+q(V(Q))+" m"),this},$f=g.lineTo=function(R,Q){return de(q(M(R))+" "+q(V(Q))+" l"),this},bs=g.curveTo=function(R,Q,Ae,Oe,ze,mt){return de([q(M(R)),q(V(Q)),q(M(Ae)),q(V(Oe)),q(M(ze)),q(V(mt)),"c"].join(" ")),this};g.__private__.line=g.line=function(R,Q,Ae,Oe,ze){if(isNaN(R)||isNaN(Q)||isNaN(Ae)||isNaN(Oe)||!us(ze))throw new Error("Invalid arguments passed to jsPDF.line");return T===C?this.lines([[Ae-R,Oe-Q]],R,Q,[1,1],ze||"S"):this.lines([[Ae-R,Oe-Q]],R,Q,[1,1]).stroke()},g.__private__.lines=g.lines=function(R,Q,Ae,Oe,ze,mt){var _t,Qt,sr,yr,kr,$r,La,Xa,_a,yn,sn,Un;if(typeof R=="number"&&(Un=Ae,Ae=Q,Q=R,R=Un),Oe=Oe||[1,1],mt=mt||!1,isNaN(Q)||isNaN(Ae)||!Array.isArray(R)||!Array.isArray(Oe)||!us(ze)||typeof mt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Ru(Q,Ae),_t=Oe[0],Qt=Oe[1],yr=R.length,yn=Q,sn=Ae,sr=0;sr<yr;sr++)(kr=R[sr]).length===2?(yn=kr[0]*_t+yn,sn=kr[1]*Qt+sn,$f(yn,sn)):($r=kr[0]*_t+yn,La=kr[1]*Qt+sn,Xa=kr[2]*_t+yn,_a=kr[3]*Qt+sn,yn=kr[4]*_t+yn,sn=kr[5]*Qt+sn,bs($r,La,Xa,_a,yn,sn));return mt&&Tu(),Ol(ze),this},g.path=function(R){for(var Q=0;Q<R.length;Q++){var Ae=R[Q],Oe=Ae.c;switch(Ae.op){case"m":Ru(Oe[0],Oe[1]);break;case"l":$f(Oe[0],Oe[1]);break;case"c":bs.apply(this,Oe);break;case"h":Tu()}}return this},g.__private__.rect=g.rect=function(R,Q,Ae,Oe,ze){if(isNaN(R)||isNaN(Q)||isNaN(Ae)||isNaN(Oe)||!us(ze))throw new Error("Invalid arguments passed to jsPDF.rect");return T===C&&(Oe=-Oe),de([q(M(R)),q(V(Q)),q(M(Ae)),q(M(Oe)),"re"].join(" ")),Ol(ze),this},g.__private__.triangle=g.triangle=function(R,Q,Ae,Oe,ze,mt,_t){if(isNaN(R)||isNaN(Q)||isNaN(Ae)||isNaN(Oe)||isNaN(ze)||isNaN(mt)||!us(_t))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Ae-R,Oe-Q],[ze-Ae,mt-Oe],[R-ze,Q-mt]],R,Q,[1,1],_t,!0),this},g.__private__.roundedRect=g.roundedRect=function(R,Q,Ae,Oe,ze,mt,_t){if(isNaN(R)||isNaN(Q)||isNaN(Ae)||isNaN(Oe)||isNaN(ze)||isNaN(mt)||!us(_t))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Qt=4/3*(Math.SQRT2-1);return ze=Math.min(ze,.5*Ae),mt=Math.min(mt,.5*Oe),this.lines([[Ae-2*ze,0],[ze*Qt,0,ze,mt-mt*Qt,ze,mt],[0,Oe-2*mt],[0,mt*Qt,-ze*Qt,mt,-ze,mt],[2*ze-Ae,0],[-ze*Qt,0,-ze,-mt*Qt,-ze,-mt],[0,2*mt-Oe],[0,-mt*Qt,ze*Qt,-mt,ze,-mt]],R+ze,Q,[1,1],_t,!0),this},g.__private__.ellipse=g.ellipse=function(R,Q,Ae,Oe,ze){if(isNaN(R)||isNaN(Q)||isNaN(Ae)||isNaN(Oe)||!us(ze))throw new Error("Invalid arguments passed to jsPDF.ellipse");var mt=4/3*(Math.SQRT2-1)*Ae,_t=4/3*(Math.SQRT2-1)*Oe;return Ru(R+Ae,Q),bs(R+Ae,Q-_t,R+mt,Q-Oe,R,Q-Oe),bs(R-mt,Q-Oe,R-Ae,Q-_t,R-Ae,Q),bs(R-Ae,Q+_t,R-mt,Q+Oe,R,Q+Oe),bs(R+mt,Q+Oe,R+Ae,Q+_t,R+Ae,Q),Ol(ze),this},g.__private__.circle=g.circle=function(R,Q,Ae,Oe){if(isNaN(R)||isNaN(Q)||isNaN(Ae)||!us(Oe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(R,Q,Ae,Ae,Oe)},g.setFont=function(R,Q,Ae){return Ae&&(Q=B(Q,Ae)),kt=el(R,Q,{disableWarning:!1}),this};var _i=g.__private__.getFont=g.getFont=function(){return Dt[el.apply(g,arguments)]};g.__private__.getFontList=g.getFontList=function(){var R,Q,Ae={};for(R in Ce)if(Ce.hasOwnProperty(R))for(Q in Ae[R]=[],Ce[R])Ce[R].hasOwnProperty(Q)&&Ae[R].push(Q);return Ae},g.addFont=function(R,Q,Ae,Oe,ze){var mt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&mt.indexOf(arguments[3])!==-1?ze=arguments[3]:arguments[3]&&mt.indexOf(arguments[3])==-1&&(Ae=B(Ae,Oe)),ia.call(this,R,Q,Ae,ze=ze||"Identity-H")};var go,Rl=t.lineWidth||.200025,rl=g.__private__.getLineWidth=g.getLineWidth=function(){return Rl},gr=g.__private__.setLineWidth=g.setLineWidth=function(R){return Rl=R,de(q(M(R))+" w"),this};g.__private__.setLineDash=lr.API.setLineDash=lr.API.setLineDashPattern=function(R,Q){if(R=R||[],Q=Q||0,isNaN(Q)||!Array.isArray(R))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return R=R.map(function(Ae){return q(M(Ae))}).join(" "),Q=q(M(Q)),de("["+R+"] "+Q+" d"),this};var Wf=g.__private__.getLineHeight=g.getLineHeight=function(){return Ie*go};g.__private__.getLineHeight=g.getLineHeight=function(){return Ie*go};var Du=g.__private__.setLineHeightFactor=g.setLineHeightFactor=function(R){return typeof(R=R||1.15)=="number"&&(go=R),this},Vf=g.__private__.getLineHeightFactor=g.getLineHeightFactor=function(){return go};Du(t.lineHeight);var Bs=g.__private__.getHorizontalCoordinate=function(R){return M(R)},Bn=g.__private__.getVerticalCoordinate=function(R){return T===A?R:It[F].mediaBox.topRightY-It[F].mediaBox.bottomLeftY-M(R)},Fu=g.__private__.getHorizontalCoordinateString=g.getHorizontalCoordinateString=function(R){return q(Bs(R))},Dl=g.__private__.getVerticalCoordinateString=g.getVerticalCoordinateString=function(R){return q(Bn(R))},Us=t.strokeColor||"0 G";g.__private__.getStrokeColor=g.getDrawColor=function(){return we(Us)},g.__private__.setStrokeColor=g.setDrawColor=function(R,Q,Ae,Oe){return Us=je({ch1:R,ch2:Q,ch3:Ae,ch4:Oe,pdfColorType:"draw",precision:2}),de(Us),this};var Fl=t.fillColor||"0 g";g.__private__.getFillColor=g.getFillColor=function(){return we(Fl)},g.__private__.setFillColor=g.setFillColor=function(R,Q,Ae,Oe){return Fl=je({ch1:R,ch2:Q,ch3:Ae,ch4:Oe,pdfColorType:"fill",precision:2}),de(Fl),this};var Hi=t.textColor||"0 g",Gf=g.__private__.getTextColor=g.getTextColor=function(){return we(Hi)};g.__private__.setTextColor=g.setTextColor=function(R,Q,Ae,Oe){return Hi=je({ch1:R,ch2:Q,ch3:Ae,ch4:Oe,pdfColorType:"text",precision:3}),this};var Xs=t.charSpace,Nc=g.__private__.getCharSpace=g.getCharSpace=function(){return parseFloat(Xs||0)};g.__private__.setCharSpace=g.setCharSpace=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Xs=R,this};var jc=0;g.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},g.__private__.setLineCap=g.setLineCap=function(R){var Q=g.CapJoinStyles[R];if(Q===void 0)throw new Error("Line cap style of '"+R+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return jc=Q,de(Q+" J"),this};var Tn=0;g.__private__.setLineJoin=g.setLineJoin=function(R){var Q=g.CapJoinStyles[R];if(Q===void 0)throw new Error("Line join style of '"+R+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Tn=Q,de(Q+" j"),this},g.__private__.setLineMiterLimit=g.__private__.setMiterLimit=g.setLineMiterLimit=g.setMiterLimit=function(R){if(R=R||0,isNaN(R))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return de(q(M(R))+" M"),this},g.GState=f1,g.setGState=function(R){(R=typeof R=="string"?Pe[Ct[R]]:$i(null,R)).equals(gt)||(de("/"+R.id+" gs"),gt=R)};var $i=function(R,Q){if(!R||!Ct[R]){var Ae=!1;for(var Oe in Pe)if(Pe.hasOwnProperty(Oe)&&Pe[Oe].equals(Q)){Ae=!0;break}if(Ae)Q=Pe[Oe];else{var ze="GS"+(Object.keys(Pe).length+1).toString(10);Pe[ze]=Q,Q.id=ze}return R&&(Ct[R]=Q.id),pr.publish("addGState",Q),Q}};g.addGState=function(R,Q){return $i(R,Q),this},g.saveGraphicsState=function(){return de("q"),$e.push({key:kt,size:Ie,color:Hi}),this},g.restoreGraphicsState=function(){de("Q");var R=$e.pop();return kt=R.key,Ie=R.size,Hi=R.color,gt=null,this},g.setCurrentTransformationMatrix=function(R){return de(R.toString()+" cm"),this},g.comment=function(R){return de("#"+R),this};var Ks=function(R,Q){var Ae=R||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Ae},set:function(mt){isNaN(mt)||(Ae=parseFloat(mt))}});var Oe=Q||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Oe},set:function(mt){isNaN(mt)||(Oe=parseFloat(mt))}});var ze="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ze},set:function(mt){ze=mt.toString()}}),this},vo=function(R,Q,Ae,Oe){Ks.call(this,R,Q),this.type="rect";var ze=Ae||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ze},set:function(_t){isNaN(_t)||(ze=parseFloat(_t))}});var mt=Oe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return mt},set:function(_t){isNaN(_t)||(mt=parseFloat(_t))}}),this},kc=function(){this.page=Rt,this.currentPage=F,this.pages=Le.slice(0),this.pagesContext=It.slice(0),this.x=Ye,this.y=Pt,this.matrix=Et,this.width=yo(F),this.height=Lu(F),this.outputDestination=at,this.id="",this.objectNumber=-1};kc.prototype.restore=function(){Rt=this.page,F=this.currentPage,It=this.pagesContext,Le=this.pages,Ye=this.x,Pt=this.y,Et=this.matrix,Pl(F,this.width),_o(F,this.height),at=this.outputDestination};var Ll=function(R,Q,Ae,Oe,ze){Ea.push(new kc),Rt=F=0,Le=[],Ye=R,Pt=Q,Et=ze,ua([Ae,Oe])};for(var xo in g.beginFormObject=function(R,Q,Ae,Oe,ze){return Ll(R,Q,Ae,Oe,ze),this},g.endFormObject=function(R){return(function(Q){if(Nt[Q])Ea.pop().restore();else{var Ae=new kc,Oe="Xo"+(Object.keys(fa).length+1).toString(10);Ae.id=Oe,Nt[Q]=Oe,fa[Oe]=Ae,pr.publish("addFormObject",Ae),Ea.pop().restore()}})(R),this},g.doFormObject=function(R,Q){var Ae=fa[Nt[R]];return de("q"),de(Q.toString()+" cm"),de("/"+Ae.id+" Do"),de("Q"),this},g.getFormObject=function(R){var Q=fa[Nt[R]];return{x:Q.x,y:Q.y,width:Q.width,height:Q.height,matrix:Q.matrix}},g.save=function(R,Q){return R=R||"generated.pdf",(Q=Q||{}).returnPromise=Q.returnPromise||!1,Q.returnPromise===!1?(of(tl(zi()),R),typeof of.unload=="function"&&jr.setTimeout&&setTimeout(of.unload,911),this):new Promise(function(Ae,Oe){try{var ze=of(tl(zi()),R);typeof of.unload=="function"&&jr.setTimeout&&setTimeout(of.unload,911),Ae(ze)}catch(mt){Oe(mt.message)}})},lr.API)lr.API.hasOwnProperty(xo)&&(xo==="events"&&lr.API.events.length?(function(R,Q){var Ae,Oe,ze;for(ze=Q.length-1;ze!==-1;ze--)Ae=Q[ze][0],Oe=Q[ze][1],R.subscribe.apply(R,[Ae].concat(typeof Oe=="function"?[Oe]:Oe))})(pr,lr.API.events):g[xo]=lr.API[xo]);function yo(R){return It[R].mediaBox.topRightX-It[R].mediaBox.bottomLeftX}function Pl(R,Q){It[R].mediaBox.topRightX=Q+It[R].mediaBox.bottomLeftX}function Lu(R){return It[R].mediaBox.topRightY-It[R].mediaBox.bottomLeftY}function _o(R,Q){It[R].mediaBox.topRightY=Q+It[R].mediaBox.bottomLeftY}var bo=g.getPageWidth=function(R){return yo(R=R||F)/qe},Yf=g.setPageWidth=function(R,Q){Pl(R,Q*qe)},wo=g.getPageHeight=function(R){return Lu(R=R||F)/qe},Xf=g.setPageHeight=function(R,Q){_o(R,Q*qe)};return g.internal={pdfEscape:Lr,getStyle:Cu,getFont:_i,getFontSize:Xe,getCharSpace:Nc,getTextColor:Gf,getLineHeight:Wf,getLineHeightFactor:Vf,getLineWidth:rl,write:it,getHorizontalCoordinate:Bs,getVerticalCoordinate:Bn,getCoordinateString:Fu,getVerticalCoordinateString:Dl,collections:{},newObject:qt,newAdditionalObject:Ne,newObjectDeferred:Kt,newObjectDeferredBegin:re,getFilters:We,putStream:st,events:pr,scaleFactor:qe,pageSize:{getWidth:function(){return bo(F)},setWidth:function(R){Yf(F,R)},getHeight:function(){return wo(F)},setHeight:function(R){Xf(F,R)}},encryptionOptions:m,encryption:xn,getEncryptor:function(R){return m!==null?xn.encryptor(R,0):function(Q){return Q}},output:Eu,getNumberOfPages:Is,get pages(){return Le},out:de,f2:D,f3:O,getPageInfo:nn,getPageInfoByObjId:Sc,getCurrentPageInfo:qf,getPDFVersion:_,Point:Ks,Rectangle:vo,Matrix:rr,hasHotfix:cs},Object.defineProperty(g.internal.pageSize,"width",{get:function(){return bo(F)},set:function(R){Yf(F,R)},enumerable:!0,configurable:!0}),Object.defineProperty(g.internal.pageSize,"height",{get:function(){return wo(F)},set:function(R){Xf(F,R)},enumerable:!0,configurable:!0}),(function(R){for(var Q=0,Ae=ve.length;Q<Ae;Q++){var Oe=ia.call(this,R[Q][0],R[Q][1],R[Q][2],ve[Q][3],!0);v===!1&&(x[Oe]=!0);var ze=R[Q][0].split("-");Jt({id:Oe,fontName:ze[0],fontStyle:ze[1]||""})}pr.publish("addFonts",{fonts:Dt,dictionary:Ce})}).call(g,ve),kt="F1",ls(n,r),pr.publish("initialized"),g}Vd.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},Vd.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Vd.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},Vd.prototype.processOwnerPassword=function(t,e){return qx(Ux(e).substr(0,5),t)},Vd.prototype.encryptor=function(t,e){var r=Ux(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(a){return qx(r,a)}},f1.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||va(t)!==va(this))return!1;var a=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;a++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&a--;return a===0},lr.API={events:[]},lr.version="3.0.4";var hn=lr.API,Q2=1,Uf=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},qd=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Cr=function(t){return t.toFixed(2)},iu=function(t){return t.toFixed(5)};hn.__acroform__={};var pi=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},vS=function(t){return t*Q2},Sl=function(t){var e=new tk,r=nr.internal.getHeight(t)||0,a=nr.internal.getWidth(t)||0;return e.BBox=[0,0,Number(Cr(a)),Number(Cr(r))],e},jz=hn.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},kz=hn.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},Ez=hn.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},jn=hn.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Ez(t,e-1)},kn=hn.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return jz(t,e-1)},En=hn.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return kz(t,e-1)},Az=hn.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,a=e.internal.getVerticalCoordinate,n=t[0],s=t[1],l=t[2],c=t[3],f={};return f.lowerLeft_X=r(n)||0,f.lowerLeft_Y=a(s+c)||0,f.upperRight_X=r(n+l)||0,f.upperRight_Y=a(s)||0,[Number(Cr(f.lowerLeft_X)),Number(Cr(f.lowerLeft_Y)),Number(Cr(f.upperRight_X)),Number(Cr(f.upperRight_Y))]},Cz=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,a=zx(t,r),n=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+n+" "+Cr(a.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(a.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=Sl(t);return s.scope=t.scope,s.stream=e.join(`
`),s}},zx=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,a={text:"",fontSize:""},n=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");n=t.multiline?n.map(function(D){return D.split(`
`)}):n.map(function(D){return[D]});var s=r,l=nr.internal.getHeight(t)||0;l=l<0?-l:l;var c=nr.internal.getWidth(t)||0;c=c<0?-c:c;var f=function(D,O,M){if(D+1<n.length){var V=O+" "+n[D+1][0];return Tp(V,t,M).width<=c-4}return!1};s++;e:for(;s>0;){e="",s--;var d,m,v=Tp("3",t,s).height,x=t.multiline?l-s:(l-v)/2,g=x+=2,b=0,_=0,w=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+Tp(e,t,s=12).width+", FieldWidth:"+c+`
`;break}for(var E="",C=0,A=0;A<n.length;A++)if(n.hasOwnProperty(A)){var T=!1;if(n[A].length!==1&&w!==n[A].length-1){if((v+2)*(C+2)+2>l)continue e;E+=n[A][w],T=!0,_=A,A--}else{E=(E+=n[A][w]+" ").substr(E.length-1)==" "?E.substr(0,E.length-1):E;var G=parseInt(A),W=f(G,E,s),B=A>=n.length-1;if(W&&!B){E+=" ",w=0;continue}if(W||B){if(B)_=G;else if(t.multiline&&(v+2)*(C+2)+2>l)continue e}else{if(!t.multiline||(v+2)*(C+2)+2>l)continue e;_=G}}for(var q="",L=b;L<=_;L++){var J=n[L];if(t.multiline){if(L===_){q+=J[w]+" ",w=(w+1)%J.length;continue}if(L===b){q+=J[J.length-1]+" ";continue}}q+=J[0]+" "}switch(q=q.substr(q.length-1)==" "?q.substr(0,q.length-1):q,m=Tp(q,t,s).width,t.textAlign){case"right":d=c-m-2;break;case"center":d=(c-m)/2;break;default:d=2}e+=Cr(d)+" "+Cr(g)+` Td
`,e+="("+Uf(q)+`) Tj
`,e+=-Cr(d)+` 0 Td
`,g=-(s+2),m=0,b=T?_:_+1,C++,E=""}break}return a.text=e,a.fontSize=s,a},Tp=function(t,e,r){var a=e.scope.internal.getFont(e.fontName,e.fontStyle),n=e.scope.getStringUnitWidth(t,{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:n}},Tz={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Oz=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(a){return a.type===r.type&&a.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},Rz=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Zo.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(Tz)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Q2=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new rk,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var a=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in a)if(a.hasOwnProperty(n)){var s=a[n];s.objId=void 0,s.hasAnnotation&&Oz(s,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(a,n){var s=!a;for(var l in a||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),a=a||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(a.hasOwnProperty(l)){var c=a[l],f=[],d=c.Rect;if(c.Rect&&(c.Rect=Az(c.Rect,n)),n.internal.newObjectDeferredBegin(c.objId,!0),c.DA=nr.createDefaultAppearanceStream(c),va(c)==="object"&&typeof c.getKeyValueListForStream=="function"&&(f=c.getKeyValueListForStream()),c.Rect=d,c.hasAppearanceStream&&!c.appearanceStreamContent){var m=Cz(c);f.push({key:"AP",value:"<</N "+m+">>"}),n.internal.acroformPlugin.xForms.push(m)}if(c.appearanceStreamContent){var v="";for(var x in c.appearanceStreamContent)if(c.appearanceStreamContent.hasOwnProperty(x)){var g=c.appearanceStreamContent[x];if(v+="/"+x+" ",v+="<<",Object.keys(g).length>=1||Array.isArray(g)){for(var l in g)if(g.hasOwnProperty(l)){var b=g[l];typeof b=="function"&&(b=b.call(n,c)),v+="/"+l+" "+b+" ",n.internal.acroformPlugin.xForms.indexOf(b)>=0||n.internal.acroformPlugin.xForms.push(b)}}else typeof(b=g)=="function"&&(b=b.call(n,c)),v+="/"+l+" "+b,n.internal.acroformPlugin.xForms.indexOf(b)>=0||n.internal.acroformPlugin.xForms.push(b);v+=">>"}f.push({key:"AP",value:`<<
`+v+">>"})}n.internal.putStream({additionalKeyValues:f,objectId:c.objId}),n.internal.out("endobj")}s&&(function(_,w){for(var E in _)if(_.hasOwnProperty(E)){var C=E,A=_[E];w.internal.newObjectDeferredBegin(A.objId,!0),va(A)==="object"&&typeof A.putStream=="function"&&A.putStream(),delete _[C]}})(n.internal.acroformPlugin.xForms,n)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},ek=hn.__acroform__.arrayToPdfArray=function(t,e,r){var a=function(l){return l};if(Array.isArray(t)){for(var n="[",s=0;s<t.length;s++)switch(s!==0&&(n+=" "),va(t[s])){case"boolean":case"number":case"object":n+=t[s].toString();break;case"string":t[s].substr(0,1)!=="/"?(e!==void 0&&r&&(a=r.internal.getEncryptor(e)),n+="("+Uf(a(t[s].toString()))+")"):n+=t[s].toString()}return n+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Bv=function(t,e,r){var a=function(n){return n};return e!==void 0&&r&&(a=r.internal.getEncryptor(e)),(t=t||"").toString(),"("+Uf(a(t))+")"},kl=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};kl.prototype.toString=function(){return this.objId+" 0 R"},kl.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},kl.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var a=e[r],n=this[a];n&&(Array.isArray(n)?t.push({key:a,value:ek(n,this.objId,this.scope)}):n instanceof kl?(n.scope=this.scope,t.push({key:a,value:n.objId+" 0 R"})):typeof n!="function"&&t.push({key:a,value:n}))}return t};var tk=function(){kl.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};pi(tk,kl);var rk=function(){kl.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(a){return a};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Uf(r(t))+")"}},set:function(r){t=r}})};pi(rk,kl);var Zo=function t(){kl.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(E){if(isNaN(E))throw new Error('Invalid value "'+E+'" for attribute F supplied.');e=E}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!jn(e,3)},set:function(E){E?this.F=kn(e,3):this.F=En(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(E){if(isNaN(E))throw new Error('Invalid value "'+E+'" for attribute Ff supplied.');r=E}});var a=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(a.length!==0)return a},set:function(E){a=E!==void 0?E:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[0])?0:a[0]},set:function(E){a[0]=E}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[1])?0:a[1]},set:function(E){a[1]=E}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[2])?0:a[2]},set:function(E){a[2]=E}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[3])?0:a[3]},set:function(E){a[3]=E}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(E){switch(E){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=E;break;default:throw new Error('Invalid value "'+E+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof d1)return;s="FieldObject"+t.FieldNum++}var E=function(C){return C};return this.scope&&(E=this.scope.internal.getEncryptor(this.objId)),"("+Uf(E(s))+")"},set:function(E){s=E.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(E){s=E}});var l="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return l},set:function(E){l=E}});var c="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return c},set:function(E){c=E}});var f=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return f},set:function(E){f=E}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/Q2:d},set:function(E){d=E}});var m="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return m},set:function(E){m=E}});var v="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!v||this instanceof d1||this instanceof bf))return Bv(v,this.objId,this.scope)},set:function(E){E=E.toString(),v=E}});var x=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(x)return this instanceof ss==0?Bv(x,this.objId,this.scope):x},set:function(E){E=E.toString(),x=this instanceof ss==0?E.substr(0,1)==="("?qd(E.substr(1,E.length-2)):qd(E):E}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ss==1?qd(x.substr(1,x.length-1)):x},set:function(E){E=E.toString(),x=this instanceof ss==1?"/"+E:E}});var g=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(g)return g},set:function(E){this.V=E}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof ss==0?Bv(g,this.objId,this.scope):g},set:function(E){E=E.toString(),g=this instanceof ss==0?E.substr(0,1)==="("?qd(E.substr(1,E.length-2)):qd(E):E}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ss==1?qd(g.substr(1,g.length-1)):g},set:function(E){E=E.toString(),g=this instanceof ss==1?"/"+E:E}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var b,_=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return _},set:function(E){E=!!E,_=E}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(b)return b},set:function(E){b=E}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!jn(this.Ff,1)},set:function(E){E?this.Ff=kn(this.Ff,1):this.Ff=En(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!jn(this.Ff,2)},set:function(E){E?this.Ff=kn(this.Ff,2):this.Ff=En(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!jn(this.Ff,3)},set:function(E){E?this.Ff=kn(this.Ff,3):this.Ff=En(this.Ff,3)}});var w=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(w!==null)return w},set:function(E){if([0,1,2].indexOf(E)===-1)throw new Error('Invalid value "'+E+'" for attribute Q supplied.');w=E}}),Object.defineProperty(this,"textAlign",{get:function(){var E;switch(w){case 0:default:E="left";break;case 1:E="center";break;case 2:E="right"}return E},configurable:!0,enumerable:!0,set:function(E){switch(E){case"right":case 2:w=2;break;case"center":case 1:w=1;break;default:w=0}}})};pi(Zo,kl);var rh=function(){Zo.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return ek(e,this.objId,this.scope)},set:function(r){var a,n;n=[],typeof(a=r)=="string"&&(n=(function(s,l,c){c||(c=1);for(var f,d=[];f=l.exec(s);)d.push(f[c]);return d})(a,/\((.*?)\)/g)),e=n}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,a){for(a=a||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),a!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!jn(this.Ff,18)},set:function(r){r?this.Ff=kn(this.Ff,18):this.Ff=En(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!jn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=kn(this.Ff,19):this.Ff=En(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!jn(this.Ff,20)},set:function(r){r?(this.Ff=kn(this.Ff,20),e.sort()):this.Ff=En(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!jn(this.Ff,22)},set:function(r){r?this.Ff=kn(this.Ff,22):this.Ff=En(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!jn(this.Ff,23)},set:function(r){r?this.Ff=kn(this.Ff,23):this.Ff=En(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!jn(this.Ff,27)},set:function(r){r?this.Ff=kn(this.Ff,27):this.Ff=En(this.Ff,27)}}),this.hasAppearanceStream=!1};pi(rh,Zo);var ah=function(){rh.call(this),this.fontName="helvetica",this.combo=!1};pi(ah,rh);var nh=function(){ah.call(this),this.combo=!0};pi(nh,ah);var Up=function(){nh.call(this),this.edit=!0};pi(Up,nh);var ss=function(){Zo.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!jn(this.Ff,15)},set:function(r){r?this.Ff=kn(this.Ff,15):this.Ff=En(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!jn(this.Ff,16)},set:function(r){r?this.Ff=kn(this.Ff,16):this.Ff=En(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!jn(this.Ff,17)},set:function(r){r?this.Ff=kn(this.Ff,17):this.Ff=En(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!jn(this.Ff,26)},set:function(r){r?this.Ff=kn(this.Ff,26):this.Ff=En(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var a,n=[];for(a in n.push("<<"),e)n.push("/"+a+" ("+Uf(r(e[a]))+")");return n.push(">>"),n.join(`
`)}},set:function(r){va(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};pi(ss,Zo);var qp=function(){ss.call(this),this.pushButton=!0};pi(qp,ss);var sh=function(){ss.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};pi(sh,ss);var d1=function(){var t,e;Zo.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(n){e=n}});var r,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(c){return c};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var s,l=[];for(s in l.push("<<"),a)l.push("/"+s+" ("+Uf(n(a[s]))+")");return l.push(">>"),l.join(`
`)},set:function(n){va(n)==="object"&&(a=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(n){typeof n=="string"&&(a.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(n){r=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(n){r="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=nr.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};pi(d1,Zo),sh.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},sh.prototype.createOption=function(t){var e=new d1;return e.Parent=this,e.optionName=t,this.Kids.push(e),Dz.call(this.scope,e),e};var zp=function(){ss.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=nr.CheckBox.createAppearanceStream()};pi(zp,ss);var bf=function(){Zo.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!jn(this.Ff,13)},set:function(e){e?this.Ff=kn(this.Ff,13):this.Ff=En(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!jn(this.Ff,21)},set:function(e){e?this.Ff=kn(this.Ff,21):this.Ff=En(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!jn(this.Ff,23)},set:function(e){e?this.Ff=kn(this.Ff,23):this.Ff=En(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!jn(this.Ff,24)},set:function(e){e?this.Ff=kn(this.Ff,24):this.Ff=En(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!jn(this.Ff,25)},set:function(e){e?this.Ff=kn(this.Ff,25):this.Ff=En(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!jn(this.Ff,26)},set:function(e){e?this.Ff=kn(this.Ff,26):this.Ff=En(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};pi(bf,Zo);var Hp=function(){bf.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!jn(this.Ff,14)},set:function(t){t?this.Ff=kn(this.Ff,14):this.Ff=En(this.Ff,14)}}),this.password=!0};pi(Hp,bf);var nr={CheckBox:{createAppearanceStream:function(){return{N:{On:nr.CheckBox.YesNormal},D:{On:nr.CheckBox.YesPushDown,Off:nr.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Sl(t);e.scope=t.scope;var r=[],a=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),s=zx(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+Cr(nr.internal.getWidth(t))+" "+Cr(nr.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+a+" "+Cr(s.fontSize)+" Tf "+n),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=Sl(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,a=t.scope.__private__.encodeColorString(t.color),n=[],s=nr.internal.getHeight(t),l=nr.internal.getWidth(t),c=zx(t,t.caption);return n.push("1 g"),n.push("0 0 "+Cr(l)+" "+Cr(s)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+Cr(l-1)+" "+Cr(s-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+r+" "+Cr(c.fontSize)+" Tf "+a),n.push(c.text),n.push("ET"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Sl(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Cr(nr.internal.getWidth(t))+" "+Cr(nr.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:nr.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=nr.RadioButton.Circle.YesNormal,e.D[t]=nr.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Sl(t);e.scope=t.scope;var r=[],a=nr.internal.getWidth(t)<=nr.internal.getHeight(t)?nr.internal.getWidth(t)/4:nr.internal.getHeight(t)/4;a=Number((.9*a).toFixed(5));var n=nr.internal.Bezier_C,s=Number((a*n).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+iu(nr.internal.getWidth(t)/2)+" "+iu(nr.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Sl(t);e.scope=t.scope;var r=[],a=nr.internal.getWidth(t)<=nr.internal.getHeight(t)?nr.internal.getWidth(t)/4:nr.internal.getHeight(t)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),s=Number((n*nr.internal.Bezier_C).toFixed(5)),l=Number((a*nr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+iu(nr.internal.getWidth(t)/2)+" "+iu(nr.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+iu(nr.internal.getWidth(t)/2)+" "+iu(nr.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+l+" "+l+" "+a+" 0 "+a+" c"),r.push("-"+l+" "+a+" -"+a+" "+l+" -"+a+" 0 c"),r.push("-"+a+" -"+l+" -"+l+" -"+a+" 0 -"+a+" c"),r.push(l+" -"+a+" "+a+" -"+l+" "+a+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Sl(t);e.scope=t.scope;var r=[],a=nr.internal.getWidth(t)<=nr.internal.getHeight(t)?nr.internal.getWidth(t)/4:nr.internal.getHeight(t)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),s=Number((n*nr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+iu(nr.internal.getWidth(t)/2)+" "+iu(nr.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:nr.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=nr.RadioButton.Cross.YesNormal,e.D[t]=nr.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Sl(t);e.scope=t.scope;var r=[],a=nr.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+Cr(nr.internal.getWidth(t)-2)+" "+Cr(nr.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(Cr(a.x1.x)+" "+Cr(a.x1.y)+" m"),r.push(Cr(a.x2.x)+" "+Cr(a.x2.y)+" l"),r.push(Cr(a.x4.x)+" "+Cr(a.x4.y)+" m"),r.push(Cr(a.x3.x)+" "+Cr(a.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Sl(t);e.scope=t.scope;var r=nr.internal.calculateCross(t),a=[];return a.push("0.749023 g"),a.push("0 0 "+Cr(nr.internal.getWidth(t))+" "+Cr(nr.internal.getHeight(t))+" re"),a.push("f"),a.push("q"),a.push("1 1 "+Cr(nr.internal.getWidth(t)-2)+" "+Cr(nr.internal.getHeight(t)-2)+" re"),a.push("W"),a.push("n"),a.push(Cr(r.x1.x)+" "+Cr(r.x1.y)+" m"),a.push(Cr(r.x2.x)+" "+Cr(r.x2.y)+" l"),a.push(Cr(r.x4.x)+" "+Cr(r.x4.y)+" m"),a.push(Cr(r.x3.x)+" "+Cr(r.x3.y)+" l"),a.push("s"),a.push("Q"),e.stream=a.join(`
`),e},OffPushDown:function(t){var e=Sl(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Cr(nr.internal.getWidth(t))+" "+Cr(nr.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};nr.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=nr.internal.getWidth(t),r=nr.internal.getHeight(t),a=Math.min(e,r);return{x1:{x:(e-a)/2,y:(r-a)/2+a},x2:{x:(e-a)/2+a,y:(r-a)/2},x3:{x:(e-a)/2,y:(r-a)/2},x4:{x:(e-a)/2+a,y:(r-a)/2+a}}}},nr.internal.getWidth=function(t){var e=0;return va(t)==="object"&&(e=vS(t.Rect[2])),e},nr.internal.getHeight=function(t){var e=0;return va(t)==="object"&&(e=vS(t.Rect[3])),e};var Dz=hn.addField=function(t){if(Rz(this,t),!(t instanceof Zo))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};hn.AcroFormChoiceField=rh,hn.AcroFormListBox=ah,hn.AcroFormComboBox=nh,hn.AcroFormEditBox=Up,hn.AcroFormButton=ss,hn.AcroFormPushButton=qp,hn.AcroFormRadioButton=sh,hn.AcroFormCheckBox=zp,hn.AcroFormTextField=bf,hn.AcroFormPasswordField=Hp,hn.AcroFormAppearance=nr,hn.AcroForm={ChoiceField:rh,ListBox:ah,ComboBox:nh,EditBox:Up,Button:ss,PushButton:qp,RadioButton:sh,CheckBox:zp,TextField:bf,PasswordField:Hp,Appearance:nr},lr.AcroForm={ChoiceField:rh,ListBox:ah,ComboBox:nh,EditBox:Up,Button:ss,PushButton:qp,RadioButton:sh,CheckBox:zp,TextField:bf,PasswordField:Hp,Appearance:nr};lr.AcroForm;function ak(t){return t.reduce(function(e,r,a){return e[r]=a,e},{})}(function(t){var e="addImage_";t.__addimage__={};var r="UNKNOWN",a={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=t.__addimage__.getImageFileTypeByImageData=function(D,O){var M,V,ie,X,Z,K=r;if((O=O||r)==="RGBA"||D.data!==void 0&&D.data instanceof Uint8ClampedArray&&"height"in D&&"width"in D)return"RGBA";if(W(D))for(Z in a)for(ie=a[Z],M=0;M<ie.length;M+=1){for(X=!0,V=0;V<ie[M].length;V+=1)if(ie[M][V]!==void 0&&ie[M][V]!==D[V]){X=!1;break}if(X===!0){K=Z;break}}else for(Z in a)for(ie=a[Z],M=0;M<ie.length;M+=1){for(X=!0,V=0;V<ie[M].length;V+=1)if(ie[M][V]!==void 0&&ie[M][V]!==D.charCodeAt(V)){X=!1;break}if(X===!0){K=Z;break}}return K===r&&O!==r&&(K=O),K},s=function D(O){for(var M=this.internal.write,V=this.internal.putStream,ie=(0,this.internal.getFilters)();ie.indexOf("FlateEncode")!==-1;)ie.splice(ie.indexOf("FlateEncode"),1);O.objectId=this.internal.newObject();var X=[];if(X.push({key:"Type",value:"/XObject"}),X.push({key:"Subtype",value:"/Image"}),X.push({key:"Width",value:O.width}),X.push({key:"Height",value:O.height}),O.colorSpace===E.INDEXED?X.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(O.palette.length/3-1)+" "+("sMask"in O&&O.sMask!==void 0?O.objectId+2:O.objectId+1)+" 0 R]"}):(X.push({key:"ColorSpace",value:"/"+O.colorSpace}),O.colorSpace===E.DEVICE_CMYK&&X.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),X.push({key:"BitsPerComponent",value:O.bitsPerComponent}),"decodeParameters"in O&&O.decodeParameters!==void 0&&X.push({key:"DecodeParms",value:"<<"+O.decodeParameters+">>"}),"transparency"in O&&Array.isArray(O.transparency)&&O.transparency.length>0){for(var Z="",K=0,ae=O.transparency.length;K<ae;K++)Z+=O.transparency[K]+" "+O.transparency[K]+" ";X.push({key:"Mask",value:"["+Z+"]"})}O.sMask!==void 0&&X.push({key:"SMask",value:O.objectId+1+" 0 R"});var fe=O.filter!==void 0?["/"+O.filter]:void 0;if(V({data:O.data,additionalKeyValues:X,alreadyAppliedFilters:fe,objectId:O.objectId}),M("endobj"),"sMask"in O&&O.sMask!==void 0){var U,j=(U=O.sMaskBitsPerComponent)!==null&&U!==void 0?U:O.bitsPerComponent,F={width:O.width,height:O.height,colorSpace:"DeviceGray",bitsPerComponent:j,data:O.sMask};"filter"in O&&(F.decodeParameters="/Predictor ".concat(O.predictor," /Colors 1 /BitsPerComponent ").concat(j," /Columns ").concat(O.width),F.filter=O.filter),D.call(this,F)}if(O.colorSpace===E.INDEXED){var I=this.internal.newObject();V({data:q(new Uint8Array(O.palette)),objectId:I}),M("endobj")}},l=function(){var D=this.internal.collections[e+"images"];for(var O in D)s.call(this,D[O])},c=function(){var D,O=this.internal.collections[e+"images"],M=this.internal.write;for(var V in O)M("/I"+(D=O[V]).index,D.objectId,"0","R")},f=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",l),this.internal.events.subscribe("putXobjectDict",c))},d=function(){var D=this.internal.collections[e+"images"];return f.call(this),D},m=function(){return Object.keys(this.internal.collections[e+"images"]).length},v=function(D){return typeof t["process"+D.toUpperCase()]=="function"},x=function(D){return va(D)==="object"&&D.nodeType===1},g=function(D,O){if(D.nodeName==="IMG"&&D.hasAttribute("src")){var M=""+D.getAttribute("src");if(M.indexOf("data:image/")===0)return Bp(unescape(M).split("base64,").pop());var V=t.loadFile(M,!0);if(V!==void 0)return V}if(D.nodeName==="CANVAS"){if(D.width===0||D.height===0)throw new Error("Given canvas must have data. Canvas width: "+D.width+", height: "+D.height);var ie;switch(O){case"PNG":ie="image/png";break;case"WEBP":ie="image/webp";break;default:ie="image/jpeg"}return Bp(D.toDataURL(ie,1).split("base64,").pop())}},b=function(D){var O=this.internal.collections[e+"images"];if(O){for(var M in O)if(D===O[M].alias)return O[M]}},_=function(D,O,M){return D||O||(D=-96,O=-96),D<0&&(D=-1*M.width*72/D/this.internal.scaleFactor),O<0&&(O=-1*M.height*72/O/this.internal.scaleFactor),D===0&&(D=O*M.width/M.height),O===0&&(O=D*M.height/M.width),[D,O]},w=function(D,O,M,V,ie,X){var Z=_.call(this,M,V,ie),K=this.internal.getCoordinateString,ae=this.internal.getVerticalCoordinateString,fe=d.call(this);if(M=Z[0],V=Z[1],fe[ie.index]=ie,X){X*=Math.PI/180;var U=Math.cos(X),j=Math.sin(X),F=function(z){return z.toFixed(4)},I=[F(U),F(j),F(-1*j),F(U),0,0,"cm"]}this.internal.write("q"),X?(this.internal.write([1,"0","0",1,K(D),ae(O+V),"cm"].join(" ")),this.internal.write(I.join(" ")),this.internal.write([K(M),"0","0",K(V),"0","0","cm"].join(" "))):this.internal.write([K(M),"0","0",K(V),K(D),ae(O+V),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ie.index+" Do"),this.internal.write("Q")},E=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var C=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},A=t.__addimage__.sHashCode=function(D){var O,M,V=0;if(typeof D=="string")for(M=D.length,O=0;O<M;O++)V=(V<<5)-V+D.charCodeAt(O),V|=0;else if(W(D))for(M=D.byteLength/2,O=0;O<M;O++)V=(V<<5)-V+D[O],V|=0;return V},T=t.__addimage__.validateStringAsBase64=function(D){(D=D||"").toString().trim();var O=!0;return D.length===0&&(O=!1),D.length%4!=0&&(O=!1),/^[A-Za-z0-9+/]+$/.test(D.substr(0,D.length-2))===!1&&(O=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(D.substr(-2))===!1&&(O=!1),O},G=t.__addimage__.extractImageFromDataUrl=function(D){if(D==null||!(D=D.trim()).startsWith("data:"))return null;var O=D.indexOf(",");return O<0?null:D.substring(0,O).trim().endsWith("base64")?D.substring(O+1):null};t.__addimage__.isArrayBuffer=function(D){return D instanceof ArrayBuffer};var W=t.__addimage__.isArrayBufferView=function(D){return D instanceof Int8Array||D instanceof Uint8Array||D instanceof Uint8ClampedArray||D instanceof Int16Array||D instanceof Uint16Array||D instanceof Int32Array||D instanceof Uint32Array||D instanceof Float32Array||D instanceof Float64Array},B=t.__addimage__.binaryStringToUint8Array=function(D){for(var O=D.length,M=new Uint8Array(O),V=0;V<O;V++)M[V]=D.charCodeAt(V);return M},q=t.__addimage__.arrayBufferToBinaryString=function(D){for(var O="",M=W(D)?D:new Uint8Array(D),V=0;V<M.length;V+=8192)O+=String.fromCharCode.apply(null,M.subarray(V,V+8192));return O};t.addImage=function(){var D,O,M,V,ie,X,Z,K,ae;if(typeof arguments[1]=="number"?(O=r,M=arguments[1],V=arguments[2],ie=arguments[3],X=arguments[4],Z=arguments[5],K=arguments[6],ae=arguments[7]):(O=arguments[1],M=arguments[2],V=arguments[3],ie=arguments[4],X=arguments[5],Z=arguments[6],K=arguments[7],ae=arguments[8]),va(D=arguments[0])==="object"&&!x(D)&&"imageData"in D){var fe=D;D=fe.imageData,O=fe.format||O||r,M=fe.x||M||0,V=fe.y||V||0,ie=fe.w||fe.width||ie,X=fe.h||fe.height||X,Z=fe.alias||Z,K=fe.compression||K,ae=fe.rotation||fe.angle||ae}var U=this.internal.getFilters();if(K===void 0&&U.indexOf("FlateEncode")!==-1&&(K="SLOW"),isNaN(M)||isNaN(V))throw new Error("Invalid coordinates passed to jsPDF.addImage");f.call(this);var j=L.call(this,D,O,Z,K);return w.call(this,M,V,ie,X,j,ae),this};var L=function(D,O,M,V){var ie,X,Z;if(typeof D=="string"&&n(D)===r){D=unescape(D);var K=J(D,!1);(K!==""||(K=t.loadFile(D,!0))!==void 0)&&(D=K)}if(x(D)&&(D=g(D,O)),O=n(D,O),!v(O))throw new Error("addImage does not support files of type '"+O+"', please ensure that a plugin for '"+O+"' support is added.");if(((Z=M)==null||Z.length===0)&&(M=(function(ae){return typeof ae=="string"||W(ae)?A(ae):W(ae.data)?A(ae.data):null})(D)),(ie=b.call(this,M))||(D instanceof Uint8Array||O==="RGBA"||(X=D,D=B(D)),ie=this["process"+O.toUpperCase()](D,m.call(this),M,(function(ae){return ae&&typeof ae=="string"&&(ae=ae.toUpperCase()),ae in t.image_compression?ae:C.NONE})(V),X)),!ie)throw new Error("An unknown error occurred whilst processing the image.");return ie},J=t.__addimage__.convertBase64ToBinaryString=function(D,O){O=typeof O!="boolean"||O;var M,V="";if(typeof D=="string"){var ie;M=(ie=G(D))!==null&&ie!==void 0?ie:D;try{V=Bp(M)}catch(X){if(O)throw T(M)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+X.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return V};t.getImageProperties=function(D){var O,M,V="";if(x(D)&&(D=g(D)),typeof D=="string"&&n(D)===r&&((V=J(D,!1))===""&&(V=t.loadFile(D)||""),D=V),M=n(D),!v(M))throw new Error("addImage does not support files of type '"+M+"', please ensure that a plugin for '"+M+"' support is added.");if(D instanceof Uint8Array||(D=B(D)),!(O=this["process"+M.toUpperCase()](D)))throw new Error("An unknown error occurred whilst processing the image");return O.fileType=M,O}})(lr.API),(function(t){var e=function(r){if(r!==void 0&&r!="")return!0};lr.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var a,n,s,l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString,f=this.internal.getPageInfoByObjId(r.objId),d=r.pageContext.annotations,m=!1,v=0;v<d.length&&!m;v++)switch((a=d[v]).type){case"link":(e(a.options.url)||e(a.options.pageNumber))&&(m=!0);break;case"reference":case"text":case"freetext":m=!0}if(m!=0){this.internal.write("/Annots [");for(var x=0;x<d.length;x++){a=d[x];var g=this.internal.pdfEscape,b=this.internal.getEncryptor(r.objId);switch(a.type){case"reference":this.internal.write(" "+a.object.objId+" 0 R ");break;case"text":var _=this.internal.newAdditionalObject(),w=this.internal.newAdditionalObject(),E=this.internal.getEncryptor(_.objId),C=a.title||"Note";s="<</Type /Annot /Subtype /Text "+(n="/Rect ["+l(a.bounds.x)+" "+c(a.bounds.y+a.bounds.h)+" "+l(a.bounds.x+a.bounds.w)+" "+c(a.bounds.y)+"] ")+"/Contents ("+g(E(a.contents))+")",s+=" /Popup "+w.objId+" 0 R",s+=" /P "+f.objId+" 0 R",s+=" /T ("+g(E(C))+") >>",_.content=s;var A=_.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+l(a.bounds.x+30)+" "+c(a.bounds.y+a.bounds.h)+" "+l(a.bounds.x+a.bounds.w+30)+" "+c(a.bounds.y)+"] ")+" /Parent "+A,a.open&&(s+=" /Open true"),s+=" >>",w.content=s,this.internal.write(_.objId,"0 R",w.objId,"0 R");break;case"freetext":n="/Rect ["+l(a.bounds.x)+" "+c(a.bounds.y)+" "+l(a.bounds.x+a.bounds.w)+" "+c(a.bounds.y+a.bounds.h)+"] ";var T=a.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+g(b(a.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+T+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(a.options.name){var G=this.annotations._nameMap[a.options.name];a.options.pageNumber=G.page,a.options.top=G.y}else a.options.top||(a.options.top=0);if(n="/Rect ["+a.finalBounds.x+" "+a.finalBounds.y+" "+a.finalBounds.w+" "+a.finalBounds.h+"] ",s="",a.options.url)s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+g(b(a.options.url))+") >>";else if(a.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(a.options.pageNumber).objId+" 0 R",a.options.magFactor=a.options.magFactor||"XYZ",a.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+a.options.top+"]";break;case"FitV":a.options.left=a.options.left||0,s+=" /FitV "+a.options.left+"]";break;default:var W=c(a.options.top);a.options.left=a.options.left||0,a.options.zoom===void 0&&(a.options.zoom=0),s+=" /XYZ "+a.options.left+" "+W+" "+a.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var a=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":a.pageContext.annotations.push(r)}},t.link=function(r,a,n,s,l){var c=this.internal.getCurrentPageInfo(),f=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;c.pageContext.annotations.push({finalBounds:{x:f(r),y:d(a),w:f(r+n),h:d(a+s)},options:l,type:"link"})},t.textWithLink=function(r,a,n,s){var l,c,f=this.getTextWidth(r),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){c=s.maxWidth;var m=this.splitTextToSize(r,c).length;l=Math.ceil(d*m)}else c=f,l=d;return this.text(r,a,n,s),n+=.2*d,s.align==="center"&&(a-=f/2),s.align==="right"&&(a-=f),this.link(a,n-d,c,l,s),f},t.getTextWidth=function(r){var a=this.internal.getFontSize();return this.getStringUnitWidth(r)*a/this.internal.scaleFactor}})(lr.API),(function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},a={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];t.__arabicParser__={};var s=t.__arabicParser__.isInArabicSubstitutionA=function(_){return e[_.charCodeAt(0)]!==void 0},l=t.__arabicParser__.isArabicLetter=function(_){return typeof _=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(_)},c=t.__arabicParser__.isArabicEndLetter=function(_){return l(_)&&s(_)&&e[_.charCodeAt(0)].length<=2},f=t.__arabicParser__.isArabicAlfLetter=function(_){return l(_)&&n.indexOf(_.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(_){return l(_)&&s(_)&&e[_.charCodeAt(0)].length>=1};var d=t.__arabicParser__.arabicLetterHasFinalForm=function(_){return l(_)&&s(_)&&e[_.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(_){return l(_)&&s(_)&&e[_.charCodeAt(0)].length>=3};var m=t.__arabicParser__.arabicLetterHasMedialForm=function(_){return l(_)&&s(_)&&e[_.charCodeAt(0)].length==4},v=t.__arabicParser__.resolveLigatures=function(_){var w=0,E=r,C="",A=0;for(w=0;w<_.length;w+=1)E[_.charCodeAt(w)]!==void 0?(A++,typeof(E=E[_.charCodeAt(w)])=="number"&&(C+=String.fromCharCode(E),E=r,A=0),w===_.length-1&&(E=r,C+=_.charAt(w-(A-1)),w-=A-1,A=0)):(E=r,C+=_.charAt(w-A),w-=A,A=0);return C};t.__arabicParser__.isArabicDiacritic=function(_){return _!==void 0&&a[_.charCodeAt(0)]!==void 0};var x=t.__arabicParser__.getCorrectForm=function(_,w,E){return l(_)?s(_)===!1?-1:!d(_)||!l(w)&&!l(E)||!l(E)&&c(w)||c(_)&&!l(w)||c(_)&&f(w)||c(_)&&c(w)?0:m(_)&&l(w)&&!c(w)&&l(E)&&d(E)?3:c(_)||!l(E)?1:2:-1},g=function(_){var w=0,E=0,C=0,A="",T="",G="",W=(_=_||"").split("\\s+"),B=[];for(w=0;w<W.length;w+=1){for(B.push(""),E=0;E<W[w].length;E+=1)A=W[w][E],T=W[w][E-1],G=W[w][E+1],l(A)?(C=x(A,T,G),B[w]+=C!==-1?String.fromCharCode(e[A.charCodeAt(0)][C]):A):B[w]+=A;B[w]=v(B[w])}return B.join(" ")},b=t.__arabicParser__.processArabic=t.processArabic=function(){var _,w=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,E=[];if(Array.isArray(w)){var C=0;for(E=[],C=0;C<w.length;C+=1)Array.isArray(w[C])?E.push([g(w[C][0]),w[C][1],w[C][2]]):E.push([g(w[C])]);_=E}else _=g(w);return typeof arguments[0]=="string"?_:(arguments[0].text=_,arguments[0])};t.events.push(["preProcessText",b])})(lr.API),lr.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(c){r=c}});var a=150;Object.defineProperty(this,"width",{get:function(){return a},set:function(c){a=isNaN(c)||Number.isInteger(c)===!1||c<0?150:c,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=a+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(c){n=isNaN(c)||Number.isInteger(c)===!1||c<0?300:c,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(c){s=c}});var l={};Object.defineProperty(this,"style",{get:function(){return l},set:function(c){l=c}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,a){var n;if((r=r||"2d")!=="2d")return null;for(n in a)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=a[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(lr.API),(function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,a=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var f=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return f},set:function(_){f=_}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(_){d=_}});var m=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return m},set:function(_){m=_}});var v=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return v},set:function(_){v=_}});var x=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return x},set:function(_){x=_}});var g=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return g},set:function(_){g=_}});var b=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return b},set:function(_){b=_}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(f){return a.call(this),this.internal.__cell__.headerFunction=typeof f=="function"?f:void 0,this},t.getTextDimensions=function(f,d){a.call(this);var m=(d=d||{}).fontSize||this.getFontSize(),v=d.font||this.getFont(),x=d.scaleFactor||this.internal.scaleFactor,g=0,b=0,_=0,w=this;if(!Array.isArray(f)&&typeof f!="string"){if(typeof f!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");f=String(f)}var E=d.maxWidth;E>0?typeof f=="string"?f=this.splitTextToSize(f,E):Object.prototype.toString.call(f)==="[object Array]"&&(f=f.reduce(function(A,T){return A.concat(w.splitTextToSize(T,E))},[])):f=Array.isArray(f)?f:[f];for(var C=0;C<f.length;C++)g<(_=this.getStringUnitWidth(f[C],{font:v})*m)&&(g=_);return g!==0&&(b=f.length),{w:g/=x,h:Math.max((b*m*this.getLineHeightFactor()-m*(this.getLineHeightFactor()-1))/x,0)}},t.cellAddPage=function(){a.call(this),this.addPage();var f=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(f.left,f.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var l=t.cell=function(){var f;f=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),a.call(this);var d=this.internal.__cell__.lastCell,m=this.internal.__cell__.padding,v=this.internal.__cell__.margins||e,x=this.internal.__cell__.tableHeaderRow,g=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===f.lineNumber?(f.x=(d.x||0)+(d.width||0),f.y=d.y||0):d.y+d.height+f.height+v.bottom>this.getPageHeight()?(this.cellAddPage(),f.y=v.top,g&&x&&(this.printHeaderRow(f.lineNumber,!0),f.y+=x[0].height)):f.y=d.y+d.height||f.y),f.text[0]!==void 0&&(this.rect(f.x,f.y,f.width,f.height,r===!0?"FD":void 0),f.align==="right"?this.text(f.text,f.x+f.width-m,f.y+m,{align:"right",baseline:"top"}):f.align==="center"?this.text(f.text,f.x+f.width/2,f.y+m,{align:"center",baseline:"top",maxWidth:f.width-m-m}):this.text(f.text,f.x+m,f.y+m,{align:"left",baseline:"top",maxWidth:f.width-m-m})),this.internal.__cell__.lastCell=f,this};t.table=function(f,d,m,v,x){if(a.call(this),!m)throw new Error("No data for PDF table.");var g,b,_,w,E=[],C=[],A=[],T={},G={},W=[],B=[],q=(x=x||{}).autoSize||!1,L=x.printHeaders!==!1,J=x.css&&x.css["font-size"]!==void 0?16*x.css["font-size"]:x.fontSize||12,D=x.margins||Object.assign({width:this.getPageWidth()},e),O=typeof x.padding=="number"?x.padding:3,M=x.headerBackgroundColor||"#c8c8c8",V=x.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=L,this.internal.__cell__.margins=D,this.internal.__cell__.table_font_size=J,this.internal.__cell__.padding=O,this.internal.__cell__.headerBackgroundColor=M,this.internal.__cell__.headerTextColor=V,this.setFontSize(J),v==null)C=E=Object.keys(m[0]),A=E.map(function(){return"left"});else if(Array.isArray(v)&&va(v[0])==="object")for(E=v.map(function(fe){return fe.name}),C=v.map(function(fe){return fe.prompt||fe.name||""}),A=v.map(function(fe){return fe.align||"left"}),g=0;g<v.length;g+=1)G[v[g].name]=.7499990551181103*v[g].width;else Array.isArray(v)&&typeof v[0]=="string"&&(C=E=v,A=E.map(function(){return"left"}));if(q||Array.isArray(v)&&typeof v[0]=="string")for(g=0;g<E.length;g+=1){for(T[w=E[g]]=m.map(function(fe){return fe[w]}),this.setFont(void 0,"bold"),W.push(this.getTextDimensions(C[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),b=T[w],this.setFont(void 0,"normal"),_=0;_<b.length;_+=1)W.push(this.getTextDimensions(b[_],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);G[w]=Math.max.apply(null,W)+O+O,W=[]}if(L){var ie={};for(g=0;g<E.length;g+=1)ie[E[g]]={},ie[E[g]].text=C[g],ie[E[g]].align=A[g];var X=c.call(this,ie,G);B=E.map(function(fe){return new s(f,d,G[fe],X,ie[fe].text,void 0,ie[fe].align)}),this.setTableHeaderRow(B),this.printHeaderRow(1,!1)}var Z=v.reduce(function(fe,U){return fe[U.name]=U.align,fe},{});for(g=0;g<m.length;g+=1){"rowStart"in x&&x.rowStart instanceof Function&&x.rowStart({row:g,data:m[g]},this);var K=c.call(this,m[g],G);for(_=0;_<E.length;_+=1){var ae=m[g][E[_]];"cellStart"in x&&x.cellStart instanceof Function&&x.cellStart({row:g,col:_,data:ae},this),l.call(this,new s(f,d,G[E[_]],K,ae,g+2,Z[E[_]]))}}return this.internal.__cell__.table_x=f,this.internal.__cell__.table_y=d,this};var c=function(f,d){var m=this.internal.__cell__.padding,v=this.internal.__cell__.table_font_size,x=this.internal.scaleFactor;return Object.keys(f).map(function(g){var b=f[g];return this.splitTextToSize(b.hasOwnProperty("text")?b.text:b,d[g]-m-m)},this).map(function(g){return this.getLineHeightFactor()*g.length*v/x+m+m},this).reduce(function(g,b){return Math.max(g,b)},0)};t.setTableHeaderRow=function(f){a.call(this),this.internal.__cell__.tableHeaderRow=f},t.printHeaderRow=function(f,d){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var m;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var v=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(v[0],v[1],v[2],v[3],void 0,-1)}this.setFont(void 0,"bold");for(var x=[],g=0;g<this.internal.__cell__.tableHeaderRow.length;g+=1){m=this.internal.__cell__.tableHeaderRow[g].clone(),d&&(m.y=this.internal.__cell__.margins.top||0,x.push(m)),m.lineNumber=f;var b=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),l.call(this,m),this.setTextColor(b)}x.length>0&&this.setTableHeaderRow(x),this.setFont(void 0,"normal"),r=!1}})(lr.API);var nk={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},sk=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Hx=ak(sk),ik=[100,200,300,400,500,600,700,800,900],Fz=ak(ik);function Uv(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=(function(s){return nk[s=s||"normal"]?s:"normal"})(t.style),a=(function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400})(t.weight),n=(function(s){return typeof Hx[s=s||"normal"]=="number"?s:"normal"})(t.stretch);return{family:e,style:r,weight:a,stretch:n,src:t.src||[],ref:t.ref||{name:e,style:[n,r,a].join(" ")}}}function xS(t,e,r,a){var n;for(n=r;n>=0&&n<e.length;n+=a)if(t[e[n]])return t[e[n]];for(n=r;n>=0&&n<e.length;n-=a)if(t[e[n]])return t[e[n]]}var Lz={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},yS={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function _S(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function bS(t){return t.trimLeft()}function Pz(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function Mz(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var Op,wS,SS,zd,Rp,NS,jS,kS,qv=["times"];function ES(t,e,r,a,n){var s=4,l=CS;switch(n){case lr.API.image_compression.FAST:s=1,l=AS;break;case lr.API.image_compression.MEDIUM:s=6,l=TS;break;case lr.API.image_compression.SLOW:s=9,l=OS}t=(function(f,d,m,v){for(var x,g=f.length/d,b=new Uint8Array(f.length+g),_=[Iz,AS,CS,TS,OS],w=0;w<g;w+=1){var E=w*d,C=f.subarray(E,E+d);if(v)b.set(v(C,m,x),E+w);else{for(var A=_.length,T=[],G=0;G<A;G+=1)T[G]=_[G](C,m,x);var W=Uz(T.concat());b.set(T[W],E+w)}x=C}return b})(t,e,Math.ceil(r*a/8),l);var c=Px(t,{level:s});return lr.API.__addimage__.arrayBufferToBinaryString(c)}function Iz(t){var e=Array.apply([],t);return e.unshift(0),e}function AS(t,e){var r=t.length,a=[];a[0]=1;for(var n=0;n<r;n+=1){var s=t[n-e]||0;a[n+1]=t[n]-s+256&255}return a}function CS(t,e,r){var a=t.length,n=[];n[0]=2;for(var s=0;s<a;s+=1){var l=r&&r[s]||0;n[s+1]=t[s]-l+256&255}return n}function TS(t,e,r){var a=t.length,n=[];n[0]=3;for(var s=0;s<a;s+=1){var l=t[s-e]||0,c=r&&r[s]||0;n[s+1]=t[s]+256-(l+c>>>1)&255}return n}function OS(t,e,r){var a=t.length,n=[];n[0]=4;for(var s=0;s<a;s+=1){var l=Bz(t[s-e]||0,r&&r[s]||0,r&&r[s-e]||0);n[s+1]=t[s]-l+256&255}return n}function Bz(t,e,r){if(t===e&&e===r)return t;var a=Math.abs(e-r),n=Math.abs(t-r),s=Math.abs(t+e-r-r);return a<=n&&a<=s?t:n<=s?e:r}function Uz(t){var e=t.map(function(r){return r.reduce(function(a,n){return a+Math.abs(n)},0)});return e.indexOf(Math.min.apply(null,e))}function zv(t,e,r){var a=e*r,n=Math.floor(a/8),s=16-(a-8*n+r),l=(1<<r)-1;return ok(t,n)>>s&l}function RS(t,e,r,a){var n=r*a,s=Math.floor(n/8),l=16-(n-8*s+a),c=(1<<a)-1,f=(e&c)<<l;(function(d,m,v){if(m+1<d.byteLength)d.setUint16(m,v,!1);else{var x=v>>8&255;d.setUint8(m,x)}})(t,s,ok(t,s)&~(c<<l)&65535|f)}function ok(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function qz(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,a=t[e++]|t[e++]<<8,n=t[e++],s=n>>7,l=1<<1+(7&n);t[e++],t[e++];var c=null,f=null;s&&(c=e,f=l,e+=3*l);var d=!0,m=[],v=0,x=null,g=0,b=null;for(this.width=r,this.height=a;d&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,b=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((D=t[e++])>=0))throw Error("Invalid block size");if(D===0)break;e+=D}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var _=t[e++];v=t[e++]|t[e++]<<8,x=t[e++],1&_||(x=null),g=_>>2&7,e++;break;case 254:for(;;){if(!((D=t[e++])>=0))throw Error("Invalid block size");if(D===0)break;e+=D}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var w=t[e++]|t[e++]<<8,E=t[e++]|t[e++]<<8,C=t[e++]|t[e++]<<8,A=t[e++]|t[e++]<<8,T=t[e++],G=T>>6&1,W=1<<1+(7&T),B=c,q=f,L=!1;T>>7&&(L=!0,B=e,q=W,e+=3*W);var J=e;for(e++;;){var D;if(!((D=t[e++])>=0))throw Error("Invalid block size");if(D===0)break;e+=D}m.push({x:w,y:E,width:C,height:A,has_local_palette:L,palette_offset:B,palette_size:q,data_offset:J,data_length:e-J,transparent_index:x,interlaced:!!G,delay:v,disposal:g});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return m.length},this.loopCount=function(){return b},this.frameInfo=function(O){if(O<0||O>=m.length)throw new Error("Frame index out of range.");return m[O]},this.decodeAndBlitFrameBGRA=function(O,M){var V=this.frameInfo(O),ie=V.width*V.height,X=new Uint8Array(ie);DS(t,V.data_offset,X,ie);var Z=V.palette_offset,K=V.transparent_index;K===null&&(K=256);var ae=V.width,fe=r-ae,U=ae,j=4*(V.y*r+V.x),F=4*((V.y+V.height)*r+V.x),I=j,z=4*fe;V.interlaced===!0&&(z+=4*r*7);for(var ne=8,se=0,pe=X.length;se<pe;++se){var ye=X[se];if(U===0&&(U=ae,(I+=z)>=F&&(z=4*fe+4*r*(ne-1),I=j+(ae+fe)*(ne<<1),ne>>=1)),ye===K)I+=4;else{var _e=t[Z+3*ye],Le=t[Z+3*ye+1],ue=t[Z+3*ye+2];M[I++]=ue,M[I++]=Le,M[I++]=_e,M[I++]=255}--U}},this.decodeAndBlitFrameRGBA=function(O,M){var V=this.frameInfo(O),ie=V.width*V.height,X=new Uint8Array(ie);DS(t,V.data_offset,X,ie);var Z=V.palette_offset,K=V.transparent_index;K===null&&(K=256);var ae=V.width,fe=r-ae,U=ae,j=4*(V.y*r+V.x),F=4*((V.y+V.height)*r+V.x),I=j,z=4*fe;V.interlaced===!0&&(z+=4*r*7);for(var ne=8,se=0,pe=X.length;se<pe;++se){var ye=X[se];if(U===0&&(U=ae,(I+=z)>=F&&(z=4*fe+4*r*(ne-1),I=j+(ae+fe)*(ne<<1),ne>>=1)),ye===K)I+=4;else{var _e=t[Z+3*ye],Le=t[Z+3*ye+1],ue=t[Z+3*ye+2];M[I++]=_e,M[I++]=Le,M[I++]=ue,M[I++]=255}--U}}}function DS(t,e,r,a){for(var n=t[e++],s=1<<n,l=s+1,c=l+1,f=n+1,d=(1<<f)-1,m=0,v=0,x=0,g=t[e++],b=new Int32Array(4096),_=null;;){for(;m<16&&g!==0;)v|=t[e++]<<m,m+=8,g===1?g=t[e++]:--g;if(m<f)break;var w=v&d;if(v>>=f,m-=f,w!==s){if(w===l)break;for(var E=w<c?w:_,C=0,A=E;A>s;)A=b[A]>>8,++C;var T=A;if(x+C+(E!==w?1:0)>a)return void Oa.log("Warning, gif stream longer than expected.");r[x++]=T;var G=x+=C;for(E!==w&&(r[x++]=T),A=E;C--;)A=b[A],r[--G]=255&A,A>>=8;_!==null&&c<4096&&(b[c++]=_<<8|T,c>=d+1&&f<12&&(++f,d=d<<1|1)),_=w}else c=l+1,d=(1<<(f=n+1))-1,_=null}return x!==a&&Oa.log("Warning, gif stream shorter than expected."),r}function Hv(t){var e,r,a,n,s,l=Math.floor,c=new Array(64),f=new Array(64),d=new Array(64),m=new Array(64),v=new Array(65535),x=new Array(65535),g=new Array(64),b=new Array(64),_=[],w=0,E=7,C=new Array(64),A=new Array(64),T=new Array(64),G=new Array(256),W=new Array(2048),B=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],q=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],L=[0,1,2,3,4,5,6,7,8,9,10,11],J=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],D=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],O=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],M=[0,1,2,3,4,5,6,7,8,9,10,11],V=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ie=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function X(j,F){for(var I=0,z=0,ne=new Array,se=1;se<=16;se++){for(var pe=1;pe<=j[se];pe++)ne[F[z]]=[],ne[F[z]][0]=I,ne[F[z]][1]=se,z++,I++;I*=2}return ne}function Z(j){for(var F=j[0],I=j[1]-1;I>=0;)F&1<<I&&(w|=1<<E),I--,--E<0&&(w==255?(K(255),K(0)):K(w),E=7,w=0)}function K(j){_.push(j)}function ae(j){K(j>>8&255),K(255&j)}function fe(j,F,I,z,ne){for(var se,pe=ne[0],ye=ne[240],_e=(function(Ie,wt){var Xe,ct,jt,Lt,Vt,$t,Wt,Ot,kt,qe,Ye=0;for(kt=0;kt<8;++kt){Xe=Ie[Ye],ct=Ie[Ye+1],jt=Ie[Ye+2],Lt=Ie[Ye+3],Vt=Ie[Ye+4],$t=Ie[Ye+5],Wt=Ie[Ye+6];var Pt=Xe+(Ot=Ie[Ye+7]),Et=Xe-Ot,Dt=ct+Wt,Ce=ct-Wt,$e=jt+$t,xe=jt-$t,Be=Lt+Vt,Pe=Lt-Vt,Ct=Pt+Be,gt=Pt-Be,Rt=Dt+$e,It=Dt-$e;Ie[Ye]=Ct+Rt,Ie[Ye+4]=Ct-Rt;var pr=.707106781*(It+gt);Ie[Ye+2]=gt+pr,Ie[Ye+6]=gt-pr;var sa=.382683433*((Ct=Pe+xe)-(It=Ce+Et)),fa=.5411961*Ct+sa,Nt=1.306562965*It+sa,Ea=.707106781*(Rt=xe+Ce),rr=Et+Ea,ya=Et-Ea;Ie[Ye+5]=ya+fa,Ie[Ye+3]=ya-fa,Ie[Ye+1]=rr+Nt,Ie[Ye+7]=rr-Nt,Ye+=8}for(Ye=0,kt=0;kt<8;++kt){Xe=Ie[Ye],ct=Ie[Ye+8],jt=Ie[Ye+16],Lt=Ie[Ye+24],Vt=Ie[Ye+32],$t=Ie[Ye+40],Wt=Ie[Ye+48];var vn=Xe+(Ot=Ie[Ye+56]),Da=Xe-Ot,an=ct+Wt,qt=ct-Wt,Kt=jt+$t,re=jt-$t,Ne=Lt+Vt,me=Lt-Vt,ge=vn+Ne,we=vn-Ne,je=an+Kt,We=an-Kt;Ie[Ye]=ge+je,Ie[Ye+32]=ge-je;var st=.707106781*(We+we);Ie[Ye+16]=we+st,Ie[Ye+48]=we-st;var Ke=.382683433*((ge=me+re)-(We=qt+Da)),Je=.5411961*ge+Ke,Qe=1.306562965*We+Ke,St=.707106781*(je=re+qt),Ft=Da+St,Ht=Da-St;Ie[Ye+40]=Ht+Je,Ie[Ye+24]=Ht-Je,Ie[Ye+8]=Ft+Qe,Ie[Ye+56]=Ft-Qe,Ye++}for(kt=0;kt<64;++kt)qe=Ie[kt]*wt[kt],g[kt]=qe>0?qe+.5|0:qe-.5|0;return g})(j,F),Le=0;Le<64;++Le)b[B[Le]]=_e[Le];var ue=b[0]-I;I=b[0],ue==0?Z(z[0]):(Z(z[x[se=32767+ue]]),Z(v[se]));for(var at=63;at>0&&b[at]==0;)at--;if(at==0)return Z(pe),I;for(var ht,de=1;de<=at;){for(var it=de;b[de]==0&&de<=at;)++de;var Se=de-it;if(Se>=16){ht=Se>>4;for(var ve=1;ve<=ht;++ve)Z(ye);Se&=15}se=32767+b[de],Z(ne[(Se<<4)+x[se]]),Z(v[se]),de++}return at!=63&&Z(pe),I}function U(j){j=Math.min(Math.max(j,1),100),s!=j&&((function(F){for(var I=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],z=0;z<64;z++){var ne=l((I[z]*F+50)/100);ne=Math.min(Math.max(ne,1),255),c[B[z]]=ne}for(var se=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],pe=0;pe<64;pe++){var ye=l((se[pe]*F+50)/100);ye=Math.min(Math.max(ye,1),255),f[B[pe]]=ye}for(var _e=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Le=0,ue=0;ue<8;ue++)for(var at=0;at<8;at++)d[Le]=1/(c[B[Le]]*_e[ue]*_e[at]*8),m[Le]=1/(f[B[Le]]*_e[ue]*_e[at]*8),Le++})(j<50?Math.floor(5e3/j):Math.floor(200-2*j)),s=j)}this.encode=function(j,F){F&&U(F),_=new Array,w=0,E=7,ae(65496),ae(65504),ae(16),K(74),K(70),K(73),K(70),K(0),K(1),K(1),K(0),ae(1),ae(1),K(0),K(0),(function(){ae(65499),ae(132),K(0);for(var ct=0;ct<64;ct++)K(c[ct]);K(1);for(var jt=0;jt<64;jt++)K(f[jt])})(),(function(ct,jt){ae(65472),ae(17),K(8),ae(jt),ae(ct),K(3),K(1),K(17),K(0),K(2),K(17),K(1),K(3),K(17),K(1)})(j.width,j.height),(function(){ae(65476),ae(418),K(0);for(var ct=0;ct<16;ct++)K(q[ct+1]);for(var jt=0;jt<=11;jt++)K(L[jt]);K(16);for(var Lt=0;Lt<16;Lt++)K(J[Lt+1]);for(var Vt=0;Vt<=161;Vt++)K(D[Vt]);K(1);for(var $t=0;$t<16;$t++)K(O[$t+1]);for(var Wt=0;Wt<=11;Wt++)K(M[Wt]);K(17);for(var Ot=0;Ot<16;Ot++)K(V[Ot+1]);for(var kt=0;kt<=161;kt++)K(ie[kt])})(),ae(65498),ae(12),K(3),K(1),K(0),K(2),K(17),K(3),K(17),K(0),K(63),K(0);var I=0,z=0,ne=0;w=0,E=7,this.encode.displayName="_encode_";for(var se,pe,ye,_e,Le,ue,at,ht,de,it=j.data,Se=j.width,ve=j.height,Ie=4*Se,wt=0;wt<ve;){for(se=0;se<Ie;){for(Le=Ie*wt+se,at=-1,ht=0,de=0;de<64;de++)ue=Le+(ht=de>>3)*Ie+(at=4*(7&de)),wt+ht>=ve&&(ue-=Ie*(wt+1+ht-ve)),se+at>=Ie&&(ue-=se+at-Ie+4),pe=it[ue++],ye=it[ue++],_e=it[ue++],C[de]=(W[pe]+W[ye+256|0]+W[_e+512|0]>>16)-128,A[de]=(W[pe+768|0]+W[ye+1024|0]+W[_e+1280|0]>>16)-128,T[de]=(W[pe+1280|0]+W[ye+1536|0]+W[_e+1792|0]>>16)-128;I=fe(C,d,I,e,a),z=fe(A,m,z,r,n),ne=fe(T,m,ne,r,n),se+=32}wt+=8}if(E>=0){var Xe=[];Xe[1]=E+1,Xe[0]=(1<<E+1)-1,Z(Xe)}return ae(65497),new Uint8Array(_)},t=t||50,(function(){for(var j=String.fromCharCode,F=0;F<256;F++)G[F]=j(F)})(),e=X(q,L),r=X(O,M),a=X(J,D),n=X(V,ie),(function(){for(var j=1,F=2,I=1;I<=15;I++){for(var z=j;z<F;z++)x[32767+z]=I,v[32767+z]=[],v[32767+z][1]=I,v[32767+z][0]=z;for(var ne=-(F-1);ne<=-j;ne++)x[32767+ne]=I,v[32767+ne]=[],v[32767+ne][1]=I,v[32767+ne][0]=F-1+ne;j<<=1,F<<=1}})(),(function(){for(var j=0;j<256;j++)W[j]=19595*j,W[j+256|0]=38470*j,W[j+512|0]=7471*j+32768,W[j+768|0]=-11059*j,W[j+1024|0]=-21709*j,W[j+1280|0]=32768*j+8421375,W[j+1536|0]=-27439*j,W[j+1792|0]=-5329*j})(),U(t)}function zo(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function FS(t){function e(L){if(!L)throw Error("assert :P")}function r(L,J,D){for(var O=0;4>O;O++)if(L[J+O]!=D.charCodeAt(O))return!0;return!1}function a(L,J,D,O,M){for(var V=0;V<M;V++)L[J+V]=D[O+V]}function n(L,J,D,O){for(var M=0;M<O;M++)L[J+M]=D}function s(L){return new Int32Array(L)}function l(L,J){for(var D=[],O=0;O<L;O++)D.push(new J);return D}function c(L,J){var D=[];return(function O(M,V,ie){for(var X=ie[V],Z=0;Z<X&&(M.push(ie.length>V+1?[]:new J),!(ie.length<V+1));Z++)O(M[Z],V+1,ie)})(D,0,L),D}var f=function(){var L=this;function J(y,N){for(var P=1<<N-1>>>0;y&P;)P>>>=1;return P?(y&P-1)+P:y}function D(y,N,P,H,te){e(!(H%P));do y[N+(H-=P)]=te;while(0<H)}function O(y,N,P,H,te){if(e(2328>=te),512>=te)var oe=s(512);else if((oe=s(te))==null)return 0;return(function(le,he,be,Ee,De,Ze){var ke,Me,Ve=he,ut=1<<be,Ge=s(16),lt=s(16);for(e(De!=0),e(Ee!=null),e(le!=null),e(0<be),Me=0;Me<De;++Me){if(15<Ee[Me])return 0;++Ge[Ee[Me]]}if(Ge[0]==De)return 0;for(lt[1]=0,ke=1;15>ke;++ke){if(Ge[ke]>1<<ke)return 0;lt[ke+1]=lt[ke]+Ge[ke]}for(Me=0;Me<De;++Me)ke=Ee[Me],0<Ee[Me]&&(Ze[lt[ke]++]=Me);if(lt[15]==1)return(Ee=new M).g=0,Ee.value=Ze[0],D(le,Ve,1,ut,Ee),ut;var pt,At=-1,yt=ut-1,ar=0,Gt=1,Nr=1,Zt=1<<be;for(Me=0,ke=1,De=2;ke<=be;++ke,De<<=1){if(Gt+=Nr<<=1,0>(Nr-=Ge[ke]))return 0;for(;0<Ge[ke];--Ge[ke])(Ee=new M).g=ke,Ee.value=Ze[Me++],D(le,Ve+ar,De,Zt,Ee),ar=J(ar,ke)}for(ke=be+1,De=2;15>=ke;++ke,De<<=1){if(Gt+=Nr<<=1,0>(Nr-=Ge[ke]))return 0;for(;0<Ge[ke];--Ge[ke]){if(Ee=new M,(ar&yt)!=At){for(Ve+=Zt,pt=1<<(At=ke)-be;15>At&&!(0>=(pt-=Ge[At]));)++At,pt<<=1;ut+=Zt=1<<(pt=At-be),le[he+(At=ar&yt)].g=pt+be,le[he+At].value=Ve-he-At}Ee.g=ke-be,Ee.value=Ze[Me++],D(le,Ve+(ar>>be),De,Zt,Ee),ar=J(ar,ke)}}return Gt!=2*lt[15]-1?0:ut})(y,N,P,H,te,oe)}function M(){this.value=this.g=0}function V(){this.value=this.g=0}function ie(){this.G=l(5,M),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=l(sl,V)}function X(y,N,P,H){e(y!=null),e(N!=null),e(2147483648>H),y.Ca=254,y.I=0,y.b=-8,y.Ka=0,y.oa=N,y.pa=P,y.Jd=N,y.Yc=P+H,y.Zc=4<=H?P+H-4+1:P,pe(y)}function Z(y,N){for(var P=0;0<N--;)P|=_e(y,128)<<N;return P}function K(y,N){var P=Z(y,N);return ye(y)?-P:P}function ae(y,N,P,H){var te,oe=0;for(e(y!=null),e(N!=null),e(4294967288>H),y.Sb=H,y.Ra=0,y.u=0,y.h=0,4<H&&(H=4),te=0;te<H;++te)oe+=N[P+te]<<8*te;y.Ra=oe,y.bb=H,y.oa=N,y.pa=P}function fe(y){for(;8<=y.u&&y.bb<y.Sb;)y.Ra>>>=8,y.Ra+=y.oa[y.pa+y.bb]<<Gi-8>>>0,++y.bb,y.u-=8;z(y)&&(y.h=1,y.u=0)}function U(y,N){if(e(0<=N),!y.h&&N<=ds){var P=I(y)&ws[N];return y.u+=N,fe(y),P}return y.h=1,y.u=0}function j(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function F(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function I(y){return y.Ra>>>(y.u&Gi-1)>>>0}function z(y){return e(y.bb<=y.Sb),y.h||y.bb==y.Sb&&y.u>Gi}function ne(y,N){y.u=N,y.h=z(y)}function se(y){y.u>=Yi&&(e(y.u>=Yi),fe(y))}function pe(y){e(y!=null&&y.oa!=null),y.pa<y.Zc?(y.I=(y.oa[y.pa++]|y.I<<8)>>>0,y.b+=8):(e(y!=null&&y.oa!=null),y.pa<y.Yc?(y.b+=8,y.I=y.oa[y.pa++]|y.I<<8):y.Ka?y.b=0:(y.I<<=8,y.b+=8,y.Ka=1))}function ye(y){return Z(y,1)}function _e(y,N){var P=y.Ca;0>y.b&&pe(y);var H=y.b,te=P*N>>>8,oe=(y.I>>>H>te)+0;for(oe?(P-=te,y.I-=te+1<<H>>>0):P=te+1,H=P,te=0;256<=H;)te+=8,H>>=8;return H=7^te+Ao[H],y.b-=H,y.Ca=(P<<H)-1,oe}function Le(y,N,P){y[N+0]=P>>24&255,y[N+1]=P>>16&255,y[N+2]=P>>8&255,y[N+3]=255&P}function ue(y,N){return y[N+0]|y[N+1]<<8}function at(y,N){return ue(y,N)|y[N+2]<<16}function ht(y,N){return ue(y,N)|ue(y,N+2)<<16}function de(y,N){var P=1<<N;return e(y!=null),e(0<N),y.X=s(P),y.X==null?0:(y.Mb=32-N,y.Xa=N,1)}function it(y,N){e(y!=null),e(N!=null),e(y.Xa==N.Xa),a(N.X,0,y.X,0,1<<N.Xa)}function Se(){this.X=[],this.Xa=this.Mb=0}function ve(y,N,P,H){e(P!=null),e(H!=null);var te=P[0],oe=H[0];return te==0&&(te=(y*oe+N/2)/N),oe==0&&(oe=(N*te+y/2)/y),0>=te||0>=oe?0:(P[0]=te,H[0]=oe,1)}function Ie(y,N){return y+(1<<N)-1>>>N}function wt(y,N){return((4278255360&y)+(4278255360&N)>>>0&4278255360)+((16711935&y)+(16711935&N)>>>0&16711935)>>>0}function Xe(y,N){L[N]=function(P,H,te,oe,le,he,be){var Ee;for(Ee=0;Ee<le;++Ee){var De=L[y](he[be+Ee-1],te,oe+Ee);he[be+Ee]=wt(P[H+Ee],De)}}}function ct(){this.ud=this.hd=this.jd=0}function jt(y,N){return((4278124286&(y^N))>>>1)+(y&N)>>>0}function Lt(y){return 0<=y&&256>y?y:0>y?0:255<y?255:void 0}function Vt(y,N){return Lt(y+(y-N+.5>>1))}function $t(y,N,P){return Math.abs(N-P)-Math.abs(y-P)}function Wt(y,N,P,H,te,oe,le){for(H=oe[le-1],P=0;P<te;++P)oe[le+P]=H=wt(y[N+P],H)}function Ot(y,N,P,H,te){var oe;for(oe=0;oe<P;++oe){var le=y[N+oe],he=le>>8&255,be=16711935&(be=(be=16711935&le)+((he<<16)+he));H[te+oe]=(4278255360&le)+be>>>0}}function kt(y,N){N.jd=255&y,N.hd=y>>8&255,N.ud=y>>16&255}function qe(y,N,P,H,te,oe){var le;for(le=0;le<H;++le){var he=N[P+le],be=he>>>8,Ee=he,De=255&(De=(De=he>>>16)+((y.jd<<24>>24)*(be<<24>>24)>>>5));Ee=255&(Ee=(Ee+=(y.hd<<24>>24)*(be<<24>>24)>>>5)+((y.ud<<24>>24)*(De<<24>>24)>>>5)),te[oe+le]=(4278255360&he)+(De<<16)+Ee}}function Ye(y,N,P,H,te){L[N]=function(oe,le,he,be,Ee,De,Ze,ke,Me){for(be=Ze;be<ke;++be)for(Ze=0;Ze<Me;++Ze)Ee[De++]=te(he[H(oe[le++])])},L[y]=function(oe,le,he,be,Ee,De,Ze){var ke=8>>oe.b,Me=oe.Ea,Ve=oe.K[0],ut=oe.w;if(8>ke)for(oe=(1<<oe.b)-1,ut=(1<<ke)-1;le<he;++le){var Ge,lt=0;for(Ge=0;Ge<Me;++Ge)Ge&oe||(lt=H(be[Ee++])),De[Ze++]=te(Ve[lt&ut]),lt>>=ke}else L["VP8LMapColor"+P](be,Ee,Ve,ut,De,Ze,le,he,Me)}}function Pt(y,N,P,H,te){for(P=N+P;N<P;){var oe=y[N++];H[te++]=oe>>16&255,H[te++]=oe>>8&255,H[te++]=255&oe}}function Et(y,N,P,H,te){for(P=N+P;N<P;){var oe=y[N++];H[te++]=oe>>16&255,H[te++]=oe>>8&255,H[te++]=255&oe,H[te++]=oe>>24&255}}function Dt(y,N,P,H,te){for(P=N+P;N<P;){var oe=(le=y[N++])>>16&240|le>>12&15,le=240&le|le>>28&15;H[te++]=oe,H[te++]=le}}function Ce(y,N,P,H,te){for(P=N+P;N<P;){var oe=(le=y[N++])>>16&248|le>>13&7,le=le>>5&224|le>>3&31;H[te++]=oe,H[te++]=le}}function $e(y,N,P,H,te){for(P=N+P;N<P;){var oe=y[N++];H[te++]=255&oe,H[te++]=oe>>8&255,H[te++]=oe>>16&255}}function xe(y,N,P,H,te,oe){if(oe==0)for(P=N+P;N<P;)Le(H,((oe=y[N++])[0]>>24|oe[1]>>8&65280|oe[2]<<8&16711680|oe[3]<<24)>>>0),te+=32;else a(H,te,y,N,P)}function Be(y,N){L[N][0]=L[y+"0"],L[N][1]=L[y+"1"],L[N][2]=L[y+"2"],L[N][3]=L[y+"3"],L[N][4]=L[y+"4"],L[N][5]=L[y+"5"],L[N][6]=L[y+"6"],L[N][7]=L[y+"7"],L[N][8]=L[y+"8"],L[N][9]=L[y+"9"],L[N][10]=L[y+"10"],L[N][11]=L[y+"11"],L[N][12]=L[y+"12"],L[N][13]=L[y+"13"],L[N][14]=L[y+"0"],L[N][15]=L[y+"0"]}function Pe(y){return y==Wu||y==td||y==Lc||y==rd}function Ct(){this.eb=[],this.size=this.A=this.fb=0}function gt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Rt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Ct,this.f.kb=new gt,this.sd=null}function It(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function pr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function sa(y){return alert("todo:WebPSamplerProcessPlane"),y.T}function fa(y,N){var P=y.T,H=N.ba.f.RGBA,te=H.eb,oe=H.fb+y.ka*H.A,le=$n[N.ba.S],he=y.y,be=y.O,Ee=y.f,De=y.N,Ze=y.ea,ke=y.W,Me=N.cc,Ve=N.dc,ut=N.Mc,Ge=N.Nc,lt=y.ka,pt=y.ka+y.T,At=y.U,yt=At+1>>1;for(lt==0?le(he,be,null,null,Ee,De,Ze,ke,Ee,De,Ze,ke,te,oe,null,null,At):(le(N.ec,N.fc,he,be,Me,Ve,ut,Ge,Ee,De,Ze,ke,te,oe-H.A,te,oe,At),++P);lt+2<pt;lt+=2)Me=Ee,Ve=De,ut=Ze,Ge=ke,De+=y.Rc,ke+=y.Rc,oe+=2*H.A,le(he,(be+=2*y.fa)-y.fa,he,be,Me,Ve,ut,Ge,Ee,De,Ze,ke,te,oe-H.A,te,oe,At);return be+=y.fa,y.j+pt<y.o?(a(N.ec,N.fc,he,be,At),a(N.cc,N.dc,Ee,De,yt),a(N.Mc,N.Nc,Ze,ke,yt),P--):1&pt||le(he,be,null,null,Ee,De,Ze,ke,Ee,De,Ze,ke,te,oe+H.A,null,null,At),P}function Nt(y,N,P){var H=y.F,te=[y.J];if(H!=null){var oe=y.U,le=N.ba.S,he=le==$u||le==Lc;N=N.ba.f.RGBA;var be=[0],Ee=y.ka;be[0]=y.T,y.Kb&&(Ee==0?--be[0]:(--Ee,te[0]-=y.width),y.j+y.ka+y.T==y.o&&(be[0]=y.o-y.j-Ee));var De=N.eb;Ee=N.fb+Ee*N.A,y=Uu(H,te[0],y.width,oe,be,De,Ee+(he?0:3),N.A),e(P==be),y&&Pe(le)&&Ul(De,Ee,he,oe,be,N.A)}return 0}function Ea(y){var N=y.ma,P=N.ba.S,H=11>P,te=P==es||P==Qs||P==$u||P==Fc||P==12||Pe(P);if(N.memory=null,N.Ib=null,N.Jb=null,N.Nd=null,!Eo(N.Oa,y,te?11:12))return 0;if(te&&Pe(P)&&Pu(),y.da)alert("todo:use_scaling");else{if(H){if(N.Ib=sa,y.Kb){if(P=y.U+1>>1,N.memory=s(y.U+2*P),N.memory==null)return 0;N.ec=N.memory,N.fc=0,N.cc=N.ec,N.dc=N.fc+y.U,N.Mc=N.cc,N.Nc=N.dc+P,N.Ib=fa,Pu()}}else alert("todo:EmitYUV");te&&(N.Jb=Nt,H&&bi())}if(H&&!dl){for(y=0;256>y;++y)Wn[y]=89858*(y-128)+Ic>>si,D1[y]=-22014*(y-128)+Ic,mm[y]=-45773*(y-128),od[y]=113618*(y-128)+Ic>>si;for(y=$l;y<fl;++y)N=76283*(y-16)+Ic>>si,F1[y-$l]=Fa(N,255),L1[y-$l]=Fa(N+8>>4,15);dl=1}return 1}function rr(y){var N=y.ma,P=y.U,H=y.T;return e(!(1&y.ka)),0>=P||0>=H?0:(P=N.Ib(y,N),N.Jb!=null&&N.Jb(y,N,P),N.Dc+=P,1)}function ya(y){y.ma.memory=null}function vn(y,N,P,H){return U(y,8)!=47?0:(N[0]=U(y,14)+1,P[0]=U(y,14)+1,H[0]=U(y,1),U(y,3)!=0?0:!y.h)}function Da(y,N){if(4>y)return y+1;var P=y-2>>1;return(2+(1&y)<<P)+U(N,P)+1}function an(y,N){return 120<N?N-120:1<=(P=((P=ti[N-1])>>4)*y+(8-(15&P)))?P:1;var P}function qt(y,N,P){var H=I(P),te=y[N+=255&H].g-8;return 0<te&&(ne(P,P.u+8),H=I(P),N+=y[N].value,N+=H&(1<<te)-1),ne(P,P.u+y[N].g),y[N].value}function Kt(y,N,P){return P.g+=y.g,P.value+=y.value<<N>>>0,e(8>=P.g),y.g}function re(y,N,P){var H=y.xc;return e((N=H==0?0:y.vc[y.md*(P>>H)+(N>>H)])<y.Wb),y.Ya[N]}function Ne(y,N,P,H){var te=y.ab,oe=y.c*N,le=y.C;N=le+N;var he=P,be=H;for(H=y.Ta,P=y.Ua;0<te--;){var Ee=y.gc[te],De=le,Ze=N,ke=he,Me=be,Ve=(be=H,he=P,Ee.Ea);switch(e(De<Ze),e(Ze<=Ee.nc),Ee.hc){case 2:Ka(ke,Me,(Ze-De)*Ve,be,he);break;case 0:var ut=De,Ge=Ze,lt=be,pt=he,At=(Zt=Ee).Ea;ut==0&&(Tc(ke,Me,null,null,1,lt,pt),Wt(ke,Me+1,0,0,At-1,lt,pt+1),Me+=At,pt+=At,++ut);for(var yt=1<<Zt.b,ar=yt-1,Gt=Ie(At,Zt.b),Nr=Zt.K,Zt=Zt.w+(ut>>Zt.b)*Gt;ut<Ge;){var Mr=Nr,Ca=Zt,Er=1;for(Oc(ke,Me,lt,pt-At,1,lt,pt);Er<At;){var Yt=(Er&~ar)+yt;Yt>At&&(Yt=At),(0,Co[Mr[Ca++]>>8&15])(ke,Me+ +Er,lt,pt+Er-At,Yt-Er,lt,pt+Er),Er=Yt}Me+=At,pt+=At,++ut&ar||(Zt+=Gt)}Ze!=Ee.nc&&a(be,he-Ve,be,he+(Ze-De-1)*Ve,Ve);break;case 1:for(Ve=ke,Ge=Me,At=(ke=Ee.Ea)-(pt=ke&~(lt=(Me=1<<Ee.b)-1)),ut=Ie(ke,Ee.b),yt=Ee.K,Ee=Ee.w+(De>>Ee.b)*ut;De<Ze;){for(ar=yt,Gt=Ee,Nr=new ct,Zt=Ge+pt,Mr=Ge+ke;Ge<Zt;)kt(ar[Gt++],Nr),Rc(Nr,Ve,Ge,Me,be,he),Ge+=Me,he+=Me;Ge<Mr&&(kt(ar[Gt++],Nr),Rc(Nr,Ve,Ge,At,be,he),Ge+=At,he+=At),++De&lt||(Ee+=ut)}break;case 3:if(ke==be&&Me==he&&0<Ee.b){for(Ge=be,ke=Ve=he+(Ze-De)*Ve-(pt=(Ze-De)*Ie(Ee.Ea,Ee.b)),Me=be,lt=he,ut=[],pt=(At=pt)-1;0<=pt;--pt)ut[pt]=Me[lt+pt];for(pt=At-1;0<=pt;--pt)Ge[ke+pt]=ut[pt];Kf(Ee,De,Ze,be,Ve,be,he)}else Kf(Ee,De,Ze,ke,Me,be,he)}he=H,be=P}be!=P&&a(H,P,he,be,oe)}function me(y,N){var P=y.V,H=y.Ba+y.c*y.C,te=N-y.C;if(e(N<=y.l.o),e(16>=te),0<te){var oe=y.l,le=y.Ta,he=y.Ua,be=oe.width;if(Ne(y,te,P,H),te=he=[he],e((P=y.C)<(H=N)),e(oe.v<oe.va),H>oe.o&&(H=oe.o),P<oe.j){var Ee=oe.j-P;P=oe.j,te[0]+=Ee*be}if(P>=H?P=0:(te[0]+=4*oe.v,oe.ka=P-oe.j,oe.U=oe.va-oe.v,oe.T=H-P,P=1),P){if(he=he[0],11>(P=y.ca).S){var De=P.f.RGBA,Ze=(H=P.S,te=oe.U,oe=oe.T,Ee=De.eb,De.A),ke=oe;for(De=De.fb+y.Ma*De.A;0<ke--;){var Me=le,Ve=he,ut=te,Ge=Ee,lt=De;switch(H){case Qf:Dc(Me,Ve,ut,Ge,lt);break;case es:To(Me,Ve,ut,Ge,lt);break;case Wu:To(Me,Ve,ut,Ge,lt),Ul(Ge,lt,0,ut,1,0);break;case ed:Il(Me,Ve,ut,Ge,lt);break;case Qs:xe(Me,Ve,ut,Ge,lt,1);break;case td:xe(Me,Ve,ut,Ge,lt,1),Ul(Ge,lt,0,ut,1,0);break;case $u:xe(Me,Ve,ut,Ge,lt,0);break;case Lc:xe(Me,Ve,ut,Ge,lt,0),Ul(Ge,lt,1,ut,1,0);break;case Fc:Oo(Me,Ve,ut,Ge,lt);break;case rd:Oo(Me,Ve,ut,Ge,lt),Zs(Ge,lt,ut,1,0);break;case il:Ji(Me,Ve,ut,Ge,lt);break;default:e(0)}he+=be,De+=Ze}y.Ma+=oe}else alert("todo:EmitRescaledRowsYUVA");e(y.Ma<=P.height)}}y.C=N,e(y.C<=y.i)}function ge(y){var N;if(0<y.ua)return 0;for(N=0;N<y.Wb;++N){var P=y.Ya[N].G,H=y.Ya[N].H;if(0<P[1][H[1]+0].g||0<P[2][H[2]+0].g||0<P[3][H[3]+0].g)return 0}return 1}function we(y,N,P,H,te,oe){if(y.Z!=0){var le=y.qd,he=y.rd;for(e(Fo[y.Z]!=null);N<P;++N)Fo[y.Z](le,he,H,te,H,te,oe),le=H,he=te,te+=oe;y.qd=le,y.rd=he}}function je(y,N){var P=y.l.ma,H=P.Z==0||P.Z==1?y.l.j:y.C;if(H=y.C<H?H:y.C,e(N<=y.l.o),N>H){var te=y.l.width,oe=P.ca,le=P.tb+te*H,he=y.V,be=y.Ba+y.c*H,Ee=y.gc;e(y.ab==1),e(Ee[0].hc==3),Ki(Ee[0],H,N,he,be,oe,le),we(P,H,N,oe,le,te)}y.C=y.Ma=N}function We(y,N,P,H,te,oe,le){var he=y.$/H,be=y.$%H,Ee=y.m,De=y.s,Ze=P+y.$,ke=Ze;te=P+H*te;var Me=P+H*oe,Ve=280+De.ua,ut=y.Pb?he:16777216,Ge=0<De.ua?De.Wa:null,lt=De.wc,pt=Ze<Me?re(De,be,he):null;e(y.C<oe),e(Me<=te);var At=!1;e:for(;;){for(;At||Ze<Me;){var yt=0;if(he>=ut){var ar=Ze-P;e((ut=y).Pb),ut.wd=ut.m,ut.xd=ar,0<ut.s.ua&&it(ut.s.Wa,ut.s.vb),ut=he+ol}if(be&lt||(pt=re(De,be,he)),e(pt!=null),pt.Qb&&(N[Ze]=pt.qb,At=!0),!At)if(se(Ee),pt.jc){yt=Ee,ar=N;var Gt=Ze,Nr=pt.pd[I(yt)&sl-1];e(pt.jc),256>Nr.g?(ne(yt,yt.u+Nr.g),ar[Gt]=Nr.value,yt=0):(ne(yt,yt.u+Nr.g-256),e(256<=Nr.value),yt=Nr.value),yt==0&&(At=!0)}else yt=qt(pt.G[0],pt.H[0],Ee);if(Ee.h)break;if(At||256>yt){if(!At)if(pt.nd)N[Ze]=(pt.qb|yt<<8)>>>0;else{if(se(Ee),At=qt(pt.G[1],pt.H[1],Ee),se(Ee),ar=qt(pt.G[2],pt.H[2],Ee),Gt=qt(pt.G[3],pt.H[3],Ee),Ee.h)break;N[Ze]=(Gt<<24|At<<16|yt<<8|ar)>>>0}if(At=!1,++Ze,++be>=H&&(be=0,++he,le!=null&&he<=oe&&!(he%16)&&le(y,he),Ge!=null))for(;ke<Ze;)yt=N[ke++],Ge.X[(506832829*yt&4294967295)>>>Ge.Mb]=yt}else if(280>yt){if(yt=Da(yt-256,Ee),ar=qt(pt.G[4],pt.H[4],Ee),se(Ee),ar=an(H,ar=Da(ar,Ee)),Ee.h)break;if(Ze-P<ar||te-Ze<yt)break e;for(Gt=0;Gt<yt;++Gt)N[Ze+Gt]=N[Ze+Gt-ar];for(Ze+=yt,be+=yt;be>=H;)be-=H,++he,le!=null&&he<=oe&&!(he%16)&&le(y,he);if(e(Ze<=te),be&lt&&(pt=re(De,be,he)),Ge!=null)for(;ke<Ze;)yt=N[ke++],Ge.X[(506832829*yt&4294967295)>>>Ge.Mb]=yt}else{if(!(yt<Ve))break e;for(At=yt-280,e(Ge!=null);ke<Ze;)yt=N[ke++],Ge.X[(506832829*yt&4294967295)>>>Ge.Mb]=yt;yt=Ze,e(!(At>>>(ar=Ge).Xa)),N[yt]=ar.X[At],At=!0}At||e(Ee.h==z(Ee))}if(y.Pb&&Ee.h&&Ze<te)e(y.m.h),y.a=5,y.m=y.wd,y.$=y.xd,0<y.s.ua&&it(y.s.vb,y.s.Wa);else{if(Ee.h)break e;le?.(y,he>oe?oe:he),y.a=0,y.$=Ze-P}return 1}return y.a=3,0}function st(y){e(y!=null),y.vc=null,y.yc=null,y.Ya=null;var N=y.Wa;N!=null&&(N.X=null),y.vb=null,e(y!=null)}function Ke(){var y=new yr;return y==null?null:(y.a=0,y.xb=jh,Be("Predictor","VP8LPredictors"),Be("Predictor","VP8LPredictors_C"),Be("PredictorAdd","VP8LPredictorsAdd"),Be("PredictorAdd","VP8LPredictorsAdd_C"),Ka=Ot,Rc=qe,Dc=Pt,To=Et,Oo=Dt,Ji=Ce,Il=$e,L.VP8LMapColor32b=Xi,L.VP8LMapColor8b=qn,y)}function Je(y,N,P,H,te){var oe=1,le=[y],he=[N],be=H.m,Ee=H.s,De=null,Ze=0;e:for(;;){if(P)for(;oe&&U(be,1);){var ke=le,Me=he,Ve=H,ut=1,Ge=Ve.m,lt=Ve.gc[Ve.ab],pt=U(Ge,2);if(Ve.Oc&1<<pt)oe=0;else{switch(Ve.Oc|=1<<pt,lt.hc=pt,lt.Ea=ke[0],lt.nc=Me[0],lt.K=[null],++Ve.ab,e(4>=Ve.ab),pt){case 0:case 1:lt.b=U(Ge,3)+2,ut=Je(Ie(lt.Ea,lt.b),Ie(lt.nc,lt.b),0,Ve,lt.K),lt.K=lt.K[0];break;case 3:var At,yt=U(Ge,8)+1,ar=16<yt?0:4<yt?1:2<yt?2:3;if(ke[0]=Ie(lt.Ea,ar),lt.b=ar,At=ut=Je(yt,1,0,Ve,lt.K)){var Gt,Nr=yt,Zt=lt,Mr=1<<(8>>Zt.b),Ca=s(Mr);if(Ca==null)At=0;else{var Er=Zt.K[0],Yt=Zt.w;for(Ca[0]=Zt.K[0][0],Gt=1;Gt<1*Nr;++Gt)Ca[Gt]=wt(Er[Yt+Gt],Ca[Gt-1]);for(;Gt<4*Mr;++Gt)Ca[Gt]=0;Zt.K[0]=null,Zt.K[0]=Ca,At=1}}ut=At;break;case 2:break;default:e(0)}oe=ut}}if(le=le[0],he=he[0],oe&&U(be,1)&&!(oe=1<=(Ze=U(be,4))&&11>=Ze)){H.a=3;break e}var zt;if(zt=oe)t:{var Pa,vr,Tr,oa=H,_n=le,Vn=he,wa=Ze,on=P,ts=oa.m,ln=oa.s,Fr=[null],Yr=1,Ma=0,Qr=ri[wa];r:for(;;){if(on&&U(ts,1)){var bn=U(ts,3)+2,Ia=Ie(_n,bn),Xr=Ie(Vn,bn),Qa=Ia*Xr;if(!Je(Ia,Xr,0,oa,Fr))break r;for(Fr=Fr[0],ln.xc=bn,Pa=0;Pa<Qa;++Pa){var la=Fr[Pa]>>8&65535;Fr[Pa]=la,la>=Yr&&(Yr=la+1)}}if(ts.h)break r;for(vr=0;5>vr;++vr){var cn=zl[vr];!vr&&0<wa&&(cn+=1<<wa),Ma<cn&&(Ma=cn)}var un=l(Yr*Qr,M),da=Yr,Vr=l(da,ie);if(Vr==null)var rs=null;else e(65536>=da),rs=Vr;var Wa=s(Ma);if(rs==null||Wa==null||un==null){oa.a=1;break r}var ur=un;for(Pa=Tr=0;Pa<Yr;++Pa){var fr=rs[Pa],Kr=fr.G,Ss=fr.H,ii=0,ms=1,fn=0;for(vr=0;5>vr;++vr){cn=zl[vr],Kr[vr]=ur,Ss[vr]=Tr,!vr&&0<wa&&(cn+=1<<wa);n:{var hl,ml=cn,cd=oa,Sa=Wa,Eh=ur,Ah=Tr,ud=0,Lo=cd.m,P1=U(Lo,1);if(n(Sa,0,0,ml),P1){var Ch=U(Lo,1)+1,Th=U(Lo,1),fd=U(Lo,Th==0?1:8);Sa[fd]=1,Ch==2&&(Sa[fd=U(Lo,8)]=1);var Rn=1}else{var Va=s(19),Xu=U(Lo,4)+4;if(19<Xu){cd.a=3;var pl=0;break n}for(hl=0;hl<Xu;++hl)Va[Vu[hl]]=U(Lo,3);var Uc=void 0,Wl=void 0,eo=cd,dd=Va,qc=ml,hd=Sa,md=0,Po=eo.m,Oh=8,Rh=l(128,M);a:for(;O(Rh,0,7,dd,19);){if(U(Po,1)){var pm=2+2*U(Po,3);if((Uc=2+U(Po,pm))>qc)break a}else Uc=qc;for(Wl=0;Wl<qc&&Uc--;){se(Po);var Dh=Rh[0+(127&I(Po))];ne(Po,Po.u+Dh.g);var gl=Dh.value;if(16>gl)hd[Wl++]=gl,gl!=0&&(Oh=gl);else{var gm=gl==16,vm=gl-16,xm=Pc[vm],Fh=U(Po,ei[vm])+xm;if(Wl+Fh>qc)break a;for(var ym=gm?Oh:0;0<Fh--;)hd[Wl++]=ym}}md=1;break a}md||(eo.a=3),Rn=md}(Rn=Rn&&!Lo.h)&&(ud=O(Eh,Ah,8,Sa,ml)),Rn&&ud!=0?pl=ud:(cd.a=3,pl=0)}if(pl==0)break r;if(ms&&ad[vr]==1&&(ms=ur[Tr].g==0),ii+=ur[Tr].g,Tr+=pl,3>=vr){var Vl,pd=Wa[0];for(Vl=1;Vl<cn;++Vl)Wa[Vl]>pd&&(pd=Wa[Vl]);fn+=pd}}if(fr.nd=ms,fr.Qb=0,ms&&(fr.qb=(Kr[3][Ss[3]+0].value<<24|Kr[1][Ss[1]+0].value<<16|Kr[2][Ss[2]+0].value)>>>0,ii==0&&256>Kr[0][Ss[0]+0].value&&(fr.Qb=1,fr.qb+=Kr[0][Ss[0]+0].value<<8)),fr.jc=!fr.Qb&&6>fn,fr.jc){var Ku,to=fr;for(Ku=0;Ku<sl;++Ku){var Mo=Ku,Io=to.pd[Mo],gd=to.G[0][to.H[0]+Mo];256<=gd.value?(Io.g=gd.g+256,Io.value=gd.value):(Io.g=0,Io.value=0,Mo>>=Kt(gd,8,Io),Mo>>=Kt(to.G[1][to.H[1]+Mo],16,Io),Mo>>=Kt(to.G[2][to.H[2]+Mo],0,Io),Kt(to.G[3][to.H[3]+Mo],24,Io))}}}ln.vc=Fr,ln.Wb=Yr,ln.Ya=rs,ln.yc=un,zt=1;break t}zt=0}if(!(oe=zt)){H.a=3;break e}if(0<Ze){if(Ee.ua=1<<Ze,!de(Ee.Wa,Ze)){H.a=1,oe=0;break e}}else Ee.ua=0;var vd=H,Gl=le,_m=he,zc=vd.s,Hc=zc.xc;if(vd.c=Gl,vd.i=_m,zc.md=Ie(Gl,Hc),zc.wc=Hc==0?-1:(1<<Hc)-1,P){H.xb=ll;break e}if((De=s(le*he))==null){H.a=1,oe=0;break e}oe=(oe=We(H,De,0,le,he,he,null))&&!be.h;break e}return oe?(te!=null?te[0]=De:(e(De==null),e(P)),H.$=0,P||st(Ee)):st(Ee),oe}function Qe(y,N){var P=y.c*y.i,H=P+N+16*N;return e(y.c<=N),y.V=s(H),y.V==null?(y.Ta=null,y.Ua=0,y.a=1,0):(y.Ta=y.V,y.Ua=y.Ba+P+N,1)}function St(y,N){var P=y.C,H=N-P,te=y.V,oe=y.Ba+y.c*P;for(e(N<=y.l.o);0<H;){var le=16<H?16:H,he=y.l.ma,be=y.l.width,Ee=be*le,De=he.ca,Ze=he.tb+be*P,ke=y.Ta,Me=y.Ua;Ne(y,le,te,oe),Hs(ke,Me,De,Ze,Ee),we(he,P,P+le,De,Ze,be),H-=le,te+=le*y.c,P+=le}e(P==N),y.C=y.Ma=N}function Ft(){this.ub=this.yd=this.td=this.Rb=0}function Ht(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Tt(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Bt(){this.Yb=(function(){var y=[];return(function N(P,H,te){for(var oe=te[H],le=0;le<oe&&(P.push(te.length>H+1?[]:0),!(te.length<H+1));le++)N(P[le],H+1,te)})(y,0,[3,11]),y})()}function Jt(){this.jb=s(3),this.Wc=c([4,8],Bt),this.Xc=c([4,17],Bt)}function ia(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Lr(){this.ld=this.La=this.dd=this.tc=0}function ua(){this.Na=this.la=0}function ls(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function gi(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function vi(){this.uc=this.M=this.Nb=0,this.wa=Array(new Lr),this.Y=0,this.ya=Array(new gi),this.aa=0,this.l=new po}function Is(){this.y=s(16),this.f=s(8),this.ea=s(8)}function el(){this.cb=this.a=0,this.sc="",this.m=new j,this.Od=new Ft,this.Kc=new Ht,this.ed=new ia,this.Qa=new Tt,this.Ic=this.$c=this.Aa=0,this.D=new vi,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=l(8,j),this.ia=0,this.pb=l(4,ls),this.Pa=new Jt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Is),this.Hd=0,this.rb=Array(new ua),this.sb=0,this.wa=Array(new Lr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new gi),this.L=this.aa=0,this.gd=c([4,2],Lr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Fa(y,N){return 0>y?0:y>N?N:y}function po(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function xi(){var y=new el;return y!=null&&(y.a=0,y.sc="OK",y.cb=0,y.Xb=0,$s||($s=tl)),y}function Jr(y,N,P){return y.a==0&&(y.a=N,y.sc=P,y.cb=0),0}function ku(y,N,P){return 3<=P&&y[N+0]==157&&y[N+1]==1&&y[N+2]==42}function zi(y,N){if(y==null)return 0;if(y.a=0,y.sc="OK",N==null)return Jr(y,2,"null VP8Io passed to VP8GetHeaders()");var P=N.data,H=N.w,te=N.ha;if(4>te)return Jr(y,7,"Truncated header.");var oe=P[H+0]|P[H+1]<<8|P[H+2]<<16,le=y.Od;if(le.Rb=!(1&oe),le.td=oe>>1&7,le.yd=oe>>4&1,le.ub=oe>>5,3<le.td)return Jr(y,3,"Incorrect keyframe parameters.");if(!le.yd)return Jr(y,4,"Frame not displayable.");H+=3,te-=3;var he=y.Kc;if(le.Rb){if(7>te)return Jr(y,7,"cannot parse picture header");if(!ku(P,H,te))return Jr(y,3,"Bad code word");he.c=16383&(P[H+4]<<8|P[H+3]),he.Td=P[H+4]>>6,he.i=16383&(P[H+6]<<8|P[H+5]),he.Ud=P[H+6]>>6,H+=7,te-=7,y.za=he.c+15>>4,y.Ub=he.i+15>>4,N.width=he.c,N.height=he.i,N.Da=0,N.j=0,N.v=0,N.va=N.width,N.o=N.height,N.da=0,N.ib=N.width,N.hb=N.height,N.U=N.width,N.T=N.height,n((oe=y.Pa).jb,0,255,oe.jb.length),e((oe=y.Qa)!=null),oe.Cb=0,oe.Bb=0,oe.Fb=1,n(oe.Zb,0,0,oe.Zb.length),n(oe.Lb,0,0,oe.Lb)}if(le.ub>te)return Jr(y,7,"bad partition length");X(oe=y.m,P,H,le.ub),H+=le.ub,te-=le.ub,le.Rb&&(he.Ld=ye(oe),he.Kd=ye(oe)),he=y.Qa;var be,Ee=y.Pa;if(e(oe!=null),e(he!=null),he.Cb=ye(oe),he.Cb){if(he.Bb=ye(oe),ye(oe)){for(he.Fb=ye(oe),be=0;4>be;++be)he.Zb[be]=ye(oe)?K(oe,7):0;for(be=0;4>be;++be)he.Lb[be]=ye(oe)?K(oe,6):0}if(he.Bb)for(be=0;3>be;++be)Ee.jb[be]=ye(oe)?Z(oe,8):255}else he.Bb=0;if(oe.Ka)return Jr(y,3,"cannot parse segment header");if((he=y.ed).zd=ye(oe),he.Tb=Z(oe,6),he.wb=Z(oe,3),he.Pc=ye(oe),he.Pc&&ye(oe)){for(Ee=0;4>Ee;++Ee)ye(oe)&&(he.vd[Ee]=K(oe,6));for(Ee=0;4>Ee;++Ee)ye(oe)&&(he.od[Ee]=K(oe,6))}if(y.L=he.Tb==0?0:he.zd?1:2,oe.Ka)return Jr(y,3,"cannot parse filter header");var De=te;if(te=be=H,H=be+De,he=De,y.Xb=(1<<Z(y.m,2))-1,De<3*(Ee=y.Xb))P=7;else{for(be+=3*Ee,he-=3*Ee,De=0;De<Ee;++De){var Ze=P[te+0]|P[te+1]<<8|P[te+2]<<16;Ze>he&&(Ze=he),X(y.Jc[+De],P,be,Ze),be+=Ze,he-=Ze,te+=3}X(y.Jc[+Ee],P,be,he),P=be<H?0:5}if(P!=0)return Jr(y,P,"cannot parse partitions");for(P=Z(be=y.m,7),te=ye(be)?K(be,4):0,H=ye(be)?K(be,4):0,he=ye(be)?K(be,4):0,Ee=ye(be)?K(be,4):0,be=ye(be)?K(be,4):0,De=y.Qa,Ze=0;4>Ze;++Ze){if(De.Cb){var ke=De.Zb[Ze];De.Fb||(ke+=P)}else{if(0<Ze){y.pb[Ze]=y.pb[0];continue}ke=P}var Me=y.pb[Ze];Me.Sc[0]=ai[Fa(ke+te,127)],Me.Sc[1]=ni[Fa(ke+0,127)],Me.Eb[0]=2*ai[Fa(ke+H,127)],Me.Eb[1]=101581*ni[Fa(ke+he,127)]>>16,8>Me.Eb[1]&&(Me.Eb[1]=8),Me.Qc[0]=ai[Fa(ke+Ee,117)],Me.Qc[1]=ni[Fa(ke+be,127)],Me.lc=ke+be}if(!le.Rb)return Jr(y,4,"Not a key frame.");for(ye(oe),le=y.Pa,P=0;4>P;++P){for(te=0;8>te;++te)for(H=0;3>H;++H)for(he=0;11>he;++he)Ee=_e(oe,Aa[P][te][H][he])?Z(oe,8):hm[P][te][H][he],le.Wc[P][te].Yb[H][he]=Ee;for(te=0;17>te;++te)le.Xc[P][te]=le.Wc[P][Br[te]]}return y.kc=ye(oe),y.kc&&(y.Bd=Z(oe,8)),y.cb=1}function tl(y,N,P,H,te,oe,le){var he=N[te].Yb[P];for(P=0;16>te;++te){if(!_e(y,he[P+0]))return te;for(;!_e(y,he[P+1]);)if(he=N[++te].Yb[0],P=0,te==16)return 16;var be=N[te+1].Yb;if(_e(y,he[P+2])){var Ee=y,De=0;if(_e(Ee,(ke=he)[(Ze=P)+3]))if(_e(Ee,ke[Ze+6])){for(he=0,Ze=2*(De=_e(Ee,ke[Ze+8]))+(ke=_e(Ee,ke[Ze+9+De])),De=0,ke=dm[Ze];ke[he];++he)De+=De+_e(Ee,ke[he]);De+=3+(8<<Ze)}else _e(Ee,ke[Ze+7])?(De=7+2*_e(Ee,165),De+=_e(Ee,145)):De=5+_e(Ee,159);else De=_e(Ee,ke[Ze+4])?3+_e(Ee,ke[Ze+5]):2;he=be[2]}else De=1,he=be[1];be=le+Nh[te],0>(Ee=y).b&&pe(Ee);var Ze,ke=Ee.b,Me=(Ze=Ee.Ca>>1)-(Ee.I>>ke)>>31;--Ee.b,Ee.Ca+=Me,Ee.Ca|=1,Ee.I-=(Ze+1&Me)<<ke,oe[be]=((De^Me)-Me)*H[(0<te)+0]}return 16}function Eu(y){var N=y.rb[y.sb-1];N.la=0,N.Na=0,n(y.zc,0,0,y.zc.length),y.ja=0}function cs(y,N,P,H,te){te=y[N+P+32*H]+(te>>3),y[N+P+32*H]=-256&te?0>te?0:255:te}function xn(y,N,P,H,te,oe){cs(y,N,0,P,H+te),cs(y,N,1,P,H+oe),cs(y,N,2,P,H-oe),cs(y,N,3,P,H-te)}function nn(y){return(20091*y>>16)+y}function Sc(y,N,P,H){var te,oe=0,le=s(16);for(te=0;4>te;++te){var he=y[N+0]+y[N+8],be=y[N+0]-y[N+8],Ee=(35468*y[N+4]>>16)-nn(y[N+12]),De=nn(y[N+4])+(35468*y[N+12]>>16);le[oe+0]=he+De,le[oe+1]=be+Ee,le[oe+2]=be-Ee,le[oe+3]=he-De,oe+=4,N++}for(te=oe=0;4>te;++te)he=(y=le[oe+0]+4)+le[oe+8],be=y-le[oe+8],Ee=(35468*le[oe+4]>>16)-nn(le[oe+12]),cs(P,H,0,0,he+(De=nn(le[oe+4])+(35468*le[oe+12]>>16))),cs(P,H,1,0,be+Ee),cs(P,H,2,0,be-Ee),cs(P,H,3,0,he-De),oe++,H+=32}function qf(y,N,P,H){var te=y[N+0]+4,oe=35468*y[N+4]>>16,le=nn(y[N+4]),he=35468*y[N+1]>>16;xn(P,H,0,te+le,y=nn(y[N+1]),he),xn(P,H,1,te+oe,y,he),xn(P,H,2,te-oe,y,he),xn(P,H,3,te-le,y,he)}function Au(y,N,P,H,te){Sc(y,N,P,H),te&&Sc(y,N+16,P,H+4)}function us(y,N,P,H){Ro(y,N+0,P,H,1),Ro(y,N+32,P,H+128,1)}function Cu(y,N,P,H){var te;for(y=y[N+0]+4,te=0;4>te;++te)for(N=0;4>N;++N)cs(P,H,N,te,y)}function Tu(y,N,P,H){y[N+0]&&Zr(y,N+0,P,H),y[N+16]&&Zr(y,N+16,P,H+4),y[N+32]&&Zr(y,N+32,P,H+128),y[N+48]&&Zr(y,N+48,P,H+128+4)}function yi(y,N,P,H){var te,oe=s(16);for(te=0;4>te;++te){var le=y[N+0+te]+y[N+12+te],he=y[N+4+te]+y[N+8+te],be=y[N+4+te]-y[N+8+te],Ee=y[N+0+te]-y[N+12+te];oe[0+te]=le+he,oe[8+te]=le-he,oe[4+te]=Ee+be,oe[12+te]=Ee-be}for(te=0;4>te;++te)le=(y=oe[0+4*te]+3)+oe[3+4*te],he=oe[1+4*te]+oe[2+4*te],be=oe[1+4*te]-oe[2+4*te],Ee=y-oe[3+4*te],P[H+0]=le+he>>3,P[H+16]=Ee+be>>3,P[H+32]=le-he>>3,P[H+48]=Ee-be>>3,H+=64}function Ol(y,N,P){var H,te=N-32,oe=Qn,le=255-y[te-1];for(H=0;H<P;++H){var he,be=oe,Ee=le+y[N-1];for(he=0;he<P;++he)y[N+he]=be[Ee+y[te+he]];N+=32}}function zf(y,N){Ol(y,N,4)}function Hf(y,N){Ol(y,N,8)}function Ou(y,N){Ol(y,N,16)}function Ru(y,N){var P;for(P=0;16>P;++P)a(y,N+32*P,y,N-32,16)}function $f(y,N){var P;for(P=16;0<P;--P)n(y,N,y[N-1],16),N+=32}function bs(y,N,P){var H;for(H=0;16>H;++H)n(N,P+32*H,y,16)}function _i(y,N){var P,H=16;for(P=0;16>P;++P)H+=y[N-1+32*P]+y[N+P-32];bs(H>>5,y,N)}function go(y,N){var P,H=8;for(P=0;16>P;++P)H+=y[N-1+32*P];bs(H>>4,y,N)}function Rl(y,N){var P,H=8;for(P=0;16>P;++P)H+=y[N+P-32];bs(H>>4,y,N)}function rl(y,N){bs(128,y,N)}function gr(y,N,P){return y+2*N+P+2>>2}function Wf(y,N){var P,H=N-32;for(H=new Uint8Array([gr(y[H-1],y[H+0],y[H+1]),gr(y[H+0],y[H+1],y[H+2]),gr(y[H+1],y[H+2],y[H+3]),gr(y[H+2],y[H+3],y[H+4])]),P=0;4>P;++P)a(y,N+32*P,H,0,H.length)}function Du(y,N){var P=y[N-1],H=y[N-1+32],te=y[N-1+64],oe=y[N-1+96];Le(y,N+0,16843009*gr(y[N-1-32],P,H)),Le(y,N+32,16843009*gr(P,H,te)),Le(y,N+64,16843009*gr(H,te,oe)),Le(y,N+96,16843009*gr(te,oe,oe))}function Vf(y,N){var P,H=4;for(P=0;4>P;++P)H+=y[N+P-32]+y[N-1+32*P];for(H>>=3,P=0;4>P;++P)n(y,N+32*P,H,4)}function Bs(y,N){var P=y[N-1+0],H=y[N-1+32],te=y[N-1+64],oe=y[N-1-32],le=y[N+0-32],he=y[N+1-32],be=y[N+2-32],Ee=y[N+3-32];y[N+0+96]=gr(H,te,y[N-1+96]),y[N+1+96]=y[N+0+64]=gr(P,H,te),y[N+2+96]=y[N+1+64]=y[N+0+32]=gr(oe,P,H),y[N+3+96]=y[N+2+64]=y[N+1+32]=y[N+0+0]=gr(le,oe,P),y[N+3+64]=y[N+2+32]=y[N+1+0]=gr(he,le,oe),y[N+3+32]=y[N+2+0]=gr(be,he,le),y[N+3+0]=gr(Ee,be,he)}function Bn(y,N){var P=y[N+1-32],H=y[N+2-32],te=y[N+3-32],oe=y[N+4-32],le=y[N+5-32],he=y[N+6-32],be=y[N+7-32];y[N+0+0]=gr(y[N+0-32],P,H),y[N+1+0]=y[N+0+32]=gr(P,H,te),y[N+2+0]=y[N+1+32]=y[N+0+64]=gr(H,te,oe),y[N+3+0]=y[N+2+32]=y[N+1+64]=y[N+0+96]=gr(te,oe,le),y[N+3+32]=y[N+2+64]=y[N+1+96]=gr(oe,le,he),y[N+3+64]=y[N+2+96]=gr(le,he,be),y[N+3+96]=gr(he,be,be)}function Fu(y,N){var P=y[N-1+0],H=y[N-1+32],te=y[N-1+64],oe=y[N-1-32],le=y[N+0-32],he=y[N+1-32],be=y[N+2-32],Ee=y[N+3-32];y[N+0+0]=y[N+1+64]=oe+le+1>>1,y[N+1+0]=y[N+2+64]=le+he+1>>1,y[N+2+0]=y[N+3+64]=he+be+1>>1,y[N+3+0]=be+Ee+1>>1,y[N+0+96]=gr(te,H,P),y[N+0+64]=gr(H,P,oe),y[N+0+32]=y[N+1+96]=gr(P,oe,le),y[N+1+32]=y[N+2+96]=gr(oe,le,he),y[N+2+32]=y[N+3+96]=gr(le,he,be),y[N+3+32]=gr(he,be,Ee)}function Dl(y,N){var P=y[N+0-32],H=y[N+1-32],te=y[N+2-32],oe=y[N+3-32],le=y[N+4-32],he=y[N+5-32],be=y[N+6-32],Ee=y[N+7-32];y[N+0+0]=P+H+1>>1,y[N+1+0]=y[N+0+64]=H+te+1>>1,y[N+2+0]=y[N+1+64]=te+oe+1>>1,y[N+3+0]=y[N+2+64]=oe+le+1>>1,y[N+0+32]=gr(P,H,te),y[N+1+32]=y[N+0+96]=gr(H,te,oe),y[N+2+32]=y[N+1+96]=gr(te,oe,le),y[N+3+32]=y[N+2+96]=gr(oe,le,he),y[N+3+64]=gr(le,he,be),y[N+3+96]=gr(he,be,Ee)}function Us(y,N){var P=y[N-1+0],H=y[N-1+32],te=y[N-1+64],oe=y[N-1+96];y[N+0+0]=P+H+1>>1,y[N+2+0]=y[N+0+32]=H+te+1>>1,y[N+2+32]=y[N+0+64]=te+oe+1>>1,y[N+1+0]=gr(P,H,te),y[N+3+0]=y[N+1+32]=gr(H,te,oe),y[N+3+32]=y[N+1+64]=gr(te,oe,oe),y[N+3+64]=y[N+2+64]=y[N+0+96]=y[N+1+96]=y[N+2+96]=y[N+3+96]=oe}function Fl(y,N){var P=y[N-1+0],H=y[N-1+32],te=y[N-1+64],oe=y[N-1+96],le=y[N-1-32],he=y[N+0-32],be=y[N+1-32],Ee=y[N+2-32];y[N+0+0]=y[N+2+32]=P+le+1>>1,y[N+0+32]=y[N+2+64]=H+P+1>>1,y[N+0+64]=y[N+2+96]=te+H+1>>1,y[N+0+96]=oe+te+1>>1,y[N+3+0]=gr(he,be,Ee),y[N+2+0]=gr(le,he,be),y[N+1+0]=y[N+3+32]=gr(P,le,he),y[N+1+32]=y[N+3+64]=gr(H,P,le),y[N+1+64]=y[N+3+96]=gr(te,H,P),y[N+1+96]=gr(oe,te,H)}function Hi(y,N){var P;for(P=0;8>P;++P)a(y,N+32*P,y,N-32,8)}function Gf(y,N){var P;for(P=0;8>P;++P)n(y,N,y[N-1],8),N+=32}function Xs(y,N,P){var H;for(H=0;8>H;++H)n(N,P+32*H,y,8)}function Nc(y,N){var P,H=8;for(P=0;8>P;++P)H+=y[N+P-32]+y[N-1+32*P];Xs(H>>4,y,N)}function jc(y,N){var P,H=4;for(P=0;8>P;++P)H+=y[N+P-32];Xs(H>>3,y,N)}function Tn(y,N){var P,H=4;for(P=0;8>P;++P)H+=y[N-1+32*P];Xs(H>>3,y,N)}function $i(y,N){Xs(128,y,N)}function Ks(y,N,P){var H=y[N-P],te=y[N+0],oe=3*(te-H)+Do[1020+y[N-2*P]-y[N+P]],le=Hu[112+(oe+4>>3)];y[N-P]=Qn[255+H+Hu[112+(oe+3>>3)]],y[N+0]=Qn[255+te-le]}function vo(y,N,P,H){var te=y[N+0],oe=y[N+P];return zn[255+y[N-2*P]-y[N-P]]>H||zn[255+oe-te]>H}function kc(y,N,P,H){return 4*zn[255+y[N-P]-y[N+0]]+zn[255+y[N-2*P]-y[N+P]]<=H}function Ll(y,N,P,H,te){var oe=y[N-3*P],le=y[N-2*P],he=y[N-P],be=y[N+0],Ee=y[N+P],De=y[N+2*P],Ze=y[N+3*P];return 4*zn[255+he-be]+zn[255+le-Ee]>H?0:zn[255+y[N-4*P]-oe]<=te&&zn[255+oe-le]<=te&&zn[255+le-he]<=te&&zn[255+Ze-De]<=te&&zn[255+De-Ee]<=te&&zn[255+Ee-be]<=te}function xo(y,N,P,H){var te=2*H+1;for(H=0;16>H;++H)kc(y,N+H,P,te)&&Ks(y,N+H,P)}function yo(y,N,P,H){var te=2*H+1;for(H=0;16>H;++H)kc(y,N+H*P,1,te)&&Ks(y,N+H*P,1)}function Pl(y,N,P,H){var te;for(te=3;0<te;--te)xo(y,N+=4*P,P,H)}function Lu(y,N,P,H){var te;for(te=3;0<te;--te)yo(y,N+=4,P,H)}function _o(y,N,P,H,te,oe,le,he){for(oe=2*oe+1;0<te--;){if(Ll(y,N,P,oe,le))if(vo(y,N,P,he))Ks(y,N,P);else{var be=y,Ee=N,De=P,Ze=be[Ee-2*De],ke=be[Ee-De],Me=be[Ee+0],Ve=be[Ee+De],ut=be[Ee+2*De],Ge=27*(pt=Do[1020+3*(Me-ke)+Do[1020+Ze-Ve]])+63>>7,lt=18*pt+63>>7,pt=9*pt+63>>7;be[Ee-3*De]=Qn[255+be[Ee-3*De]+pt],be[Ee-2*De]=Qn[255+Ze+lt],be[Ee-De]=Qn[255+ke+Ge],be[Ee+0]=Qn[255+Me-Ge],be[Ee+De]=Qn[255+Ve-lt],be[Ee+2*De]=Qn[255+ut-pt]}N+=H}}function bo(y,N,P,H,te,oe,le,he){for(oe=2*oe+1;0<te--;){if(Ll(y,N,P,oe,le))if(vo(y,N,P,he))Ks(y,N,P);else{var be=y,Ee=N,De=P,Ze=be[Ee-De],ke=be[Ee+0],Me=be[Ee+De],Ve=Hu[112+(4+(ut=3*(ke-Ze))>>3)],ut=Hu[112+(ut+3>>3)],Ge=Ve+1>>1;be[Ee-2*De]=Qn[255+be[Ee-2*De]+Ge],be[Ee-De]=Qn[255+Ze+ut],be[Ee+0]=Qn[255+ke-Ve],be[Ee+De]=Qn[255+Me-Ge]}N+=H}}function Yf(y,N,P,H,te,oe){_o(y,N,P,1,16,H,te,oe)}function wo(y,N,P,H,te,oe){_o(y,N,1,P,16,H,te,oe)}function Xf(y,N,P,H,te,oe){var le;for(le=3;0<le;--le)bo(y,N+=4*P,P,1,16,H,te,oe)}function R(y,N,P,H,te,oe){var le;for(le=3;0<le;--le)bo(y,N+=4,1,P,16,H,te,oe)}function Q(y,N,P,H,te,oe,le,he){_o(y,N,te,1,8,oe,le,he),_o(P,H,te,1,8,oe,le,he)}function Ae(y,N,P,H,te,oe,le,he){_o(y,N,1,te,8,oe,le,he),_o(P,H,1,te,8,oe,le,he)}function Oe(y,N,P,H,te,oe,le,he){bo(y,N+4*te,te,1,8,oe,le,he),bo(P,H+4*te,te,1,8,oe,le,he)}function ze(y,N,P,H,te,oe,le,he){bo(y,N+4,1,te,8,oe,le,he),bo(P,H+4,1,te,8,oe,le,he)}function mt(){this.ba=new Rt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new pr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function _t(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Qt(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function sr(){this.ua=0,this.Wa=new Se,this.vb=new Se,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ie,this.yc=new M}function yr(){this.xb=this.a=0,this.l=new po,this.ca=new Rt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new F,this.Pb=0,this.wd=new F,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new sr,this.ab=0,this.gc=l(4,Qt),this.Oc=0}function kr(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new po,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function $r(y,N,P,H,te,oe,le){for(y=y==null?0:y[N+0],N=0;N<le;++N)te[oe+N]=y+P[H+N]&255,y=te[oe+N]}function La(y,N,P,H,te,oe,le){var he;if(y==null)$r(null,null,P,H,te,oe,le);else for(he=0;he<le;++he)te[oe+he]=y[N+he]+P[H+he]&255}function Xa(y,N,P,H,te,oe,le){if(y==null)$r(null,null,P,H,te,oe,le);else{var he,be=y[N+0],Ee=be,De=be;for(he=0;he<le;++he)Ee=De+(be=y[N+he])-Ee,De=P[H+he]+(-256&Ee?0>Ee?0:255:Ee)&255,Ee=be,te[oe+he]=De}}function _a(y,N,P,H){var te=N.width,oe=N.o;if(e(y!=null&&N!=null),0>P||0>=H||P+H>oe)return null;if(!y.Cc){if(y.ga==null){var le;if(y.ga=new kr,(le=y.ga==null)||(le=N.width*N.o,e(y.Gb.length==0),y.Gb=s(le),y.Uc=0,y.Gb==null?le=0:(y.mb=y.Gb,y.nb=y.Uc,y.rc=null,le=1),le=!le),!le){le=y.ga;var he=y.Fa,be=y.P,Ee=y.qc,De=y.mb,Ze=y.nb,ke=be+1,Me=Ee-1,Ve=le.l;if(e(he!=null&&De!=null&&N!=null),Fo[0]=null,Fo[1]=$r,Fo[2]=La,Fo[3]=Xa,le.ca=De,le.tb=Ze,le.c=N.width,le.i=N.height,e(0<le.c&&0<le.i),1>=Ee)N=0;else if(le.$a=3&he[be+0],le.Z=he[be+0]>>2&3,le.Lc=he[be+0]>>4&3,be=he[be+0]>>6&3,0>le.$a||1<le.$a||4<=le.Z||1<le.Lc||be)N=0;else if(Ve.put=rr,Ve.ac=Ea,Ve.bc=ya,Ve.ma=le,Ve.width=N.width,Ve.height=N.height,Ve.Da=N.Da,Ve.v=N.v,Ve.va=N.va,Ve.j=N.j,Ve.o=N.o,le.$a)e:{e(le.$a==1),N=Ke();t:for(;;){if(N==null){N=0;break e}if(e(le!=null),le.mc=N,N.c=le.c,N.i=le.i,N.l=le.l,N.l.ma=le,N.l.width=le.c,N.l.height=le.i,N.a=0,ae(N.m,he,ke,Me),!Je(le.c,le.i,1,N,null)||(N.ab==1&&N.gc[0].hc==3&&ge(N.s)?(le.ic=1,he=N.c*N.i,N.Ta=null,N.Ua=0,N.V=s(he),N.Ba=0,N.V==null?(N.a=1,N=0):N=1):(le.ic=0,N=Qe(N,le.c)),!N))break t;N=1;break e}le.mc=null,N=0}else N=Me>=le.c*le.i;le=!N}if(le)return null;y.ga.Lc!=1?y.Ga=0:H=oe-P}e(y.ga!=null),e(P+H<=oe);e:{if(N=(he=y.ga).c,oe=he.l.o,he.$a==0){if(ke=y.rc,Me=y.Vc,Ve=y.Fa,be=y.P+1+P*N,Ee=y.mb,De=y.nb+P*N,e(be<=y.P+y.qc),he.Z!=0)for(e(Fo[he.Z]!=null),le=0;le<H;++le)Fo[he.Z](ke,Me,Ve,be,Ee,De,N),ke=Ee,Me=De,De+=N,be+=N;else for(le=0;le<H;++le)a(Ee,De,Ve,be,N),ke=Ee,Me=De,De+=N,be+=N;y.rc=ke,y.Vc=Me}else{if(e(he.mc!=null),N=P+H,e((le=he.mc)!=null),e(N<=le.i),le.C>=N)N=1;else if(he.ic||bi(),he.ic){he=le.V,ke=le.Ba,Me=le.c;var ut=le.i,Ge=(Ve=1,be=le.$/Me,Ee=le.$%Me,De=le.m,Ze=le.s,le.$),lt=Me*ut,pt=Me*N,At=Ze.wc,yt=Ge<pt?re(Ze,Ee,be):null;e(Ge<=lt),e(N<=ut),e(ge(Ze));t:for(;;){for(;!De.h&&Ge<pt;){if(Ee&At||(yt=re(Ze,Ee,be)),e(yt!=null),se(De),256>(ut=qt(yt.G[0],yt.H[0],De)))he[ke+Ge]=ut,++Ge,++Ee>=Me&&(Ee=0,++be<=N&&!(be%16)&&je(le,be));else{if(!(280>ut)){Ve=0;break t}ut=Da(ut-256,De);var ar,Gt=qt(yt.G[4],yt.H[4],De);if(se(De),!(Ge>=(Gt=an(Me,Gt=Da(Gt,De)))&&lt-Ge>=ut)){Ve=0;break t}for(ar=0;ar<ut;++ar)he[ke+Ge+ar]=he[ke+Ge+ar-Gt];for(Ge+=ut,Ee+=ut;Ee>=Me;)Ee-=Me,++be<=N&&!(be%16)&&je(le,be);Ge<pt&&Ee&At&&(yt=re(Ze,Ee,be))}e(De.h==z(De))}je(le,be>N?N:be);break t}!Ve||De.h&&Ge<lt?(Ve=0,le.a=De.h?5:3):le.$=Ge,N=Ve}else N=We(le,le.V,le.Ba,le.c,le.i,N,St);if(!N){H=0;break e}}P+H>=oe&&(y.Cc=1),H=1}if(!H)return null;if(y.Cc&&((H=y.ga)!=null&&(H.mc=null),y.ga=null,0<y.Ga))return alert("todo:WebPDequantizeLevels"),null}return y.nb+P*te}function yn(y,N,P,H,te,oe){for(;0<te--;){var le,he=y,be=N+(P?1:0),Ee=y,De=N+(P?0:3);for(le=0;le<H;++le){var Ze=Ee[De+4*le];Ze!=255&&(Ze*=32897,he[be+4*le+0]=he[be+4*le+0]*Ze>>23,he[be+4*le+1]=he[be+4*le+1]*Ze>>23,he[be+4*le+2]=he[be+4*le+2]*Ze>>23)}N+=oe}}function sn(y,N,P,H,te){for(;0<H--;){var oe;for(oe=0;oe<P;++oe){var le=y[N+2*oe+0],he=15&(Ee=y[N+2*oe+1]),be=4369*he,Ee=(240&Ee|Ee>>4)*be>>16;y[N+2*oe+0]=(240&le|le>>4)*be>>16&240|(15&le|le<<4)*be>>16>>4&15,y[N+2*oe+1]=240&Ee|he}N+=te}}function Un(y,N,P,H,te,oe,le,he){var be,Ee,De=255;for(Ee=0;Ee<te;++Ee){for(be=0;be<H;++be){var Ze=y[N+be];oe[le+4*be]=Ze,De&=Ze}N+=P,le+=he}return De!=255}function So(y,N,P,H,te){var oe;for(oe=0;oe<te;++oe)P[H+oe]=y[N+oe]>>8}function bi(){Ul=yn,Zs=sn,Uu=Un,Hs=So}function No(y,N,P){L[y]=function(H,te,oe,le,he,be,Ee,De,Ze,ke,Me,Ve,ut,Ge,lt,pt,At){var yt,ar=At-1>>1,Gt=he[be+0]|Ee[De+0]<<16,Nr=Ze[ke+0]|Me[Ve+0]<<16;e(H!=null);var Zt=3*Gt+Nr+131074>>2;for(N(H[te+0],255&Zt,Zt>>16,ut,Ge),oe!=null&&(Zt=3*Nr+Gt+131074>>2,N(oe[le+0],255&Zt,Zt>>16,lt,pt)),yt=1;yt<=ar;++yt){var Mr=he[be+yt]|Ee[De+yt]<<16,Ca=Ze[ke+yt]|Me[Ve+yt]<<16,Er=Gt+Mr+Nr+Ca+524296,Yt=Er+2*(Mr+Nr)>>3;Zt=Yt+Gt>>1,Gt=(Er=Er+2*(Gt+Ca)>>3)+Mr>>1,N(H[te+2*yt-1],255&Zt,Zt>>16,ut,Ge+(2*yt-1)*P),N(H[te+2*yt-0],255&Gt,Gt>>16,ut,Ge+(2*yt-0)*P),oe!=null&&(Zt=Er+Nr>>1,Gt=Yt+Ca>>1,N(oe[le+2*yt-1],255&Zt,Zt>>16,lt,pt+(2*yt-1)*P),N(oe[le+2*yt+0],255&Gt,Gt>>16,lt,pt+(2*yt+0)*P)),Gt=Mr,Nr=Ca}1&At||(Zt=3*Gt+Nr+131074>>2,N(H[te+At-1],255&Zt,Zt>>16,ut,Ge+(At-1)*P),oe!=null&&(Zt=3*Nr+Gt+131074>>2,N(oe[le+At-1],255&Zt,Zt>>16,lt,pt+(At-1)*P)))}}function Pu(){$n[Qf]=Hl,$n[es]=Mc,$n[ed]=kh,$n[Qs]=sd,$n[$u]=cl,$n[Fc]=Qi,$n[il]=ul,$n[Wu]=Mc,$n[td]=sd,$n[Lc]=cl,$n[rd]=Qi}function Ec(y){return y&-16384?0>y?0:255:y>>id}function Wi(y,N){return Ec((19077*y>>8)+(26149*N>>8)-14234)}function wi(y,N,P){return Ec((19077*y>>8)-(6419*N>>8)-(13320*P>>8)+8708)}function Ml(y,N){return Ec((19077*y>>8)+(33050*N>>8)-17685)}function jo(y,N,P,H,te){H[te+0]=Wi(y,P),H[te+1]=wi(y,N,P),H[te+2]=Ml(y,N)}function On(y,N,P,H,te){H[te+0]=Ml(y,N),H[te+1]=wi(y,N,P),H[te+2]=Wi(y,P)}function al(y,N,P,H,te){var oe=wi(y,N,P);N=oe<<3&224|Ml(y,N)>>3,H[te+0]=248&Wi(y,P)|oe>>5,H[te+1]=N}function nl(y,N,P,H,te){var oe=240&Ml(y,N)|15;H[te+0]=240&Wi(y,P)|wi(y,N,P)>>4,H[te+1]=oe}function Ac(y,N,P,H,te){H[te+0]=255,jo(y,N,P,H,te+1)}function Vi(y,N,P,H,te){On(y,N,P,H,te),H[te+3]=255}function fs(y,N,P,H,te){jo(y,N,P,H,te),H[te+3]=255}function ko(y,N,P){L[y]=function(H,te,oe,le,he,be,Ee,De,Ze){for(var ke=De+(-2&Ze)*P;De!=ke;)N(H[te+0],oe[le+0],he[be+0],Ee,De),N(H[te+1],oe[le+0],he[be+0],Ee,De+P),te+=2,++le,++be,De+=2*P;1&Ze&&N(H[te+0],oe[le+0],he[be+0],Ee,De)}}function Cc(y,N,P){return P==0?y==0?N==0?6:5:N==0?4:0:P}function Mu(y,N,P,H,te){switch(y>>>30){case 3:Ro(N,P,H,te,0);break;case 2:Zn(N,P,H,te);break;case 1:Zr(N,P,H,te)}}function qs(y,N){var P,H,te=N.M,oe=N.Nb,le=y.oc,he=y.pc+40,be=y.oc,Ee=y.pc+584,De=y.oc,Ze=y.pc+600;for(P=0;16>P;++P)le[he+32*P-1]=129;for(P=0;8>P;++P)be[Ee+32*P-1]=129,De[Ze+32*P-1]=129;for(0<te?le[he-1-32]=be[Ee-1-32]=De[Ze-1-32]=129:(n(le,he-32-1,127,21),n(be,Ee-32-1,127,9),n(De,Ze-32-1,127,9)),H=0;H<y.za;++H){var ke=N.ya[N.aa+H];if(0<H){for(P=-1;16>P;++P)a(le,he+32*P-4,le,he+32*P+12,4);for(P=-1;8>P;++P)a(be,Ee+32*P-4,be,Ee+32*P+4,4),a(De,Ze+32*P-4,De,Ze+32*P+4,4)}var Me=y.Gd,Ve=y.Hd+H,ut=ke.ad,Ge=ke.Hc;if(0<te&&(a(le,he-32,Me[Ve].y,0,16),a(be,Ee-32,Me[Ve].f,0,8),a(De,Ze-32,Me[Ve].ea,0,8)),ke.Za){var lt=le,pt=he-32+16;for(0<te&&(H>=y.za-1?n(lt,pt,Me[Ve].y[15],4):a(lt,pt,Me[Ve+1].y,0,4)),P=0;4>P;P++)lt[pt+128+P]=lt[pt+256+P]=lt[pt+384+P]=lt[pt+0+P];for(P=0;16>P;++P,Ge<<=2)lt=le,pt=he+Za[P],$a[ke.Ob[P]](lt,pt),Mu(Ge,ut,16*+P,lt,pt)}else if(lt=Cc(H,te,ke.Ob[0]),hs[lt](le,he),Ge!=0)for(P=0;16>P;++P,Ge<<=2)Mu(Ge,ut,16*+P,le,he+Za[P]);for(P=ke.Gc,lt=Cc(H,te,ke.Dd),ki[lt](be,Ee),ki[lt](De,Ze),Ge=ut,lt=be,pt=Ee,255&(ke=0|P)&&(170&ke?Js(Ge,256,lt,pt):Wr(Ge,256,lt,pt)),ke=De,Ge=Ze,255&(P>>=8)&&(170&P?Js(ut,320,ke,Ge):Wr(ut,320,ke,Ge)),te<y.Ub-1&&(a(Me[Ve].y,0,le,he+480,16),a(Me[Ve].f,0,be,Ee+224,8),a(Me[Ve].ea,0,De,Ze+224,8)),P=8*oe*y.B,Me=y.sa,Ve=y.ta+16*H+16*oe*y.R,ut=y.qa,ke=y.ra+8*H+P,Ge=y.Ha,lt=y.Ia+8*H+P,P=0;16>P;++P)a(Me,Ve+P*y.R,le,he+32*P,16);for(P=0;8>P;++P)a(ut,ke+P*y.B,be,Ee+32*P,8),a(Ge,lt+P*y.B,De,Ze+32*P,8)}}function Si(y,N,P,H,te,oe,le,he,be){var Ee=[0],De=[0],Ze=0,ke=be!=null?be.kd:0,Me=be??new _t;if(y==null||12>P)return 7;Me.data=y,Me.w=N,Me.ha=P,N=[N],P=[P],Me.gb=[Me.gb];e:{var Ve=N,ut=P,Ge=Me.gb;if(e(y!=null),e(ut!=null),e(Ge!=null),Ge[0]=0,12<=ut[0]&&!r(y,Ve[0],"RIFF")){if(r(y,Ve[0]+8,"WEBP")){Ge=3;break e}var lt=ht(y,Ve[0]+4);if(12>lt||4294967286<lt){Ge=3;break e}if(ke&&lt>ut[0]-8){Ge=7;break e}Ge[0]=lt,Ve[0]+=12,ut[0]-=12}Ge=0}if(Ge!=0)return Ge;for(lt=0<Me.gb[0],P=P[0];;){e:{var pt=y;ut=N,Ge=P;var At=Ee,yt=De,ar=Ve=[0];if((Zt=Ze=[Ze])[0]=0,8>Ge[0])Ge=7;else{if(!r(pt,ut[0],"VP8X")){if(ht(pt,ut[0]+4)!=10){Ge=3;break e}if(18>Ge[0]){Ge=7;break e}var Gt=ht(pt,ut[0]+8),Nr=1+at(pt,ut[0]+12);if(2147483648<=Nr*(pt=1+at(pt,ut[0]+15))){Ge=3;break e}ar!=null&&(ar[0]=Gt),At!=null&&(At[0]=Nr),yt!=null&&(yt[0]=pt),ut[0]+=18,Ge[0]-=18,Zt[0]=1}Ge=0}}if(Ze=Ze[0],Ve=Ve[0],Ge!=0)return Ge;if(ut=!!(2&Ve),!lt&&Ze)return 3;if(oe!=null&&(oe[0]=!!(16&Ve)),le!=null&&(le[0]=ut),he!=null&&(he[0]=0),le=Ee[0],Ve=De[0],Ze&&ut&&be==null){Ge=0;break}if(4>P){Ge=7;break}if(lt&&Ze||!lt&&!Ze&&!r(y,N[0],"ALPH")){P=[P],Me.na=[Me.na],Me.P=[Me.P],Me.Sa=[Me.Sa];e:{Gt=y,Ge=N,lt=P;var Zt=Me.gb;At=Me.na,yt=Me.P,ar=Me.Sa,Nr=22,e(Gt!=null),e(lt!=null),pt=Ge[0];var Mr=lt[0];for(e(At!=null),e(ar!=null),At[0]=null,yt[0]=null,ar[0]=0;;){if(Ge[0]=pt,lt[0]=Mr,8>Mr){Ge=7;break e}var Ca=ht(Gt,pt+4);if(4294967286<Ca){Ge=3;break e}var Er=8+Ca+1&-2;if(Nr+=Er,0<Zt&&Nr>Zt){Ge=3;break e}if(!r(Gt,pt,"VP8 ")||!r(Gt,pt,"VP8L")){Ge=0;break e}if(Mr[0]<Er){Ge=7;break e}r(Gt,pt,"ALPH")||(At[0]=Gt,yt[0]=pt+8,ar[0]=Ca),pt+=Er,Mr-=Er}}if(P=P[0],Me.na=Me.na[0],Me.P=Me.P[0],Me.Sa=Me.Sa[0],Ge!=0)break}P=[P],Me.Ja=[Me.Ja],Me.xa=[Me.xa];e:if(Zt=y,Ge=N,lt=P,At=Me.gb[0],yt=Me.Ja,ar=Me.xa,Gt=Ge[0],pt=!r(Zt,Gt,"VP8 "),Nr=!r(Zt,Gt,"VP8L"),e(Zt!=null),e(lt!=null),e(yt!=null),e(ar!=null),8>lt[0])Ge=7;else{if(pt||Nr){if(Zt=ht(Zt,Gt+4),12<=At&&Zt>At-12){Ge=3;break e}if(ke&&Zt>lt[0]-8){Ge=7;break e}yt[0]=Zt,Ge[0]+=8,lt[0]-=8,ar[0]=Nr}else ar[0]=5<=lt[0]&&Zt[Gt+0]==47&&!(Zt[Gt+4]>>5),yt[0]=lt[0];Ge=0}if(P=P[0],Me.Ja=Me.Ja[0],Me.xa=Me.xa[0],N=N[0],Ge!=0)break;if(4294967286<Me.Ja)return 3;if(he==null||ut||(he[0]=Me.xa?2:1),le=[le],Ve=[Ve],Me.xa){if(5>P){Ge=7;break}he=le,ke=Ve,ut=oe,y==null||5>P?y=0:5<=P&&y[N+0]==47&&!(y[N+4]>>5)?(lt=[0],Zt=[0],At=[0],ae(yt=new F,y,N,P),vn(yt,lt,Zt,At)?(he!=null&&(he[0]=lt[0]),ke!=null&&(ke[0]=Zt[0]),ut!=null&&(ut[0]=At[0]),y=1):y=0):y=0}else{if(10>P){Ge=7;break}he=Ve,y==null||10>P||!ku(y,N+3,P-3)?y=0:(ke=y[N+0]|y[N+1]<<8|y[N+2]<<16,ut=16383&(y[N+7]<<8|y[N+6]),y=16383&(y[N+9]<<8|y[N+8]),1&ke||3<(ke>>1&7)||!(ke>>4&1)||ke>>5>=Me.Ja||!ut||!y?y=0:(le&&(le[0]=ut),he&&(he[0]=y),y=1))}if(!y||(le=le[0],Ve=Ve[0],Ze&&(Ee[0]!=le||De[0]!=Ve)))return 3;be!=null&&(be[0]=Me,be.offset=N-be.w,e(4294967286>N-be.w),e(be.offset==be.ha-P));break}return Ge==0||Ge==7&&Ze&&be==null?(oe!=null&&(oe[0]|=Me.na!=null&&0<Me.na.length),H!=null&&(H[0]=le),te!=null&&(te[0]=Ve),0):Ge}function Eo(y,N,P){var H=N.width,te=N.height,oe=0,le=0,he=H,be=te;if(N.Da=y!=null&&0<y.Da,N.Da&&(he=y.cd,be=y.bd,oe=y.v,le=y.j,11>P||(oe&=-2,le&=-2),0>oe||0>le||0>=he||0>=be||oe+he>H||le+be>te))return 0;if(N.v=oe,N.j=le,N.va=oe+he,N.o=le+be,N.U=he,N.T=be,N.da=y!=null&&0<y.da,N.da){if(!ve(he,be,P=[y.ib],oe=[y.hb]))return 0;N.ib=P[0],N.hb=oe[0]}return N.ob=y!=null&&y.ob,N.Kb=y==null||!y.Sd,N.da&&(N.ob=N.ib<3*H/4&&N.hb<3*te/4,N.Kb=0),1}function Iu(y){if(y==null)return 2;if(11>y.S){var N=y.f.RGBA;N.fb+=(y.height-1)*N.A,N.A=-N.A}else N=y.f.kb,y=y.height,N.O+=(y-1)*N.fa,N.fa=-N.fa,N.N+=(y-1>>1)*N.Ab,N.Ab=-N.Ab,N.W+=(y-1>>1)*N.Db,N.Db=-N.Db,N.F!=null&&(N.J+=(y-1)*N.lb,N.lb=-N.lb);return 0}function Ni(y,N,P,H){if(H==null||0>=y||0>=N)return 2;if(P!=null){if(P.Da){var te=P.cd,oe=P.bd,le=-2&P.v,he=-2&P.j;if(0>le||0>he||0>=te||0>=oe||le+te>y||he+oe>N)return 2;y=te,N=oe}if(P.da){if(!ve(y,N,te=[P.ib],oe=[P.hb]))return 2;y=te[0],N=oe[0]}}H.width=y,H.height=N;e:{var be=H.width,Ee=H.height;if(y=H.S,0>=be||0>=Ee||!(y>=Qf&&13>y))y=2;else{if(0>=H.Rd&&H.sd==null){le=oe=te=N=0;var De=(he=be*ld[y])*Ee;if(11>y||(oe=(Ee+1)/2*(N=(be+1)/2),y==12&&(le=(te=be)*Ee)),(Ee=s(De+2*oe+le))==null){y=1;break e}H.sd=Ee,11>y?((be=H.f.RGBA).eb=Ee,be.fb=0,be.A=he,be.size=De):((be=H.f.kb).y=Ee,be.O=0,be.fa=he,be.Fd=De,be.f=Ee,be.N=0+De,be.Ab=N,be.Cd=oe,be.ea=Ee,be.W=0+De+oe,be.Db=N,be.Ed=oe,y==12&&(be.F=Ee,be.J=0+De+2*oe),be.Tc=le,be.lb=te)}if(N=1,te=H.S,oe=H.width,le=H.height,te>=Qf&&13>te)if(11>te)y=H.f.RGBA,N&=(he=Math.abs(y.A))*(le-1)+oe<=y.size,N&=he>=oe*ld[te],N&=y.eb!=null;else{y=H.f.kb,he=(oe+1)/2,De=(le+1)/2,be=Math.abs(y.fa),Ee=Math.abs(y.Ab);var Ze=Math.abs(y.Db),ke=Math.abs(y.lb),Me=ke*(le-1)+oe;N&=be*(le-1)+oe<=y.Fd,N&=Ee*(De-1)+he<=y.Cd,N=(N&=Ze*(De-1)+he<=y.Ed)&be>=oe&Ee>=he&Ze>=he,N&=y.y!=null,N&=y.f!=null,N&=y.ea!=null,te==12&&(N&=ke>=oe,N&=Me<=y.Tc,N&=y.F!=null)}else N=0;y=N?0:2}}return y!=0||P!=null&&P.fd&&(y=Iu(H)),y}var sl=64,ws=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ds=24,Gi=32,Yi=8,Ao=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Xe("Predictor0","PredictorAdd0"),L.Predictor0=function(){return 4278190080},L.Predictor1=function(y){return y},L.Predictor2=function(y,N,P){return N[P+0]},L.Predictor3=function(y,N,P){return N[P+1]},L.Predictor4=function(y,N,P){return N[P-1]},L.Predictor5=function(y,N,P){return jt(jt(y,N[P+1]),N[P+0])},L.Predictor6=function(y,N,P){return jt(y,N[P-1])},L.Predictor7=function(y,N,P){return jt(y,N[P+0])},L.Predictor8=function(y,N,P){return jt(N[P-1],N[P+0])},L.Predictor9=function(y,N,P){return jt(N[P+0],N[P+1])},L.Predictor10=function(y,N,P){return jt(jt(y,N[P-1]),jt(N[P+0],N[P+1]))},L.Predictor11=function(y,N,P){var H=N[P+0];return 0>=$t(H>>24&255,y>>24&255,(N=N[P-1])>>24&255)+$t(H>>16&255,y>>16&255,N>>16&255)+$t(H>>8&255,y>>8&255,N>>8&255)+$t(255&H,255&y,255&N)?H:y},L.Predictor12=function(y,N,P){var H=N[P+0];return(Lt((y>>24&255)+(H>>24&255)-((N=N[P-1])>>24&255))<<24|Lt((y>>16&255)+(H>>16&255)-(N>>16&255))<<16|Lt((y>>8&255)+(H>>8&255)-(N>>8&255))<<8|Lt((255&y)+(255&H)-(255&N)))>>>0},L.Predictor13=function(y,N,P){var H=N[P-1];return(Vt((y=jt(y,N[P+0]))>>24&255,H>>24&255)<<24|Vt(y>>16&255,H>>16&255)<<16|Vt(y>>8&255,H>>8&255)<<8|Vt(255&y,255&H))>>>0};var Tc=L.PredictorAdd0;L.PredictorAdd1=Wt,Xe("Predictor2","PredictorAdd2"),Xe("Predictor3","PredictorAdd3"),Xe("Predictor4","PredictorAdd4"),Xe("Predictor5","PredictorAdd5"),Xe("Predictor6","PredictorAdd6"),Xe("Predictor7","PredictorAdd7"),Xe("Predictor8","PredictorAdd8"),Xe("Predictor9","PredictorAdd9"),Xe("Predictor10","PredictorAdd10"),Xe("Predictor11","PredictorAdd11"),Xe("Predictor12","PredictorAdd12"),Xe("Predictor13","PredictorAdd13");var Oc=L.PredictorAdd2;Ye("ColorIndexInverseTransform","MapARGB","32b",function(y){return y>>8&255},function(y){return y}),Ye("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(y){return y},function(y){return y>>8&255});var Ka,Kf=L.ColorIndexInverseTransform,Xi=L.MapARGB,Ki=L.VP8LColorIndexInverseTransformAlpha,qn=L.MapAlpha,Co=L.VP8LPredictorsAdd=[];Co.length=16,(L.VP8LPredictors=[]).length=16,(L.VP8LPredictorsAdd_C=[]).length=16,(L.VP8LPredictors_C=[]).length=16;var Rc,Dc,To,Oo,Ji,Il,zs,Ro,Zn,Js,Zr,Wr,ba,Ja,Zi,ji,Bl,Bu,bh,cm,um,fm,wh,Sh,Ul,Zs,Uu,Hs,ql=s(511),Jf=s(2041),qu=s(225),zu=s(767),Zf=0,Do=Jf,Hu=qu,Qn=zu,zn=ql,Qf=0,es=1,ed=2,Qs=3,$u=4,Fc=5,il=6,Wu=7,td=8,Lc=9,rd=10,ei=[2,3,7],Pc=[3,3,11],zl=[280,256,256,256,40],ad=[0,1,1,1,0],Vu=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],ti=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],ri=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],ol=8,ai=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ni=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],$s=null,dm=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Nh=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],nd=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],hm=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Hn=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Aa=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Br=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],hs=[],$a=[],ki=[],ll=1,jh=2,Fo=[],$n=[];No("UpsampleRgbLinePair",jo,3),No("UpsampleBgrLinePair",On,3),No("UpsampleRgbaLinePair",fs,4),No("UpsampleBgraLinePair",Vi,4),No("UpsampleArgbLinePair",Ac,4),No("UpsampleRgba4444LinePair",nl,2),No("UpsampleRgb565LinePair",al,2);var Hl=L.UpsampleRgbLinePair,kh=L.UpsampleBgrLinePair,Mc=L.UpsampleRgbaLinePair,sd=L.UpsampleBgraLinePair,cl=L.UpsampleArgbLinePair,Qi=L.UpsampleRgba4444LinePair,ul=L.UpsampleRgb565LinePair,si=16,Ic=1<<si-1,$l=-227,fl=482,id=6,dl=0,Wn=s(256),od=s(256),mm=s(256),D1=s(256),F1=s(fl-$l),L1=s(fl-$l);ko("YuvToRgbRow",jo,3),ko("YuvToBgrRow",On,3),ko("YuvToRgbaRow",fs,4),ko("YuvToBgraRow",Vi,4),ko("YuvToArgbRow",Ac,4),ko("YuvToRgba4444Row",nl,2),ko("YuvToRgb565Row",al,2);var Za=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Bc=[0,2,8],Gu=[8,7,6,4,4,2,2,2,1,1,1,1],Yu=1;this.WebPDecodeRGBA=function(y,N,P,H,te){var oe=es,le=new mt,he=new Rt;le.ba=he,he.S=oe,he.width=[he.width],he.height=[he.height];var be=he.width,Ee=he.height,De=new It;if(De==null||y==null)var Ze=2;else e(De!=null),Ze=Si(y,N,P,De.width,De.height,De.Pd,De.Qd,De.format,null);if(Ze!=0?be=0:(be!=null&&(be[0]=De.width[0]),Ee!=null&&(Ee[0]=De.height[0]),be=1),be){he.width=he.width[0],he.height=he.height[0],H!=null&&(H[0]=he.width),te!=null&&(te[0]=he.height);e:{if(H=new po,(te=new _t).data=y,te.w=N,te.ha=P,te.kd=1,N=[0],e(te!=null),((y=Si(te.data,te.w,te.ha,null,null,null,N,null,te))==0||y==7)&&N[0]&&(y=4),(N=y)==0){if(e(le!=null),H.data=te.data,H.w=te.w+te.offset,H.ha=te.ha-te.offset,H.put=rr,H.ac=Ea,H.bc=ya,H.ma=le,te.xa){if((y=Ke())==null){le=1;break e}if((function(ke,Me){var Ve=[0],ut=[0],Ge=[0];t:for(;;){if(ke==null)return 0;if(Me==null)return ke.a=2,0;if(ke.l=Me,ke.a=0,ae(ke.m,Me.data,Me.w,Me.ha),!vn(ke.m,Ve,ut,Ge)){ke.a=3;break t}if(ke.xb=jh,Me.width=Ve[0],Me.height=ut[0],!Je(Ve[0],ut[0],1,ke,null))break t;return 1}return e(ke.a!=0),0})(y,H)){if(H=(N=Ni(H.width,H.height,le.Oa,le.ba))==0){t:{H=y;r:for(;;){if(H==null){H=0;break t}if(e(H.s.yc!=null),e(H.s.Ya!=null),e(0<H.s.Wb),e((P=H.l)!=null),e((te=P.ma)!=null),H.xb!=0){if(H.ca=te.ba,H.tb=te.tb,e(H.ca!=null),!Eo(te.Oa,P,Qs)){H.a=2;break r}if(!Qe(H,P.width)||P.da)break r;if((P.da||Pe(H.ca.S))&&bi(),11>H.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),H.ca.f.kb.F!=null&&bi()),H.Pb&&0<H.s.ua&&H.s.vb.X==null&&!de(H.s.vb,H.s.Wa.Xa)){H.a=1;break r}H.xb=0}if(!We(H,H.V,H.Ba,H.c,H.i,P.o,me))break r;te.Dc=H.Ma,H=1;break t}e(H.a!=0),H=0}H=!H}H&&(N=y.a)}else N=y.a}else{if((y=new xi)==null){le=1;break e}if(y.Fa=te.na,y.P=te.P,y.qc=te.Sa,zi(y,H)){if((N=Ni(H.width,H.height,le.Oa,le.ba))==0){if(y.Aa=0,P=le.Oa,e((te=y)!=null),P!=null){if(0<(be=0>(be=P.Md)?0:100<be?255:255*be/100)){for(Ee=De=0;4>Ee;++Ee)12>(Ze=te.pb[Ee]).lc&&(Ze.ia=be*Gu[0>Ze.lc?0:Ze.lc]>>3),De|=Ze.ia;De&&(alert("todo:VP8InitRandom"),te.ia=1)}te.Ga=P.Id,100<te.Ga?te.Ga=100:0>te.Ga&&(te.Ga=0)}(function(ke,Me){if(ke==null)return 0;if(Me==null)return Jr(ke,2,"NULL VP8Io parameter in VP8Decode().");if(!ke.cb&&!zi(ke,Me))return 0;if(e(ke.cb),Me.ac==null||Me.ac(Me)){Me.ob&&(ke.L=0);var Ve=Bc[ke.L];if(ke.L==2?(ke.yb=0,ke.zb=0):(ke.yb=Me.v-Ve>>4,ke.zb=Me.j-Ve>>4,0>ke.yb&&(ke.yb=0),0>ke.zb&&(ke.zb=0)),ke.Va=Me.o+15+Ve>>4,ke.Hb=Me.va+15+Ve>>4,ke.Hb>ke.za&&(ke.Hb=ke.za),ke.Va>ke.Ub&&(ke.Va=ke.Ub),0<ke.L){var ut=ke.ed;for(Ve=0;4>Ve;++Ve){var Ge;if(ke.Qa.Cb){var lt=ke.Qa.Lb[Ve];ke.Qa.Fb||(lt+=ut.Tb)}else lt=ut.Tb;for(Ge=0;1>=Ge;++Ge){var pt=ke.gd[Ve][Ge],At=lt;if(ut.Pc&&(At+=ut.vd[0],Ge&&(At+=ut.od[0])),0<(At=0>At?0:63<At?63:At)){var yt=At;0<ut.wb&&(yt=4<ut.wb?yt>>2:yt>>1)>9-ut.wb&&(yt=9-ut.wb),1>yt&&(yt=1),pt.dd=yt,pt.tc=2*At+yt,pt.ld=40<=At?2:15<=At?1:0}else pt.tc=0;pt.La=Ge}}}Ve=0}else Jr(ke,6,"Frame setup failed"),Ve=ke.a;if(Ve=Ve==0){if(Ve){ke.$c=0,0<ke.Aa||(ke.Ic=Yu);t:{Ve=ke.Ic,ut=4*(yt=ke.za);var ar=32*yt,Gt=yt+1,Nr=0<ke.L?yt*(0<ke.Aa?2:1):0,Zt=(ke.Aa==2?2:1)*yt;if((pt=ut+832+(Ge=3*(16*Ve+Bc[ke.L])/2*ar)+(lt=ke.Fa!=null&&0<ke.Fa.length?ke.Kc.c*ke.Kc.i:0))!=pt)Ve=0;else{if(pt>ke.Vb){if(ke.Vb=0,ke.Ec=s(pt),ke.Fc=0,ke.Ec==null){Ve=Jr(ke,1,"no memory during frame initialization.");break t}ke.Vb=pt}pt=ke.Ec,At=ke.Fc,ke.Ac=pt,ke.Bc=At,At+=ut,ke.Gd=l(ar,Is),ke.Hd=0,ke.rb=l(Gt+1,ua),ke.sb=1,ke.wa=Nr?l(Nr,Lr):null,ke.Y=0,ke.D.Nb=0,ke.D.wa=ke.wa,ke.D.Y=ke.Y,0<ke.Aa&&(ke.D.Y+=yt),e(!0),ke.oc=pt,ke.pc=At,At+=832,ke.ya=l(Zt,gi),ke.aa=0,ke.D.ya=ke.ya,ke.D.aa=ke.aa,ke.Aa==2&&(ke.D.aa+=yt),ke.R=16*yt,ke.B=8*yt,yt=(ar=Bc[ke.L])*ke.R,ar=ar/2*ke.B,ke.sa=pt,ke.ta=At+yt,ke.qa=ke.sa,ke.ra=ke.ta+16*Ve*ke.R+ar,ke.Ha=ke.qa,ke.Ia=ke.ra+8*Ve*ke.B+ar,ke.$c=0,At+=Ge,ke.mb=lt?pt:null,ke.nb=lt?At:null,e(At+lt<=ke.Fc+ke.Vb),Eu(ke),n(ke.Ac,ke.Bc,0,ut),Ve=1}}if(Ve){if(Me.ka=0,Me.y=ke.sa,Me.O=ke.ta,Me.f=ke.qa,Me.N=ke.ra,Me.ea=ke.Ha,Me.Vd=ke.Ia,Me.fa=ke.R,Me.Rc=ke.B,Me.F=null,Me.J=0,!Zf){for(Ve=-255;255>=Ve;++Ve)ql[255+Ve]=0>Ve?-Ve:Ve;for(Ve=-1020;1020>=Ve;++Ve)Jf[1020+Ve]=-128>Ve?-128:127<Ve?127:Ve;for(Ve=-112;112>=Ve;++Ve)qu[112+Ve]=-16>Ve?-16:15<Ve?15:Ve;for(Ve=-255;510>=Ve;++Ve)zu[255+Ve]=0>Ve?0:255<Ve?255:Ve;Zf=1}zs=yi,Ro=Au,Js=us,Zr=Cu,Wr=Tu,Zn=qf,ba=Yf,Ja=wo,Zi=Q,ji=Ae,Bl=Xf,Bu=R,bh=Oe,cm=ze,um=xo,fm=yo,wh=Pl,Sh=Lu,$a[0]=Vf,$a[1]=zf,$a[2]=Wf,$a[3]=Du,$a[4]=Bs,$a[5]=Fu,$a[6]=Bn,$a[7]=Dl,$a[8]=Fl,$a[9]=Us,hs[0]=_i,hs[1]=Ou,hs[2]=Ru,hs[3]=$f,hs[4]=go,hs[5]=Rl,hs[6]=rl,ki[0]=Nc,ki[1]=Hf,ki[2]=Hi,ki[3]=Gf,ki[4]=Tn,ki[5]=jc,ki[6]=$i,Ve=1}else Ve=0}Ve&&(Ve=(function(Mr,Ca){for(Mr.M=0;Mr.M<Mr.Va;++Mr.M){var Er,Yt=Mr.Jc[Mr.M&Mr.Xb],zt=Mr.m,Pa=Mr;for(Er=0;Er<Pa.za;++Er){var vr=zt,Tr=Pa,oa=Tr.Ac,_n=Tr.Bc+4*Er,Vn=Tr.zc,wa=Tr.ya[Tr.aa+Er];if(Tr.Qa.Bb?wa.$b=_e(vr,Tr.Pa.jb[0])?2+_e(vr,Tr.Pa.jb[2]):_e(vr,Tr.Pa.jb[1]):wa.$b=0,Tr.kc&&(wa.Ad=_e(vr,Tr.Bd)),wa.Za=!_e(vr,145)+0,wa.Za){var on=wa.Ob,ts=0;for(Tr=0;4>Tr;++Tr){var ln,Fr=Vn[0+Tr];for(ln=0;4>ln;++ln){Fr=Hn[oa[_n+ln]][Fr];for(var Yr=nd[_e(vr,Fr[0])];0<Yr;)Yr=nd[2*Yr+_e(vr,Fr[Yr])];Fr=-Yr,oa[_n+ln]=Fr}a(on,ts,oa,_n,4),ts+=4,Vn[0+Tr]=Fr}}else Fr=_e(vr,156)?_e(vr,128)?1:3:_e(vr,163)?2:0,wa.Ob[0]=Fr,n(oa,_n,Fr,4),n(Vn,0,Fr,4);wa.Dd=_e(vr,142)?_e(vr,114)?_e(vr,183)?1:3:2:0}if(Pa.m.Ka)return Jr(Mr,7,"Premature end-of-partition0 encountered.");for(;Mr.ja<Mr.za;++Mr.ja){if(Pa=Yt,vr=(zt=Mr).rb[zt.sb-1],oa=zt.rb[zt.sb+zt.ja],Er=zt.ya[zt.aa+zt.ja],_n=zt.kc?Er.Ad:0)vr.la=oa.la=0,Er.Za||(vr.Na=oa.Na=0),Er.Hc=0,Er.Gc=0,Er.ia=0;else{var Ma,Qr;if(vr=oa,oa=Pa,_n=zt.Pa.Xc,Vn=zt.ya[zt.aa+zt.ja],wa=zt.pb[Vn.$b],Tr=Vn.ad,on=0,ts=zt.rb[zt.sb-1],Fr=ln=0,n(Tr,on,0,384),Vn.Za)var bn=0,Ia=_n[3];else{Yr=s(16);var Xr=vr.Na+ts.Na;if(Xr=$s(oa,_n[1],Xr,wa.Eb,0,Yr,0),vr.Na=ts.Na=(0<Xr)+0,1<Xr)zs(Yr,0,Tr,on);else{var Qa=Yr[0]+3>>3;for(Yr=0;256>Yr;Yr+=16)Tr[on+Yr]=Qa}bn=1,Ia=_n[0]}var la=15&vr.la,cn=15&ts.la;for(Yr=0;4>Yr;++Yr){var un=1&cn;for(Qa=Qr=0;4>Qa;++Qa)la=la>>1|(un=(Xr=$s(oa,Ia,Xr=un+(1&la),wa.Sc,bn,Tr,on))>bn)<<7,Qr=Qr<<2|(3<Xr?3:1<Xr?2:Tr[on+0]!=0),on+=16;la>>=4,cn=cn>>1|un<<7,ln=(ln<<8|Qr)>>>0}for(Ia=la,bn=cn>>4,Ma=0;4>Ma;Ma+=2){for(Qr=0,la=vr.la>>4+Ma,cn=ts.la>>4+Ma,Yr=0;2>Yr;++Yr){for(un=1&cn,Qa=0;2>Qa;++Qa)Xr=un+(1&la),la=la>>1|(un=0<(Xr=$s(oa,_n[2],Xr,wa.Qc,0,Tr,on)))<<3,Qr=Qr<<2|(3<Xr?3:1<Xr?2:Tr[on+0]!=0),on+=16;la>>=2,cn=cn>>1|un<<5}Fr|=Qr<<4*Ma,Ia|=la<<4<<Ma,bn|=(240&cn)<<Ma}vr.la=Ia,ts.la=bn,Vn.Hc=ln,Vn.Gc=Fr,Vn.ia=43690&Fr?0:wa.ia,_n=!(ln|Fr)}if(0<zt.L&&(zt.wa[zt.Y+zt.ja]=zt.gd[Er.$b][Er.Za],zt.wa[zt.Y+zt.ja].La|=!_n),Pa.Ka)return Jr(Mr,7,"Premature end-of-file encountered.")}if(Eu(Mr),zt=Ca,Pa=1,Er=(Yt=Mr).D,vr=0<Yt.L&&Yt.M>=Yt.zb&&Yt.M<=Yt.Va,Yt.Aa==0)t:{if(Er.M=Yt.M,Er.uc=vr,qs(Yt,Er),Pa=1,Er=(Qr=Yt.D).Nb,vr=(Fr=Bc[Yt.L])*Yt.R,oa=Fr/2*Yt.B,Yr=16*Er*Yt.R,Qa=8*Er*Yt.B,_n=Yt.sa,Vn=Yt.ta-vr+Yr,wa=Yt.qa,Tr=Yt.ra-oa+Qa,on=Yt.Ha,ts=Yt.Ia-oa+Qa,cn=(la=Qr.M)==0,ln=la>=Yt.Va-1,Yt.Aa==2&&qs(Yt,Qr),Qr.uc)for(un=(Xr=Yt).D.M,e(Xr.D.uc),Qr=Xr.yb;Qr<Xr.Hb;++Qr){bn=Qr,Ia=un;var da=(Vr=(fn=Xr).D).Nb;Ma=fn.R;var Vr=Vr.wa[Vr.Y+bn],rs=fn.sa,Wa=fn.ta+16*da*Ma+16*bn,ur=Vr.dd,fr=Vr.tc;if(fr!=0)if(e(3<=fr),fn.L==1)0<bn&&fm(rs,Wa,Ma,fr+4),Vr.La&&Sh(rs,Wa,Ma,fr),0<Ia&&um(rs,Wa,Ma,fr+4),Vr.La&&wh(rs,Wa,Ma,fr);else{var Kr=fn.B,Ss=fn.qa,ii=fn.ra+8*da*Kr+8*bn,ms=fn.Ha,fn=fn.Ia+8*da*Kr+8*bn;da=Vr.ld,0<bn&&(Ja(rs,Wa,Ma,fr+4,ur,da),ji(Ss,ii,ms,fn,Kr,fr+4,ur,da)),Vr.La&&(Bu(rs,Wa,Ma,fr,ur,da),cm(Ss,ii,ms,fn,Kr,fr,ur,da)),0<Ia&&(ba(rs,Wa,Ma,fr+4,ur,da),Zi(Ss,ii,ms,fn,Kr,fr+4,ur,da)),Vr.La&&(Bl(rs,Wa,Ma,fr,ur,da),bh(Ss,ii,ms,fn,Kr,fr,ur,da))}}if(Yt.ia&&alert("todo:DitherRow"),zt.put!=null){if(Qr=16*la,la=16*(la+1),cn?(zt.y=Yt.sa,zt.O=Yt.ta+Yr,zt.f=Yt.qa,zt.N=Yt.ra+Qa,zt.ea=Yt.Ha,zt.W=Yt.Ia+Qa):(Qr-=Fr,zt.y=_n,zt.O=Vn,zt.f=wa,zt.N=Tr,zt.ea=on,zt.W=ts),ln||(la-=Fr),la>zt.o&&(la=zt.o),zt.F=null,zt.J=null,Yt.Fa!=null&&0<Yt.Fa.length&&Qr<la&&(zt.J=_a(Yt,zt,Qr,la-Qr),zt.F=Yt.mb,zt.F==null&&zt.F.length==0)){Pa=Jr(Yt,3,"Could not decode alpha data.");break t}Qr<zt.j&&(Fr=zt.j-Qr,Qr=zt.j,e(!(1&Fr)),zt.O+=Yt.R*Fr,zt.N+=Yt.B*(Fr>>1),zt.W+=Yt.B*(Fr>>1),zt.F!=null&&(zt.J+=zt.width*Fr)),Qr<la&&(zt.O+=zt.v,zt.N+=zt.v>>1,zt.W+=zt.v>>1,zt.F!=null&&(zt.J+=zt.v),zt.ka=Qr-zt.j,zt.U=zt.va-zt.v,zt.T=la-Qr,Pa=zt.put(zt))}Er+1!=Yt.Ic||ln||(a(Yt.sa,Yt.ta-vr,_n,Vn+16*Yt.R,vr),a(Yt.qa,Yt.ra-oa,wa,Tr+8*Yt.B,oa),a(Yt.Ha,Yt.Ia-oa,on,ts+8*Yt.B,oa))}if(!Pa)return Jr(Mr,6,"Output aborted.")}return 1})(ke,Me)),Me.bc!=null&&Me.bc(Me),Ve&=1}return Ve?(ke.cb=0,Ve):0})(y,H)||(N=y.a)}}else N=y.a}N==0&&le.Oa!=null&&le.Oa.fd&&(N=Iu(le.ba))}le=N}oe=le!=0?null:11>oe?he.f.RGBA.eb:he.f.kb.y}else oe=null;return oe};var ld=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(L,J){for(var D="",O=0;O<4;O++)D+=String.fromCharCode(L[J++]);return D}function m(L,J){return L[J+0]|L[J+1]<<8}function v(L,J){return(L[J+0]|L[J+1]<<8|L[J+2]<<16)>>>0}function x(L,J){return(L[J+0]|L[J+1]<<8|L[J+2]<<16|L[J+3]<<24)>>>0}new f;var g=[0],b=[0],_=[],w=new f,E=t,C=(function(L,J){var D={},O=0,M=!1,V=0,ie=0;if(D.frames=[],!(function(j,F){for(var I=0;I<4;I++)if(j[F+I]!="RIFF".charCodeAt(I))return!0;return!1})(L,J)){for(x(L,J+=4),J+=8;J<L.length;){var X=d(L,J),Z=x(L,J+=4);J+=4;var K=Z+(1&Z);switch(X){case"VP8 ":case"VP8L":D.frames[O]===void 0&&(D.frames[O]={}),(U=D.frames[O]).src_off=M?ie:J-8,U.src_size=V+Z+8,O++,M&&(M=!1,V=0,ie=0);break;case"VP8X":(U=D.header={}).feature_flags=L[J];var ae=J+4;U.canvas_width=1+v(L,ae),ae+=3,U.canvas_height=1+v(L,ae),ae+=3;break;case"ALPH":M=!0,V=K+8,ie=J-8;break;case"ANIM":(U=D.header).bgcolor=x(L,J),ae=J+4,U.loop_count=m(L,ae),ae+=2;break;case"ANMF":var fe,U;(U=D.frames[O]={}).offset_x=2*v(L,J),J+=3,U.offset_y=2*v(L,J),J+=3,U.width=1+v(L,J),J+=3,U.height=1+v(L,J),J+=3,U.duration=v(L,J),J+=3,fe=L[J++],U.dispose=1&fe,U.blend=fe>>1&1}X!="ANMF"&&(J+=K)}return D}})(E,0);C.response=E,C.rgbaoutput=!0,C.dataurl=!1;var A=C.header?C.header:null,T=C.frames?C.frames:null;if(A){A.loop_counter=A.loop_count,g=[A.canvas_height],b=[A.canvas_width];for(var G=0;G<T.length&&T[G].blend!=0;G++);}var W=T[0],B=w.WebPDecodeRGBA(E,W.src_off,W.src_size,b,g);W.rgba=B,W.imgwidth=b[0],W.imgheight=g[0];for(var q=0;q<b[0]*g[0]*4;q++)_[q]=B[q];return this.width=b,this.height=g,this.data=_,this}(function(t){var e,r,a,n,s,l,c,f,d,m=function(j){return j=j||{},this.isStrokeTransparent=j.isStrokeTransparent||!1,this.strokeOpacity=j.strokeOpacity||1,this.strokeStyle=j.strokeStyle||"#000000",this.fillStyle=j.fillStyle||"#000000",this.isFillTransparent=j.isFillTransparent||!1,this.fillOpacity=j.fillOpacity||1,this.font=j.font||"10px sans-serif",this.textBaseline=j.textBaseline||"alphabetic",this.textAlign=j.textAlign||"left",this.lineWidth=j.lineWidth||1,this.lineJoin=j.lineJoin||"miter",this.lineCap=j.lineCap||"butt",this.path=j.path||[],this.transform=j.transform!==void 0?j.transform.clone():new f,this.globalCompositeOperation=j.globalCompositeOperation||"normal",this.globalAlpha=j.globalAlpha||1,this.clip_path=j.clip_path||[],this.currentPoint=j.currentPoint||new l,this.miterLimit=j.miterLimit||10,this.lastPoint=j.lastPoint||new l,this.lineDashOffset=j.lineDashOffset||0,this.lineDash=j.lineDash||[],this.margin=j.margin||[0,0,0,0],this.prevPageLastElemOffset=j.prevPageLastElemOffset||0,this.ignoreClearRect=typeof j.ignoreClearRect!="boolean"||j.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new v(this),e=this.internal.f2,r=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,l=this.internal.Point,c=this.internal.Rectangle,f=this.internal.Matrix,d=new m}]);var v=function(j){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var F=j;Object.defineProperty(this,"pdf",{get:function(){return F}});var I=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return I},set:function(de){I=!!de}});var z=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return z},set:function(de){z=!!de}});var ne=0;Object.defineProperty(this,"posX",{get:function(){return ne},set:function(de){isNaN(de)||(ne=de)}});var se=0;Object.defineProperty(this,"posY",{get:function(){return se},set:function(de){isNaN(de)||(se=de)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(de){var it;typeof de=="number"?it=[de,de,de,de]:((it=new Array(4))[0]=de[0],it[1]=de.length>=2?de[1]:it[0],it[2]=de.length>=3?de[2]:it[0],it[3]=de.length>=4?de[3]:it[1]),d.margin=it}});var pe=!1;Object.defineProperty(this,"autoPaging",{get:function(){return pe},set:function(de){pe=de}});var ye=0;Object.defineProperty(this,"lastBreak",{get:function(){return ye},set:function(de){ye=de}});var _e=[];Object.defineProperty(this,"pageBreaks",{get:function(){return _e},set:function(de){_e=de}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(de){de instanceof m&&(d=de)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(de){d.path=de}});var Le=[];Object.defineProperty(this,"ctxStack",{get:function(){return Le},set:function(de){Le=de}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(de){var it;it=x(de),this.ctx.fillStyle=it.style,this.ctx.isFillTransparent=it.a===0,this.ctx.fillOpacity=it.a,this.pdf.setFillColor(it.r,it.g,it.b,{a:it.a}),this.pdf.setTextColor(it.r,it.g,it.b,{a:it.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(de){var it=x(de);this.ctx.strokeStyle=it.style,this.ctx.isStrokeTransparent=it.a===0,this.ctx.strokeOpacity=it.a,it.a===0?this.pdf.setDrawColor(255,255,255):(it.a,this.pdf.setDrawColor(it.r,it.g,it.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(de){["butt","round","square"].indexOf(de)!==-1&&(this.ctx.lineCap=de,this.pdf.setLineCap(de))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(de){isNaN(de)||(this.ctx.lineWidth=de,this.pdf.setLineWidth(de))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(de){["bevel","round","miter"].indexOf(de)!==-1&&(this.ctx.lineJoin=de,this.pdf.setLineJoin(de))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(de){isNaN(de)||(this.ctx.miterLimit=de,this.pdf.setMiterLimit(de))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(de){this.ctx.textBaseline=de}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(de){["right","end","center","left","start"].indexOf(de)!==-1&&(this.ctx.textAlign=de)}});var ue=null,at=null,ht=null;Object.defineProperty(this,"fontFaces",{get:function(){return ht},set:function(de){ue=null,at=null,ht=de}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(de){var it;if(this.ctx.font=de,(it=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(de))!==null){var Se=it[1];it[2];var ve=it[3],Ie=it[4];it[5];var wt=it[6],Xe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ie)[2];Ie=Math.floor(Xe==="px"?parseFloat(Ie)*this.pdf.internal.scaleFactor:Xe==="em"?parseFloat(Ie)*this.pdf.getFontSize():parseFloat(Ie)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ie);var ct=(function(Ye){var Pt,Et,Dt=[],Ce=Ye.trim();if(Ce==="")return qv;if(Ce in yS)return[yS[Ce]];for(;Ce!=="";){switch(Et=null,Pt=(Ce=bS(Ce)).charAt(0)){case'"':case"'":Et=Pz(Ce.substring(1),Pt);break;default:Et=Mz(Ce)}if(Et===null||(Dt.push(Et[0]),(Ce=bS(Et[1]))!==""&&Ce.charAt(0)!==","))return qv;Ce=Ce.replace(/^,/,"")}return Dt})(wt);if(this.fontFaces){var jt=(function(Ye,Pt){var Et=Ye.getFontList(),Dt=JSON.stringify(Et);if(ue===null||at!==Dt){var Ce=(function($e){var xe=[];return Object.keys($e).forEach(function(Be){$e[Be].forEach(function(Pe){var Ct=null;switch(Pe){case"bold":Ct={family:Be,weight:"bold"};break;case"italic":Ct={family:Be,style:"italic"};break;case"bolditalic":Ct={family:Be,weight:"bold",style:"italic"};break;case"":case"normal":Ct={family:Be}}Ct!==null&&(Ct.ref={name:Be,style:Pe},xe.push(Ct))})}),xe})(Et);ue=(function($e){for(var xe={},Be=0;Be<$e.length;++Be){var Pe=Uv($e[Be]),Ct=Pe.family,gt=Pe.stretch,Rt=Pe.style,It=Pe.weight;xe[Ct]=xe[Ct]||{},xe[Ct][gt]=xe[Ct][gt]||{},xe[Ct][gt][Rt]=xe[Ct][gt][Rt]||{},xe[Ct][gt][Rt][It]=Pe}return xe})(Ce.concat(Pt)),at=Dt}return ue})(this.pdf,this.fontFaces),Lt=ct.map(function(Ye){return{family:Ye,stretch:"normal",weight:ve,style:Se}}),Vt=(function(Ye,Pt,Et){for(var Dt=(Et=Et||{}).defaultFontFamily||"times",Ce=Object.assign({},Lz,Et.genericFontFamilies||{}),$e=null,xe=null,Be=0;Be<Pt.length;++Be)if(Ce[($e=Uv(Pt[Be])).family]&&($e.family=Ce[$e.family]),Ye.hasOwnProperty($e.family)){xe=Ye[$e.family];break}if(!(xe=xe||Ye[Dt]))throw new Error("Could not find a font-family for the rule '"+_S($e)+"' and default family '"+Dt+"'.");if(xe=(function(Pe,Ct){if(Ct[Pe])return Ct[Pe];var gt=Hx[Pe],Rt=gt<=Hx.normal?-1:1,It=xS(Ct,sk,gt,Rt);if(!It)throw new Error("Could not find a matching font-stretch value for "+Pe);return It})($e.stretch,xe),xe=(function(Pe,Ct){if(Ct[Pe])return Ct[Pe];for(var gt=nk[Pe],Rt=0;Rt<gt.length;++Rt)if(Ct[gt[Rt]])return Ct[gt[Rt]];throw new Error("Could not find a matching font-style for "+Pe)})($e.style,xe),!(xe=(function(Pe,Ct){if(Ct[Pe])return Ct[Pe];if(Pe===400&&Ct[500])return Ct[500];if(Pe===500&&Ct[400])return Ct[400];var gt=Fz[Pe],Rt=xS(Ct,ik,gt,Pe<400?-1:1);if(!Rt)throw new Error("Could not find a matching font-weight for value "+Pe);return Rt})($e.weight,xe)))throw new Error("Failed to resolve a font for the rule '"+_S($e)+"'.");return xe})(jt,Lt);this.pdf.setFont(Vt.ref.name,Vt.ref.style)}else{var $t="";(ve==="bold"||parseInt(ve,10)>=700||Se==="bold")&&($t="bold"),Se==="italic"&&($t+="italic"),$t.length===0&&($t="normal");for(var Wt="",Ot={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},kt=0;kt<ct.length;kt++){if(this.pdf.internal.getFont(ct[kt],$t,{noFallback:!0,disableWarning:!0})!==void 0){Wt=ct[kt];break}if($t==="bolditalic"&&this.pdf.internal.getFont(ct[kt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Wt=ct[kt],$t="bold";else if(this.pdf.internal.getFont(ct[kt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Wt=ct[kt],$t="normal";break}}if(Wt===""){for(var qe=0;qe<ct.length;qe++)if(Ot[ct[qe]]){Wt=Ot[ct[qe]];break}}Wt=Wt===""?"Times":Wt,this.pdf.setFont(Wt,$t)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(de){this.ctx.globalCompositeOperation=de}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(de){this.ctx.globalAlpha=de}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(de){this.ctx.lineDashOffset=de,U.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(de){this.ctx.lineDash=de,U.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(de){this.ctx.ignoreClearRect=!!de}})};v.prototype.setLineDash=function(j){this.lineDash=j},v.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},v.prototype.fill=function(){T.call(this,"fill",!1)},v.prototype.stroke=function(){T.call(this,"stroke",!1)},v.prototype.beginPath=function(){this.path=[{type:"begin"}]},v.prototype.moveTo=function(j,F){if(isNaN(j)||isNaN(F))throw Oa.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var I=this.ctx.transform.applyToPoint(new l(j,F));this.path.push({type:"mt",x:I.x,y:I.y}),this.ctx.lastPoint=new l(j,F)},v.prototype.closePath=function(){var j=new l(0,0),F=0;for(F=this.path.length-1;F!==-1;F--)if(this.path[F].type==="begin"&&va(this.path[F+1])==="object"&&typeof this.path[F+1].x=="number"){j=new l(this.path[F+1].x,this.path[F+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l(j.x,j.y)},v.prototype.lineTo=function(j,F){if(isNaN(j)||isNaN(F))throw Oa.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var I=this.ctx.transform.applyToPoint(new l(j,F));this.path.push({type:"lt",x:I.x,y:I.y}),this.ctx.lastPoint=new l(I.x,I.y)},v.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),T.call(this,null,!0)},v.prototype.quadraticCurveTo=function(j,F,I,z){if(isNaN(I)||isNaN(z)||isNaN(j)||isNaN(F))throw Oa.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ne=this.ctx.transform.applyToPoint(new l(I,z)),se=this.ctx.transform.applyToPoint(new l(j,F));this.path.push({type:"qct",x1:se.x,y1:se.y,x:ne.x,y:ne.y}),this.ctx.lastPoint=new l(ne.x,ne.y)},v.prototype.bezierCurveTo=function(j,F,I,z,ne,se){if(isNaN(ne)||isNaN(se)||isNaN(j)||isNaN(F)||isNaN(I)||isNaN(z))throw Oa.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var pe=this.ctx.transform.applyToPoint(new l(ne,se)),ye=this.ctx.transform.applyToPoint(new l(j,F)),_e=this.ctx.transform.applyToPoint(new l(I,z));this.path.push({type:"bct",x1:ye.x,y1:ye.y,x2:_e.x,y2:_e.y,x:pe.x,y:pe.y}),this.ctx.lastPoint=new l(pe.x,pe.y)},v.prototype.arc=function(j,F,I,z,ne,se){if(isNaN(j)||isNaN(F)||isNaN(I)||isNaN(z)||isNaN(ne))throw Oa.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(se=!!se,!this.ctx.transform.isIdentity){var pe=this.ctx.transform.applyToPoint(new l(j,F));j=pe.x,F=pe.y;var ye=this.ctx.transform.applyToPoint(new l(0,I)),_e=this.ctx.transform.applyToPoint(new l(0,0));I=Math.sqrt(Math.pow(ye.x-_e.x,2)+Math.pow(ye.y-_e.y,2))}Math.abs(ne-z)>=2*Math.PI&&(z=0,ne=2*Math.PI),this.path.push({type:"arc",x:j,y:F,radius:I,startAngle:z,endAngle:ne,counterclockwise:se})},v.prototype.arcTo=function(j,F,I,z,ne){throw new Error("arcTo not implemented.")},v.prototype.rect=function(j,F,I,z){if(isNaN(j)||isNaN(F)||isNaN(I)||isNaN(z))throw Oa.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(j,F),this.lineTo(j+I,F),this.lineTo(j+I,F+z),this.lineTo(j,F+z),this.lineTo(j,F),this.lineTo(j+I,F),this.lineTo(j,F)},v.prototype.fillRect=function(j,F,I,z){if(isNaN(j)||isNaN(F)||isNaN(I)||isNaN(z))throw Oa.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!g.call(this)){var ne={};this.lineCap!=="butt"&&(ne.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ne.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(j,F,I,z),this.fill(),ne.hasOwnProperty("lineCap")&&(this.lineCap=ne.lineCap),ne.hasOwnProperty("lineJoin")&&(this.lineJoin=ne.lineJoin)}},v.prototype.strokeRect=function(j,F,I,z){if(isNaN(j)||isNaN(F)||isNaN(I)||isNaN(z))throw Oa.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");b.call(this)||(this.beginPath(),this.rect(j,F,I,z),this.stroke())},v.prototype.clearRect=function(j,F,I,z){if(isNaN(j)||isNaN(F)||isNaN(I)||isNaN(z))throw Oa.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(j,F,I,z))},v.prototype.save=function(j){j=typeof j!="boolean"||j;for(var F=this.pdf.internal.getCurrentPageInfo().pageNumber,I=0;I<this.pdf.internal.getNumberOfPages();I++)this.pdf.setPage(I+1),this.pdf.internal.out("q");if(this.pdf.setPage(F),j){this.ctx.fontSize=this.pdf.internal.getFontSize();var z=new m(this.ctx);this.ctxStack.push(this.ctx),this.ctx=z}},v.prototype.restore=function(j){j=typeof j!="boolean"||j;for(var F=this.pdf.internal.getCurrentPageInfo().pageNumber,I=0;I<this.pdf.internal.getNumberOfPages();I++)this.pdf.setPage(I+1),this.pdf.internal.out("Q");this.pdf.setPage(F),j&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},v.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var x=function(j){var F,I,z,ne;if(j.isCanvasGradient===!0&&(j=j.getColor()),!j)return{r:0,g:0,b:0,a:0,style:j};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(j))F=0,I=0,z=0,ne=0;else{var se=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(j);if(se!==null)F=parseInt(se[1]),I=parseInt(se[2]),z=parseInt(se[3]),ne=1;else if((se=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(j))!==null)F=parseInt(se[1]),I=parseInt(se[2]),z=parseInt(se[3]),ne=parseFloat(se[4]);else{if(ne=1,typeof j=="string"&&j.charAt(0)!=="#"){var pe=new Jj(j);j=pe.ok?pe.toHex():"#000000"}j.length===4?(F=j.substring(1,2),F+=F,I=j.substring(2,3),I+=I,z=j.substring(3,4),z+=z):(F=j.substring(1,3),I=j.substring(3,5),z=j.substring(5,7)),F=parseInt(F,16),I=parseInt(I,16),z=parseInt(z,16)}}return{r:F,g:I,b:z,a:ne,style:j}},g=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},b=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};v.prototype.fillText=function(j,F,I,z){if(isNaN(F)||isNaN(I)||typeof j!="string")throw Oa.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(z=isNaN(z)?void 0:z,!g.call(this)){var ne=K(this.ctx.transform.rotation),se=this.ctx.transform.scaleX;O.call(this,{text:j,x:F,y:I,scale:se,angle:ne,align:this.textAlign,maxWidth:z})}},v.prototype.strokeText=function(j,F,I,z){if(isNaN(F)||isNaN(I)||typeof j!="string")throw Oa.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!b.call(this)){z=isNaN(z)?void 0:z;var ne=K(this.ctx.transform.rotation),se=this.ctx.transform.scaleX;O.call(this,{text:j,x:F,y:I,scale:se,renderingMode:"stroke",angle:ne,align:this.textAlign,maxWidth:z})}},v.prototype.measureText=function(j){if(typeof j!="string")throw Oa.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var F=this.pdf,I=this.pdf.internal.scaleFactor,z=F.internal.getFontSize(),ne=F.getStringUnitWidth(j)*z/F.internal.scaleFactor;return new function(se){var pe=(se=se||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return pe}}),this}({width:ne*=Math.round(96*I/72*1e4)/1e4})},v.prototype.scale=function(j,F){if(isNaN(j)||isNaN(F))throw Oa.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var I=new f(j,0,0,F,0,0);this.ctx.transform=this.ctx.transform.multiply(I)},v.prototype.rotate=function(j){if(isNaN(j))throw Oa.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var F=new f(Math.cos(j),Math.sin(j),-Math.sin(j),Math.cos(j),0,0);this.ctx.transform=this.ctx.transform.multiply(F)},v.prototype.translate=function(j,F){if(isNaN(j)||isNaN(F))throw Oa.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var I=new f(1,0,0,1,j,F);this.ctx.transform=this.ctx.transform.multiply(I)},v.prototype.transform=function(j,F,I,z,ne,se){if(isNaN(j)||isNaN(F)||isNaN(I)||isNaN(z)||isNaN(ne)||isNaN(se))throw Oa.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var pe=new f(j,F,I,z,ne,se);this.ctx.transform=this.ctx.transform.multiply(pe)},v.prototype.setTransform=function(j,F,I,z,ne,se){j=isNaN(j)?1:j,F=isNaN(F)?0:F,I=isNaN(I)?0:I,z=isNaN(z)?1:z,ne=isNaN(ne)?0:ne,se=isNaN(se)?0:se,this.ctx.transform=new f(j,F,I,z,ne,se)};var _=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};v.prototype.drawImage=function(j,F,I,z,ne,se,pe,ye,_e){var Le=this.pdf.getImageProperties(j),ue=1,at=1,ht=1,de=1;z!==void 0&&ye!==void 0&&(ht=ye/z,de=_e/ne,ue=Le.width/z*ye/z,at=Le.height/ne*_e/ne),se===void 0&&(se=F,pe=I,F=0,I=0),z!==void 0&&ye===void 0&&(ye=z,_e=ne),z===void 0&&ye===void 0&&(ye=Le.width,_e=Le.height);var it=this.ctx.transform.decompose(),Se=K(it.rotate.shx),ve=new f,Ie=(ve=(ve=(ve=ve.multiply(it.translate)).multiply(it.skew)).multiply(it.scale)).applyToRectangle(new c(se-F*ht,pe-I*de,z*ue,ne*at));if(this.autoPaging){for(var wt,Xe=w.call(this,Ie),ct=[],jt=0;jt<Xe.length;jt+=1)ct.indexOf(Xe[jt])===-1&&ct.push(Xe[jt]);A(ct);for(var Lt=ct[0],Vt=ct[ct.length-1],$t=Lt;$t<Vt+1;$t++){this.pdf.setPage($t);var Wt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ot=$t===1?this.posY+this.margin[0]:this.margin[0],kt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],qe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ye=$t===1?0:kt+($t-2)*qe;if(this.ctx.clip_path.length!==0){var Pt=this.path;wt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=C(wt,this.posX+this.margin[3],-Ye+Ot+this.ctx.prevPageLastElemOffset),G.call(this,"fill",!0),this.path=Pt}var Et=JSON.parse(JSON.stringify(Ie));Et=C([Et],this.posX+this.margin[3],-Ye+Ot+this.ctx.prevPageLastElemOffset)[0];var Dt=($t>Lt||$t<Vt)&&_.call(this);Dt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Wt,qe,null).clip().discardPath()),this.pdf.addImage(j,"JPEG",Et.x,Et.y,Et.w,Et.h,null,null,Se),Dt&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(j,"JPEG",Ie.x,Ie.y,Ie.w,Ie.h,null,null,Se)};var w=function(j,F,I){var z=[];F=F||this.pdf.internal.pageSize.width,I=I||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ne=this.posY+this.ctx.prevPageLastElemOffset;switch(j.type){default:case"mt":case"lt":z.push(Math.floor((j.y+ne)/I)+1);break;case"arc":z.push(Math.floor((j.y+ne-j.radius)/I)+1),z.push(Math.floor((j.y+ne+j.radius)/I)+1);break;case"qct":var se=ae(this.ctx.lastPoint.x,this.ctx.lastPoint.y,j.x1,j.y1,j.x,j.y);z.push(Math.floor((se.y+ne)/I)+1),z.push(Math.floor((se.y+se.h+ne)/I)+1);break;case"bct":var pe=fe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,j.x1,j.y1,j.x2,j.y2,j.x,j.y);z.push(Math.floor((pe.y+ne)/I)+1),z.push(Math.floor((pe.y+pe.h+ne)/I)+1);break;case"rect":z.push(Math.floor((j.y+ne)/I)+1),z.push(Math.floor((j.y+j.h+ne)/I)+1)}for(var ye=0;ye<z.length;ye+=1)for(;this.pdf.internal.getNumberOfPages()<z[ye];)E.call(this);return z},E=function(){var j=this.fillStyle,F=this.strokeStyle,I=this.font,z=this.lineCap,ne=this.lineWidth,se=this.lineJoin;this.pdf.addPage(),this.fillStyle=j,this.strokeStyle=F,this.font=I,this.lineCap=z,this.lineWidth=ne,this.lineJoin=se},C=function(j,F,I){for(var z=0;z<j.length;z++)switch(j[z].type){case"bct":j[z].x2+=F,j[z].y2+=I;case"qct":j[z].x1+=F,j[z].y1+=I;default:j[z].x+=F,j[z].y+=I}return j},A=function(j){return j.sort(function(F,I){return F-I})},T=function(j,F){var I=this.fillStyle,z=this.strokeStyle,ne=this.lineCap,se=this.lineWidth,pe=Math.abs(se*this.ctx.transform.scaleX),ye=this.lineJoin;if(this.autoPaging){for(var _e,Le,ue=JSON.parse(JSON.stringify(this.path)),at=JSON.parse(JSON.stringify(this.path)),ht=[],de=0;de<at.length;de++)if(at[de].x!==void 0)for(var it=w.call(this,at[de]),Se=0;Se<it.length;Se+=1)ht.indexOf(it[Se])===-1&&ht.push(it[Se]);for(var ve=0;ve<ht.length;ve++)for(;this.pdf.internal.getNumberOfPages()<ht[ve];)E.call(this);A(ht);for(var Ie=ht[0],wt=ht[ht.length-1],Xe=Ie;Xe<wt+1;Xe++){this.pdf.setPage(Xe),this.fillStyle=I,this.strokeStyle=z,this.lineCap=ne,this.lineWidth=pe,this.lineJoin=ye;var ct=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],jt=Xe===1?this.posY+this.margin[0]:this.margin[0],Lt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Vt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],$t=Xe===1?0:Lt+(Xe-2)*Vt;if(this.ctx.clip_path.length!==0){var Wt=this.path;_e=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=C(_e,this.posX+this.margin[3],-$t+jt+this.ctx.prevPageLastElemOffset),G.call(this,j,!0),this.path=Wt}if(Le=JSON.parse(JSON.stringify(ue)),this.path=C(Le,this.posX+this.margin[3],-$t+jt+this.ctx.prevPageLastElemOffset),F===!1||Xe===0){var Ot=(Xe>Ie||Xe<wt)&&_.call(this);Ot&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ct,Vt,null).clip().discardPath()),G.call(this,j,F),Ot&&this.pdf.restoreGraphicsState()}this.lineWidth=se}this.path=ue}else this.lineWidth=pe,G.call(this,j,F),this.lineWidth=se},G=function(j,F){if((j!=="stroke"||F||!b.call(this))&&(j==="stroke"||F||!g.call(this))){for(var I,z,ne=[],se=this.path,pe=0;pe<se.length;pe++){var ye=se[pe];switch(ye.type){case"begin":ne.push({begin:!0});break;case"close":ne.push({close:!0});break;case"mt":ne.push({start:ye,deltas:[],abs:[]});break;case"lt":var _e=ne.length;if(se[pe-1]&&!isNaN(se[pe-1].x)&&(I=[ye.x-se[pe-1].x,ye.y-se[pe-1].y],_e>0)){for(;_e>=0;_e--)if(ne[_e-1].close!==!0&&ne[_e-1].begin!==!0){ne[_e-1].deltas.push(I),ne[_e-1].abs.push(ye);break}}break;case"bct":I=[ye.x1-se[pe-1].x,ye.y1-se[pe-1].y,ye.x2-se[pe-1].x,ye.y2-se[pe-1].y,ye.x-se[pe-1].x,ye.y-se[pe-1].y],ne[ne.length-1].deltas.push(I);break;case"qct":var Le=se[pe-1].x+2/3*(ye.x1-se[pe-1].x),ue=se[pe-1].y+2/3*(ye.y1-se[pe-1].y),at=ye.x+2/3*(ye.x1-ye.x),ht=ye.y+2/3*(ye.y1-ye.y),de=ye.x,it=ye.y;I=[Le-se[pe-1].x,ue-se[pe-1].y,at-se[pe-1].x,ht-se[pe-1].y,de-se[pe-1].x,it-se[pe-1].y],ne[ne.length-1].deltas.push(I);break;case"arc":ne.push({deltas:[],abs:[],arc:!0}),Array.isArray(ne[ne.length-1].abs)&&ne[ne.length-1].abs.push(ye)}}z=F?null:j==="stroke"?"stroke":"fill";for(var Se=!1,ve=0;ve<ne.length;ve++)if(ne[ve].arc)for(var Ie=ne[ve].abs,wt=0;wt<Ie.length;wt++){var Xe=Ie[wt];Xe.type==="arc"?q.call(this,Xe.x,Xe.y,Xe.radius,Xe.startAngle,Xe.endAngle,Xe.counterclockwise,void 0,F,!Se):M.call(this,Xe.x,Xe.y),Se=!0}else if(ne[ve].close===!0)this.pdf.internal.out("h"),Se=!1;else if(ne[ve].begin!==!0){var ct=ne[ve].start.x,jt=ne[ve].start.y;V.call(this,ne[ve].deltas,ct,jt),Se=!0}z&&L.call(this,z),F&&J.call(this)}},W=function(j){var F=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,I=F*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return j-I;case"top":return j+F-I;case"hanging":return j+F-2*I;case"middle":return j+F/2-I;default:return j}},B=function(j){return j+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};v.prototype.createLinearGradient=function(){var j=function(){};return j.colorStops=[],j.addColorStop=function(F,I){this.colorStops.push([F,I])},j.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},j.isCanvasGradient=!0,j},v.prototype.createPattern=function(){return this.createLinearGradient()},v.prototype.createRadialGradient=function(){return this.createLinearGradient()};var q=function(j,F,I,z,ne,se,pe,ye,_e){for(var Le=X.call(this,I,z,ne,se),ue=0;ue<Le.length;ue++){var at=Le[ue];ue===0&&(_e?D.call(this,at.x1+j,at.y1+F):M.call(this,at.x1+j,at.y1+F)),ie.call(this,j,F,at.x2,at.y2,at.x3,at.y3,at.x4,at.y4)}ye?J.call(this):L.call(this,pe)},L=function(j){switch(j){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},J=function(){this.pdf.clip(),this.pdf.discardPath()},D=function(j,F){this.pdf.internal.out(r(j)+" "+a(F)+" m")},O=function(j){var F;switch(j.align){case"right":case"end":F="right";break;case"center":F="center";break;default:F="left"}var I,z,ne,se=this.pdf.getTextDimensions(j.text),pe=W.call(this,j.y),ye=B.call(this,pe)-se.h,_e=this.ctx.transform.applyToPoint(new l(j.x,pe));if(this.autoPaging){var Le=this.ctx.transform.decompose(),ue=new f;ue=(ue=(ue=ue.multiply(Le.translate)).multiply(Le.skew)).multiply(Le.scale);for(var at=this.ctx.transform.applyToRectangle(new c(j.x,pe,se.w,se.h)),ht=ue.applyToRectangle(new c(j.x,ye,se.w,se.h)),de=w.call(this,ht),it=[],Se=0;Se<de.length;Se+=1)it.indexOf(de[Se])===-1&&it.push(de[Se]);A(it);for(var ve=it[0],Ie=it[it.length-1],wt=ve;wt<Ie+1;wt++){this.pdf.setPage(wt);var Xe=wt===1?this.posY+this.margin[0]:this.margin[0],ct=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],jt=this.pdf.internal.pageSize.height-this.margin[2],Lt=jt-this.margin[0],Vt=this.pdf.internal.pageSize.width-this.margin[1],$t=Vt-this.margin[3],Wt=wt===1?0:ct+(wt-2)*Lt;if(this.ctx.clip_path.length!==0){var Ot=this.path;I=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=C(I,this.posX+this.margin[3],-1*Wt+Xe),G.call(this,"fill",!0),this.path=Ot}var kt=C([JSON.parse(JSON.stringify(ht))],this.posX+this.margin[3],-Wt+Xe+this.ctx.prevPageLastElemOffset)[0];j.scale>=.01&&(z=this.pdf.internal.getFontSize(),this.pdf.setFontSize(z*j.scale),ne=this.lineWidth,this.lineWidth=ne*j.scale);var qe=this.autoPaging!=="text";if(qe||kt.y+kt.h<=jt){if(qe||kt.y>=Xe&&kt.x<=Vt){var Ye=qe?j.text:this.pdf.splitTextToSize(j.text,j.maxWidth||Vt-kt.x)[0],Pt=C([JSON.parse(JSON.stringify(at))],this.posX+this.margin[3],-Wt+Xe+this.ctx.prevPageLastElemOffset)[0],Et=qe&&(wt>ve||wt<Ie)&&_.call(this);Et&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],$t,Lt,null).clip().discardPath()),this.pdf.text(Ye,Pt.x,Pt.y,{angle:j.angle,align:F,renderingMode:j.renderingMode}),Et&&this.pdf.restoreGraphicsState()}}else kt.y<jt&&(this.ctx.prevPageLastElemOffset+=jt-kt.y);j.scale>=.01&&(this.pdf.setFontSize(z),this.lineWidth=ne)}}else j.scale>=.01&&(z=this.pdf.internal.getFontSize(),this.pdf.setFontSize(z*j.scale),ne=this.lineWidth,this.lineWidth=ne*j.scale),this.pdf.text(j.text,_e.x+this.posX,_e.y+this.posY,{angle:j.angle,align:F,renderingMode:j.renderingMode,maxWidth:j.maxWidth}),j.scale>=.01&&(this.pdf.setFontSize(z),this.lineWidth=ne)},M=function(j,F,I,z){I=I||0,z=z||0,this.pdf.internal.out(r(j+I)+" "+a(F+z)+" l")},V=function(j,F,I){return this.pdf.lines(j,F,I,null,null)},ie=function(j,F,I,z,ne,se,pe,ye){this.pdf.internal.out([e(n(I+j)),e(s(z+F)),e(n(ne+j)),e(s(se+F)),e(n(pe+j)),e(s(ye+F)),"c"].join(" "))},X=function(j,F,I,z){for(var ne=2*Math.PI,se=Math.PI/2;F>I;)F-=ne;var pe=Math.abs(I-F);pe<ne&&z&&(pe=ne-pe);for(var ye=[],_e=z?-1:1,Le=F;pe>1e-5;){var ue=Le+_e*Math.min(pe,se);ye.push(Z.call(this,j,Le,ue)),pe-=Math.abs(ue-Le),Le=ue}return ye},Z=function(j,F,I){var z=(I-F)/2,ne=j*Math.cos(z),se=j*Math.sin(z),pe=ne,ye=-se,_e=pe*pe+ye*ye,Le=_e+pe*ne+ye*se,ue=4/3*(Math.sqrt(2*_e*Le)-Le)/(pe*se-ye*ne),at=pe-ue*ye,ht=ye+ue*pe,de=at,it=-ht,Se=z+F,ve=Math.cos(Se),Ie=Math.sin(Se);return{x1:j*Math.cos(F),y1:j*Math.sin(F),x2:at*ve-ht*Ie,y2:at*Ie+ht*ve,x3:de*ve-it*Ie,y3:de*Ie+it*ve,x4:j*Math.cos(I),y4:j*Math.sin(I)}},K=function(j){return 180*j/Math.PI},ae=function(j,F,I,z,ne,se){var pe=j+.5*(I-j),ye=F+.5*(z-F),_e=ne+.5*(I-ne),Le=se+.5*(z-se),ue=Math.min(j,ne,pe,_e),at=Math.max(j,ne,pe,_e),ht=Math.min(F,se,ye,Le),de=Math.max(F,se,ye,Le);return new c(ue,ht,at-ue,de-ht)},fe=function(j,F,I,z,ne,se,pe,ye){var _e,Le,ue,at,ht,de,it,Se,ve,Ie,wt,Xe,ct,jt,Lt=I-j,Vt=z-F,$t=ne-I,Wt=se-z,Ot=pe-ne,kt=ye-se;for(Le=0;Le<41;Le++)ve=(it=(ue=j+(_e=Le/40)*Lt)+_e*((ht=I+_e*$t)-ue))+_e*(ht+_e*(ne+_e*Ot-ht)-it),Ie=(Se=(at=F+_e*Vt)+_e*((de=z+_e*Wt)-at))+_e*(de+_e*(se+_e*kt-de)-Se),Le==0?(wt=ve,Xe=Ie,ct=ve,jt=Ie):(wt=Math.min(wt,ve),Xe=Math.min(Xe,Ie),ct=Math.max(ct,ve),jt=Math.max(jt,Ie));return new c(Math.round(wt),Math.round(Xe),Math.round(ct-wt),Math.round(jt-Xe))},U=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var j,F,I=(j=this.ctx.lineDash,F=this.ctx.lineDashOffset,JSON.stringify({lineDash:j,lineDashOffset:F}));this.prevLineDash!==I&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=I)}}})(lr.API),(function(t){var e=function(l){var c,f,d,m,v,x,g,b,_,w;for(f=[],d=0,m=(l+=c="\0\0\0\0".slice(l.length%4||4)).length;m>d;d+=4)(v=(l.charCodeAt(d)<<24)+(l.charCodeAt(d+1)<<16)+(l.charCodeAt(d+2)<<8)+l.charCodeAt(d+3))!==0?(x=(v=((v=((v=((v=(v-(w=v%85))/85)-(_=v%85))/85)-(b=v%85))/85)-(g=v%85))/85)%85,f.push(x+33,g+33,b+33,_+33,w+33)):f.push(122);return(function(E,C){for(var A=C;A>0;A--)E.pop()})(f,c.length),String.fromCharCode.apply(String,f)+"~>"},r=function(l){var c,f,d,m,v,x=String,g="length",b=255,_="charCodeAt",w="slice",E="replace";for(l[w](-2),l=l[w](0,-2)[E](/\s/g,"")[E]("z","!!!!!"),d=[],m=0,v=(l+=c="uuuuu"[w](l[g]%5||5))[g];v>m;m+=5)f=52200625*(l[_](m)-33)+614125*(l[_](m+1)-33)+7225*(l[_](m+2)-33)+85*(l[_](m+3)-33)+(l[_](m+4)-33),d.push(b&f>>24,b&f>>16,b&f>>8,b&f);return(function(C,A){for(var T=A;T>0;T--)C.pop()})(d,c[g]),x.fromCharCode.apply(x,d)},a=function(l){return l.split("").map(function(c){return("0"+c.charCodeAt().toString(16)).slice(-2)}).join("")+">"},n=function(l){var c=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((l=l.replace(/\s/g,"")).indexOf(">")!==-1&&(l=l.substr(0,l.indexOf(">"))),l.length%2&&(l+="0"),c.test(l)===!1)return"";for(var f="",d=0;d<l.length;d+=2)f+=String.fromCharCode("0x"+(l[d]+l[d+1]));return f},s=function(l){for(var c=new Uint8Array(l.length),f=l.length;f--;)c[f]=l.charCodeAt(f);return(c=Px(c)).reduce(function(d,m){return d+String.fromCharCode(m)},"")};t.processDataByFilters=function(l,c){var f=0,d=l||"",m=[];for(typeof(c=c||[])=="string"&&(c=[c]),f=0;f<c.length;f+=1)switch(c[f]){case"ASCII85Decode":case"/ASCII85Decode":d=r(d),m.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":d=e(d),m.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":d=n(d),m.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":d=a(d),m.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":d=s(d),m.push("/FlateDecode");break;default:throw new Error('The filter: "'+c[f]+'" is not implemented')}return{data:d,reverseChain:m.reverse().join(" ")}}})(lr.API),(function(t){t.loadFile=function(e,r,a){return(function(n,s,l){s=s!==!1,l=typeof l=="function"?l:function(){};var c=void 0;try{c=(function(f,d,m){var v=new XMLHttpRequest,x=0,g=function(b){var _=b.length,w=[],E=String.fromCharCode;for(x=0;x<_;x+=1)w.push(E(255&b.charCodeAt(x)));return w.join("")};if(v.open("GET",f,!d),v.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(v.onload=function(){v.status===200?m(g(this.responseText)):m(void 0)}),v.send(null),d&&v.status===200)return g(v.responseText)})(n,s,l)}catch{}return c})(e,r,a)},t.loadImageFile=t.loadFile})(lr.API),(function(t){function e(){return(jr.html2canvas?Promise.resolve(jr.html2canvas):wv(()=>import("./html2canvas.esm-Ge7aVWlp.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load html2canvas: "+c))}).then(function(c){return c.default?c.default:c})}function r(){return(jr.DOMPurify?Promise.resolve(jr.DOMPurify):wv(()=>import("./purify.es-Bzr520pe.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load dompurify: "+c))}).then(function(c){return c.default?c.default:c})}var a=function(c){var f=va(c);return f==="undefined"?"undefined":f==="string"||c instanceof String?"string":f==="number"||c instanceof Number?"number":f==="function"||c instanceof Function?"function":c&&c.constructor===Array?"array":c&&c.nodeType===1?"element":f==="object"?"object":"unknown"},n=function(c,f){var d=document.createElement(c);for(var m in f.className&&(d.className=f.className),f.innerHTML&&f.dompurify&&(d.innerHTML=f.dompurify.sanitize(f.innerHTML)),f.style)d.style[m]=f.style[m];return d},s=function c(f,d){for(var m=f.nodeType===3?document.createTextNode(f.nodeValue):f.cloneNode(!1),v=f.firstChild;v;v=v.nextSibling)d!==!0&&v.nodeType===1&&v.nodeName==="SCRIPT"||m.appendChild(c(v,d));return f.nodeType===1&&(f.nodeName==="CANVAS"?(m.width=f.width,m.height=f.height,m.getContext("2d").drawImage(f,0,0)):f.nodeName!=="TEXTAREA"&&f.nodeName!=="SELECT"||(m.value=f.value),m.addEventListener("load",function(){m.scrollTop=f.scrollTop,m.scrollLeft=f.scrollLeft},!0)),m},l=function c(f){var d=Object.assign(c.convert(Promise.resolve()),JSON.parse(JSON.stringify(c.template))),m=c.convert(Promise.resolve(),d);return(m=m.setProgress(1,c,1,[c])).set(f)};(l.prototype=Object.create(Promise.prototype)).constructor=l,l.convert=function(c,f){return c.__proto__=f||l.prototype,c},l.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},l.prototype.from=function(c,f){return this.then(function(){switch(f=f||(function(d){switch(a(d)){case"string":return"string";case"element":return d.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(c),f){case"string":return this.then(r).then(function(d){return this.set({src:n("div",{innerHTML:c,dompurify:d})})});case"element":return this.set({src:c});case"canvas":return this.set({canvas:c});case"img":return this.set({img:c});default:return this.error("Unknown source type.")}})},l.prototype.to=function(c){switch(c){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},l.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var c={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},f=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);f.tagName==="BODY"&&(c.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:c}),this.prop.container.appendChild(f),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},l.prototype.toCanvas=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(e).then(function(f){var d=Object.assign({},this.opt.html2canvas);return delete d.onrendered,f(this.prop.container,d)}).then(function(f){(this.opt.html2canvas.onrendered||function(){})(f),this.prop.canvas=f,document.body.removeChild(this.prop.overlay)})},l.prototype.toContext2d=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(e).then(function(f){var d=this.opt.jsPDF,m=this.opt.fontFaces,v=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,x=Object.assign({async:!0,allowTaint:!0,scale:v,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete x.onrendered,d.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,d.context2d.posX=this.opt.x,d.context2d.posY=this.opt.y,d.context2d.margin=this.opt.margin,d.context2d.fontFaces=m,m)for(var g=0;g<m.length;++g){var b=m[g],_=b.src.find(function(w){return w.format==="truetype"});_&&d.addFont(_.url,b.ref.name,b.ref.style)}return x.windowHeight=x.windowHeight||0,x.windowHeight=x.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):x.windowHeight,d.context2d.save(!0),f(this.prop.container,x)}).then(function(f){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(f),this.prop.canvas=f,document.body.removeChild(this.prop.overlay)})},l.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var c=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=c})},l.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},l.prototype.output=function(c,f,d){return(d=d||"pdf").toLowerCase()==="img"||d.toLowerCase()==="image"?this.outputImg(c,f):this.outputPdf(c,f)},l.prototype.outputPdf=function(c,f){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(c,f)})},l.prototype.outputImg=function(c){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(c){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+c+'" is not supported.'}})},l.prototype.save=function(c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(c?{filename:c}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},l.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},l.prototype.set=function(c){if(a(c)!=="object")return this;var f=Object.keys(c||{}).map(function(d){if(d in l.template.prop)return function(){this.prop[d]=c[d]};switch(d){case"margin":return this.setMargin.bind(this,c.margin);case"jsPDF":return function(){return this.opt.jsPDF=c.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,c.pageSize);default:return function(){this.opt[d]=c[d]}}},this);return this.then(function(){return this.thenList(f)})},l.prototype.get=function(c,f){return this.then(function(){var d=c in l.template.prop?this.prop[c]:this.opt[c];return f?f(d):d})},l.prototype.setMargin=function(c){return this.then(function(){switch(a(c)){case"number":c=[c,c,c,c];case"array":if(c.length===2&&(c=[c[0],c[1],c[0],c[1]]),c.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=c}).then(this.setPageSize)},l.prototype.setPageSize=function(c){function f(d,m){return Math.floor(d*m/72*96)}return this.then(function(){(c=c||lr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(c.inner={width:c.width-this.opt.margin[1]-this.opt.margin[3],height:c.height-this.opt.margin[0]-this.opt.margin[2]},c.inner.px={width:f(c.inner.width,c.k),height:f(c.inner.height,c.k)},c.inner.ratio=c.inner.height/c.inner.width),this.prop.pageSize=c})},l.prototype.setProgress=function(c,f,d,m){return c!=null&&(this.progress.val=c),f!=null&&(this.progress.state=f),d!=null&&(this.progress.n=d),m!=null&&(this.progress.stack=m),this.progress.ratio=this.progress.val/this.progress.state,this},l.prototype.updateProgress=function(c,f,d,m){return this.setProgress(c?this.progress.val+c:null,f||null,d?this.progress.n+d:null,m?this.progress.stack.concat(m):null)},l.prototype.then=function(c,f){var d=this;return this.thenCore(c,f,function(m,v){return d.updateProgress(null,null,1,[m]),Promise.prototype.then.call(this,function(x){return d.updateProgress(null,m),x}).then(m,v).then(function(x){return d.updateProgress(1),x})})},l.prototype.thenCore=function(c,f,d){d=d||Promise.prototype.then;var m=this;c&&(c=c.bind(m)),f&&(f=f.bind(m));var v=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?m:l.convert(Object.assign({},m),Promise.prototype),x=d.call(v,c,f);return l.convert(x,m.__proto__)},l.prototype.thenExternal=function(c,f){return Promise.prototype.then.call(this,c,f)},l.prototype.thenList=function(c){var f=this;return c.forEach(function(d){f=f.thenCore(d)}),f},l.prototype.catch=function(c){c&&(c=c.bind(this));var f=Promise.prototype.catch.call(this,c);return l.convert(f,this)},l.prototype.catchExternal=function(c){return Promise.prototype.catch.call(this,c)},l.prototype.error=function(c){return this.then(function(){throw new Error(c)})},l.prototype.using=l.prototype.set,l.prototype.saveAs=l.prototype.save,l.prototype.export=l.prototype.output,l.prototype.run=l.prototype.then,lr.getPageSize=function(c,f,d){if(va(c)==="object"){var m=c;c=m.orientation,f=m.unit||f,d=m.format||d}f=f||"mm",d=d||"a4",c=(""+(c||"P")).toLowerCase();var v,x=(""+d).toLowerCase(),g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(f){case"pt":v=1;break;case"mm":v=72/25.4;break;case"cm":v=72/2.54;break;case"in":v=72;break;case"px":v=.75;break;case"pc":case"em":v=12;break;case"ex":v=6;break;default:throw"Invalid unit: "+f}var b,_=0,w=0;if(g.hasOwnProperty(x))_=g[x][1]/v,w=g[x][0]/v;else try{_=d[1],w=d[0]}catch{throw new Error("Invalid format: "+d)}if(c==="p"||c==="portrait")c="p",w>_&&(b=w,w=_,_=b);else{if(c!=="l"&&c!=="landscape")throw"Invalid orientation: "+c;c="l",_>w&&(b=w,w=_,_=b)}return{width:w,height:_,unit:f,k:v,orientation:c}},t.html=function(c,f){(f=f||{}).callback=f.callback||function(){},f.html2canvas=f.html2canvas||{},f.html2canvas.canvas=f.html2canvas.canvas||this.canvas,f.jsPDF=f.jsPDF||this,f.fontFaces=f.fontFaces?f.fontFaces.map(Uv):null;var d=new l(f);return f.worker?d:d.from(c).doCallback()}})(lr.API),lr.API.addJS=function(t){return SS=t,this.internal.events.subscribe("postPutResources",function(){Op=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Op+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),wS=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+SS+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Op!==void 0&&wS!==void 0&&this.internal.out("/Names <</JavaScript "+Op+" 0 R>>")}),this},(function(t){var e;t.events.push(["postPutResources",function(){var r=this,a=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=r.outline.render().split(/\r\n/),s=0;s<n.length;s++){var l=n[s],c=a.exec(l);if(c!=null){var f=c[1];r.internal.newObjectDeferredBegin(f,!1)}r.internal.write(l)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,m=[];for(s=0;s<d;s++){var v=r.internal.newObject();m.push(v);var x=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+x.objId+" 0 R /XYZ null null null]>> endobj")}var g=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<m.length;s++)r.internal.write("(page_"+(s+1)+")"+m[s]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+g+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(a,n,s){var l={title:n,options:s,children:[]};return a==null&&(a=this.root),a.children.push(l),l},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(a){a.id=r.internal.newObjectDeferred();for(var n=0;n<a.children.length;n++)this.genIds_r(a.children[n])},r.outline.renderRoot=function(a){this.objStart(a),this.line("/Type /Outlines"),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1]))),this.line("/Count "+this.count_r({count:0},a)),this.objEnd()},r.outline.renderItems=function(a){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<a.children.length;s++){var l=a.children[s];this.objStart(l),this.line("/Title "+this.makeString(l.title)),this.line("/Parent "+this.makeRef(a)),s>0&&this.line("/Prev "+this.makeRef(a.children[s-1])),s<a.children.length-1&&this.line("/Next "+this.makeRef(a.children[s+1])),l.children.length>0&&(this.line("/First "+this.makeRef(l.children[0])),this.line("/Last "+this.makeRef(l.children[l.children.length-1])));var c=this.count=this.count_r({count:0},l);if(c>0&&this.line("/Count "+c),l.options&&l.options.pageNumber){var f=r.internal.getPageInfo(l.options.pageNumber);this.line("/Dest ["+f.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var d=0;d<a.children.length;d++)this.renderItems(a.children[d])},r.outline.line=function(a){this.ctx.val+=a+`\r
`},r.outline.makeRef=function(a){return a.id+" 0 R"},r.outline.makeString=function(a){return"("+r.internal.pdfEscape(a)+")"},r.outline.objStart=function(a){this.ctx.val+=`\r
`+a.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(a,n){for(var s=0;s<n.children.length;s++)a.count++,this.count_r(a,n.children[s]);return a.count}}])})(lr.API),(function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,a,n,s,l,c){var f,d=this.decode.DCT_DECODE,m=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=l||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,f=(function(v){for(var x,g=256*v.charCodeAt(4)+v.charCodeAt(5),b=v.length,_={width:0,height:0,numcomponents:1},w=4;w<b;w+=2){if(w+=g,e.indexOf(v.charCodeAt(w+1))!==-1){x=256*v.charCodeAt(w+5)+v.charCodeAt(w+6),_={width:256*v.charCodeAt(w+7)+v.charCodeAt(w+8),height:x,numcomponents:v.charCodeAt(w+9)};break}g=256*v.charCodeAt(w+2)+v.charCodeAt(w+3)}return _})(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),f.numcomponents){case 1:c=this.color_spaces.DEVICE_GRAY;break;case 4:c=this.color_spaces.DEVICE_CMYK;break;case 3:c=this.color_spaces.DEVICE_RGB}m={data:r,width:f.width,height:f.height,colorSpace:c,bitsPerComponent:8,filter:d,index:a,alias:n}}return m}})(lr.API),lr.API.processPNG=function(t,e,r,a){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var n,s=_z(t,{checkCrc:!0}),l=s.width,c=s.height,f=s.channels,d=s.palette,m=s.depth;n=d&&f===1?(function(q){for(var L=q.width,J=q.height,D=q.data,O=q.palette,M=q.depth,V=!1,ie=[],X=[],Z=void 0,K=!1,ae=0,fe=0;fe<O.length;fe++){var U=E5(O[fe],4),j=U[0],F=U[1],I=U[2],z=U[3];ie.push(j,F,I),z!=null&&(z===0?(ae++,X.length<1&&X.push(fe)):z<255&&(K=!0))}if(K||ae>1){V=!0,X=void 0;var ne=L*J;Z=new Uint8Array(ne);for(var se=new DataView(D.buffer),pe=0;pe<ne;pe++){var ye=zv(se,pe,M),_e=E5(O[ye],4)[3];Z[pe]=_e}}else ae===0&&(X=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:V?8:void 0,colorBytes:D,alphaBytes:Z,needSMask:V,palette:ie,mask:X}})(s):f===2||f===4?(function(q){for(var L=q.data,J=q.width,D=q.height,O=q.channels,M=q.depth,V=O===2?"DeviceGray":"DeviceRGB",ie=O-1,X=J*D,Z=ie,K=X*Z,ae=1*X,fe=Math.ceil(K*M/8),U=Math.ceil(ae*M/8),j=new Uint8Array(fe),F=new Uint8Array(U),I=new DataView(L.buffer),z=new DataView(j.buffer),ne=new DataView(F.buffer),se=!1,pe=0;pe<X;pe++){for(var ye=pe*O,_e=0;_e<Z;_e++)RS(z,zv(I,ye+_e,M),pe*Z+_e,M);var Le=zv(I,ye+Z,M);Le<(1<<M)-1&&(se=!0),RS(ne,Le,1*pe,M)}return{colorSpace:V,colorsPerPixel:ie,sMaskBitsPerComponent:se?M:void 0,colorBytes:j,alphaBytes:F,needSMask:se}})(s):(function(q){var L=q.data,J=q.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:J,colorsPerPixel:J==="DeviceGray"?1:3,colorBytes:L instanceof Uint16Array?(function(D){for(var O=D.length,M=new Uint8Array(2*O),V=new DataView(M.buffer,M.byteOffset,M.byteLength),ie=0;ie<O;ie++)V.setUint16(2*ie,D[ie],!1);return M})(L):L,needSMask:!1}})(s);var v,x,g,b=n,_=b.colorSpace,w=b.colorsPerPixel,E=b.sMaskBitsPerComponent,C=b.colorBytes,A=b.alphaBytes,T=b.needSMask,G=b.palette,W=b.mask,B=null;return a!==lr.API.image_compression.NONE&&typeof Px=="function"?(B=(function(q){var L;switch(q){case lr.API.image_compression.FAST:L=11;break;case lr.API.image_compression.MEDIUM:L=13;break;case lr.API.image_compression.SLOW:L=14;break;default:L=12}return L})(a),v=this.decode.FLATE_DECODE,x="/Predictor ".concat(B," /Colors ").concat(w," /BitsPerComponent ").concat(m," /Columns ").concat(l),t=ES(C,Math.ceil(l*w*m/8),w,m,a),T&&(g=ES(A,Math.ceil(l*E/8),1,E,a))):(v=void 0,x=void 0,t=C,T&&(g=A)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(g&&this.__addimage__.isArrayBuffer(g)||this.__addimage__.isArrayBufferView(g))&&(g=this.__addimage__.arrayBufferToBinaryString(g)),{alias:r,data:t,index:e,filter:v,decodeParameters:x,transparency:W,palette:G,sMask:g,predictor:B,width:l,height:c,bitsPerComponent:m,sMaskBitsPerComponent:E,colorSpace:_}}},(function(t){t.processGIF89A=function(e,r,a,n){var s=new qz(e),l=s.width,c=s.height,f=[];s.decodeAndBlitFrameRGBA(0,f);var d={data:f,width:l,height:c},m=new Hv(100).encode(d,100);return t.processJPEG.call(this,m,r,a,n)},t.processGIF87A=t.processGIF89A})(lr.API),zo.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:n,green:a,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},zo.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){Oa.log("bit decode error:"+r)}},zo.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var a=this.bottom_up?t:this.height-1-t,n=0;n<e;n++)for(var s=this.datav.getUint8(this.pos++,!0),l=a*this.width*4+8*n*4,c=0;c<8&&8*n+c<this.width;c++){var f=this.palette[s>>7-c&1];this.data[l+4*c]=f.blue,this.data[l+4*c+1]=f.green,this.data[l+4*c+2]=f.red,this.data[l+4*c+3]=255}r!==0&&(this.pos+=4-r)}},zo.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<t;n++){var s=this.datav.getUint8(this.pos++,!0),l=a*this.width*4+2*n*4,c=s>>4,f=15&s,d=this.palette[c];if(this.data[l]=d.blue,this.data[l+1]=d.green,this.data[l+2]=d.red,this.data[l+3]=255,2*n+1>=this.width)break;d=this.palette[f],this.data[l+4]=d.blue,this.data[l+4+1]=d.green,this.data[l+4+2]=d.red,this.data[l+4+3]=255}e!==0&&(this.pos+=4-e)}},zo.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,a=0;a<this.width;a++){var n=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*a;if(n<this.palette.length){var l=this.palette[n];this.data[s]=l.red,this.data[s+1]=l.green,this.data[s+2]=l.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}t!==0&&(this.pos+=4-t)}},zo.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(s&e)/e*255|0,c=(s>>5&e)/e*255|0,f=(s>>10&e)/e*255|0,d=s>>15?255:0,m=a*this.width*4+4*n;this.data[m]=f,this.data[m+1]=c,this.data[m+2]=l,this.data[m+3]=d}this.pos+=t}},zo.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),a=this.height-1;a>=0;a--){for(var n=this.bottom_up?a:this.height-1-a,s=0;s<this.width;s++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var c=(l&e)/e*255|0,f=(l>>5&r)/r*255|0,d=(l>>11)/e*255|0,m=n*this.width*4+4*s;this.data[m]=d,this.data[m+1]=f,this.data[m+2]=c,this.data[m+3]=255}this.pos+=t}},zo.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=s,this.data[l+1]=n,this.data[l+2]=a,this.data[l+3]=255}this.pos+=this.width%4}},zo.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),c=e*this.width*4+4*r;this.data[c]=s,this.data[c+1]=n,this.data[c+2]=a,this.data[c+3]=l}},zo.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(e,r,a,n){var s=new zo(e,!1),l=s.width,c=s.height,f={data:s.getData(),width:l,height:c},d=new Hv(100).encode(f,100);return t.processJPEG.call(this,d,r,a,n)}})(lr.API),FS.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(e,r,a,n){var s=new FS(e),l=s.width,c=s.height,f={data:s.getData(),width:l,height:c},d=new Hv(100).encode(f,100);return t.processJPEG.call(this,d,r,a,n)}})(lr.API),lr.API.processRGBA=function(t,e,r){for(var a=t.data,n=a.length,s=new Uint8Array(n/4*3),l=new Uint8Array(n/4),c=0,f=0,d=0;d<n;d+=4){var m=a[d],v=a[d+1],x=a[d+2],g=a[d+3];s[c++]=m,s[c++]=v,s[c++]=x,l[f++]=g}var b=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(l),data:b,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},lr.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},zd=lr.API,Rp=zd.getCharWidthsArray=function(t,e){var r,a,n=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),l=e.charSpace||this.internal.getCharSpace(),c=e.widths?e.widths:n.metadata.Unicode.widths,f=c.fof?c.fof:1,d=e.kerning?e.kerning:n.metadata.Unicode.kerning,m=d.fof?d.fof:1,v=e.doKerning!==!1,x=0,g=t.length,b=0,_=c[0]||f,w=[];for(r=0;r<g;r++)a=t.charCodeAt(r),typeof n.metadata.widthOfString=="function"?w.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(a))+l*(1e3/s)||0)/1e3):(x=v&&va(d[a])==="object"&&!isNaN(parseInt(d[a][b],10))?d[a][b]/m:0,w.push((c[a]||_)/f+x)),b=a;return w},NS=zd.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),a=e.font||this.internal.getFont(),n=e.charSpace||this.internal.getCharSpace();return zd.processArabic&&(t=zd.processArabic(t)),typeof a.metadata.widthOfString=="function"?a.metadata.widthOfString(t,r,n)/r:Rp.apply(this,arguments).reduce(function(s,l){return s+l},0)},jS=function(t,e,r,a){for(var n=[],s=0,l=t.length,c=0;s!==l&&c+e[s]<r;)c+=e[s],s++;n.push(t.slice(0,s));var f=s;for(c=0;s!==l;)c+e[s]>a&&(n.push(t.slice(f,s)),c=0,f=s),c+=e[s],s++;return f!==s&&n.push(t.slice(f,s)),n},kS=function(t,e,r){r||(r={});var a,n,s,l,c,f,d,m=[],v=[m],x=r.textIndent||0,g=0,b=0,_=t.split(" "),w=Rp.apply(this,[" ",r])[0];if(f=r.lineIndent===-1?_[0].length+2:r.lineIndent||0){var E=Array(f).join(" "),C=[];_.map(function(T){(T=T.split(/\s*\n/)).length>1?C=C.concat(T.map(function(G,W){return(W&&G.length?`
`:"")+G})):C.push(T[0])}),_=C,f=NS.apply(this,[E,r])}for(s=0,l=_.length;s<l;s++){var A=0;if(a=_[s],f&&a[0]==`
`&&(a=a.substr(1),A=1),x+g+(b=(n=Rp.apply(this,[a,r])).reduce(function(T,G){return T+G},0))>e||A){if(b>e){for(c=jS.apply(this,[a,n,e-(x+g),e]),m.push(c.shift()),m=[c.pop()];c.length;)v.push([c.shift()]);b=n.slice(a.length-(m[0]?m[0].length:0)).reduce(function(T,G){return T+G},0)}else m=[a];v.push(m),x=b+f,g=w}else m.push(a),x+=g+b,g=w}return d=f?function(T,G){return(G?E:"")+T.join(" ")}:function(T){return T.join(" ")},v.map(d)},zd.splitTextToSize=function(t,e,r){var a,n=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(m){if(m.widths&&m.kerning)return{widths:m.widths,kerning:m.kerning};var v=this.internal.getFont(m.fontName,m.fontStyle),x="Unicode";return v.metadata[x]?{widths:v.metadata[x].widths||{0:1},kerning:v.metadata[x].kerning||{}}:{font:v.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);a=Array.isArray(t)?t:String(t).split(/\r?\n/);var l=1*this.internal.scaleFactor*e/n;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/n:0,s.lineIndent=r.lineIndent;var c,f,d=[];for(c=0,f=a.length;c<f;c++)d=d.concat(kS.apply(this,[a[c],l,s]));return d},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",r="klmnopqrstuvwxyz",a={},n={},s=0;s<16;s++)a[r[s]]=e[s],n[e[s]]=r[s];var l=function(x){return"0x"+parseInt(x,10).toString(16)},c=t.__fontmetrics__.compress=function(x){var g,b,_,w,E=["{"];for(var C in x){if(g=x[C],isNaN(parseInt(C,10))?b="'"+C+"'":(C=parseInt(C,10),b=(b=l(C).slice(2)).slice(0,-1)+n[b.slice(-1)]),typeof g=="number")g<0?(_=l(g).slice(3),w="-"):(_=l(g).slice(2),w=""),_=w+_.slice(0,-1)+n[_.slice(-1)];else{if(va(g)!=="object")throw new Error("Don't know what to do with value type "+va(g)+".");_=c(g)}E.push(b+_)}return E.push("}"),E.join("")},f=t.__fontmetrics__.uncompress=function(x){if(typeof x!="string")throw new Error("Invalid argument passed to uncompress.");for(var g,b,_,w,E={},C=1,A=E,T=[],G="",W="",B=x.length-1,q=1;q<B;q+=1)(w=x[q])=="'"?g?(_=g.join(""),g=void 0):g=[]:g?g.push(w):w=="{"?(T.push([A,_]),A={},_=void 0):w=="}"?((b=T.pop())[0][b[1]]=A,_=void 0,A=b[0]):w=="-"?C=-1:_===void 0?a.hasOwnProperty(w)?(G+=a[w],_=parseInt(G,16)*C,C=1,G=""):G+=w:a.hasOwnProperty(w)?(W+=a[w],A[_]=parseInt(W,16)*C,C=1,_=void 0,W=""):W+=w;return E},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:f("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},m={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},v={Unicode:{"Courier-Oblique":f("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":f("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":f("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:f("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":f("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":f("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:f("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:f("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":f("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:f("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":f("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":f("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":f("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":f("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(x){var g=x.font,b=v.Unicode[g.postScriptName];b&&(g.metadata.Unicode={},g.metadata.Unicode.widths=b.widths,g.metadata.Unicode.kerning=b.kerning);var _=m.Unicode[g.postScriptName];_&&(g.metadata.Unicode.encoding=_,g.encoding=_.codePages[0])}])})(lr.API),(function(t){var e=function(r){for(var a=r.length,n=new Uint8Array(a),s=0;s<a;s++)n[s]=r.charCodeAt(s);return n};t.API.events.push(["addFont",function(r){var a=void 0,n=r.font,s=r.instance;if(!n.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(a=s.existsFileInVFS(n.postScriptName)===!1?s.loadFile(n.postScriptName):s.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(l,c){c=/^\x00\x01\x00\x00/.test(c)?e(c):e(Bp(c)),l.metadata=t.API.TTFFont.open(c),l.metadata.Unicode=l.metadata.Unicode||{encoding:{},kerning:{},widths:[]},l.metadata.glyIdsUsed=[0]})(n,a)}}])})(lr),lr.API.addSvgAsImage=function(t,e,r,a,n,s,l,c){if(isNaN(e)||isNaN(r))throw Oa.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(n))throw Oa.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var f=document.createElement("canvas");f.width=a,f.height=n;var d=f.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,f.width,f.height);var m={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},v=this;return(jr.canvg?Promise.resolve(jr.canvg):wv(()=>import("./index.es-pHHyIGFH.js"),[])).catch(function(x){return Promise.reject(new Error("Could not load canvg: "+x))}).then(function(x){return x.default?x.default:x}).then(function(x){return x.fromString(d,t,m)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(x){return x.render(m)}).then(function(){v.addImage(f.toDataURL("image/jpeg",1),e,r,a,n,l,c)})},lr.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var a=1;a<=this.internal.getNumberOfPages();a++)for(var n=0;n<this.internal.pages[a].length;n++)this.internal.pages[a][n]=this.internal.pages[a][n].replace(e,r);return this},lr.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var a,n,s,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},c=Object.keys(l),f=[],d=0,m=0,v=0;function x(b,_){var w,E=!1;for(w=0;w<b.length;w+=1)b[w]===_&&(E=!0);return E}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var g=c.length;for(v=0;v<g;v+=1)r[c[v]].value=r[c[v]].defaultValue,r[c[v]].explicitSet=!1}if(va(t)==="object"){for(n in t)if(s=t[n],x(c,n)&&s!==void 0){if(r[n].type==="boolean"&&typeof s=="boolean")r[n].value=s;else if(r[n].type==="name"&&x(r[n].valueSet,s))r[n].value=s;else if(r[n].type==="integer"&&Number.isInteger(s))r[n].value=s;else if(r[n].type==="array"){for(d=0;d<s.length;d+=1)if(a=!0,s[d].length===1&&typeof s[d][0]=="number")f.push(String(s[d]-1));else if(s[d].length>1){for(m=0;m<s[d].length;m+=1)typeof s[d][m]!="number"&&(a=!1);a===!0&&f.push([s[d][0]-1,s[d][1]-1].join(" "))}r[n].value="["+f.join(" ")+"]"}else r[n].value=r[n].defaultValue;r[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var b,_=[];for(b in r)r[b].explicitSet===!0&&(r[b].type==="name"?_.push("/"+b+" /"+r[b].value):_.push("/"+b+" "+r[b].value));_.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+_.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},(function(t){var e=function(){var a='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',n=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(a)),l=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),c=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),f=unescape(encodeURIComponent("</x:xmpmeta>")),d=s.length+l.length+c.length+n.length+f.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(n+s+l+c+f),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(a,n){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:a,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}})(lr.API),(function(t){var e=t.API,r=e.pdfEscape16=function(s,l){for(var c,f=l.metadata.Unicode.widths,d=["","0","00","000","0000"],m=[""],v=0,x=s.length;v<x;++v){if(c=l.metadata.characterToGlyph(s.charCodeAt(v)),l.metadata.glyIdsUsed.push(c),l.metadata.toUnicode[c]=s.charCodeAt(v),f.indexOf(c)==-1&&(f.push(c),f.push([parseInt(l.metadata.widthOfGlyph(c),10)])),c=="0")return m.join("");c=c.toString(16),m.push(d[4-c.length],c)}return m.join("")},a=function(s){var l,c,f,d,m,v,x;for(m=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,f=[],v=0,x=(c=Object.keys(s).sort(function(g,b){return g-b})).length;v<x;v++)l=c[v],f.length>=100&&(m+=`
`+f.length+` beginbfchar
`+f.join(`
`)+`
endbfchar`,f=[]),s[l]!==void 0&&s[l]!==null&&typeof s[l].toString=="function"&&(d=("0000"+s[l].toString(16)).slice(-4),l=("0000"+(+l).toString(16)).slice(-4),f.push("<"+l+"><"+d+">"));return f.length&&(m+=`
`+f.length+` beginbfchar
`+f.join(`
`)+`
endbfchar
`),m+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(l){var c=l.font,f=l.out,d=l.newObject,m=l.putStream;if(c.metadata instanceof t.API.TTFFont&&c.encoding==="Identity-H"){for(var v=c.metadata.Unicode.widths,x=c.metadata.subset.encode(c.metadata.glyIdsUsed,1),g="",b=0;b<x.length;b++)g+=String.fromCharCode(x[b]);var _=d();m({data:g,addLength1:!0,objectId:_}),f("endobj");var w=d();m({data:a(c.metadata.toUnicode),addLength1:!0,objectId:w}),f("endobj");var E=d();f("<<"),f("/Type /FontDescriptor"),f("/FontName /"+Gd(c.fontName)),f("/FontFile2 "+_+" 0 R"),f("/FontBBox "+t.API.PDFObject.convert(c.metadata.bbox)),f("/Flags "+c.metadata.flags),f("/StemV "+c.metadata.stemV),f("/ItalicAngle "+c.metadata.italicAngle),f("/Ascent "+c.metadata.ascender),f("/Descent "+c.metadata.decender),f("/CapHeight "+c.metadata.capHeight),f(">>"),f("endobj");var C=d();f("<<"),f("/Type /Font"),f("/BaseFont /"+Gd(c.fontName)),f("/FontDescriptor "+E+" 0 R"),f("/W "+t.API.PDFObject.convert(v)),f("/CIDToGIDMap /Identity"),f("/DW 1000"),f("/Subtype /CIDFontType2"),f("/CIDSystemInfo"),f("<<"),f("/Supplement 0"),f("/Registry (Adobe)"),f("/Ordering ("+c.encoding+")"),f(">>"),f(">>"),f("endobj"),c.objectNumber=d(),f("<<"),f("/Type /Font"),f("/Subtype /Type0"),f("/ToUnicode "+w+" 0 R"),f("/BaseFont /"+Gd(c.fontName)),f("/Encoding /"+c.encoding),f("/DescendantFonts ["+C+" 0 R]"),f(">>"),f("endobj"),c.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(l){var c=l.font,f=l.out,d=l.newObject,m=l.putStream;if(c.metadata instanceof t.API.TTFFont&&c.encoding==="WinAnsiEncoding"){for(var v=c.metadata.rawData,x="",g=0;g<v.length;g++)x+=String.fromCharCode(v[g]);var b=d();m({data:x,addLength1:!0,objectId:b}),f("endobj");var _=d();m({data:a(c.metadata.toUnicode),addLength1:!0,objectId:_}),f("endobj");var w=d();f("<<"),f("/Descent "+c.metadata.decender),f("/CapHeight "+c.metadata.capHeight),f("/StemV "+c.metadata.stemV),f("/Type /FontDescriptor"),f("/FontFile2 "+b+" 0 R"),f("/Flags 96"),f("/FontBBox "+t.API.PDFObject.convert(c.metadata.bbox)),f("/FontName /"+Gd(c.fontName)),f("/ItalicAngle "+c.metadata.italicAngle),f("/Ascent "+c.metadata.ascender),f(">>"),f("endobj"),c.objectNumber=d();for(var E=0;E<c.metadata.hmtx.widths.length;E++)c.metadata.hmtx.widths[E]=parseInt(c.metadata.hmtx.widths[E]*(1e3/c.metadata.head.unitsPerEm));f("<</Subtype/TrueType/Type/Font/ToUnicode "+_+" 0 R/BaseFont/"+Gd(c.fontName)+"/FontDescriptor "+w+" 0 R/Encoding/"+c.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(c.metadata.hmtx.widths)+">>"),f("endobj"),c.isAlreadyPutted=!0}})(s)}]);var n=function(s){var l,c=s.text||"",f=s.x,d=s.y,m=s.options||{},v=s.mutex||{},x=v.pdfEscape,g=v.activeFontKey,b=v.fonts,_=g,w="",E=0,C="",A=b[_].encoding;if(b[_].encoding!=="Identity-H")return{text:c,x:f,y:d,options:m,mutex:v};for(C=c,_=g,Array.isArray(c)&&(C=c[0]),E=0;E<C.length;E+=1)b[_].metadata.hasOwnProperty("cmap")&&(l=b[_].metadata.cmap.unicode.codeMap[C[E].charCodeAt(0)]),l||C[E].charCodeAt(0)<256&&b[_].metadata.hasOwnProperty("Unicode")?w+=C[E]:w+="";var T="";return parseInt(_.slice(1))<14||A==="WinAnsiEncoding"?T=x(w,_).split("").map(function(G){return G.charCodeAt(0).toString(16)}).join(""):A==="Identity-H"&&(T=r(w,b[_])),v.isHex=!0,{text:T,x:f,y:d,options:m,mutex:v}};e.events.push(["postProcessText",function(s){var l=s.text||"",c=[],f={text:l,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(l)){var d=0;for(d=0;d<l.length;d+=1)Array.isArray(l[d])&&l[d].length===3?c.push([n(Object.assign({},f,{text:l[d][0]})).text,l[d][1],l[d][2]]):c.push(n(Object.assign({},f,{text:l[d]})).text);s.text=c}else s.text=n(Object.assign({},f,{text:l})).text}])})(lr),(function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,a){return e.call(this),this.internal.vFS[r]=a,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}})(lr.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(a){var n,s,l,c,f,d,m,v=e,x=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],g=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],b={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},_={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},w=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],E=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),C=!1,A=0;this.__bidiEngine__={};var T=function(D){var O=D.charCodeAt(),M=O>>8,V=_[M];return V!==void 0?v[256*V+(255&O)]:M===252||M===253?"AL":E.test(M)?"L":M===8?"R":"N"},G=function(D){for(var O,M=0;M<D.length;M++){if((O=T(D.charAt(M)))==="L")return!1;if(O==="R")return!0}return!1},W=function(D,O,M,V){var ie,X,Z,K,ae=O[V];switch(ae){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":C=!1;break;case"N":case"AN":break;case"EN":C&&(ae="AN");break;case"AL":C=!0,ae="R";break;case"WS":case"BN":ae="N";break;case"CS":V<1||V+1>=O.length||(ie=M[V-1])!=="EN"&&ie!=="AN"||(X=O[V+1])!=="EN"&&X!=="AN"?ae="N":C&&(X="AN"),ae=X===ie?X:"N";break;case"ES":ae=(ie=V>0?M[V-1]:"B")==="EN"&&V+1<O.length&&O[V+1]==="EN"?"EN":"N";break;case"ET":if(V>0&&M[V-1]==="EN"){ae="EN";break}if(C){ae="N";break}for(Z=V+1,K=O.length;Z<K&&O[Z]==="ET";)Z++;ae=Z<K&&O[Z]==="EN"?"EN":"N";break;case"NSM":if(l&&!c){for(K=O.length,Z=V+1;Z<K&&O[Z]==="NSM";)Z++;if(Z<K){var fe=D[V],U=fe>=1425&&fe<=2303||fe===64286;if(ie=O[Z],U&&(ie==="R"||ie==="AL")){ae="R";break}}}ae=V<1||(ie=O[V-1])==="B"?"N":M[V-1];break;case"B":C=!1,n=!0,ae=A;break;case"S":s=!0,ae="N"}return ae},B=function(D,O,M){var V=D.split("");return M&&q(V,M,{hiLevel:A}),V.reverse(),O&&O.reverse(),V.join("")},q=function(D,O,M){var V,ie,X,Z,K,ae=-1,fe=D.length,U=0,j=[],F=A?g:x,I=[];for(C=!1,n=!1,s=!1,ie=0;ie<fe;ie++)I[ie]=T(D[ie]);for(X=0;X<fe;X++){if(K=U,j[X]=W(D,I,j,X),V=240&(U=F[K][b[j[X]]]),U&=15,O[X]=Z=F[U][5],V>0)if(V===16){for(ie=ae;ie<X;ie++)O[ie]=1;ae=-1}else ae=-1;if(F[U][6])ae===-1&&(ae=X);else if(ae>-1){for(ie=ae;ie<X;ie++)O[ie]=Z;ae=-1}I[X]==="B"&&(O[X]=0),M.hiLevel|=Z}s&&(function(z,ne,se){for(var pe=0;pe<se;pe++)if(z[pe]==="S"){ne[pe]=A;for(var ye=pe-1;ye>=0&&z[ye]==="WS";ye--)ne[ye]=A}})(I,O,fe)},L=function(D,O,M,V,ie){if(!(ie.hiLevel<D)){if(D===1&&A===1&&!n)return O.reverse(),void(M&&M.reverse());for(var X,Z,K,ae,fe=O.length,U=0;U<fe;){if(V[U]>=D){for(K=U+1;K<fe&&V[K]>=D;)K++;for(ae=U,Z=K-1;ae<Z;ae++,Z--)X=O[ae],O[ae]=O[Z],O[Z]=X,M&&(X=M[ae],M[ae]=M[Z],M[Z]=X);U=K}U++}}},J=function(D,O,M){var V=D.split(""),ie={hiLevel:A};return M||(M=[]),q(V,M,ie),(function(X,Z,K){if(K.hiLevel!==0&&m)for(var ae,fe=0;fe<X.length;fe++)Z[fe]===1&&(ae=w.indexOf(X[fe]))>=0&&(X[fe]=w[ae+1])})(V,M,ie),L(2,V,O,M,ie),L(1,V,O,M,ie),V.join("")};return this.__bidiEngine__.doBidiReorder=function(D,O,M){if((function(ie,X){if(X)for(var Z=0;Z<ie.length;Z++)X[Z]=Z;c===void 0&&(c=G(ie)),d===void 0&&(d=G(ie))})(D,O),l||!f||d)if(l&&f&&c^d)A=c?1:0,D=B(D,O,M);else if(!l&&f&&d)A=c?1:0,D=J(D,O,M),D=B(D,O);else if(!l||c||f||d){if(l&&!f&&c^d)D=B(D,O),c?(A=0,D=J(D,O,M)):(A=1,D=J(D,O,M),D=B(D,O));else if(l&&c&&!f&&d)A=1,D=J(D,O,M),D=B(D,O);else if(!l&&!f&&c^d){var V=m;c?(A=1,D=J(D,O,M),A=0,m=!1,D=J(D,O,M),m=V):(A=0,D=J(D,O,M),D=B(D,O),A=1,m=!1,D=J(D,O,M),m=V,D=B(D,O))}}else A=0,D=J(D,O,M);else A=c?1:0,D=J(D,O,M);return D},this.__bidiEngine__.setOptions=function(D){D&&(l=D.isInputVisual,f=D.isOutputVisual,c=D.isInputRtl,d=D.isOutputRtl,m=D.isSymmetricSwapping)},this.__bidiEngine__.setOptions(a),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(a){var n=a.text;a.x,a.y;var s=a.options||{};a.mutex,s.lang;var l=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(n)==="[object Array]"){var c=0;for(l=[],c=0;c<n.length;c+=1)Object.prototype.toString.call(n[c])==="[object Array]"?l.push([r.doBidiReorder(n[c][0]),n[c][1],n[c][2]]):l.push([r.doBidiReorder(n[c])]);a.text=l}else a.text=r.doBidiReorder(n);r.setOptions({isInputVisual:!0})}])})(lr),lr.API.TTFFont=(function(){function t(e){var r;if(this.rawData=e,r=this.contents=new bu(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new rH(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new zz(this.contents),this.head=new $z(this),this.name=new Xz(this),this.cmap=new lk(this),this.toUnicode={},this.hhea=new Wz(this),this.maxp=new Kz(this),this.hmtx=new Jz(this),this.post=new Gz(this),this.os2=new Vz(this),this.loca=new tH(this),this.glyf=new Zz(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,a,n,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var l,c,f,d;for(d=[],l=0,c=(f=this.bbox).length;l<c;l++)e=f[l],d.push(Math.round(e*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(a=255&(n=this.post.italic_angle),32768&(r=n>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+a)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,a){var n,s,l,c;for(l=0,s=0,c=(e=""+e).length;0<=c?s<c:s>c;s=0<=c?++s:--s)n=e.charCodeAt(s),l+=this.widthOfGlyph(this.characterToGlyph(n))+a*(1e3/r)||0;return l*(r/1e3)},t.prototype.lineHeight=function(e,r){var a;return r==null&&(r=!1),a=r?this.lineGap:0,(this.ascender+a-this.decender)/1e3*e},t})();var Qo,bu=(function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,a;for(a=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)a[r]=String.fromCharCode(this.readByte());return a.join("")},t.prototype.writeString=function(e){var r,a,n;for(n=[],r=0,a=e.length;0<=a?r<a:r>a;r=0<=a?++r:--r)n.push(this.writeByte(e.charCodeAt(r)));return n},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,a,n,s,l,c,f;return e=this.readByte(),r=this.readByte(),a=this.readByte(),n=this.readByte(),s=this.readByte(),l=this.readByte(),c=this.readByte(),f=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^a)+4294967296*(255^n)+16777216*(255^s)+65536*(255^l)+256*(255^c)+(255^f)+1):72057594037927940*e+281474976710656*r+1099511627776*a+4294967296*n+16777216*s+65536*l+256*c+f},t.prototype.writeLongLong=function(e){var r,a;return r=Math.floor(e/4294967296),a=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(a>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,a;for(r=[],a=0;0<=e?a<e:a>e;a=0<=e?++a:--a)r.push(this.readByte());return r},t.prototype.write=function(e){var r,a,n,s;for(s=[],a=0,n=e.length;a<n;a++)r=e[a],s.push(this.writeByte(r));return s},t})(),zz=(function(){var t;function e(r){var a,n,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},n=0,s=this.tableCount;0<=s?n<s:n>s;n=0<=s?++n:--n)a={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[a.tag]=a}return e.prototype.encode=function(r){var a,n,s,l,c,f,d,m,v,x,g,b,_;for(_ in g=Object.keys(r).length,f=Math.log(2),v=16*Math.floor(Math.log(g)/f),l=Math.floor(v/f),m=16*g-v,(n=new bu).writeInt(this.scalarType),n.writeShort(g),n.writeShort(v),n.writeShort(l),n.writeShort(m),s=16*g,d=n.pos+s,c=null,b=[],r)for(x=r[_],n.writeString(_),n.writeInt(t(x)),n.writeInt(d),n.writeInt(x.length),b=b.concat(x),_==="head"&&(c=d),d+=x.length;d%4;)b.push(0),d++;return n.write(b),a=2981146554-t(n.data),n.pos=c+8,n.writeUInt32(a),n.data},t=function(r){var a,n,s,l;for(r=ck.call(r);r.length%4;)r.push(0);for(s=new bu(r),n=0,a=0,l=r.length;a<l;a=a+=4)n+=s.readUInt32();return 4294967295&n},e})(),Hz={}.hasOwnProperty,Tl=function(t,e){for(var r in e)Hz.call(e,r)&&(t[r]=e[r]);function a(){this.constructor=t}return a.prototype=e.prototype,t.prototype=new a,t.__super__=e.prototype,t};Qo=(function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var $z=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tl(t,Qo),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var r;return(r=new bu).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(e),r.writeShort(this.glyphDataFormat),r.data},t})(),LS=(function(){function t(e,r){var a,n,s,l,c,f,d,m,v,x,g,b,_,w,E,C,A;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),v=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(f=0;f<256;++f)this.codeMap[f]=e.readByte();break;case 4:for(g=e.readUInt16(),x=g/2,e.pos+=6,s=(function(){var T,G;for(G=[],f=T=0;0<=x?T<x:T>x;f=0<=x?++T:--T)G.push(e.readUInt16());return G})(),e.pos+=2,_=(function(){var T,G;for(G=[],f=T=0;0<=x?T<x:T>x;f=0<=x?++T:--T)G.push(e.readUInt16());return G})(),d=(function(){var T,G;for(G=[],f=T=0;0<=x?T<x:T>x;f=0<=x?++T:--T)G.push(e.readUInt16());return G})(),m=(function(){var T,G;for(G=[],f=T=0;0<=x?T<x:T>x;f=0<=x?++T:--T)G.push(e.readUInt16());return G})(),n=(this.length-e.pos+this.offset)/2,c=(function(){var T,G;for(G=[],f=T=0;0<=n?T<n:T>n;f=0<=n?++T:--T)G.push(e.readUInt16());return G})(),f=E=0,A=s.length;E<A;f=++E)for(w=s[f],a=C=b=_[f];b<=w?C<=w:C>=w;a=b<=w?++C:--C)m[f]===0?l=a+d[f]:(l=c[m[f]/2+(a-b)-(x-f)]||0)!==0&&(l+=d[f]),this.codeMap[a]=65535&l}e.pos=v}return t.encode=function(e,r){var a,n,s,l,c,f,d,m,v,x,g,b,_,w,E,C,A,T,G,W,B,q,L,J,D,O,M,V,ie,X,Z,K,ae,fe,U,j,F,I,z,ne,se,pe,ye,_e,Le,ue;switch(V=new bu,l=Object.keys(e).sort(function(at,ht){return at-ht}),r){case"macroman":for(_=0,w=(function(){var at=[];for(b=0;b<256;++b)at.push(0);return at})(),C={0:0},s={},ie=0,ae=l.length;ie<ae;ie++)C[ye=e[n=l[ie]]]==null&&(C[ye]=++_),s[n]={old:e[n],new:C[e[n]]},w[n]=C[e[n]];return V.writeUInt16(1),V.writeUInt16(0),V.writeUInt32(12),V.writeUInt16(0),V.writeUInt16(262),V.writeUInt16(0),V.write(w),{charMap:s,subtable:V.data,maxGlyphID:_+1};case"unicode":for(O=[],v=[],A=0,C={},a={},E=d=null,X=0,fe=l.length;X<fe;X++)C[G=e[n=l[X]]]==null&&(C[G]=++A),a[n]={old:G,new:C[G]},c=C[G]-n,E!=null&&c===d||(E&&v.push(E),O.push(n),d=c),E=n;for(E&&v.push(E),v.push(65535),O.push(65535),J=2*(L=O.length),q=2*Math.pow(Math.log(L)/Math.LN2,2),x=Math.log(q/2)/Math.LN2,B=2*L-q,f=[],W=[],g=[],b=Z=0,U=O.length;Z<U;b=++Z){if(D=O[b],m=v[b],D===65535){f.push(0),W.push(0);break}if(D-(M=a[D].new)>=32768)for(f.push(0),W.push(2*(g.length+L-b)),n=K=D;D<=m?K<=m:K>=m;n=D<=m?++K:--K)g.push(a[n].new);else f.push(M-D),W.push(0)}for(V.writeUInt16(3),V.writeUInt16(1),V.writeUInt32(12),V.writeUInt16(4),V.writeUInt16(16+8*L+2*g.length),V.writeUInt16(0),V.writeUInt16(J),V.writeUInt16(q),V.writeUInt16(x),V.writeUInt16(B),se=0,j=v.length;se<j;se++)n=v[se],V.writeUInt16(n);for(V.writeUInt16(0),pe=0,F=O.length;pe<F;pe++)n=O[pe],V.writeUInt16(n);for(_e=0,I=f.length;_e<I;_e++)c=f[_e],V.writeUInt16(c);for(Le=0,z=W.length;Le<z;Le++)T=W[Le],V.writeUInt16(T);for(ue=0,ne=g.length;ue<ne;ue++)_=g[ue],V.writeUInt16(_);return{charMap:a,subtable:V.data,maxGlyphID:A+1}}},t})(),lk=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tl(t,Qo),t.prototype.tag="cmap",t.prototype.parse=function(e){var r,a,n;for(e.pos=this.offset,this.version=e.readUInt16(),n=e.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)r=new LS(e,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(e,r){var a,n;return r==null&&(r="macroman"),a=LS.encode(e,r),(n=new bu).writeUInt16(0),n.writeUInt16(1),a.table=n.data.concat(a.subtable),a},t})(),Wz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tl(t,Qo),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t})(),Vz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tl(t,Qo),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var r,a;for(a=[],r=0;r<10;++r)a.push(e.readByte());return a})(),this.charRange=(function(){var r,a;for(a=[],r=0;r<4;++r)a.push(e.readInt());return a})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var r,a;for(a=[],r=0;r<2;r=++r)a.push(e.readInt());return a})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t})(),Gz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tl(t,Qo),t.prototype.tag="post",t.prototype.parse=function(e){var r,a,n;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(a=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=a?s<a:s>a;s=0<=a?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],n=[];e.pos<this.offset+this.length;)r=e.readByte(),n.push(this.names.push(e.readString(r)));return n;case 151552:return a=e.readUInt16(),this.offsets=e.read(a);case 262144:return this.map=(function(){var l,c,f;for(f=[],s=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;s=0<=c?++l:--l)f.push(e.readUInt32());return f}).call(this)}},t})(),Yz=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},Xz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tl(t,Qo),t.prototype.tag="name",t.prototype.parse=function(e){var r,a,n,s,l,c,f,d,m,v,x;for(e.pos=this.offset,e.readShort(),r=e.readShort(),c=e.readShort(),a=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)a.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+c+e.readShort()});for(f={},s=m=0,v=a.length;m<v;s=++m)n=a[s],e.pos=n.offset,d=e.readString(n.length),l=new Yz(d,n),f[x=n.nameID]==null&&(f[x]=[]),f[n.nameID].push(l);this.strings=f,this.copyright=f[0],this.fontFamily=f[1],this.fontSubfamily=f[2],this.uniqueSubfamily=f[3],this.fontName=f[4],this.version=f[5];try{this.postscriptName=f[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=f[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=f[7],this.manufacturer=f[8],this.designer=f[9],this.description=f[10],this.vendorUrl=f[11],this.designerUrl=f[12],this.license=f[13],this.licenseUrl=f[14],this.preferredFamily=f[15],this.preferredSubfamily=f[17],this.compatibleFull=f[18],this.sampleText=f[19]},t})(),Kz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tl(t,Qo),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t})(),Jz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tl(t,Qo),t.prototype.tag="hmtx",t.prototype.parse=function(e){var r,a,n,s,l,c,f;for(e.pos=this.offset,this.metrics=[],r=0,c=this.file.hhea.numberOfMetrics;0<=c?r<c:r>c;r=0<=c?++r:--r)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(n=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var d,m;for(m=[],r=d=0;0<=n?d<n:d>n;r=0<=n?++d:--d)m.push(e.readInt16());return m})(),this.widths=(function(){var d,m,v,x;for(x=[],d=0,m=(v=this.metrics).length;d<m;d++)s=v[d],x.push(s.advance);return x}).call(this),a=this.widths[this.widths.length-1],f=[],r=l=0;0<=n?l<n:l>n;r=0<=n?++l:--l)f.push(this.widths.push(a));return f},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t})(),ck=[].slice,Zz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tl(t,Qo),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var r,a,n,s,l,c,f,d,m,v;return e in this.cache?this.cache[e]:(s=this.file.loca,r=this.file.contents,a=s.indexOf(e),(n=s.lengthOf(e))===0?this.cache[e]=null:(r.pos=this.offset+a,l=(c=new bu(r.read(n))).readShort(),d=c.readShort(),v=c.readShort(),f=c.readShort(),m=c.readShort(),this.cache[e]=l===-1?new eH(c,d,v,f,m):new Qz(c,l,d,v,f,m),this.cache[e]))},t.prototype.encode=function(e,r,a){var n,s,l,c,f;for(l=[],s=[],c=0,f=r.length;c<f;c++)n=e[r[c]],s.push(l.length),n&&(l=l.concat(n.encode(a)));return s.push(l.length),{table:l,offsets:s}},t})(),Qz=(function(){function t(e,r,a,n,s,l){this.raw=e,this.numberOfContours=r,this.xMin=a,this.yMin=n,this.xMax=s,this.yMax=l,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),eH=(function(){function t(e,r,a,n,s){var l,c;for(this.raw=e,this.xMin=r,this.yMin=a,this.xMax=n,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],l=this.raw;c=l.readShort(),this.glyphOffsets.push(l.pos),this.glyphIDs.push(l.readUInt16()),32&c;)l.pos+=1&c?4:2,128&c?l.pos+=8:64&c?l.pos+=4:8&c&&(l.pos+=2)}return t.prototype.encode=function(){var e,r,a;for(r=new bu(ck.call(this.raw.data)),e=0,a=this.glyphIDs.length;e<a;++e)r.pos=this.glyphOffsets[e];return r.data},t})(),tH=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tl(t,Qo),t.prototype.tag="loca",t.prototype.parse=function(e){var r,a;return e.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var n,s;for(s=[],a=0,n=this.length;a<n;a+=2)s.push(2*e.readUInt16());return s}).call(this):(function(){var n,s;for(s=[],a=0,n=this.length;a<n;a+=4)s.push(e.readUInt32());return s}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,r){for(var a=new Uint32Array(this.offsets.length),n=0,s=0,l=0;l<a.length;++l)if(a[l]=n,s<r.length&&r[s]==l){++s,a[l]=n;var c=this.offsets[l],f=this.offsets[l+1]-c;f>0&&(n+=f)}for(var d=new Array(4*a.length),m=0;m<a.length;++m)d[4*m+3]=255&a[m],d[4*m+2]=(65280&a[m])>>8,d[4*m+1]=(16711680&a[m])>>16,d[4*m]=(4278190080&a[m])>>24;return d},t})(),rH=(function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,a,n,s;for(r in n=this.font.cmap.tables[0].codeMap,e={},s=this.subset)a=s[r],e[r]=n[a];return e},t.prototype.glyphsFor=function(e){var r,a,n,s,l,c,f;for(n={},l=0,c=e.length;l<c;l++)n[s=e[l]]=this.font.glyf.glyphFor(s);for(s in r=[],n)(a=n[s])!=null&&a.compound&&r.push.apply(r,a.glyphIDs);if(r.length>0)for(s in f=this.glyphsFor(r))a=f[s],n[s]=a;return n},t.prototype.encode=function(e,r){var a,n,s,l,c,f,d,m,v,x,g,b,_,w,E;for(n in a=lk.encode(this.generateCmap(),"unicode"),l=this.glyphsFor(e),g={0:0},E=a.charMap)g[(f=E[n]).old]=f.new;for(b in x=a.maxGlyphID,l)b in g||(g[b]=x++);return m=(function(C){var A,T;for(A in T={},C)T[C[A]]=A;return T})(g),v=Object.keys(m).sort(function(C,A){return C-A}),_=(function(){var C,A,T;for(T=[],C=0,A=v.length;C<A;C++)c=v[C],T.push(m[c]);return T})(),s=this.font.glyf.encode(l,_,g),d=this.font.loca.encode(s.offsets,_),w={cmap:this.font.cmap.raw(),glyf:s.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(w["OS/2"]=this.font.os2.raw()),this.font.directory.encode(w)},t})();lr.API.PDFObject=(function(){var t;function e(){}return t=function(r,a){return(Array(a+1).join("0")+r).slice(-a)},e.convert=function(r){var a,n,s,l;if(Array.isArray(r))return"["+(function(){var c,f,d;for(d=[],c=0,f=r.length;c<f;c++)a=r[c],d.push(e.convert(a));return d})().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(n in s=["<<"],r)l=r[n],s.push("/"+n+" "+e.convert(l));return s.push(">>"),s.join(`
`)}return""+r},e})();function uk(t,e,r,a,n){a=a||{};var s=1.15,l=n.internal.scaleFactor,c=n.internal.getFontSize()/l,f=n.getLineHeightFactor?n.getLineHeightFactor():s,d=c*f,m=/\r\n|\r|\n/g,v="",x=1;if((a.valign==="middle"||a.valign==="bottom"||a.halign==="center"||a.halign==="right")&&(v=typeof t=="string"?t.split(m):t,x=v.length||1),r+=c*(2-s),a.valign==="middle"?r-=x/2*d:a.valign==="bottom"&&(r-=x*d),a.halign==="center"||a.halign==="right"){var g=c;if(a.halign==="center"&&(g*=.5),v&&x>=1){for(var b=0;b<v.length;b++)n.text(v[b],e-n.getStringUnitWidth(v[b])*g,r),r+=d;return n}e-=n.getStringUnitWidth(t)*g}return a.halign==="justify"?n.text(t,e,r,{maxWidth:a.maxWidth||100,align:"justify"}):n.text(t,e,r),n}var PS={},ih=(function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=e:PS=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,r){var a,n,s;r===void 0&&(r=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var l=this.jsPDFDocument.internal.getFont(),c=l.fontStyle,f=l.fontName;if(e.font&&(f=e.font),e.fontStyle){c=e.fontStyle;var d=this.getFontList()[f];d&&d.indexOf(c)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(d[0]),c=d[0])}if(this.jsPDFDocument.setFont(f,c),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!r){var m=t.unifyColor(e.fillColor);m&&(a=this.jsPDFDocument).setFillColor.apply(a,m),m=t.unifyColor(e.textColor),m&&(n=this.jsPDFDocument).setTextColor.apply(n,m),m=t.unifyColor(e.lineColor),m&&(s=this.jsPDFDocument).setDrawColor.apply(s,m),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,r,a){return this.jsPDFDocument.splitTextToSize(e,r,a)},t.prototype.rect=function(e,r,a,n,s){return this.jsPDFDocument.rect(e,r,a,n,s)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return PS||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t})(),$x=function(t,e){return $x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r[n]=a[n])},$x(t,e)};function fk(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");$x(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var dk=(function(t){fk(e,t);function e(r){var a=t.call(this)||this;return a._element=r,a}return e})(Array);function aH(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function nH(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function h1(t,e,r){r.applyStyles(e,!0);var a=Array.isArray(t)?t:[t],n=a.map(function(s){return r.getTextWidth(s)}).reduce(function(s,l){return Math.max(s,l)},0);return n}function hk(t,e,r,a){var n=e.settings.tableLineWidth,s=e.settings.tableLineColor;t.applyStyles({lineWidth:n,lineColor:s});var l=mk(n,!1);l&&t.rect(r.x,r.y,e.getWidth(t.pageSize().width),a.y-r.y,l)}function mk(t,e){var r=t>0,a=e||e===0;return r&&a?"DF":r?"S":a?"F":null}function O1(t,e){var r,a,n,s;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(r=t.left)!==null&&r!==void 0?r:e,top:(a=t.top)!==null&&a!==void 0?a:e,right:(n=t.right)!==null&&n!==void 0?n:e,bottom:(s=t.bottom)!==null&&s!==void 0?s:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function pk(t,e){var r=O1(e.settings.margin,0);return t.pageSize().width-(r.left+r.right)}function sH(t,e,r,a,n){var s={},l=1.3333333333333333,c=$v(e,function(A){return n.getComputedStyle(A).backgroundColor});c!=null&&(s.fillColor=c);var f=$v(e,function(A){return n.getComputedStyle(A).color});f!=null&&(s.textColor=f);var d=oH(a,r);d&&(s.cellPadding=d);var m="borderTopColor",v=l*r,x=a.borderTopWidth;if(a.borderBottomWidth===x&&a.borderRightWidth===x&&a.borderLeftWidth===x){var g=(parseFloat(x)||0)/v;g&&(s.lineWidth=g)}else s.lineWidth={top:(parseFloat(a.borderTopWidth)||0)/v,right:(parseFloat(a.borderRightWidth)||0)/v,bottom:(parseFloat(a.borderBottomWidth)||0)/v,left:(parseFloat(a.borderLeftWidth)||0)/v},s.lineWidth.top||(s.lineWidth.right?m="borderRightColor":s.lineWidth.bottom?m="borderBottomColor":s.lineWidth.left&&(m="borderLeftColor"));var b=$v(e,function(A){return n.getComputedStyle(A)[m]});b!=null&&(s.lineColor=b);var _=["left","right","center","justify"];_.indexOf(a.textAlign)!==-1&&(s.halign=a.textAlign),_=["middle","bottom","top"],_.indexOf(a.verticalAlign)!==-1&&(s.valign=a.verticalAlign);var w=parseInt(a.fontSize||"");isNaN(w)||(s.fontSize=w/l);var E=iH(a);E&&(s.fontStyle=E);var C=(a.fontFamily||"").toLowerCase();return t.indexOf(C)!==-1&&(s.font=C),s}function iH(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function $v(t,e){var r=gk(t,e);if(!r)return null;var a=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!a||!Array.isArray(a))return null;var n=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])],s=parseInt(a[4]);return s===0||isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function gk(t,e){var r=e(t);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?t.parentElement==null?null:gk(t.parentElement,e):r}function oH(t,e){var r=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],a=96/(72/e),n=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,s=r.map(function(c){return parseInt(c||"0")/a}),l=O1(s,0);return n>l.top&&(l.top=n),n>l.bottom&&(l.bottom=n),l}function vk(t,e,r,a,n){var s,l;a===void 0&&(a=!1),n===void 0&&(n=!1);var c;typeof e=="string"?c=r.document.querySelector(e):c=e;var f=Object.keys(t.getFontList()),d=t.scaleFactor(),m=[],v=[],x=[];if(!c)return console.error("Html table could not be found with input: ",e),{head:m,body:v,foot:x};for(var g=0;g<c.rows.length;g++){var b=c.rows[g],_=(l=(s=b?.parentElement)===null||s===void 0?void 0:s.tagName)===null||l===void 0?void 0:l.toLowerCase(),w=lH(f,d,r,b,a,n);w&&(_==="thead"?m.push(w):_==="tfoot"?x.push(w):v.push(w))}return{head:m,body:v,foot:x}}function lH(t,e,r,a,n,s){for(var l=new dk(a),c=0;c<a.cells.length;c++){var f=a.cells[c],d=r.getComputedStyle(f);if(n||d.display!=="none"){var m=void 0;s&&(m=sH(t,f,e,d,r)),l.push({rowSpan:f.rowSpan,colSpan:f.colSpan,styles:m,_element:f,content:cH(f)})}}var v=r.getComputedStyle(a);if(l.length>0&&(n||v.display!=="none"))return l}function cH(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),e.innerText||e.textContent||""}function uH(t,e,r){for(var a=0,n=[t,e,r];a<n.length;a++){var s=n[a];s&&typeof s!="object"&&console.error("The options parameter should be of type object, is: "+typeof s),s.startY&&typeof s.startY!="number"&&(console.error("Invalid value for startY option",s.startY),delete s.startY)}}function uc(t,e,r,a,n){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(t),l=1;l<arguments.length;l++){var c=arguments[l];if(c!=null)for(var f in c)Object.prototype.hasOwnProperty.call(c,f)&&(s[f]=c[f])}return s}function xk(t,e){var r=new ih(t),a=r.getDocumentOptions(),n=r.getGlobalOptions();uH(n,a,e);var s=uc({},n,a,e),l;typeof window<"u"&&(l=window);var c=fH(n,a,e),f=dH(n,a,e),d=hH(r,s),m=pH(r,s,l);return{id:e.tableId,content:m,hooks:f,styles:c,settings:d}}function fH(t,e,r){for(var a={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},n=function(f){if(f==="columnStyles"){var d=t[f],m=e[f],v=r[f];a.columnStyles=uc({},d,m,v)}else{var x=[t,e,r],g=x.map(function(b){return b[f]||{}});a[f]=uc({},g[0],g[1],g[2])}},s=0,l=Object.keys(a);s<l.length;s++){var c=l[s];n(c)}return a}function dH(t,e,r){for(var a=[t,e,r],n={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},s=0,l=a;s<l.length;s++){var c=l[s];c.didParseCell&&n.didParseCell.push(c.didParseCell),c.willDrawCell&&n.willDrawCell.push(c.willDrawCell),c.didDrawCell&&n.didDrawCell.push(c.didDrawCell),c.willDrawPage&&n.willDrawPage.push(c.willDrawPage),c.didDrawPage&&n.didDrawPage.push(c.didDrawPage)}return n}function hH(t,e){var r,a,n,s,l,c,f,d,m,v,x,g,b=O1(e.margin,40/t.scaleFactor()),_=(r=mH(t,e.startY))!==null&&r!==void 0?r:b.top,w;e.showFoot===!0?w="everyPage":e.showFoot===!1?w="never":w=(a=e.showFoot)!==null&&a!==void 0?a:"everyPage";var E;e.showHead===!0?E="everyPage":e.showHead===!1?E="never":E=(n=e.showHead)!==null&&n!==void 0?n:"everyPage";var C=(s=e.useCss)!==null&&s!==void 0?s:!1,A=e.theme||(C?"plain":"striped"),T=!!e.horizontalPageBreak,G=(l=e.horizontalPageBreakRepeat)!==null&&l!==void 0?l:null;return{includeHiddenHtml:(c=e.includeHiddenHtml)!==null&&c!==void 0?c:!1,useCss:C,theme:A,startY:_,margin:b,pageBreak:(f=e.pageBreak)!==null&&f!==void 0?f:"auto",rowPageBreak:(d=e.rowPageBreak)!==null&&d!==void 0?d:"auto",tableWidth:(m=e.tableWidth)!==null&&m!==void 0?m:"auto",showHead:E,showFoot:w,tableLineWidth:(v=e.tableLineWidth)!==null&&v!==void 0?v:0,tableLineColor:(x=e.tableLineColor)!==null&&x!==void 0?x:200,horizontalPageBreak:T,horizontalPageBreakRepeat:G,horizontalPageBreakBehaviour:(g=e.horizontalPageBreakBehaviour)!==null&&g!==void 0?g:"afterAllRows"}}function mH(t,e){var r=t.getLastAutoTable(),a=t.scaleFactor(),n=t.pageNumber(),s=!1;if(r&&r.startPageNumber){var l=r.startPageNumber+r.pageNumber-1;s=l===n}return typeof e=="number"?e:(e==null||e===!1)&&s&&r?.finalY!=null?r.finalY+20/a:null}function pH(t,e,r){var a=e.head||[],n=e.body||[],s=e.foot||[];if(e.html){var l=e.includeHiddenHtml;if(r){var c=vk(t,e.html,r,l,e.useCss)||{};a=c.head||a,n=c.body||a,s=c.foot||a}else console.error("Cannot parse html in non browser environment")}var f=e.columns||gH(a,n,s);return{columns:f,head:a,body:n,foot:s}}function gH(t,e,r){var a=t[0]||e[0]||r[0]||[],n=[];return Object.keys(a).filter(function(s){return s!=="_element"}).forEach(function(s){var l=1,c;Array.isArray(a)?c=a[parseInt(s)]:c=a[s],typeof c=="object"&&!Array.isArray(c)&&(l=c?.colSpan||1);for(var f=0;f<l;f++){var d=void 0;Array.isArray(a)?d=n.length:d=s+(f>0?"_".concat(f):"");var m={dataKey:d};n.push(m)}}),n}var Wx=(function(){function t(e,r,a){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=a,this.doc=e.getDocument()}return t})(),vH=(function(t){fk(e,t);function e(r,a,n,s,l,c){var f=t.call(this,r,a,c)||this;return f.cell=n,f.row=s,f.column=l,f.section=s.section,f}return e})(Wx),xH=(function(){function t(e,r){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(r,a){return r+a.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(r,a){return r+a.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,r,a,n,s,l){for(var c=0,f=r;c<f.length;c++){var d=f[c],m=new vH(e,this,a,n,s,l),v=d(m)===!1;if(a.text=Array.isArray(a.text)?a.text:[a.text],v)return!1}return!0},t.prototype.callEndPageHooks=function(e,r){e.applyStyles(e.userStyles);for(var a=0,n=this.hooks.didDrawPage;a<n.length;a++){var s=n[a];s(new Wx(e,this,r))}},t.prototype.callWillDrawPageHooks=function(e,r){for(var a=0,n=this.hooks.willDrawPage;a<n.length;a++){var s=n[a];s(new Wx(e,this,r))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(n,s){return n+s.wrappedWidth},0);return r}else{var a=this.settings.margin;return e-a.left-a.right}},t})(),yk=(function(){function t(e,r,a,n,s){s===void 0&&(s=!1),this.height=0,this.raw=e,e instanceof dk&&(this.raw=e._element,this.element=e._element),this.index=r,this.section=a,this.cells=n,this.spansMultiplePages=s}return t.prototype.getMaxCellHeight=function(e){var r=this;return e.reduce(function(a,n){var s;return Math.max(a,((s=r.cells[n.index])===null||s===void 0?void 0:s.height)||0)},0)},t.prototype.hasRowSpan=function(e){var r=this;return e.filter(function(a){var n=r.cells[a.index];return n?n.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,r){return this.getMaxCellHeight(r)<=e},t.prototype.getMinimumRowHeight=function(e,r){var a=this;return e.reduce(function(n,s){var l=a.cells[s.index];if(!l)return 0;var c=r.getLineHeight(l.styles.fontSize),f=l.padding("vertical"),d=f+c;return d>n?d:n},0)},t})(),_k=(function(){function t(e,r,a){var n;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=a,this.raw=e;var s=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,s=(n=e.content)!==null&&n!==void 0?n:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var l=s!=null?""+s:"",c=/\r\n|\r|\n/g;this.text=l.split(c)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}var a;if(this.styles.halign==="right")a=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var n=this.width-this.padding("horizontal");a=this.x+n/2+this.padding("left")}else a=this.x+this.padding("left");return{x:a,y:e}},t.prototype.getContentHeight=function(e,r){r===void 0&&(r=1.15);var a=Array.isArray(this.text)?this.text.length:1,n=this.styles.fontSize/e*r,s=a*n+this.padding("vertical");return Math.max(s,this.styles.minCellHeight)},t.prototype.padding=function(e){var r=O1(this.styles.cellPadding,0);return e==="vertical"?r.top+r.bottom:e==="horizontal"?r.left+r.right:r[e]},t})(),yH=(function(){function t(e,r,a){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=r,this.index=a}return t.prototype.getMaxCustomCellWidth=function(e){for(var r=0,a=0,n=e.allRows();a<n.length;a++){var s=n[a],l=s.cells[this.index];l&&typeof l.styles.cellWidth=="number"&&(r=Math.max(r,l.styles.cellWidth))}return r},t})();function _H(t,e){bH(t,e);var r=[],a=0;e.columns.forEach(function(s){var l=s.getMaxCustomCellWidth(e);l?s.width=l:(s.width=s.wrappedWidth,r.push(s)),a+=s.width});var n=e.getWidth(t.pageSize().width)-a;n&&(n=Vx(r,n,function(s){return Math.max(s.minReadableWidth,s.minWidth)})),n&&(n=Vx(r,n,function(s){return s.minWidth})),n=Math.abs(n),!e.settings.horizontalPageBreak&&n>.1/t.scaleFactor()&&(n=n<1?n:Math.round(n),console.warn("Of the table content, ".concat(n," units width could not fit page"))),SH(e),NH(e,t),wH(e)}function bH(t,e){var r=t.scaleFactor(),a=e.settings.horizontalPageBreak,n=pk(t,e);e.allRows().forEach(function(s){for(var l=0,c=e.columns;l<c.length;l++){var f=c[l],d=s.cells[f.index];if(d){var m=e.hooks.didParseCell;e.callCellHooks(t,m,d,s,f,null);var v=d.padding("horizontal");d.contentWidth=h1(d.text,d.styles,t)+v;var x=h1(d.text.join(" ").split(/[^\S\u00A0]+/),d.styles,t);if(d.minReadableWidth=x+d.padding("horizontal"),typeof d.styles.cellWidth=="number")d.minWidth=d.styles.cellWidth,d.wrappedWidth=d.styles.cellWidth;else if(d.styles.cellWidth==="wrap"||a===!0)d.contentWidth>n?(d.minWidth=n,d.wrappedWidth=n):(d.minWidth=d.contentWidth,d.wrappedWidth=d.contentWidth);else{var g=10/r;d.minWidth=d.styles.minCellWidth||g,d.wrappedWidth=d.contentWidth,d.minWidth>d.wrappedWidth&&(d.wrappedWidth=d.minWidth)}}}}),e.allRows().forEach(function(s){for(var l=0,c=e.columns;l<c.length;l++){var f=c[l],d=s.cells[f.index];if(d&&d.colSpan===1)f.wrappedWidth=Math.max(f.wrappedWidth,d.wrappedWidth),f.minWidth=Math.max(f.minWidth,d.minWidth),f.minReadableWidth=Math.max(f.minReadableWidth,d.minReadableWidth);else{var m=e.styles.columnStyles[f.dataKey]||e.styles.columnStyles[f.index]||{},v=m.cellWidth||m.minCellWidth;v&&typeof v=="number"&&(f.minWidth=v,f.wrappedWidth=v)}d&&(d.colSpan>1&&!f.minWidth&&(f.minWidth=d.minWidth),d.colSpan>1&&!f.wrappedWidth&&(f.wrappedWidth=d.minWidth))}})}function Vx(t,e,r){for(var a=e,n=t.reduce(function(g,b){return g+b.wrappedWidth},0),s=0;s<t.length;s++){var l=t[s],c=l.wrappedWidth/n,f=a*c,d=l.width+f,m=r(l),v=d<m?m:d;e-=v-l.width,l.width=v}if(e=Math.round(e*1e10)/1e10,e){var x=t.filter(function(g){return e<0?g.width>r(g):!0});x.length&&(e=Vx(x,e,r))}return e}function wH(t){for(var e={},r=1,a=t.allRows(),n=0;n<a.length;n++)for(var s=a[n],l=0,c=t.columns;l<c.length;l++){var f=c[l],d=e[f.index];if(r>1)r--,delete s.cells[f.index];else if(d)d.cell.height+=s.height,r=d.cell.colSpan,delete s.cells[f.index],d.left--,d.left<=1&&delete e[f.index];else{var m=s.cells[f.index];if(!m)continue;if(m.height=s.height,m.rowSpan>1){var v=a.length-n,x=m.rowSpan>v?v:m.rowSpan;e[f.index]={cell:m,left:x,row:s}}}}}function SH(t){for(var e=t.allRows(),r=0;r<e.length;r++)for(var a=e[r],n=null,s=0,l=0,c=0;c<t.columns.length;c++){var f=t.columns[c];if(l-=1,l>1&&t.columns[c+1])s+=f.width,delete a.cells[f.index];else if(n){var d=n;delete a.cells[f.index],n=null,d.width=f.width+s}else{var d=a.cells[f.index];if(!d)continue;if(l=d.colSpan,s=0,d.colSpan>1){n=d,s+=f.width;continue}d.width=f.width+s}}}function NH(t,e){for(var r={count:0,height:0},a=0,n=t.allRows();a<n.length;a++){for(var s=n[a],l=0,c=t.columns;l<c.length;l++){var f=c[l],d=s.cells[f.index];if(d){e.applyStyles(d.styles,!0);var m=d.width-d.padding("horizontal");if(d.styles.overflow==="linebreak")d.text=e.splitTextToSize(d.text,m+1/e.scaleFactor(),{fontSize:d.styles.fontSize});else if(d.styles.overflow==="ellipsize")d.text=MS(d.text,m,d.styles,e,"...");else if(d.styles.overflow==="hidden")d.text=MS(d.text,m,d.styles,e,"");else if(typeof d.styles.overflow=="function"){var v=d.styles.overflow(d.text,m);typeof v=="string"?d.text=[v]:d.text=v}d.contentHeight=d.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var x=d.contentHeight/d.rowSpan;d.rowSpan>1&&r.count*r.height<x*d.rowSpan?r={height:x,count:d.rowSpan}:r&&r.count>0&&r.height>x&&(x=r.height),x>s.height&&(s.height=x)}}r.count--}}function MS(t,e,r,a,n){return t.map(function(s){return jH(s,e,r,a,n)})}function jH(t,e,r,a,n){var s=1e4*a.scaleFactor();if(e=Math.ceil(e*s)/s,e>=h1(t,r,a))return t;for(;e<h1(t+n,r,a)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+n}function bk(t,e){var r=new ih(t),a=kH(e,r.scaleFactor()),n=new xH(e,a);return _H(r,n),r.applyStyles(r.userStyles),n}function kH(t,e){var r=t.content,a=AH(r.columns);if(r.head.length===0){var n=IS(a,"head");n&&r.head.push(n)}if(r.foot.length===0){var n=IS(a,"foot");n&&r.foot.push(n)}var s=t.settings.theme,l=t.styles;return{columns:a,head:Wv("head",r.head,a,l,s,e),body:Wv("body",r.body,a,l,s,e),foot:Wv("foot",r.foot,a,l,s,e)}}function Wv(t,e,r,a,n,s){var l={},c=e.map(function(f,d){for(var m=0,v={},x=0,g=0,b=0,_=r;b<_.length;b++){var w=_[b];if(l[w.index]==null||l[w.index].left===0)if(g===0){var E=void 0;Array.isArray(f)?E=f[w.index-x-m]:E=f[w.dataKey];var C={};typeof E=="object"&&!Array.isArray(E)&&(C=E?.styles||{});var A=CH(t,w,d,n,a,s,C),T=new _k(E,A,t);v[w.dataKey]=T,v[w.index]=T,g=T.colSpan-1,l[w.index]={left:T.rowSpan-1,times:g}}else g--,x++;else l[w.index].left--,g=l[w.index].times,m++}return new yk(f,d,t,v)});return c}function IS(t,e){var r={};return t.forEach(function(a){if(a.raw!=null){var n=EH(e,a.raw);n!=null&&(r[a.dataKey]=n)}}),Object.keys(r).length>0?r:null}function EH(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function AH(t){return t.map(function(e,r){var a,n;return typeof e=="object"?n=(a=e.dataKey)!==null&&a!==void 0?a:r:n=r,new yH(n,e,r)})}function CH(t,e,r,a,n,s,l){var c=nH(a),f;t==="head"?f=n.headStyles:t==="body"?f=n.bodyStyles:t==="foot"&&(f=n.footStyles);var d=uc({},c.table,c[t],n.styles,f),m=n.columnStyles[e.dataKey]||n.columnStyles[e.index]||{},v=t==="body"?m:{},x=t==="body"&&r%2===0?uc({},c.alternateRow,n.alternateRowStyles):{},g=aH(s),b=uc({},g,d,x,v);return uc(b,l)}function TH(t,e,r){var a;r===void 0&&(r={});var n=pk(t,e),s=new Map,l=[],c=[],f=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?f=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(f=[e.settings.horizontalPageBreakRepeat]),f.forEach(function(x){var g=e.columns.find(function(b){return b.dataKey===x||b.index===x});g&&!s.has(g.index)&&(s.set(g.index,!0),l.push(g.index),c.push(e.columns[g.index]),n-=g.wrappedWidth)});for(var d=!0,m=(a=r?.start)!==null&&a!==void 0?a:0;m<e.columns.length;){if(s.has(m)){m++;continue}var v=e.columns[m].wrappedWidth;if(d||n>=v)d=!1,l.push(m),c.push(e.columns[m]),n-=v;else break;m++}return{colIndexes:l,columns:c,lastIndex:m-1}}function OH(t,e){for(var r=[],a=0;a<e.columns.length;a++){var n=TH(t,e,{start:a});n.columns.length&&(r.push(n),a=n.lastIndex)}return r}function wk(t,e){var r=e.settings,a=r.startY,n=r.margin,s={x:n.left,y:a},l=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),c=a+n.bottom+l;if(r.pageBreak==="avoid"){var f=e.body,d=f.reduce(function(x,g){return x+g.height},0);c+=d}var m=new ih(t);(r.pageBreak==="always"||r.startY!=null&&c>m.pageSize().height)&&(Nk(m),s.y=n.top),e.callWillDrawPageHooks(m,s);var v=uc({},s);e.startPageNumber=m.pageNumber(),r.horizontalPageBreak?RH(m,e,v,s):(m.applyStyles(m.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(x){return gc(m,e,x,s,e.columns)}),m.applyStyles(m.userStyles),e.body.forEach(function(x,g){var b=g===e.body.length-1;m1(m,e,x,b,v,s,e.columns)}),m.applyStyles(m.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(x){return gc(m,e,x,s,e.columns)})),hk(m,e,v,s),e.callEndPageHooks(m,s),e.finalY=s.y,t.lastAutoTable=e,m.applyStyles(m.userStyles)}function RH(t,e,r,a){var n=OH(t,e),s=e.settings;if(s.horizontalPageBreakBehaviour==="afterAllRows")n.forEach(function(d,m){t.applyStyles(t.userStyles),m>0?k0(t,e,r,a,d.columns,!0):BS(t,e,a,d.columns),DH(t,e,r,a,d.columns),Vv(t,e,a,d.columns)});else for(var l=-1,c=n[0],f=function(){var d=l;if(c){t.applyStyles(t.userStyles);var m=c.columns;l>=0?k0(t,e,r,a,m,!0):BS(t,e,a,m),d=US(t,e,l+1,a,m),Vv(t,e,a,m)}var v=d-l;n.slice(1).forEach(function(x){t.applyStyles(t.userStyles),k0(t,e,r,a,x.columns,!0),US(t,e,l+1,a,x.columns,v),Vv(t,e,a,x.columns)}),l=d};l<e.body.length-1;)f()}function BS(t,e,r,a){var n=e.settings;t.applyStyles(t.userStyles),(n.showHead==="firstPage"||n.showHead==="everyPage")&&e.head.forEach(function(s){return gc(t,e,s,r,a)})}function DH(t,e,r,a,n){t.applyStyles(t.userStyles),e.body.forEach(function(s,l){var c=l===e.body.length-1;m1(t,e,s,c,r,a,n)})}function US(t,e,r,a,n,s){t.applyStyles(t.userStyles),s=s??e.body.length;var l=Math.min(r+s,e.body.length),c=-1;return e.body.slice(r,l).forEach(function(f,d){var m=r+d===e.body.length-1,v=Sk(t,e,m,a);f.canEntireRowFit(v,n)&&(gc(t,e,f,a,n),c=r+d)}),c}function Vv(t,e,r,a){var n=e.settings;t.applyStyles(t.userStyles),(n.showFoot==="lastPage"||n.showFoot==="everyPage")&&e.foot.forEach(function(s){return gc(t,e,s,r,a)})}function FH(t,e,r){var a=r.getLineHeight(t.styles.fontSize),n=t.padding("vertical"),s=Math.floor((e-n)/a);return Math.max(0,s)}function LH(t,e,r,a){var n={};t.spansMultiplePages=!0,t.height=0;for(var s=0,l=0,c=r.columns;l<c.length;l++){var f=c[l],d=t.cells[f.index];if(d){Array.isArray(d.text)||(d.text=[d.text]);var m=new _k(d.raw,d.styles,d.section);m=uc(m,d),m.text=[];var v=FH(d,e,a);d.text.length>v&&(m.text=d.text.splice(v,d.text.length));var x=a.scaleFactor(),g=a.getLineHeightFactor();d.contentHeight=d.getContentHeight(x,g),d.contentHeight>=e&&(d.contentHeight=e,m.styles.minCellHeight-=e),d.contentHeight>t.height&&(t.height=d.contentHeight),m.contentHeight=m.getContentHeight(x,g),m.contentHeight>s&&(s=m.contentHeight),n[f.index]=m}}var b=new yk(t.raw,-1,t.section,n,!0);b.height=s;for(var _=0,w=r.columns;_<w.length;_++){var f=w[_],m=b.cells[f.index];m&&(m.height=b.height);var d=t.cells[f.index];d&&(d.height=t.height)}return b}function PH(t,e,r,a){var n=t.pageSize().height,s=a.settings.margin,l=s.top+s.bottom,c=n-l;e.section==="body"&&(c-=a.getHeadHeight(a.columns)+a.getFootHeight(a.columns));var f=e.getMinimumRowHeight(a.columns,t),d=f<r;if(f>c)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!d)return!1;var m=e.hasRowSpan(a.columns),v=e.getMaxCellHeight(a.columns)>c;return v?(m&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(m||a.settings.rowPageBreak==="avoid")}function m1(t,e,r,a,n,s,l){var c=Sk(t,e,a,s);if(r.canEntireRowFit(c,l))gc(t,e,r,s,l);else if(PH(t,r,c,e)){var f=LH(r,c,e,t);gc(t,e,r,s,l),k0(t,e,n,s,l),m1(t,e,f,a,n,s,l)}else k0(t,e,n,s,l),m1(t,e,r,a,n,s,l)}function gc(t,e,r,a,n){a.x=e.settings.margin.left;for(var s=0,l=n;s<l.length;s++){var c=l[s],f=r.cells[c.index];if(!f){a.x+=c.width;continue}t.applyStyles(f.styles),f.x=a.x,f.y=a.y;var d=e.callCellHooks(t,e.hooks.willDrawCell,f,r,c,a);if(d===!1){a.x+=c.width;continue}MH(t,f,a);var m=f.getTextPos();uk(f.text,m.x,m.y,{halign:f.styles.halign,valign:f.styles.valign,maxWidth:Math.ceil(f.width-f.padding("left")-f.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,f,r,c,a),a.x+=c.width}a.y+=r.height}function MH(t,e,r){var a=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof a.lineWidth=="number"){var n=mk(a.lineWidth,a.fillColor);n&&t.rect(e.x,r.y,e.width,e.height,n)}else typeof a.lineWidth=="object"&&(a.fillColor&&t.rect(e.x,r.y,e.width,e.height,"F"),IH(t,e,r,a.lineWidth))}function IH(t,e,r,a){var n,s,l,c;a.top&&(n=r.x,s=r.y,l=r.x+e.width,c=r.y,a.right&&(l+=.5*a.right),a.left&&(n-=.5*a.left),f(a.top,n,s,l,c)),a.bottom&&(n=r.x,s=r.y+e.height,l=r.x+e.width,c=r.y+e.height,a.right&&(l+=.5*a.right),a.left&&(n-=.5*a.left),f(a.bottom,n,s,l,c)),a.left&&(n=r.x,s=r.y,l=r.x,c=r.y+e.height,a.top&&(s-=.5*a.top),a.bottom&&(c+=.5*a.bottom),f(a.left,n,s,l,c)),a.right&&(n=r.x+e.width,s=r.y,l=r.x+e.width,c=r.y+e.height,a.top&&(s-=.5*a.top),a.bottom&&(c+=.5*a.bottom),f(a.right,n,s,l,c));function f(d,m,v,x,g){t.getDocument().setLineWidth(d),t.getDocument().line(m,v,x,g,"S")}}function Sk(t,e,r,a){var n=e.settings.margin.bottom,s=e.settings.showFoot;return(s==="everyPage"||s==="lastPage"&&r)&&(n+=e.getFootHeight(e.columns)),t.pageSize().height-a.y-n}function k0(t,e,r,a,n,s){n===void 0&&(n=[]),s===void 0&&(s=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!s&&e.foot.forEach(function(c){return gc(t,e,c,a,n)}),e.callEndPageHooks(t,a);var l=e.settings.margin;hk(t,e,r,a),Nk(t),e.pageNumber++,a.x=l.left,a.y=l.top,r.y=l.top,e.callWillDrawPageHooks(t,a),e.settings.showHead==="everyPage"&&(e.head.forEach(function(c){return gc(t,e,c,a,n)}),t.applyStyles(t.userStyles))}function Nk(t){var e=t.pageNumber();t.setPage(e+1);var r=t.pageNumber();return r===e?(t.addPage(),!0):!1}function BH(t){t.API.autoTable=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var a=e[0],n=xk(this,a),s=bk(this,n);return wk(this,s),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,r,a,n){uk(e,r,a,n,this)},t.API.autoTableSetDefaults=function(e){return ih.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,r){ih.setDefaults(e,r)},t.API.autoTableHtmlToJson=function(e,r){var a;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var n=new ih(this),s=vk(n,e,window,r,!1),l=s.head,c=s.body,f=((a=l[0])===null||a===void 0?void 0:a.map(function(d){return d.content}))||[];return{columns:f,rows:c,data:c}}}var Gv;function Kd(t,e){var r=xk(t,e),a=bk(t,r);wk(t,a)}try{if(typeof window<"u"&&window){var qS=window,zS=qS.jsPDF||((Gv=qS.jspdf)===null||Gv===void 0?void 0:Gv.jsPDF);zS&&BH(zS)}}catch(t){console.error("Could not apply autoTable plugin",t)}const HS=t=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:[30,41,59]},UH=t=>new Promise(e=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{const a=document.createElement("canvas");a.width=r.width,a.height=r.height,a.getContext("2d").drawImage(r,0,0),e(a.toDataURL("image/png"))},r.onerror=()=>e(null),r.src=t});function qH({project:t,company:e,onShowToast:r}){const{branding:a}=hh(),[n,s]=ee.useState([]),[l,c]=ee.useState(!0),[f,d]=ee.useState("all"),[m,v]=ee.useState(null),[x,g]=ee.useState(new Set),[b,_]=ee.useState("recent"),[w,E]=ee.useState(new Set),[C,A]=ee.useState({start:"",end:""}),[T,G]=ee.useState(!1),[W,B]=ee.useState(null),[q,L]=ee.useState(""),[J,D]=ee.useState(!1),[O,M]=ee.useState(null);ee.useEffect(()=>{V()},[t.id]);const V=async()=>{try{const Se=await ot.getTMTickets(t.id);s(Se)}catch(Se){console.error("Error loading tickets:",Se),r("Error loading T&M tickets","error")}finally{c(!1)}},ie=async(Se,ve)=>{try{await ot.updateTMTicketStatus(Se,ve),s(n.map(Ie=>Ie.id===Se?{...Ie,status:ve}:Ie)),r(`Ticket ${ve}`,"success")}catch(Ie){console.error("Error updating status:",Ie),r("Error updating status","error")}},X=Se=>{Se.ce_pco_number?(B(Se),L(""),G(!0)):ie(Se.id,"approved")},Z=async()=>{if(W)try{const Se=parseFloat(q)||0;await ot.approveTMTicket(W.id,null,null,Se),s(n.map(ve=>ve.id===W.id?{...ve,status:"approved",change_order_value:Se}:ve)),r(`Ticket approved with $${Se.toLocaleString()} change order`,"success"),G(!1),B(null),L("")}catch(Se){console.error("Error approving ticket:",Se),r("Error approving ticket","error")}},K=async Se=>{if(confirm("Delete this T&M ticket?"))try{await ot.deleteTMTicket(Se),s(n.filter(ve=>ve.id!==Se)),r("Ticket deleted","success")}catch(ve){console.error("Error deleting ticket:",ve),r("Error deleting ticket","error")}},ae=Se=>{let ve=0;return Se.t_and_m_items&&Se.t_and_m_items.forEach(Ie=>{Ie.materials_equipment?.cost_per_unit&&(ve+=Ie.quantity*Ie.materials_equipment.cost_per_unit)}),ve},fe=Se=>Se.t_and_m_workers?Se.t_and_m_workers.reduce((ve,Ie)=>{const wt=parseFloat(Ie.hours)||0,Xe=parseFloat(Ie.overtime_hours)||0;return ve+wt+Xe},0):0,U=Se=>new Date(Se).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),j=(Se,ve)=>{ve.stopPropagation(),g(Ie=>{const wt=new Set(Ie);return wt.has(Se)?wt.delete(Se):wt.add(Se),wt})},F=()=>{const Se=f==="all"?n:n.filter(Ie=>Ie.status===f),ve=Se.every(Ie=>x.has(Ie.id));g(ve?new Set:new Set(Se.map(Ie=>Ie.id)))},I=()=>{g(new Set)},z=()=>{const Se=f==="all"?n:n.filter(ve=>ve.status===f);return x.size>0?Se.filter(ve=>x.has(ve.id)):Se},ne=()=>{const Se=z();if(Se.length===0){r("No tickets to export","error");return}const ve=[],Ie=[],wt=[];Se.forEach(Lt=>{const Vt=U(Lt.work_date),$t=Lt.status;Lt.t_and_m_workers&&Lt.t_and_m_workers.forEach(Wt=>{const Ot=parseFloat(Wt.hours)||0,kt=parseFloat(Wt.overtime_hours)||0;ve.push({Date:Vt,Status:$t,"Worker Name":Wt.name,Role:Wt.role||"Laborer","Regular Hours":Ot,"OT Hours":kt,"Total Hours":Ot+kt})}),Lt.t_and_m_items&&Lt.t_and_m_items.forEach(Wt=>{const Ot=Wt.custom_name||Wt.materials_equipment?.name||"Unknown",kt=Wt.custom_category||Wt.materials_equipment?.category||"Unknown",qe=Wt.materials_equipment?.unit||"each",Ye=Wt.materials_equipment?.cost_per_unit||0,Pt=Wt.quantity*Ye;Ie.push({Date:Vt,Status:$t,Category:kt,Item:Ot,Quantity:Wt.quantity,Unit:qe,"Cost/Unit":Ye,Total:Pt})}),wt.push({Date:Vt,Status:$t,Workers:Lt.t_and_m_workers?.length||0,"Total Hours":fe(Lt),Items:Lt.t_and_m_items?.length||0,"Materials Cost":ae(Lt),Notes:Lt.notes||""})});const Xe=lu.book_new(),ct=lu.json_to_sheet(wt);if(lu.book_append_sheet(Xe,ct,"Summary"),ve.length>0){const Lt=lu.json_to_sheet(ve);lu.book_append_sheet(Xe,Lt,"Workers")}if(Ie.length>0){const Lt=lu.json_to_sheet(Ie);lu.book_append_sheet(Xe,Lt,"Materials & Equipment")}const jt=`${t.name}_TM_${new Date().toISOString().split("T")[0]}.xlsx`;rU(Xe,jt),r("Export downloaded!","success")},se=async()=>{const Se=z();if(Se.length===0){r("No tickets to export","error");return}r("Generating PDF...","info");const ve=new lr,Ie=ve.internal.pageSize.getWidth(),wt=ve.internal.pageSize.getHeight(),Xe=20;let ct=Xe;const jt=HS(a?.primary_color||"#3B82F6"),Lt=HS(a?.secondary_color||"#1E40AF");ve.setFillColor(...jt),ve.rect(0,0,Ie,45,"F"),ve.setFillColor(...Lt),ve.rect(0,42,Ie,3,"F");let Vt=Xe;if(a?.logo_url)try{const qt=await UH(a.logo_url);qt&&(ve.addImage(qt,"PNG",Xe,7,30,30),Vt=Xe+30+10)}catch(qt){console.error("Error adding logo:",qt)}ve.setTextColor(255,255,255),ve.setFontSize(22),ve.setFont("helvetica","bold"),ve.text(e?.name||"Company Name",Vt,20),ve.setFontSize(10),ve.setFont("helvetica","normal"),ve.text("TIME & MATERIALS REPORT",Vt,30),ve.setFontSize(9),ve.text(`Report Date: ${new Date().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})}`,Ie-Xe,18,{align:"right"}),t.job_number&&ve.text(`Job #: ${t.job_number}`,Ie-Xe,26,{align:"right"}),ve.text(`Status: ${f.charAt(0).toUpperCase()+f.slice(1)}`,Ie-Xe,34,{align:"right"}),ct=55,ve.setFillColor(248,250,252),ve.rect(Xe,ct-5,Ie-Xe*2,30,"F"),ve.setDrawColor(...jt),ve.setLineWidth(.5),ve.rect(Xe,ct-5,Ie-Xe*2,30,"S"),ve.setTextColor(...jt),ve.setFontSize(14),ve.setFont("helvetica","bold"),ve.text(`Project: ${t.name}`,Xe+5,ct+7),ve.setFontSize(10),ve.setFont("helvetica","normal"),ve.setTextColor(51,65,85);const $t=Se.map(qt=>new Date(qt.work_date)).sort((qt,Kt)=>qt-Kt),Wt=$t[0]?.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),Ot=$t[$t.length-1]?.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});ve.text(`Date Range: ${Wt} - ${Ot}`,Xe+5,ct+17),ve.text(`Total Tickets: ${Se.length}`,Ie-Xe-5,ct+7,{align:"right"}),ct+=40;const kt=Se.reduce((qt,Kt)=>qt+fe(Kt),0),qe=Se.reduce((qt,Kt)=>qt+ae(Kt),0),Ye=new Set(Se.flatMap(qt=>qt.t_and_m_workers?.map(Kt=>Kt.name)||[])).size;ve.setTextColor(...jt),ve.setFontSize(12),ve.setFont("helvetica","bold"),ve.text("SUMMARY",Xe,ct),ct+=8;const Pt=(Ie-Xe*2-20)/3,Et=[{label:"Total Labor Hours",value:kt.toFixed(1)},{label:"Unique Workers",value:Ye.toString()},{label:"Materials Cost",value:`$${qe.toFixed(2)}`}],Dt=jt.map(qt=>Math.min(255,qt+180));Et.forEach((qt,Kt)=>{const re=Xe+Kt*(Pt+10);ve.setFillColor(...Dt),ve.rect(re,ct,Pt,25,"F"),ve.setDrawColor(...jt),ve.setLineWidth(.5),ve.rect(re,ct,Pt,25,"S"),ve.setTextColor(...jt),ve.setFontSize(16),ve.setFont("helvetica","bold"),ve.text(qt.value,re+Pt/2,ct+12,{align:"center"}),ve.setTextColor(100,116,139),ve.setFontSize(8),ve.setFont("helvetica","normal"),ve.text(qt.label,re+Pt/2,ct+20,{align:"center"})}),ct+=35;const Ce=[],$e=[],xe=[];let Be=0,Pe=0,Ct=0,gt=0,Rt=0,It=0;Se.forEach(qt=>{qt.t_and_m_workers&&qt.t_and_m_workers.forEach(Kt=>{const re=parseFloat(Kt.hours)||0,Ne=parseFloat(Kt.overtime_hours)||0,me=Kt.role||"Laborer",ge=[U(qt.work_date),Kt.name,re.toString(),Ne>0?Ne.toString():"-",(re+Ne).toString()];me==="Foreman"||me==="Superintendent"?(Ce.push(ge),Be+=re,Pe+=Ne):me==="Operator"?($e.push(ge),Ct+=re,gt+=Ne):(xe.push(ge),Rt+=re,It+=Ne)})});const pr=(qt,Kt,re,Ne)=>{Kt.length!==0&&(ct>wt-80&&(ve.addPage(),ct=Xe),ve.setTextColor(...jt),ve.setFontSize(11),ve.setFont("helvetica","bold"),ve.text(qt,Xe,ct),ct+=5,Kd(ve,{startY:ct,head:[["Date","Name","Reg Hrs","OT Hrs","Total"]],body:Kt,margin:{left:Xe,right:Xe},headStyles:{fillColor:jt,textColor:[255,255,255],fontStyle:"bold",fontSize:9},bodyStyles:{fontSize:9,textColor:[51,65,85]},alternateRowStyles:{fillColor:[248,250,252]},columnStyles:{0:{cellWidth:30},2:{halign:"center",cellWidth:22},3:{halign:"center",cellWidth:22},4:{halign:"center",cellWidth:22}},foot:[["","SUBTOTAL:",re.toString(),Ne>0?Ne.toString():"-",(re+Ne).toString()]],footStyles:{fillColor:Lt,textColor:[255,255,255],fontStyle:"bold",fontSize:9}}),ct=ve.lastAutoTable.finalY+10)};if(Ce.length>0||$e.length>0||xe.length>0){ve.setTextColor(...jt),ve.setFontSize(12),ve.setFont("helvetica","bold"),ve.text("LABOR",Xe,ct),ct+=8,pr("SUPERVISION",Ce,Be,Pe),pr("OPERATORS",$e,Ct,gt),pr("LABORERS",xe,Rt,It);const qt=Be+Ct+Rt,Kt=Pe+gt+It;ve.setFillColor(...jt),ve.rect(Xe,ct,Ie-Xe*2,12,"F"),ve.setTextColor(255,255,255),ve.setFontSize(10),ve.setFont("helvetica","bold"),ve.text("LABOR TOTAL:",Xe+5,ct+8),ve.text(`${qt} Reg + ${Kt} OT = ${qt+Kt} Hours`,Ie-Xe-5,ct+8,{align:"right"}),ct+=20}ct>wt-100&&(ve.addPage(),ct=Xe);const sa={},fa={},Nt=["Containment","PPE","Disposal","Equipment","Other"];Se.forEach(qt=>{qt.t_and_m_items&&qt.t_and_m_items.forEach(Kt=>{const re=Kt.custom_name||Kt.materials_equipment?.name||"Unknown",Ne=Kt.custom_category||Kt.materials_equipment?.category||"Other",me=Kt.materials_equipment?.unit||"each",ge=Kt.materials_equipment?.cost_per_unit||0,we=Kt.quantity*ge;sa[Ne]||(sa[Ne]=[],fa[Ne]=0),sa[Ne].push([U(qt.work_date),re,Kt.quantity.toString(),me,`$${ge.toFixed(2)}`,`$${we.toFixed(2)}`]),fa[Ne]+=we})});const Ea=(qt,Kt,re)=>{!Kt||Kt.length===0||(ct>wt-80&&(ve.addPage(),ct=Xe),ve.setTextColor(...jt),ve.setFontSize(11),ve.setFont("helvetica","bold"),ve.text(qt.toUpperCase(),Xe,ct),ct+=5,Kd(ve,{startY:ct,head:[["Date","Item","Qty","Unit","Rate","Total"]],body:Kt,margin:{left:Xe,right:Xe},headStyles:{fillColor:jt,textColor:[255,255,255],fontStyle:"bold",fontSize:9},bodyStyles:{fontSize:9,textColor:[51,65,85]},alternateRowStyles:{fillColor:[248,250,252]},columnStyles:{2:{halign:"center",cellWidth:20},3:{halign:"center",cellWidth:25},4:{halign:"right",cellWidth:25},5:{halign:"right",cellWidth:30}},foot:[["","","","","Subtotal:",`$${re.toFixed(2)}`]],footStyles:{fillColor:Lt,textColor:[255,255,255],fontStyle:"bold",fontSize:9}}),ct=ve.lastAutoTable.finalY+10)};Object.keys(sa).length>0&&(ve.setTextColor(...jt),ve.setFontSize(12),ve.setFont("helvetica","bold"),ve.text("MATERIALS & EQUIPMENT",Xe,ct),ct+=8,Nt.forEach(qt=>{sa[qt]&&Ea(qt,sa[qt],fa[qt])}),Object.keys(sa).forEach(qt=>{Nt.includes(qt)||Ea(qt,sa[qt],fa[qt])}),ve.setFillColor(...jt),ve.rect(Xe,ct,Ie-Xe*2,12,"F"),ve.setTextColor(255,255,255),ve.setFontSize(10),ve.setFont("helvetica","bold"),ve.text("MATERIALS TOTAL:",Xe+5,ct+8),ve.text(`$${qe.toFixed(2)}`,Ie-Xe-5,ct+8,{align:"right"}),ct+=20),ct>wt-80&&(ve.addPage(),ct=Xe),ct+=10,ve.setDrawColor(...jt),ve.setLineWidth(1),ve.line(Xe,ct,Ie-Xe,ct),ct+=15,ve.setTextColor(...jt),ve.setFontSize(12),ve.setFont("helvetica","bold"),ve.text("AUTHORIZATION",Xe,ct),ct+=10,ve.setFontSize(10),ve.setFont("helvetica","normal"),ve.setTextColor(71,85,105),ve.text("I hereby authorize the above time and materials charges as accurate and approved for billing.",Xe,ct),ct+=20;const ya=ticketsToExport[0]||{},vn=(qt,Kt,re,Ne,me,ge,we)=>{ve.setFont("helvetica","bold"),ve.setFontSize(8),ve.setTextColor(...jt),ve.text(Kt,Xe,qt),ve.setFont("helvetica","normal"),ve.setFontSize(9),ve.setTextColor(100,116,139);const je=qt+18;if(ve.setDrawColor(...Lt),ve.setLineWidth(.5),ve.line(Xe,je,Xe+70,je),ve.text("Signature",Xe,je+8),ve.line(Xe+85,je,Xe+145,je),ve.text("Title / Company",Xe+85,je+8),ve.line(Ie-Xe-40,je,Ie-Xe,je),ve.text("Date",Ie-Xe-40,je+8),re)try{if(ve.addImage(re,"PNG",Xe,je-16,60,16),Ne&&(ve.setFontSize(8),ve.text(Ne,Xe,je+15)),me||ge){const We=[me,ge].filter(Boolean).join(" - ");ve.text(We,Xe+85,je-5)}if(we){const We=new Date(we).toLocaleDateString();ve.text(We,Ie-Xe-40,je-5)}}catch(We){console.error("Error adding signature to PDF:",We)}return je+25};ct=vn(ct,"GC AUTHORIZATION",ya.gc_signature_data,ya.gc_signature_name,ya.gc_signature_title,ya.gc_signature_company,ya.gc_signature_date),ct+=8,ct=vn(ct,"CLIENT AUTHORIZATION",ya.client_signature_data,ya.client_signature_name,ya.client_signature_title,ya.client_signature_company,ya.client_signature_date);const Da=ve.internal.getNumberOfPages();for(let qt=1;qt<=Da;qt++){ve.setPage(qt);const Kt=wt-15;ve.setFontSize(8),ve.setTextColor(148,163,184),ve.text(`${e?.name||"Company"} - T&M Report - ${t.name}`,Xe,Kt),ve.text(`Page ${qt} of ${Da}`,Ie-Xe,Kt,{align:"right"})}const an=`${t.name}_TM_Report_${new Date().toISOString().split("T")[0]}.pdf`;ve.save(an),r("PDF exported!","success")},pe=ee.useMemo(()=>{let Se=f==="all"?[...n]:n.filter(ve=>ve.status===f);if(C.start){const ve=new Date(C.start);ve.setHours(0,0,0,0),Se=Se.filter(Ie=>new Date(Ie.work_date)>=ve)}if(C.end){const ve=new Date(C.end);ve.setHours(23,59,59,999),Se=Se.filter(Ie=>new Date(Ie.work_date)<=ve)}if(b==="recent"){const ve=new Date;ve.setDate(ve.getDate()-7),ve.setHours(0,0,0,0),Se=Se.filter(Ie=>new Date(Ie.work_date)>=ve)}return Se},[n,f,b,C]),ye=ee.useMemo(()=>{if(b!=="all")return null;const Se={};return pe.forEach(ve=>{const Ie=new Date(ve.work_date),wt=`${Ie.getFullYear()}-${String(Ie.getMonth()+1).padStart(2,"0")}`,Xe=Ie.toLocaleDateString("en-US",{month:"long",year:"numeric"});Se[wt]||(Se[wt]={label:Xe,tickets:[],hours:0,cost:0}),Se[wt].tickets.push(ve),Se[wt].hours+=fe(ve),Se[wt].cost+=ae(ve)}),Object.entries(Se).sort((ve,Ie)=>Ie[0].localeCompare(ve[0]))},[pe,b]);ee.useEffect(()=>{if(ye&&ye.length>0){const Se=ye[0][0];E(new Set([Se]))}},[ye]);const _e=Se=>{const ve=new Set(w);ve.has(Se)?ve.delete(Se):ve.add(Se),E(ve)},Le=pe.reduce((Se,ve)=>Se+fe(ve),0),ue=pe.reduce((Se,ve)=>Se+ae(ve),0),at=f==="all"?n.length:n.filter(Se=>Se.status===f).length;if(l)return o.jsx("div",{className:"loading",children:"Loading T&M tickets..."});const ht=pe.length>0&&pe.every(Se=>x.has(Se.id)),de=x.size>0,it=Se=>o.jsxs("div",{className:`tm-ticket-card ${Se.status} ${x.has(Se.id)?"selected":""}`,children:[o.jsxs("div",{className:"tm-ticket-header",onClick:()=>v(m===Se.id?null:Se.id),children:[o.jsx("input",{type:"checkbox",checked:x.has(Se.id),onChange:ve=>j(Se.id,ve),onClick:ve=>ve.stopPropagation(),className:"tm-checkbox"}),o.jsxs("div",{className:"tm-ticket-info",children:[o.jsx("span",{className:"tm-ticket-date",children:U(Se.work_date)}),Se.ce_pco_number&&o.jsx("span",{className:"tm-ce-badge",children:Se.ce_pco_number}),o.jsx("span",{className:`tm-ticket-status ${Se.status}`,children:Se.status})]}),o.jsxs("div",{className:"tm-ticket-summary",children:[o.jsxs("span",{className:"tm-ticket-hours",children:[fe(Se)," hrs"]}),o.jsxs("span",{className:"tm-ticket-total",children:["$",ae(Se).toFixed(2)]}),o.jsx("span",{className:"tm-expand-arrow",children:m===Se.id?"":""})]})]}),m===Se.id&&o.jsxs("div",{className:"tm-ticket-details",children:[Se.t_and_m_workers?.length>0&&o.jsxs("div",{className:"tm-detail-section",children:[o.jsxs("h4",{children:[o.jsx(Ys,{size:16,className:"inline-icon"})," Workers"]}),o.jsx("div",{className:"tm-detail-list",children:Se.t_and_m_workers.map(ve=>o.jsxs("div",{className:"tm-detail-row",children:[o.jsxs("span",{children:[ve.role&&ve.role!=="Laborer"&&o.jsx("span",{className:"tm-role-badge",children:ve.role}),ve.name]}),o.jsxs("span",{children:[ve.hours," hrs",parseFloat(ve.overtime_hours)>0&&o.jsxs("span",{className:"tm-ot-badge",children:[" +",ve.overtime_hours," OT"]})]})]},ve.id))})]}),Se.t_and_m_items?.length>0&&o.jsxs("div",{className:"tm-detail-section",children:[o.jsxs("h4",{children:[o.jsx(Q0,{size:16,className:"inline-icon"})," Materials & Equipment"]}),o.jsx("div",{className:"tm-detail-list",children:Se.t_and_m_items.map(ve=>o.jsxs("div",{className:"tm-detail-row",children:[o.jsx("span",{children:ve.custom_name?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"tm-custom-badge",children:"Custom"})," ",ve.custom_name]}):ve.materials_equipment?.name}),o.jsxs("span",{className:"tm-detail-qty",children:[ve.quantity," ",ve.materials_equipment?.unit||"each",ve.materials_equipment?.cost_per_unit>0&&o.jsxs("span",{className:"tm-item-cost",children:["$",(ve.quantity*ve.materials_equipment.cost_per_unit).toFixed(2)]})]})]},ve.id))})]}),Se.notes&&o.jsxs("div",{className:"tm-detail-section",children:[o.jsxs("h4",{children:[o.jsx(El,{size:16,className:"inline-icon"})," Description"]}),o.jsx("p",{className:"tm-notes-text",children:Se.notes})]}),Se.photos&&Se.photos.length>0&&o.jsxs("div",{className:"tm-detail-section",children:[o.jsxs("h4",{children:[o.jsx(Mp,{size:16,className:"inline-icon"})," Photos (",Se.photos.length,")"]}),o.jsx("div",{className:"tm-photos-grid",children:Se.photos.map((ve,Ie)=>o.jsx("a",{href:ve,target:"_blank",rel:"noopener noreferrer",className:"tm-photo-thumb",children:o.jsx("img",{src:ve,alt:`Photo ${Ie+1}`})},Ie))})]}),Se.ce_pco_number&&Se.change_order_value>0&&o.jsxs("div",{className:"tm-change-order-value",children:[o.jsx("span",{className:"tm-co-label",children:"Change Order Value:"}),o.jsxs("span",{className:"tm-co-amount",children:["$",Se.change_order_value.toLocaleString()]})]}),o.jsxs("div",{className:"tm-ticket-actions",children:[Se.status==="pending"&&o.jsxs(o.Fragment,{children:[o.jsxs("button",{className:"btn btn-success btn-small",onClick:ve=>{ve.stopPropagation(),X(Se)},children:["Approve ",Se.ce_pco_number?"+ CO":""]}),o.jsx("button",{className:"btn btn-warning btn-small",onClick:ve=>{ve.stopPropagation(),ie(Se.id,"rejected")},children:"Reject"})]}),Se.status==="approved"&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"btn btn-primary btn-small",onClick:ve=>{ve.stopPropagation(),ie(Se.id,"billed")},children:"Mark Billed"}),o.jsxs("button",{className:"btn btn-secondary btn-small",onClick:ve=>{ve.stopPropagation(),M(Se),D(!0)},children:[o.jsx(i2,{size:14})," Signature Link"]})]}),Se.status==="rejected"&&o.jsx("button",{className:"btn btn-secondary btn-small",onClick:ve=>{ve.stopPropagation(),ie(Se.id,"pending")},children:"Restore"}),o.jsx("button",{className:"btn btn-danger btn-small",onClick:ve=>{ve.stopPropagation(),K(Se.id)},children:"Delete"})]})]})]},Se.id);return o.jsxs("div",{className:"tm-list",children:[o.jsxs("div",{className:"tm-list-header",children:[o.jsxs("div",{className:"tm-list-title",children:[o.jsx("h3",{children:"T&M Tickets"}),o.jsxs("div",{className:"tm-export-buttons",children:[de&&o.jsxs("button",{className:"btn btn-ghost btn-small",onClick:I,children:["Clear (",x.size,")"]}),o.jsxs("button",{className:"btn btn-secondary btn-small",onClick:ne,children:["Excel ",de?`(${x.size})`:""]}),o.jsxs("button",{className:"btn btn-primary btn-small",onClick:se,children:["PDF ",de?`(${x.size})`:""]})]})]}),o.jsx("div",{className:"tm-filter-tabs",children:["all","pending","approved","billed","rejected"].map(Se=>o.jsxs("button",{className:`tm-filter-tab ${f===Se?"active":""}`,onClick:()=>{d(Se),I()},children:[Se.charAt(0).toUpperCase()+Se.slice(1),o.jsx("span",{className:"tm-filter-count",children:Se==="all"?n.length:n.filter(ve=>ve.status===Se).length})]},Se))}),o.jsxs("div",{className:"view-mode-bar",children:[o.jsxs("div",{className:"view-mode-tabs",children:[o.jsx("button",{className:`view-mode-tab ${b==="recent"?"active":""}`,onClick:()=>{_("recent"),A({start:"",end:""})},children:"Recent (7 days)"}),o.jsxs("button",{className:`view-mode-tab ${b==="all"?"active":""}`,onClick:()=>_("all"),children:["All (",at,")"]})]}),b==="all"&&o.jsxs("div",{className:"date-filter",children:[o.jsx(J0,{size:16}),o.jsx("input",{type:"date",value:C.start,onChange:Se=>A(ve=>({...ve,start:Se.target.value})),placeholder:"Start date"}),o.jsx("span",{children:"to"}),o.jsx("input",{type:"date",value:C.end,onChange:Se=>A(ve=>({...ve,end:Se.target.value})),placeholder:"End date"}),(C.start||C.end)&&o.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>A({start:"",end:""}),children:"Clear"})]})]})]}),pe.length>0&&o.jsxs("div",{className:"tm-summary-bar",children:[o.jsxs("div",{className:"tm-summary-stat",children:[o.jsx("span",{className:"tm-summary-label",children:"Tickets"}),o.jsx("span",{className:"tm-summary-value",children:pe.length})]}),o.jsxs("div",{className:"tm-summary-stat",children:[o.jsx("span",{className:"tm-summary-label",children:"Total Hours"}),o.jsx("span",{className:"tm-summary-value",children:Le.toFixed(1)})]}),o.jsxs("div",{className:"tm-summary-stat",children:[o.jsx("span",{className:"tm-summary-label",children:"Materials Cost"}),o.jsxs("span",{className:"tm-summary-value",children:["$",ue.toFixed(2)]})]})]}),pe.length===0?o.jsxs("div",{className:"tm-empty-state",children:[o.jsxs("p",{children:["No ",f==="all"?"":f," T&M tickets",b==="recent"?" in the last 7 days":""]}),b==="recent"&&at>0&&o.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>_("all"),children:"View All Tickets"})]}):o.jsxs("div",{className:"tm-tickets",children:[o.jsx("div",{className:"tm-select-all-row",children:o.jsxs("label",{className:"tm-checkbox-label",onClick:F,children:[o.jsx("input",{type:"checkbox",checked:ht,onChange:F,className:"tm-checkbox"}),o.jsxs("span",{children:["Select All (",pe.length,")"]})]})}),b==="all"&&ye?ye.map(([Se,ve])=>o.jsxs("div",{className:"month-group",children:[o.jsxs("div",{className:"month-header",onClick:()=>_e(Se),children:[o.jsxs("div",{className:"month-header-left",children:[w.has(Se)?o.jsx(xc,{size:18}):o.jsx(Of,{size:18}),o.jsx("span",{className:"month-label",children:ve.label}),o.jsxs("span",{className:"month-count",children:[ve.tickets.length," tickets"]})]}),o.jsxs("div",{className:"month-header-right",children:[o.jsxs("span",{className:"month-stat",children:[ve.hours.toFixed(1)," hrs"]}),o.jsxs("span",{className:"month-stat",children:["$",ve.cost.toFixed(2)]})]})]}),w.has(Se)&&o.jsx("div",{className:"month-tickets",children:ve.tickets.map(Ie=>it(Ie))})]},Se)):pe.map(Se=>it(Se))]}),T&&W&&o.jsx("div",{className:"modal-overlay",onClick:()=>G(!1),children:o.jsxs("div",{className:"modal change-order-modal",onClick:Se=>Se.stopPropagation(),children:[o.jsx("h3",{children:"Approve Change Order Work"}),o.jsxs("p",{className:"modal-subtitle",children:["This T&M ticket is associated with ",o.jsx("strong",{children:W.ce_pco_number})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Change Order Value ($)"}),o.jsx("input",{type:"number",value:q,onChange:Se=>L(Se.target.value),placeholder:"Enter the change order amount",autoFocus:!0}),o.jsx("p",{className:"form-help",children:"This amount will be added to the project's total contract value."})]}),o.jsxs("div",{className:"modal-actions",children:[o.jsx("button",{className:"btn btn-secondary",onClick:()=>G(!1),children:"Cancel"}),o.jsxs("button",{className:"btn btn-success",onClick:Z,children:["Approve with $",parseFloat(q||0).toLocaleString()]})]})]})}),J&&O&&o.jsx(cN,{documentType:"tm_ticket",documentId:O.id,companyId:e?.id,projectId:t?.id,documentTitle:`T&M Ticket - ${new Date(O.work_date).toLocaleDateString()}${O.ce_pco_number?` (${O.ce_pco_number})`:""}`,onClose:()=>{D(!1),M(null)},onShowToast:r})]})}function zH({project:t,onClose:e,onShareCreated:r}){const{user:a}=oN(),[n,s]=ee.useState(!1),[l,c]=ee.useState(null),[f,d]=ee.useState([]),[m,v]=ee.useState(!1),[x,g]=ee.useState({progress:!0,photos:!0,daily_reports:!0,tm_tickets:!1,crew_info:!1}),[b,_]=ee.useState("never"),[w,E]=ee.useState("");ee.useEffect(()=>{C()},[t.id]);const C=async()=>{try{const O=await ot.getProjectShares(t.id);d(O)}catch(O){console.error("Error loading shares:",O)}},A=O=>{g(M=>({...M,[O]:!M[O]}))},T=()=>{if(b==="never")return null;const O=new Date;if(b==="30days")O.setDate(O.getDate()+30);else if(b==="90days")O.setDate(O.getDate()+90);else if(b==="custom"&&w)return new Date(w).toISOString();return O.toISOString()},G=async()=>{s(!0);try{const O=T(),M=await ot.createProjectShare(t.id,a.id,x,O);c({type:"success",message:"Share link created!"}),v(!1),C(),r&&r(M)}catch(O){console.error("Error creating share:",O),c({type:"error",message:"Failed to create share link"})}finally{s(!1)}},W=O=>{const M=`${window.location.origin}/view/${O}`;navigator.clipboard.writeText(M),c({type:"success",message:"Link copied to clipboard!"})},B=async O=>{if(confirm("Are you sure you want to revoke this share link?"))try{await ot.revokeProjectShare(O),c({type:"success",message:"Share link revoked"}),C()}catch(M){console.error("Error revoking share:",M),c({type:"error",message:"Failed to revoke share link"})}},q=async O=>{if(confirm("Are you sure you want to permanently delete this share link?"))try{await ot.deleteProjectShare(O),c({type:"success",message:"Share link deleted"}),C()}catch(M){console.error("Error deleting share:",M),c({type:"error",message:"Failed to delete share link"})}},L=O=>O?new Date(O).toLocaleDateString():"Never",J=O=>O?new Date(O)<new Date:!1,D=O=>{const M=[];return O.progress&&M.push("Progress"),O.photos&&M.push("Photos"),O.daily_reports&&M.push("Reports"),O.tm_tickets&&M.push("T&M"),O.crew_info&&M.push("Crew"),M.join(", ")};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"modal-overlay",onClick:e,children:o.jsxs("div",{className:"modal-content share-modal",onClick:O=>O.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsxs("h2",{children:["Share Project: ",t.name]}),o.jsx("button",{className:"close-btn",onClick:e,children:""})]}),o.jsxs("div",{className:"modal-body",children:[f.length>0&&o.jsxs("div",{className:"existing-shares",children:[o.jsx("h3",{children:"Active Share Links"}),o.jsx("div",{className:"shares-list",children:f.map(O=>o.jsxs("div",{className:`share-item ${!O.is_active||J(O.expires_at)?"inactive":""}`,children:[o.jsxs("div",{className:"share-info",children:[o.jsxs("div",{className:"share-token",children:[o.jsxs("code",{children:[window.location.origin,"/view/",O.share_token]}),o.jsx("button",{className:"btn-small",onClick:()=>W(O.share_token),disabled:!O.is_active||J(O.expires_at),children:"Copy"})]}),o.jsxs("div",{className:"share-meta",children:[o.jsx("span",{className:"permissions",children:D(O.permissions)}),o.jsxs("span",{className:"expiry",children:["Expires: ",L(O.expires_at)]}),o.jsxs("span",{className:"views",children:["Views: ",O.view_count||0,O.last_viewed_at&&` (Last: ${L(O.last_viewed_at)})`]})]}),!O.is_active&&o.jsx("div",{className:"status-badge revoked",children:"Revoked"}),J(O.expires_at)&&O.is_active&&o.jsx("div",{className:"status-badge expired",children:"Expired"})]}),o.jsxs("div",{className:"share-actions",children:[O.is_active&&!J(O.expires_at)&&o.jsx("button",{className:"btn-secondary",onClick:()=>B(O.id),children:"Revoke"}),o.jsx("button",{className:"btn-danger",onClick:()=>q(O.id),children:"Delete"})]})]},O.id))})]}),!m&&o.jsx("button",{className:"btn-primary",onClick:()=>v(!0),children:"+ Create New Share Link"}),m&&o.jsxs("div",{className:"new-share-form",children:[o.jsx("h3",{children:"Create New Share Link"}),o.jsxs("div",{className:"form-section",children:[o.jsx("label",{children:"Permissions"}),o.jsxs("div",{className:"checkbox-group",children:[o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:x.progress,onChange:()=>A("progress")}),"Progress/completion status"]}),o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:x.photos,onChange:()=>A("photos")}),"Photos feed"]}),o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:x.daily_reports,onChange:()=>A("daily_reports")}),"Daily reports"]}),o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:x.tm_tickets,onChange:()=>A("tm_tickets")}),"T&M tickets"]}),o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:x.crew_info,onChange:()=>A("crew_info")}),"Crew information"]})]})]}),o.jsxs("div",{className:"form-section",children:[o.jsx("label",{children:"Link Expiration"}),o.jsxs("div",{className:"radio-group",children:[o.jsxs("label",{children:[o.jsx("input",{type:"radio",value:"never",checked:b==="never",onChange:O=>_(O.target.value)}),"Never expires"]}),o.jsxs("label",{children:[o.jsx("input",{type:"radio",value:"30days",checked:b==="30days",onChange:O=>_(O.target.value)}),"30 days"]}),o.jsxs("label",{children:[o.jsx("input",{type:"radio",value:"90days",checked:b==="90days",onChange:O=>_(O.target.value)}),"90 days"]}),o.jsxs("label",{children:[o.jsx("input",{type:"radio",value:"custom",checked:b==="custom",onChange:O=>_(O.target.value)}),"Custom date"]})]}),b==="custom"&&o.jsx("input",{type:"date",value:w,onChange:O=>E(O.target.value),min:new Date().toISOString().split("T")[0],className:"date-input"})]}),o.jsxs("div",{className:"form-actions",children:[o.jsx("button",{className:"btn-secondary",onClick:()=>v(!1),children:"Cancel"}),o.jsx("button",{className:"btn-primary",onClick:G,disabled:n,children:n?"Generating...":"Generate Share Link"})]})]})]})]})}),l&&o.jsx(du,{message:l.message,type:l.type,onClose:()=>c(null)}),o.jsx("style",{children:`
        .share-modal {
          max-width: 700px;
          max-height: 80vh;
          overflow-y: auto;
        }

        .modal-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 1.5rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .modal-header h2 {
          margin: 0;
          font-size: 1.25rem;
        }

        .close-btn {
          background: none;
          border: none;
          font-size: 2rem;
          cursor: pointer;
          color: #6b7280;
          padding: 0;
          width: 2rem;
          height: 2rem;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .close-btn:hover {
          color: #111827;
        }

        .modal-body {
          padding: 1.5rem;
        }

        .existing-shares {
          margin-bottom: 2rem;
        }

        .existing-shares h3 {
          margin-top: 0;
          margin-bottom: 1rem;
          font-size: 1.1rem;
        }

        .shares-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .share-item {
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 1rem;
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          gap: 1rem;
        }

        .share-item.inactive {
          opacity: 0.6;
          background-color: #f9fafb;
        }

        .share-info {
          flex: 1;
        }

        .share-token {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          margin-bottom: 0.5rem;
        }

        .share-token code {
          background-color: #f3f4f6;
          padding: 0.25rem 0.5rem;
          border-radius: 4px;
          font-size: 0.875rem;
          flex: 1;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }

        .share-meta {
          display: flex;
          flex-wrap: wrap;
          gap: 1rem;
          font-size: 0.875rem;
          color: #6b7280;
        }

        .status-badge {
          display: inline-block;
          padding: 0.25rem 0.5rem;
          border-radius: 4px;
          font-size: 0.75rem;
          font-weight: 500;
          margin-top: 0.5rem;
        }

        .status-badge.revoked {
          background-color: #fee2e2;
          color: #991b1b;
        }

        .status-badge.expired {
          background-color: #fef3c7;
          color: #92400e;
        }

        .share-actions {
          display: flex;
          gap: 0.5rem;
          flex-shrink: 0;
        }

        .new-share-form {
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 1.5rem;
          background-color: #f9fafb;
        }

        .new-share-form h3 {
          margin-top: 0;
          margin-bottom: 1.5rem;
          font-size: 1.1rem;
        }

        .form-section {
          margin-bottom: 1.5rem;
        }

        .form-section label {
          display: block;
          font-weight: 500;
          margin-bottom: 0.5rem;
        }

        .checkbox-group,
        .radio-group {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .checkbox-group label,
        .radio-group label {
          font-weight: normal;
          display: flex;
          align-items: center;
          gap: 0.5rem;
        }

        .checkbox-group input[type="checkbox"],
        .radio-group input[type="radio"] {
          margin: 0;
        }

        .date-input {
          margin-top: 0.5rem;
          padding: 0.5rem;
          border: 1px solid #d1d5db;
          border-radius: 4px;
          width: 100%;
        }

        .form-actions {
          display: flex;
          justify-content: flex-end;
          gap: 0.5rem;
          margin-top: 1.5rem;
        }

        .btn-small {
          padding: 0.25rem 0.75rem;
          font-size: 0.875rem;
          border: 1px solid #d1d5db;
          background-color: white;
          border-radius: 4px;
          cursor: pointer;
        }

        .btn-small:hover:not(:disabled) {
          background-color: #f3f4f6;
        }

        .btn-small:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .btn-primary,
        .btn-secondary,
        .btn-danger {
          padding: 0.5rem 1rem;
          border-radius: 6px;
          font-weight: 500;
          cursor: pointer;
          border: none;
        }

        .btn-primary {
          background-color: var(--primary-color, #3b82f6);
          color: white;
        }

        .btn-primary:hover:not(:disabled) {
          opacity: 0.9;
        }

        .btn-primary:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .btn-secondary {
          background-color: #f3f4f6;
          color: #374151;
        }

        .btn-secondary:hover {
          background-color: #e5e7eb;
        }

        .btn-danger {
          background-color: #ef4444;
          color: white;
        }

        .btn-danger:hover {
          background-color: #dc2626;
        }
      `})]})}const Yv=t=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:[30,41,59]},HH=t=>new Promise(e=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{const a=document.createElement("canvas");a.width=r.width,a.height=r.height,a.getContext("2d").drawImage(r,0,0),e(a.toDataURL("image/png"))},r.onerror=()=>e(null),r.src=t});function $H({project:t,companyId:e,company:r,onShowToast:a}){const{branding:n}=hh(),[s,l]=ee.useState([]),[c,f]=ee.useState(null),[d,m]=ee.useState(!1),[v,x]=ee.useState(!0),[g,b]=ee.useState(null),[_,w]=ee.useState("recent"),[E,C]=ee.useState(new Set),[A,T]=ee.useState({start:"",end:""});ee.useEffect(()=>{G()},[t?.id]);const G=async()=>{x(!0);try{const K=t?await ot.getInjuryReports(t.id):await ot.getCompanyInjuryReports(e);l(K)}catch(K){console.error("Error loading injury reports:",K),b({type:"error",message:"Failed to load injury reports"})}finally{x(!1)}},W=()=>{G(),m(!1),b({type:"success",message:"Injury report created successfully"})},B=K=>{f(K)},q=()=>{f(null)},L=K=>K?new Date(K).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",J=K=>K?new Date(`2000-01-01T${K}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"",D=K=>({minor:"Minor Injury",serious:"Serious Injury",critical:"Critical Injury",near_miss:"Near Miss"})[K]||K,O=K=>({reported:"#fbbf24",under_investigation:"#3b82f6",closed:"#10b981"})[K]||"#9ca3af",M=K=>({minor:"#10b981",serious:"#f59e0b",critical:"#ef4444",near_miss:"#6b7280"})[K]||"#9ca3af",V=ee.useMemo(()=>{let K=[...s];if(A.start){const ae=new Date(A.start);ae.setHours(0,0,0,0),K=K.filter(fe=>new Date(fe.incident_date)>=ae)}if(A.end){const ae=new Date(A.end);ae.setHours(23,59,59,999),K=K.filter(fe=>new Date(fe.incident_date)<=ae)}if(_==="recent"){const ae=new Date;ae.setDate(ae.getDate()-7),ae.setHours(0,0,0,0),K=K.filter(fe=>new Date(fe.incident_date)>=ae)}return K},[s,_,A]),ie=ee.useMemo(()=>{if(_!=="all")return null;const K={};return V.forEach(ae=>{const fe=new Date(ae.incident_date),U=`${fe.getFullYear()}-${String(fe.getMonth()+1).padStart(2,"0")}`,j=fe.toLocaleDateString("en-US",{month:"long",year:"numeric"});K[U]||(K[U]={label:j,reports:[]}),K[U].reports.push(ae)}),Object.entries(K).sort((ae,fe)=>fe[0].localeCompare(ae[0]))},[V,_]);ee.useEffect(()=>{if(ie&&ie.length>0){const K=ie[0][0];C(new Set([K]))}},[ie]);const X=K=>{const ae=new Set(E);ae.has(K)?ae.delete(K):ae.add(K),C(ae)},Z=async()=>{if(s.length===0){b({type:"error",message:"No reports to export"});return}b({type:"info",message:"Generating PDF..."});const K=new lr,ae=K.internal.pageSize.getWidth(),fe=20;let U=fe;const j=Yv(n?.primary_color||"#3B82F6"),F=Yv(n?.secondary_color||"#1E40AF");K.setFillColor(...j),K.rect(0,0,ae,45,"F"),K.setFillColor(...F),K.rect(0,42,ae,3,"F");let I=fe;if(n?.logo_url)try{const se=await HH(n.logo_url);se&&(K.addImage(se,"PNG",fe,7,30,30),I=fe+40)}catch(se){console.error("Error adding logo:",se)}K.setTextColor(255,255,255),K.setFontSize(22),K.setFont("helvetica","bold"),K.text(r?.name||"Company",I,20),K.setFontSize(10),K.setFont("helvetica","normal"),K.text("INJURY & INCIDENT REPORTS",I,30),K.setFontSize(9),K.text(`Generated: ${new Date().toLocaleDateString()}`,ae-fe,20,{align:"right"}),K.text(`Total Reports: ${s.length}`,ae-fe,28,{align:"right"}),U=55,t&&(K.setFillColor(248,250,252),K.rect(fe,U-5,ae-fe*2,15,"F"),K.setTextColor(...j),K.setFontSize(12),K.setFont("helvetica","bold"),K.text(`Project: ${t.name}`,fe+5,U+5),U+=20),s.forEach(se=>{U>200&&(K.addPage(),U=fe);const pe=Yv(M(se.injury_type));K.setFillColor(...pe),K.rect(fe,U,ae-fe*2,12,"F"),K.setTextColor(255,255,255),K.setFontSize(11),K.setFont("helvetica","bold"),K.text(`${se.employee_name} - ${D(se.injury_type)}`,fe+5,U+8),K.text(L(se.incident_date),ae-fe-5,U+8,{align:"right"}),U+=17,K.setTextColor(50,50,50),K.setFontSize(9),K.setFont("helvetica","normal"),K.text(`Location: ${se.incident_location}`,fe+5,U),se.incident_time&&K.text(`Time: ${J(se.incident_time)}`,fe+100,U),U+=6,K.setFont("helvetica","bold"),K.text("Description:",fe+5,U),K.setFont("helvetica","normal"),U+=5;const ye=K.splitTextToSize(se.incident_description,ae-fe*2-10);K.text(ye,fe+5,U),U+=ye.length*4+3;const _e=[];se.body_part_affected&&_e.push(`Body Part: ${se.body_part_affected}`),se.osha_recordable&&_e.push("OSHA Recordable"),se.workers_comp_claim&&_e.push("Workers' Comp Filed"),se.medical_treatment_required&&_e.push("Medical Treatment Required"),_e.length>0&&(K.setFontSize(8),K.setTextColor(100,100,100),K.text(_e.join("  |  "),fe+5,U),U+=5),K.setFontSize(8),K.text(`Reported by: ${se.reported_by_name} (${se.reported_by_title})`,fe+5,U),U+=12});const z=K.internal.getNumberOfPages();for(let se=1;se<=z;se++)K.setPage(se),K.setFontSize(8),K.setTextColor(150,150,150),K.text(`Page ${se} of ${z}`,ae/2,K.internal.pageSize.getHeight()-10,{align:"center"}),K.text("CONFIDENTIAL - Injury Report",fe,K.internal.pageSize.getHeight()-10);const ne=`Injury_Reports_${new Date().toISOString().split("T")[0]}.pdf`;K.save(ne),b({type:"success",message:"PDF exported!"})};return v?o.jsxs("div",{className:"loading-container",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading injury reports..."})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"injury-reports-section",children:[o.jsxs("div",{className:"section-header",children:[o.jsx("h3",{children:"Injury & Incident Reports"}),o.jsxs("div",{className:"section-header-actions",children:[s.length>0&&o.jsx("button",{className:"btn-secondary",onClick:Z,children:"PDF"}),o.jsx("button",{className:"btn-primary",onClick:()=>m(!0),children:"+ File Injury Report"})]})]}),o.jsxs("div",{className:"view-mode-bar",children:[o.jsxs("div",{className:"view-mode-tabs",children:[o.jsx("button",{className:`view-mode-tab ${_==="recent"?"active":""}`,onClick:()=>{w("recent"),T({start:"",end:""})},children:"Recent (7 days)"}),o.jsxs("button",{className:`view-mode-tab ${_==="all"?"active":""}`,onClick:()=>w("all"),children:["All (",s.length,")"]})]}),_==="all"&&o.jsxs("div",{className:"date-filter",children:[o.jsx(J0,{size:16}),o.jsx("input",{type:"date",value:A.start,onChange:K=>T(ae=>({...ae,start:K.target.value})),placeholder:"Start date"}),o.jsx("span",{children:"to"}),o.jsx("input",{type:"date",value:A.end,onChange:K=>T(ae=>({...ae,end:K.target.value})),placeholder:"End date"}),(A.start||A.end)&&o.jsx("button",{className:"btn-ghost",onClick:()=>T({start:"",end:""}),children:"Clear"})]})]}),V.length===0?o.jsxs("div",{className:"empty-state",children:[o.jsx("div",{className:"empty-state-icon",children:""}),o.jsxs("h4",{children:["No Injury Reports",_==="recent"?" in the last 7 days":""]}),o.jsx("p",{children:'Click "File Injury Report" to document a workplace incident'}),_==="recent"&&s.length>0&&o.jsx("button",{className:"btn-secondary",onClick:()=>w("all"),children:"View All Reports"})]}):o.jsx("div",{className:"reports-list",children:_==="all"&&ie?ie.map(([K,ae])=>o.jsxs("div",{className:"month-group",children:[o.jsx("div",{className:"month-header",onClick:()=>X(K),children:o.jsxs("div",{className:"month-header-left",children:[E.has(K)?o.jsx(xc,{size:18}):o.jsx(Of,{size:18}),o.jsx("span",{className:"month-label",children:ae.label}),o.jsxs("span",{className:"month-count",children:[ae.reports.length," reports"]})]})}),E.has(K)&&o.jsx("div",{className:"month-reports",children:ae.reports.map(fe=>o.jsxs("div",{className:"report-card",onClick:()=>B(fe),children:[o.jsxs("div",{className:"report-header",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"report-date",children:[L(fe.incident_date)," at ",J(fe.incident_time)]}),o.jsx("div",{className:"employee-name",children:fe.employee_name})]}),o.jsxs("div",{className:"report-badges",children:[o.jsx("span",{className:"badge",style:{backgroundColor:M(fe.injury_type)},children:D(fe.injury_type)}),o.jsx("span",{className:"badge",style:{backgroundColor:O(fe.status)},children:fe.status.replace("_"," ")})]})]}),o.jsxs("div",{className:"report-summary",children:[o.jsxs("div",{className:"summary-item",children:[o.jsx("strong",{children:"Location:"})," ",fe.incident_location]}),o.jsxs("div",{className:"summary-item",children:[o.jsx("strong",{children:"Reported by:"})," ",fe.reported_by_name," (",fe.reported_by_title,")"]}),fe.body_part_affected&&o.jsxs("div",{className:"summary-item",children:[o.jsx("strong",{children:"Body Part:"})," ",fe.body_part_affected]}),fe.osha_recordable&&o.jsx("div",{className:"summary-item",children:o.jsx("span",{className:"osha-badge",children:"OSHA Recordable"})})]}),o.jsxs("div",{className:"report-description",children:[fe.incident_description.substring(0,150),fe.incident_description.length>150&&"..."]}),o.jsx("div",{className:"report-footer",children:o.jsx("span",{children:"Click to view full details"})})]},fe.id))})]},K)):V.map(K=>o.jsxs("div",{className:"report-card",onClick:()=>B(K),children:[o.jsxs("div",{className:"report-header",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"report-date",children:[L(K.incident_date)," at ",J(K.incident_time)]}),o.jsx("div",{className:"employee-name",children:K.employee_name})]}),o.jsxs("div",{className:"report-badges",children:[o.jsx("span",{className:"badge",style:{backgroundColor:M(K.injury_type)},children:D(K.injury_type)}),o.jsx("span",{className:"badge",style:{backgroundColor:O(K.status)},children:K.status.replace("_"," ")})]})]}),o.jsxs("div",{className:"report-summary",children:[o.jsxs("div",{className:"summary-item",children:[o.jsx("strong",{children:"Location:"})," ",K.incident_location]}),o.jsxs("div",{className:"summary-item",children:[o.jsx("strong",{children:"Reported by:"})," ",K.reported_by_name," (",K.reported_by_title,")"]}),K.body_part_affected&&o.jsxs("div",{className:"summary-item",children:[o.jsx("strong",{children:"Body Part:"})," ",K.body_part_affected]}),K.osha_recordable&&o.jsx("div",{className:"summary-item",children:o.jsx("span",{className:"osha-badge",children:"OSHA Recordable"})})]}),o.jsxs("div",{className:"report-description",children:[K.incident_description.substring(0,150),K.incident_description.length>150&&"..."]}),o.jsx("div",{className:"report-footer",children:o.jsx("span",{children:"Click to view full details"})})]},K.id))}),c&&o.jsx("div",{className:"modal-overlay",onClick:q,children:o.jsxs("div",{className:"modal-content report-details-modal",onClick:K=>K.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:"Injury Report Details"}),o.jsx("button",{className:"close-btn",onClick:q,children:""})]}),o.jsxs("div",{className:"modal-body",children:[o.jsxs("section",{className:"details-section",children:[o.jsx("h3",{children:"Incident Information"}),o.jsxs("div",{className:"detail-grid",children:[o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Date & Time"}),o.jsxs("div",{children:[L(c.incident_date)," at ",J(c.incident_time)]})]}),o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Location"}),o.jsx("div",{children:c.incident_location})]}),o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Injury Type"}),o.jsx("div",{children:o.jsx("span",{className:"badge",style:{backgroundColor:M(c.injury_type)},children:D(c.injury_type)})})]}),c.body_part_affected&&o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Body Part Affected"}),o.jsx("div",{children:c.body_part_affected})]})]}),o.jsxs("div",{className:"detail-item full-width",children:[o.jsx("label",{children:"Description"}),o.jsx("div",{className:"description-box",children:c.incident_description})]})]}),o.jsxs("section",{className:"details-section",children:[o.jsx("h3",{children:"Injured Employee"}),o.jsxs("div",{className:"detail-grid",children:[o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Name"}),o.jsx("div",{children:c.employee_name})]}),o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Job Title"}),o.jsx("div",{children:c.employee_job_title})]}),c.employee_phone&&o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Phone"}),o.jsx("div",{children:c.employee_phone})]}),c.employee_email&&o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Email"}),o.jsx("div",{children:c.employee_email})]}),c.employee_address&&o.jsxs("div",{className:"detail-item full-width",children:[o.jsx("label",{children:"Address"}),o.jsx("div",{children:c.employee_address})]})]})]}),o.jsxs("section",{className:"details-section",children:[o.jsx("h3",{children:"Reported By"}),o.jsxs("div",{className:"detail-grid",children:[o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Name"}),o.jsx("div",{children:c.reported_by_name})]}),o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Title"}),o.jsx("div",{children:c.reported_by_title})]}),c.reported_by_phone&&o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Phone"}),o.jsx("div",{children:c.reported_by_phone})]}),c.reported_by_email&&o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Email"}),o.jsx("div",{children:c.reported_by_email})]})]})]}),c.witnesses&&c.witnesses.length>0&&o.jsxs("section",{className:"details-section",children:[o.jsx("h3",{children:"Witnesses"}),c.witnesses.map((K,ae)=>o.jsxs("div",{className:"witness-card",children:[o.jsxs("div",{className:"witness-header",children:[o.jsx("strong",{children:K.name}),K.phone&&o.jsxs("span",{children:["  ",K.phone]}),K.email&&o.jsxs("span",{children:["  ",K.email]})]}),K.testimony&&o.jsx("div",{className:"witness-testimony",children:o.jsxs("em",{children:['"',K.testimony,'"']})})]},ae))]}),c.medical_treatment_required&&o.jsxs("section",{className:"details-section",children:[o.jsx("h3",{children:"Medical Treatment"}),o.jsxs("div",{className:"detail-grid",children:[c.medical_facility_name&&o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Facility"}),o.jsx("div",{children:c.medical_facility_name})]}),c.medical_facility_address&&o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Address"}),o.jsx("div",{children:c.medical_facility_address})]}),o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Hospitalized"}),o.jsx("div",{children:c.hospitalized?"Yes":"No"})]})]})]}),o.jsxs("section",{className:"details-section",children:[o.jsx("h3",{children:"Actions & Safety"}),c.immediate_actions_taken&&o.jsxs("div",{className:"detail-item full-width",children:[o.jsx("label",{children:"Immediate Actions Taken"}),o.jsx("div",{className:"description-box",children:c.immediate_actions_taken})]}),c.corrective_actions_planned&&o.jsxs("div",{className:"detail-item full-width",children:[o.jsx("label",{children:"Corrective Actions Planned"}),o.jsx("div",{className:"description-box",children:c.corrective_actions_planned})]}),o.jsxs("div",{className:"detail-grid",children:[c.safety_equipment_used&&o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Safety Equipment Used"}),o.jsx("div",{children:c.safety_equipment_used})]}),c.safety_equipment_failed&&o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Safety Equipment Failed"}),o.jsx("div",{children:c.safety_equipment_failed})]})]})]}),o.jsxs("section",{className:"details-section",children:[o.jsx("h3",{children:"Regulatory & Work Impact"}),o.jsxs("div",{className:"detail-grid",children:[o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"OSHA Recordable"}),o.jsx("div",{children:c.osha_recordable?"Yes":"No"})]}),o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Workers' Comp Claim"}),o.jsx("div",{children:c.workers_comp_claim?"Yes":"No"})]}),o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Days Away From Work"}),o.jsx("div",{children:c.days_away_from_work||0})]}),o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Restricted Work Days"}),o.jsx("div",{children:c.restricted_work_days||0})]})]})]}),o.jsxs("div",{className:"report-meta",children:["Filed on ",L(c.created_at)]})]})]})}),d&&o.jsx(lN,{project:t,companyId:e,onClose:()=>m(!1),onReportCreated:W}),g&&o.jsx(du,{message:g.message,type:g.type,onClose:()=>b(null)})]}),o.jsx("style",{children:`
        .injury-reports-section {
          margin-top: 2rem;
        }

        .section-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 1.5rem;
        }

        .section-header h3 {
          margin: 0;
          font-size: 1.25rem;
          color: #111827;
        }

        .view-mode-bar {
          display: flex;
          justify-content: space-between;
          align-items: center;
          gap: 1rem;
          margin-bottom: 1rem;
          padding: 0.75rem;
          background: #f8fafc;
          border-radius: 8px;
          flex-wrap: wrap;
        }

        .view-mode-tabs {
          display: flex;
          gap: 0.5rem;
        }

        .view-mode-tab {
          padding: 0.5rem 1rem;
          border: none;
          border-radius: 6px;
          font-size: 0.875rem;
          cursor: pointer;
          background: transparent;
          color: #64748b;
          transition: all 0.2s;
        }

        .view-mode-tab:hover {
          background: #e2e8f0;
        }

        .view-mode-tab.active {
          background: var(--primary-color, #3b82f6);
          color: white;
        }

        .date-filter {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          color: #64748b;
        }

        .date-filter input[type="date"] {
          padding: 0.4rem 0.5rem;
          border: 1px solid #e2e8f0;
          border-radius: 4px;
          font-size: 0.875rem;
        }

        .btn-ghost {
          background: transparent;
          border: none;
          padding: 0.4rem 0.75rem;
          color: #64748b;
          cursor: pointer;
          border-radius: 4px;
          font-size: 0.875rem;
        }

        .btn-ghost:hover {
          background: #e2e8f0;
        }

        .month-group {
          margin-bottom: 0.5rem;
        }

        .month-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 0.75rem 1rem;
          background: #f1f5f9;
          border-radius: 8px;
          cursor: pointer;
          transition: background 0.2s;
        }

        .month-header:hover {
          background: #e2e8f0;
        }

        .month-header-left {
          display: flex;
          align-items: center;
          gap: 0.5rem;
        }

        .month-label {
          font-weight: 600;
          color: #1e293b;
        }

        .month-count {
          font-size: 0.875rem;
          color: #64748b;
        }

        .month-reports {
          margin-top: 0.5rem;
          padding-left: 0.5rem;
        }

        .reports-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .report-card {
          background: white;
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 1.5rem;
          cursor: pointer;
          transition: all 0.2s;
        }

        .report-card:hover {
          box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
          border-color: var(--primary-color, #3b82f6);
        }

        .report-header {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          margin-bottom: 1rem;
        }

        .report-date {
          font-size: 0.875rem;
          color: #6b7280;
          margin-bottom: 0.25rem;
        }

        .employee-name {
          font-size: 1.125rem;
          font-weight: 600;
          color: #111827;
        }

        .report-badges {
          display: flex;
          gap: 0.5rem;
          flex-wrap: wrap;
        }

        .badge {
          padding: 0.25rem 0.75rem;
          border-radius: 12px;
          font-size: 0.75rem;
          font-weight: 500;
          color: white;
          text-transform: capitalize;
        }

        .osha-badge {
          background-color: #dc2626;
          color: white;
          padding: 0.25rem 0.5rem;
          border-radius: 4px;
          font-size: 0.75rem;
          font-weight: 600;
        }

        .report-summary {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 0.75rem;
          margin-bottom: 1rem;
          padding: 1rem;
          background-color: #f9fafb;
          border-radius: 6px;
        }

        .summary-item {
          font-size: 0.875rem;
          color: #374151;
        }

        .summary-item strong {
          color: #111827;
        }

        .report-description {
          color: #6b7280;
          line-height: 1.6;
          margin-bottom: 1rem;
        }

        .report-footer {
          text-align: right;
          font-size: 0.875rem;
          color: var(--primary-color, #3b82f6);
        }

        .report-details-modal {
          max-width: 900px;
          max-height: 90vh;
          overflow-y: auto;
        }

        .details-section {
          margin-bottom: 2rem;
          padding-bottom: 2rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .details-section:last-child {
          border-bottom: none;
        }

        .details-section h3 {
          margin-top: 0;
          margin-bottom: 1rem;
          font-size: 1.125rem;
          color: #111827;
        }

        .detail-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 1rem;
        }

        .detail-item label {
          display: block;
          font-size: 0.875rem;
          font-weight: 600;
          color: #6b7280;
          margin-bottom: 0.25rem;
        }

        .detail-item div {
          color: #111827;
        }

        .detail-item.full-width {
          grid-column: 1 / -1;
        }

        .description-box {
          background-color: #f9fafb;
          border: 1px solid #e5e7eb;
          border-radius: 6px;
          padding: 1rem;
          white-space: pre-wrap;
          line-height: 1.6;
        }

        .witness-card {
          background-color: #f9fafb;
          border-radius: 6px;
          padding: 1rem;
          margin-bottom: 0.5rem;
        }

        .witness-header {
          margin-bottom: 0.5rem;
          color: #111827;
        }

        .witness-testimony {
          color: #6b7280;
          font-size: 0.875rem;
          padding-left: 1rem;
          border-left: 3px solid #d1d5db;
        }

        .report-meta {
          text-align: center;
          font-size: 0.875rem;
          color: #6b7280;
          padding-top: 1rem;
          border-top: 1px solid #e5e7eb;
        }

        .empty-state {
          text-align: center;
          padding: 3rem 1rem;
        }

        .empty-state-icon {
          font-size: 3rem;
          margin-bottom: 1rem;
        }

        .empty-state h4 {
          margin: 0 0 0.5rem 0;
          color: #111827;
        }

        .empty-state p {
          margin: 0;
          color: #6b7280;
        }

        .section-header-actions {
          display: flex;
          gap: 0.5rem;
          align-items: center;
        }

        .btn-primary, .btn-secondary {
          padding: 0.5rem 1rem;
          border-radius: 6px;
          font-weight: 500;
          cursor: pointer;
          border: none;
        }

        .btn-primary {
          background-color: var(--primary-color, #3b82f6);
          color: white;
        }

        .btn-secondary {
          background-color: #e5e7eb;
          color: #374151;
        }

        .btn-primary:hover, .btn-secondary:hover {
          opacity: 0.9;
        }

        .loading-container {
          display: flex;
          flex-direction: column;
          align-items: center;
          padding: 3rem;
        }

        .spinner {
          width: 40px;
          height: 40px;
          border: 4px solid #e5e7eb;
          border-top-color: var(--primary-color, #3b82f6);
          border-radius: 50%;
          animation: spin 1s linear infinite;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
          .report-header {
            flex-direction: column;
            gap: 0.5rem;
          }

          .report-summary {
            grid-template-columns: 1fr;
          }

          .detail-grid {
            grid-template-columns: 1fr;
          }

          .report-details-modal {
            max-width: 100%;
            height: 100vh;
            max-height: 100vh;
            border-radius: 0;
          }
        }
      `})]})}const Xv=[{id:"message",label:"Messages",Icon:Z0,description:"Chat messages from field"},{id:"material_request",label:"Material Requests",Icon:yc,description:"Equipment and material requests"},{id:"injury_report",label:"Safety Reports",Icon:mh,description:"Injury and safety incident reports"},{id:"tm_ticket",label:"T&M Tickets",Icon:gu,description:"Time and materials tickets"}];function WH({project:t,company:e,onShowToast:r,onClose:a}){const[n,s]=ee.useState([]),[l,c]=ee.useState({}),[f,d]=ee.useState([]),[m,v]=ee.useState(!0),[x,g]=ee.useState(!1);ee.useEffect(()=>{b()},[t?.id,e?.id]);const b=async()=>{if(!(!t?.id||!e?.id))try{v(!0);const A=await ot.getCompanyUsers(e.id);s(A);const T=await ot.getProjectNotificationPreferences(t.id),G={};T.forEach(B=>{G[B.user_id]={types:B.notification_types||[],presetId:null}}),c(G);const W=await ot.getNotificationPresets(e.id);d(W)}catch(A){console.error("Error loading notification settings:",A),r?.("Error loading notification settings","error")}finally{v(!1)}},_=(A,T)=>{c(G=>{const W=G[A]||{types:[]},B=W.types.includes(T)?W.types.filter(q=>q!==T):[...W.types,T];return{...G,[A]:{types:B,presetId:null}}})},w=(A,T)=>{const G=f.find(W=>W.id===T);G&&c(W=>({...W,[A]:{types:[...G.notification_types],presetId:T}}))},E=(A,T)=>{c(G=>({...G,[A]:{types:T?Xv.map(W=>W.id):[],presetId:null}}))},C=async()=>{try{g(!0);const A=Object.entries(l).map(([T,G])=>({userId:T,notificationTypes:G.types}));await ot.setProjectNotificationPreferences(t.id,A),r?.("Notification settings saved","success"),a?.()}catch(A){console.error("Error saving notification settings:",A),r?.("Error saving notification settings","error")}finally{g(!1)}};return m?o.jsxs("div",{className:"notification-settings",children:[o.jsxs("div",{className:"notification-settings-header",children:[o.jsx("h3",{children:"Notification Settings"}),o.jsx("button",{className:"close-btn",onClick:a,children:""})]}),o.jsx("div",{className:"loading-message",children:"Loading..."})]}):o.jsxs("div",{className:"notification-settings",children:[o.jsxs("div",{className:"notification-settings-header",children:[o.jsxs("h3",{children:["Notification Settings for ",t?.name]}),o.jsx("button",{className:"close-btn",onClick:a,children:""})]}),o.jsx("p",{className:"settings-description",children:"Choose who receives notifications when field workers send messages, request materials, submit safety reports, or create T&M tickets for this project."}),n.length===0?o.jsxs("div",{className:"no-users-message",children:[o.jsx("p",{children:"No users found in this company."}),o.jsx("small",{children:"Users need to be added to the company to receive notifications."})]}):o.jsx("div",{className:"notification-users-list",children:n.map(A=>{const T=l[A.id]||{types:[],presetId:null},G=T.types.length===Xv.length,W=T.types.length>0&&!G;return o.jsxs("div",{className:"notification-user-row",children:[o.jsxs("div",{className:"user-info",children:[o.jsx("div",{className:"user-avatar",children:A.name?.charAt(0).toUpperCase()||A.email?.charAt(0).toUpperCase()}),o.jsxs("div",{className:"user-details",children:[o.jsx("span",{className:"user-name",children:A.name||A.email}),A.role&&o.jsx("span",{className:"user-role",children:A.role})]})]}),o.jsxs("div",{className:"notification-controls",children:[o.jsxs("select",{className:"preset-select",value:T.presetId||"",onChange:B=>B.target.value&&w(A.id,B.target.value),children:[o.jsx("option",{value:"",children:"Apply preset..."}),f.map(B=>o.jsx("option",{value:B.id,children:B.name},B.id))]}),o.jsx("button",{className:`toggle-all-btn ${G?"all-on":W?"some-on":""}`,onClick:()=>E(A.id,!G),title:G?"Disable all":"Enable all",children:G?"All On":W?"Some":"None"})]}),o.jsx("div",{className:"notification-types",children:Xv.map(B=>o.jsxs("label",{className:`notification-type-toggle ${T.types.includes(B.id)?"active":""}`,title:B.description,children:[o.jsx("input",{type:"checkbox",checked:T.types.includes(B.id),onChange:()=>_(A.id,B.id)}),o.jsx("span",{className:"type-icon",children:o.jsx(B.Icon,{size:16})}),o.jsx("span",{className:"type-label",children:B.label})]},B.id))})]},A.id)})}),o.jsxs("div",{className:"notification-settings-footer",children:[o.jsx("button",{className:"btn-secondary",onClick:a,children:"Cancel"}),o.jsx("button",{className:"btn-primary",onClick:C,disabled:x,children:x?"Saving...":"Save Settings"})]})]})}function VH({project:t,company:e,onShowToast:r}){const[a,n]=ee.useState([]),[s,l]=ee.useState(!0),[c,f]=ee.useState("all"),[d,m]=ee.useState(null),[v,x]=ee.useState("recent"),[g,b]=ee.useState(new Set),[_,w]=ee.useState({start:"",end:""});ee.useEffect(()=>{E();const M=ot.subscribeToMaterialRequests?.(t.id,()=>{E()});return()=>{M&&ot.unsubscribe?.(M)}},[t.id]);const E=async()=>{try{const M=await ot.getMaterialRequests(t.id);n(M||[])}catch(M){console.error("Error loading material requests:",M),r?.("Error loading material requests","error")}finally{l(!1)}},C=async(M,V)=>{try{await ot.updateMaterialRequest(M,V,"Office"),n(a.map(ie=>ie.id===M?{...ie,status:V}:ie)),r?.(`Request ${V}`,"success")}catch(ie){console.error("Error updating status:",ie),r?.("Error updating status","error")}},A=M=>new Date(M).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),T=M=>new Date(M).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),G=M=>{switch(M){case"urgent":return"priority-urgent";case"low":return"priority-low";default:return"priority-normal"}},W=M=>{switch(M){case"urgent":return"";case"low":return"";default:return""}},B=ee.useMemo(()=>{let M=c==="all"?[...a]:a.filter(V=>V.status===c);if(_.start){const V=new Date(_.start);V.setHours(0,0,0,0),M=M.filter(ie=>new Date(ie.created_at)>=V)}if(_.end){const V=new Date(_.end);V.setHours(23,59,59,999),M=M.filter(ie=>new Date(ie.created_at)<=V)}if(v==="recent"){const V=new Date;V.setDate(V.getDate()-7),V.setHours(0,0,0,0),M=M.filter(ie=>new Date(ie.created_at)>=V)}return M},[a,c,v,_]),q=ee.useMemo(()=>{if(v!=="all")return null;const M={};return B.forEach(V=>{const ie=new Date(V.created_at),X=`${ie.getFullYear()}-${String(ie.getMonth()+1).padStart(2,"0")}`,Z=ie.toLocaleDateString("en-US",{month:"long",year:"numeric"});M[X]||(M[X]={label:Z,requests:[],itemCount:0}),M[X].requests.push(V),M[X].itemCount+=V.items?.length||0}),Object.entries(M).sort((V,ie)=>ie[0].localeCompare(V[0]))},[B,v]);ee.useEffect(()=>{if(q&&q.length>0){const M=q[0][0];b(new Set([M]))}},[q]);const L=M=>{const V=new Set(g);V.has(M)?V.delete(M):V.add(M),b(V)},J={all:a.length,pending:a.filter(M=>M.status==="pending").length,ordered:a.filter(M=>M.status==="ordered").length,delivered:a.filter(M=>M.status==="delivered").length,cancelled:a.filter(M=>M.status==="cancelled").length},D=c==="all"?a.length:a.filter(M=>M.status===c).length;if(s)return o.jsx("div",{className:"loading",children:"Loading material requests..."});const O=M=>o.jsxs("div",{className:`material-request-card ${M.status} ${M.priority==="urgent"?"urgent":""}`,children:[o.jsxs("div",{className:"material-request-header-row",onClick:()=>m(d===M.id?null:M.id),children:[o.jsxs("div",{className:"material-request-info",children:[o.jsxs("span",{className:`material-priority-badge ${G(M.priority)}`,children:[W(M.priority)," ",M.priority]}),o.jsx("span",{className:"material-request-date",children:A(M.created_at)}),o.jsx("span",{className:"material-request-time",children:T(M.created_at)})]}),o.jsxs("div",{className:"material-request-summary",children:[o.jsxs("span",{className:"material-items-count",children:[M.items?.length||0," item",(M.items?.length||0)!==1?"s":""]}),o.jsx("span",{className:`material-status ${M.status}`,children:M.status}),o.jsx("span",{className:"material-expand-arrow",children:d===M.id?"":""})]})]}),d===M.id&&o.jsxs("div",{className:"material-request-details",children:[o.jsxs("div",{className:"material-detail-section",children:[o.jsxs("div",{className:"material-requester",children:[o.jsx("span",{className:"requester-label",children:"Requested by:"}),o.jsx("span",{className:"requester-name",children:M.requested_by||"Field"})]}),M.needed_by&&o.jsxs("div",{className:"material-needed-by",children:[o.jsx("span",{className:"needed-label",children:"Needed by:"}),o.jsx("span",{className:"needed-date",children:A(M.needed_by)})]})]}),M.items?.length>0&&o.jsxs("div",{className:"material-detail-section",children:[o.jsx("h4",{children:"Items Requested"}),o.jsx("div",{className:"material-items-list",children:M.items.map((V,ie)=>o.jsxs("div",{className:"material-item-row",children:[o.jsx("span",{className:"item-name",children:V.name}),o.jsxs("span",{className:"item-quantity",children:[V.quantity," ",V.unit]})]},ie))})]}),M.notes&&o.jsxs("div",{className:"material-detail-section",children:[o.jsx("h4",{children:"Notes"}),o.jsx("p",{className:"material-notes",children:M.notes})]}),o.jsxs("div",{className:"material-request-actions",children:[M.status==="pending"&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"btn btn-success btn-small",onClick:V=>{V.stopPropagation(),C(M.id,"ordered")},children:"Mark Ordered"}),o.jsx("button",{className:"btn btn-danger btn-small",onClick:V=>{V.stopPropagation(),C(M.id,"cancelled")},children:"Cancel"})]}),M.status==="ordered"&&o.jsx("button",{className:"btn btn-success btn-small",onClick:V=>{V.stopPropagation(),C(M.id,"delivered")},children:"Mark Delivered"}),M.status==="cancelled"&&o.jsx("button",{className:"btn btn-secondary btn-small",onClick:V=>{V.stopPropagation(),C(M.id,"pending")},children:"Restore"})]})]})]},M.id);return o.jsxs("div",{className:"material-requests-list card",children:[o.jsxs("div",{className:"material-requests-header",children:[o.jsxs("div",{className:"material-requests-title",children:[o.jsx("h3",{children:"Material Requests"}),J.pending>0&&o.jsxs("span",{className:"pending-badge",children:[J.pending," pending"]})]}),o.jsx("div",{className:"material-filter-tabs",children:["all","pending","ordered","delivered","cancelled"].map(M=>o.jsxs("button",{className:`material-filter-tab ${c===M?"active":""}`,onClick:()=>f(M),children:[M.charAt(0).toUpperCase()+M.slice(1),o.jsx("span",{className:"material-filter-count",children:J[M]})]},M))}),o.jsxs("div",{className:"view-mode-bar",children:[o.jsxs("div",{className:"view-mode-tabs",children:[o.jsx("button",{className:`view-mode-tab ${v==="recent"?"active":""}`,onClick:()=>{x("recent"),w({start:"",end:""})},children:"Recent (7 days)"}),o.jsxs("button",{className:`view-mode-tab ${v==="all"?"active":""}`,onClick:()=>x("all"),children:["All (",D,")"]})]}),v==="all"&&o.jsxs("div",{className:"date-filter",children:[o.jsx(J0,{size:16}),o.jsx("input",{type:"date",value:_.start,onChange:M=>w(V=>({...V,start:M.target.value})),placeholder:"Start date"}),o.jsx("span",{children:"to"}),o.jsx("input",{type:"date",value:_.end,onChange:M=>w(V=>({...V,end:M.target.value})),placeholder:"End date"}),(_.start||_.end)&&o.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>w({start:"",end:""}),children:"Clear"})]})]})]}),B.length===0?o.jsxs("div",{className:"material-empty-state",children:[o.jsx("span",{className:"empty-icon",children:o.jsx(yc,{size:32})}),o.jsxs("p",{children:["No ",c==="all"?"":c," material requests",v==="recent"?" in the last 7 days":""]}),v==="recent"&&D>0&&o.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>x("all"),children:"View All Requests"})]}):o.jsx("div",{className:"material-requests",children:v==="all"&&q?q.map(([M,V])=>o.jsxs("div",{className:"month-group",children:[o.jsxs("div",{className:"month-header",onClick:()=>L(M),children:[o.jsxs("div",{className:"month-header-left",children:[g.has(M)?o.jsx(xc,{size:18}):o.jsx(Of,{size:18}),o.jsx("span",{className:"month-label",children:V.label}),o.jsxs("span",{className:"month-count",children:[V.requests.length," requests"]})]}),o.jsx("div",{className:"month-header-right",children:o.jsxs("span",{className:"month-stat",children:[V.itemCount," items"]})})]}),g.has(M)&&o.jsx("div",{className:"month-requests",children:V.requests.map(ie=>O(ie))})]},M)):B.map(M=>O(M))})]})}const $S=t=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:[30,41,59]},GH=t=>new Promise(e=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{const a=document.createElement("canvas");a.width=r.width,a.height=r.height,a.getContext("2d").drawImage(r,0,0),e(a.toDataURL("image/png"))},r.onerror=()=>e(null),r.src=t});function YH({project:t,company:e,onShowToast:r}){const{branding:a}=hh(),[n,s]=ee.useState([]),[l,c]=ee.useState(!0),[f,d]=ee.useState(null),[m,v]=ee.useState(new Set),[x,g]=ee.useState(!1),[b,_]=ee.useState("recent"),[w,E]=ee.useState(new Set),[C,A]=ee.useState({start:"",end:""});ee.useEffect(()=>{T();const fe=ot.subscribeToDailyReports?.(t.id,()=>{T()});return()=>{fe&&ot.unsubscribe?.(fe)}},[t.id]);const T=async()=>{try{const fe=await ot.getDailyReports(t.id,365);s(fe||[])}catch(fe){console.error("Error loading daily reports:",fe),r?.("Error loading daily reports","error")}finally{c(!1)}},G=ee.useMemo(()=>{let fe=[...n];if(C.start){const U=new Date(C.start);U.setHours(0,0,0,0),fe=fe.filter(j=>new Date(j.report_date||j.created_at)>=U)}if(C.end){const U=new Date(C.end);U.setHours(23,59,59,999),fe=fe.filter(j=>new Date(j.report_date||j.created_at)<=U)}if(b==="recent"){const U=new Date;U.setDate(U.getDate()-7),U.setHours(0,0,0,0),fe=fe.filter(j=>new Date(j.report_date||j.created_at)>=U)}return fe},[n,b,C]),W=ee.useMemo(()=>{if(b!=="all")return null;const fe={};return G.forEach(U=>{const j=new Date(U.report_date||U.created_at),F=`${j.getFullYear()}-${String(j.getMonth()+1).padStart(2,"0")}`,I=j.toLocaleDateString("en-US",{month:"long",year:"numeric"});fe[F]||(fe[F]={label:I,reports:[]}),fe[F].reports.push(U)}),Object.entries(fe).sort((U,j)=>j[0].localeCompare(U[0]))},[G,b]);ee.useEffect(()=>{if(W&&W.length>0){const fe=W[0][0];E(new Set([fe]))}},[W]);const B=()=>{g(!x),x&&v(new Set)},q=fe=>{const U=new Set(m);U.has(fe)?U.delete(fe):U.add(fe),v(U)},L=()=>{m.size===G.length?v(new Set):v(new Set(G.map(fe=>fe.id)))},J=fe=>{const U=new Set(w);U.has(fe)?U.delete(fe):U.add(fe),E(U)},D=()=>m.size>0?G.filter(fe=>m.has(fe.id)):G,O=fe=>new Date(fe).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"}),M=fe=>new Date(fe).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),V=fe=>{switch(fe){case"submitted":return"";case"reviewed":return"";case"draft":return"";default:return""}},ie=fe=>{switch(fe){case"submitted":return"Submitted";case"reviewed":return"Reviewed";case"draft":return"Draft";default:return fe}},X=async()=>{const fe=D();if(fe.length===0){r?.("No reports to export","error");return}r?.("Generating PDF...","info");const U=new lr,j=U.internal.pageSize.getWidth(),F=20;let I=F;const z=$S(a?.primary_color||"#3B82F6"),ne=$S(a?.secondary_color||"#1E40AF");U.setFillColor(...z),U.rect(0,0,j,45,"F"),U.setFillColor(...ne),U.rect(0,42,j,3,"F");let se=F;if(a?.logo_url)try{const _e=await GH(a.logo_url);_e&&(U.addImage(_e,"PNG",F,7,30,30),se=F+40)}catch(_e){console.error("Error adding logo:",_e)}U.setTextColor(255,255,255),U.setFontSize(22),U.setFont("helvetica","bold"),U.text(e?.name||"Company Name",se,20),U.setFontSize(10),U.setFont("helvetica","normal"),U.text("DAILY REPORTS SUMMARY",se,30),U.setFontSize(9),U.text(`Generated: ${new Date().toLocaleDateString()}`,j-F,20,{align:"right"}),t.job_number&&U.text(`Job #: ${t.job_number}`,j-F,28,{align:"right"}),I=55,U.setFillColor(248,250,252),U.rect(F,I-5,j-F*2,20,"F"),U.setTextColor(...z),U.setFontSize(14),U.setFont("helvetica","bold"),U.text(`Project: ${t.name}`,F+5,I+7),U.setFontSize(10),U.setTextColor(100,100,100),U.text(`${fe.length} Report${fe.length!==1?"s":""}`,j-F-5,I+7,{align:"right"}),I+=25,fe.forEach((_e,Le)=>{I>250&&(U.addPage(),I=F),U.setFillColor(...z),U.setTextColor(255,255,255),U.rect(F,I,j-F*2,10,"F"),U.setFontSize(11),U.setFont("helvetica","bold"),U.text(O(_e.report_date||_e.created_at),F+5,I+7),U.text(ie(_e.status),j-F-5,I+7,{align:"right"}),I+=15,U.setTextColor(50,50,50),U.setFontSize(10),U.setFont("helvetica","normal");const ue=`Crew: ${_e.crew_count||0}  |  Tasks: ${_e.tasks_completed||0}  |  T&M: ${_e.tm_tickets_count||0}  |  Photos: ${_e.photos_count||0}`;if(U.text(ue,F+5,I),I+=8,_e.crew_list?.length>0){U.setFont("helvetica","bold"),U.text("Crew:",F+5,I),U.setFont("helvetica","normal");const at=_e.crew_list.map(de=>`${de.name} (${de.role})`).join(", "),ht=U.splitTextToSize(at,j-F*2-30);U.text(ht,F+25,I),I+=ht.length*5+3}if(_e.field_notes){U.setFont("helvetica","bold"),U.text("Notes:",F+5,I),U.setFont("helvetica","normal");const at=U.splitTextToSize(_e.field_notes,j-F*2-30);U.text(at,F+25,I),I+=at.length*5+3}if(_e.issues){U.setTextColor(180,50,50),U.setFont("helvetica","bold"),U.text("Issues:",F+5,I),U.setFont("helvetica","normal");const at=U.splitTextToSize(_e.issues,j-F*2-30);U.text(at,F+25,I),U.setTextColor(50,50,50),I+=at.length*5+3}I+=10});const pe=U.internal.getNumberOfPages();for(let _e=1;_e<=pe;_e++)U.setPage(_e),U.setFontSize(8),U.setTextColor(150,150,150),U.text(`Page ${_e} of ${pe}`,j/2,U.internal.pageSize.getHeight()-10,{align:"center"});const ye=`${t.name}_Daily_Reports_${new Date().toISOString().split("T")[0]}.pdf`;U.save(ye),r?.("PDF exported!","success")},Z=fe=>o.jsxs("div",{className:`daily-report-card ${fe.status} ${m.has(fe.id)?"selected":""}`,children:[o.jsxs("div",{className:"daily-report-header-row",onClick:()=>d(f===fe.id?null:fe.id),children:[x&&o.jsx("input",{type:"checkbox",className:"report-checkbox",checked:m.has(fe.id),onChange:U=>{U.stopPropagation(),q(fe.id)},onClick:U=>U.stopPropagation()}),o.jsxs("div",{className:"daily-report-info",children:[o.jsx("span",{className:"report-date",children:O(fe.report_date||fe.created_at)}),o.jsxs("span",{className:`report-status ${fe.status}`,children:[V(fe.status)," ",ie(fe.status)]})]}),o.jsxs("div",{className:"daily-report-summary",children:[o.jsxs("span",{className:"report-crew",children:[fe.crew_count||0," crew"]}),o.jsxs("span",{className:"report-tasks",children:[fe.tasks_completed||0," tasks"]}),o.jsx("span",{className:"report-expand",children:f===fe.id?"":""})]})]}),f===fe.id&&o.jsxs("div",{className:"daily-report-details",children:[o.jsxs("div",{className:"report-stats-grid",children:[o.jsxs("div",{className:"report-stat",children:[o.jsx("span",{className:"stat-value",children:fe.crew_count||0}),o.jsx("span",{className:"stat-label",children:"Crew on Site"})]}),o.jsxs("div",{className:"report-stat",children:[o.jsx("span",{className:"stat-value",children:fe.tasks_completed||0}),o.jsx("span",{className:"stat-label",children:"Tasks Done"})]}),o.jsxs("div",{className:"report-stat",children:[o.jsx("span",{className:"stat-value",children:fe.tm_tickets_count||0}),o.jsx("span",{className:"stat-label",children:"T&M Tickets"})]}),o.jsxs("div",{className:"report-stat",children:[o.jsx("span",{className:"stat-value",children:fe.photos_count||0}),o.jsx("span",{className:"stat-label",children:"Photos"})]})]}),fe.crew_list?.length>0&&o.jsxs("div",{className:"report-section",children:[o.jsx("h4",{children:"Crew"}),o.jsx("div",{className:"report-crew-list",children:fe.crew_list.map((U,j)=>o.jsxs("div",{className:"crew-member",children:[o.jsx("span",{className:"crew-name",children:U.name}),o.jsx("span",{className:"crew-role",children:U.role})]},j))})]}),fe.completed_tasks?.length>0&&o.jsxs("div",{className:"report-section",children:[o.jsx("h4",{children:"Completed Today"}),o.jsx("ul",{className:"report-tasks-list",children:fe.completed_tasks.map((U,j)=>o.jsxs("li",{children:[U.name,U.group&&o.jsx("span",{className:"task-group",children:U.group})]},j))})]}),fe.field_notes&&o.jsxs("div",{className:"report-section",children:[o.jsx("h4",{children:"Field Notes"}),o.jsx("p",{className:"report-notes",children:fe.field_notes})]}),fe.issues&&o.jsxs("div",{className:"report-section issues",children:[o.jsx("h4",{children:"Issues / Concerns"}),o.jsx("p",{className:"report-issues",children:fe.issues})]}),fe.submitted_at&&o.jsx("div",{className:"report-meta",children:o.jsxs("span",{children:["Submitted by ",fe.submitted_by||"Field"," at ",M(fe.submitted_at)]})})]})]},fe.id);if(l)return o.jsx("div",{className:"loading",children:"Loading daily reports..."});const K=n.length,ae=G.length;return o.jsxs("div",{className:"daily-reports-list card",children:[o.jsxs("div",{className:"daily-reports-header",children:[o.jsx("h3",{children:"Daily Reports"}),o.jsx("div",{className:"daily-reports-actions",children:n.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:`btn btn-small ${x?"btn-primary":"btn-secondary"}`,onClick:B,children:x?"Cancel":"Select"}),o.jsxs("button",{className:"btn btn-secondary btn-small",onClick:X,children:["PDF",m.size>0?` (${m.size})`:""]})]})})]}),n.length>0&&o.jsxs("div",{className:"view-mode-bar",children:[o.jsxs("div",{className:"view-mode-tabs",children:[o.jsx("button",{className:`view-mode-tab ${b==="recent"?"active":""}`,onClick:()=>_("recent"),children:"Recent (7 days)"}),o.jsxs("button",{className:`view-mode-tab ${b==="all"?"active":""}`,onClick:()=>_("all"),children:["All (",K,")"]})]}),b==="all"&&o.jsxs("div",{className:"date-filter",children:[o.jsx(J0,{size:14,className:"date-filter-icon"}),o.jsx("input",{type:"date",value:C.start,onChange:fe=>A(U=>({...U,start:fe.target.value})),className:"date-input"}),o.jsx("span",{className:"date-separator",children:"to"}),o.jsx("input",{type:"date",value:C.end,onChange:fe=>A(U=>({...U,end:fe.target.value})),className:"date-input"}),(C.start||C.end)&&o.jsx("button",{className:"date-clear",onClick:()=>A({start:"",end:""}),children:"Clear"})]})]}),x&&G.length>0&&o.jsxs("div",{className:"select-all-bar",children:[o.jsxs("label",{className:"select-all-label",children:[o.jsx("input",{type:"checkbox",checked:m.size===G.length&&G.length>0,onChange:L}),"Select All (",G.length,")"]}),m.size>0&&o.jsxs("span",{className:"selected-count",children:[m.size," selected"]})]}),n.length===0?o.jsxs("div",{className:"reports-empty-state",children:[o.jsx("span",{className:"empty-icon",children:o.jsx(gu,{size:32})}),o.jsx("p",{children:"No daily reports yet"}),o.jsx("small",{children:"Reports from the field will appear here"})]}):G.length===0?o.jsxs("div",{className:"reports-empty-state",children:[o.jsx("span",{className:"empty-icon",children:o.jsx(gu,{size:32})}),o.jsx("p",{children:"No reports in this time period"}),o.jsx("small",{children:b==="recent"?"No reports in the last 7 days":"Try adjusting your date filter"})]}):b==="recent"?o.jsxs("div",{className:"daily-reports",children:[G.map(fe=>Z(fe)),K>ae&&o.jsx("div",{className:"view-all-prompt",children:o.jsxs("button",{className:"btn btn-secondary",onClick:()=>_("all"),children:["View All ",K," Reports"]})})]}):o.jsx("div",{className:"daily-reports grouped",children:W?.map(([fe,{label:U,reports:j}])=>o.jsxs("div",{className:"month-group",children:[o.jsxs("div",{className:"month-header",onClick:()=>J(fe),children:[w.has(fe)?o.jsx(xc,{size:18,className:"month-chevron"}):o.jsx(Of,{size:18,className:"month-chevron"}),o.jsx("span",{className:"month-label",children:U}),o.jsxs("span",{className:"month-count",children:[j.length," report",j.length!==1?"s":""]})]}),w.has(fe)&&o.jsx("div",{className:"month-reports",children:j.map(F=>Z(F))})]},fe))})]})}function XH({project:t,company:e,userName:r,onShowToast:a}){const[n,s]=ee.useState([]),[l,c]=ee.useState(!0),[f,d]=ee.useState(!1),[m,v]=ee.useState(""),[x,g]=ee.useState(0),[b,_]=ee.useState(!1),w=ee.useRef(null);ee.useEffect(()=>{E();const W=ot.subscribeToMessages?.(t.id,B=>{B.new&&(s(q=>[...q,B.new]),B.new.sender_type==="field"&&g(q=>q+1))});return()=>{W&&ot.unsubscribe?.(W)}},[t.id]),ee.useEffect(()=>{b&&(w.current?.scrollIntoView({behavior:"smooth"}),ot.markMessagesRead?.(t.id,"office"),g(0))},[n,b]);const E=async()=>{try{const B=(await ot.getMessages(t.id,50)||[]).sort((L,J)=>new Date(L.created_at)-new Date(J.created_at));s(B);const q=B.filter(L=>L.sender_type==="field"&&!L.is_read).length;g(q)}catch(W){console.error("Error loading messages:",W)}finally{c(!1)}},C=async()=>{if(m.trim()){d(!0);try{const W=await ot.sendMessage(t.id,m.trim(),"office",r||"Office");s(B=>[...B,W]),v("")}catch(W){console.error("Error sending message:",W),a?.("Error sending message","error")}finally{d(!1)}}},A=W=>{W.key==="Enter"&&!W.shiftKey&&(W.preventDefault(),C())},T=W=>{const B=new Date(W),q=new Date;return B.toDateString()===q.toDateString()?B.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}):B.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})},G=n.slice(-3);return l?o.jsxs("div",{className:"project-messages card",children:[o.jsx("div",{className:"project-messages-header",children:o.jsx("h3",{children:"Messages"})}),o.jsx("div",{className:"loading",children:"Loading messages..."})]}):o.jsxs("div",{className:`project-messages card ${b?"expanded":""}`,children:[o.jsxs("div",{className:"project-messages-header",onClick:()=>_(!b),children:[o.jsxs("div",{className:"messages-title-row",children:[o.jsx("h3",{children:"Messages"}),x>0&&o.jsxs("span",{className:"messages-unread-badge",children:[x," new"]})]}),o.jsx("button",{className:"messages-toggle-btn",children:b?" Collapse":" Expand"})]}),!b&&n.length>0&&o.jsxs("div",{className:"messages-preview",children:[G.map(W=>o.jsxs("div",{className:`preview-message ${W.sender_type}`,children:[o.jsxs("span",{className:"preview-sender",children:[W.sender_type==="office"?o.jsx(O0,{size:12,className:"inline-icon"}):o.jsx(Ys,{size:12,className:"inline-icon"})," ",W.sender_name,":"]}),o.jsxs("span",{className:"preview-text",children:[W.message?.slice(0,50),W.message?.length>50?"...":""]})]},W.id)),n.length===0&&o.jsx("p",{className:"no-messages-hint",children:"No messages yet. Click to start chatting."})]}),b&&o.jsxs("div",{className:"messages-full",children:[o.jsxs("div",{className:"messages-list-container",children:[n.length===0?o.jsxs("div",{className:"messages-empty",children:[o.jsx("span",{className:"empty-icon",children:o.jsx(Z0,{size:32})}),o.jsx("p",{children:"No messages yet"}),o.jsx("small",{children:"Send a message to the field crew"})]}):n.map(W=>o.jsxs("div",{className:`message-bubble ${W.sender_type==="office"?"sent":"received"}`,children:[o.jsxs("div",{className:"message-sender",children:[W.sender_type==="office"?o.jsx(O0,{size:14,className:"inline-icon"}):o.jsx(Ys,{size:14,className:"inline-icon"})," ",W.sender_name]}),o.jsx("div",{className:"message-text",children:W.message}),W.photo_url&&o.jsx("img",{src:W.photo_url,alt:"Attached",className:"message-photo"}),o.jsx("div",{className:"message-time",children:T(W.created_at)})]},W.id)),o.jsx("div",{ref:w})]}),o.jsxs("div",{className:"messages-input-row",children:[o.jsx("textarea",{value:m,onChange:W=>v(W.target.value),onKeyDown:A,placeholder:"Type a message...",rows:1,disabled:f}),o.jsx("button",{className:"btn btn-primary send-btn",onClick:C,disabled:f||!m.trim(),children:f?"...":"Send"})]})]})]})}function KH({project:t,company:e,onShowToast:r}){const[a,n]=ee.useState(null),[s,l]=ee.useState(!0),[c,f]=ee.useState(!1);ee.useEffect(()=>{if(t?.id&&e?.id){d();const b=ot.subscribeToCrewCheckins?.(t.id,()=>{d()});return()=>{b&&ot.unsubscribe?.(b)}}},[t?.id,e?.id]);const d=async()=>{try{const b=await ot.calculateManDayCosts(t.id,e.id,t.work_type||"demolition",t.job_type||"standard");n(b)}catch(b){console.error("Error loading man day costs:",b)}finally{l(!1)}},m=b=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(b),v=b=>new Date(b).toLocaleDateString("en-US",{month:"short",day:"numeric"}),x=b=>({foreman:"Foreman",supervisor:"Supervisor",operator:"Operator",laborer:"Laborer"})[b]||b.charAt(0).toUpperCase()+b.slice(1);if(s)return o.jsxs("div",{className:"man-day-costs card",children:[o.jsx("div",{className:"man-day-header",children:o.jsx("h3",{children:"Man Day Costs"})}),o.jsx("div",{className:"loading",children:"Loading..."})]});if(!a||a.totalManDays===0)return o.jsxs("div",{className:"man-day-costs card",children:[o.jsx("div",{className:"man-day-header",children:o.jsx("h3",{children:"Man Day Costs"})}),o.jsxs("div",{className:"man-day-empty",children:[o.jsx("span",{className:"empty-icon",children:o.jsx(Ys,{size:32})}),o.jsx("p",{children:"No crew check-ins yet"}),o.jsx("small",{children:"Costs will appear as crew checks in from the field"})]})]});const g=Object.entries(a.byRole||{});return o.jsxs("div",{className:"man-day-costs card",children:[o.jsxs("div",{className:"man-day-header",onClick:()=>f(!c),children:[o.jsxs("div",{className:"man-day-title-row",children:[o.jsx("h3",{children:"Man Day Costs"}),o.jsx("span",{className:"man-day-total",children:m(a.totalCost)})]}),o.jsx("button",{className:"man-day-toggle",children:c?" Collapse":" Details"})]}),o.jsxs("div",{className:"man-day-summary",children:[o.jsxs("div",{className:"man-day-stat",children:[o.jsx("span",{className:"stat-value",children:a.daysWorked}),o.jsx("span",{className:"stat-label",children:"Days Worked"})]}),o.jsxs("div",{className:"man-day-stat",children:[o.jsx("span",{className:"stat-value",children:a.totalManDays}),o.jsx("span",{className:"stat-label",children:"Total Man Days"})]}),o.jsxs("div",{className:"man-day-stat",children:[o.jsx("span",{className:"stat-value",children:m(a.totalCost)}),o.jsx("span",{className:"stat-label",children:"Total Labor Cost"})]}),o.jsxs("div",{className:"man-day-stat",children:[o.jsx("span",{className:"stat-value",children:a.daysWorked>0?m(a.totalCost/a.daysWorked):"$0"}),o.jsx("span",{className:"stat-label",children:"Avg Cost/Day"})]})]}),c&&o.jsxs("div",{className:"man-day-details",children:[g.length>0&&o.jsxs("div",{className:"man-day-section",children:[o.jsx("h4",{children:"By Role"}),o.jsx("div",{className:"man-day-role-list",children:g.map(([b,_])=>o.jsxs("div",{className:"man-day-role-row",children:[o.jsxs("div",{className:"role-info",children:[o.jsx("span",{className:"role-name",children:x(b)}),o.jsxs("span",{className:"role-rate",children:[m(_.rate),"/day"]})]}),o.jsxs("div",{className:"role-stats",children:[o.jsxs("span",{className:"role-count",children:[_.count," days"]}),o.jsx("span",{className:"role-cost",children:m(_.cost)})]})]},b))})]}),a.byDate?.length>0&&o.jsxs("div",{className:"man-day-section",children:[o.jsx("h4",{children:"Recent Activity"}),o.jsx("div",{className:"man-day-date-list",children:a.byDate.slice(0,7).map((b,_)=>o.jsxs("div",{className:"man-day-date-row",children:[o.jsx("span",{className:"date-label",children:v(b.date)}),o.jsxs("span",{className:"date-workers",children:[b.workers," crew"]}),o.jsx("span",{className:"date-cost",children:m(b.cost)})]},_))}),a.byDate.length>7&&o.jsxs("p",{className:"man-day-more",children:["+ ",a.byDate.length-7," more days"]})]})]})]})}const Bi=t=>((t||0)/100).toFixed(2),Xt=t=>{const e=(t||0)/100;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(e)},oc=t=>Math.round((parseFloat(t)||0)*100),cu=t=>((t||0)/100).toFixed(2),Nn=t=>`${cu(t)}%`,rf=t=>Math.round((parseFloat(t)||0)*100),JH=(t,e,r,a)=>{const n=parseFloat(t)||0,s=parseFloat(e)||0,l=parseInt(r)||0,c=parseInt(a)||0,f=Math.round(n*l),d=Math.round(s*c),m=f+d;return{regularTotal:f,overtimeTotal:d,total:m}},WS=(t,e)=>{const r=parseFloat(t)||0,a=parseInt(e)||0;return Math.round(r*a)},Dp=(t,e)=>{const r=parseInt(t)||0,a=parseInt(e)||0;return Math.round(r*a/1e4)},Kv=(t,e)=>{const r=parseInt(t)||0,a=parseInt(e)||0;return Math.round(r*a/1e4)},R1=t=>{const e=(t.change_order_labor||[]).reduce((_,w)=>_+(parseInt(w.total)||0),0),r=(t.change_order_materials||[]).reduce((_,w)=>_+(parseInt(w.total)||0),0),a=(t.change_order_equipment||[]).reduce((_,w)=>_+(parseInt(w.total)||0),0),n=(t.change_order_subcontractors||[]).reduce((_,w)=>_+(parseInt(w.total)||0),0),s=Dp(e,t.labor_markup_percent||1500),l=Dp(r,t.materials_markup_percent||1500),c=Dp(a,t.equipment_markup_percent||1500),f=Dp(n,t.subcontractors_markup_percent||500),d=e+r+a+n+s+l+c+f,m=Kv(d,t.liability_insurance_percent||144),v=Kv(d,t.bond_percent||100),x=Kv(d,t.license_fee_percent||10),g=m+v+x,b=d+g;return{labor_subtotal:e,materials_subtotal:r,equipment_subtotal:a,subcontractors_subtotal:n,labor_markup_amount:s,materials_markup_amount:l,equipment_markup_amount:c,subcontractors_markup_amount:f,liability_insurance_amount:m,bond_amount:v,license_fee_amount:x,additional_fees_total:g,cor_subtotal:d,cor_total:b}},Jv=t=>{const e=[];if(t.title?.trim()||e.push("Title is required"),t.scope_of_work?.trim()||e.push("Scope of work is required"),t.period_start||e.push("Start date is required"),t.period_end||e.push("End date is required"),t.period_start&&t.period_end){const f=new Date(t.period_start);new Date(t.period_end)<f&&e.push("End date must be after start date")}const r=(t.change_order_labor||[]).length>0,a=(t.change_order_materials||[]).length>0,n=(t.change_order_equipment||[]).length>0,s=(t.change_order_subcontractors||[]).length>0;!r&&!a&&!n&&!s&&e.push("At least one line item (labor, materials, equipment, or subcontractor) is required"),R1(t).cor_total<=0&&e.push("COR total must be greater than zero");const c=5e3;return t.labor_markup_percent>c&&e.push("Labor markup percentage seems too high (>50%)"),t.materials_markup_percent>c&&e.push("Materials markup percentage seems too high (>50%)"),t.equipment_markup_percent>c&&e.push("Equipment markup percentage seems too high (>50%)"),t.subcontractors_markup_percent>c&&e.push("Subcontractors markup percentage seems too high (>50%)"),{valid:e.length===0,errors:e}},jk=t=>{const e={draft:{label:"Draft",color:"#6b7280",bgColor:"#f3f4f6"},pending_approval:{label:"Pending Approval",color:"#d97706",bgColor:"#fef3c7"},approved:{label:"Approved",color:"#059669",bgColor:"#d1fae5"},rejected:{label:"Rejected",color:"#dc2626",bgColor:"#fee2e2"},billed:{label:"Billed",color:"#2563eb",bgColor:"#dbeafe"},closed:{label:"Closed",color:"#4b5563",bgColor:"#e5e7eb"}};return e[t]||e.draft},fc=t=>t?new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",ey=(t,e)=>{const r=fc(t),a=fc(e);return r&&a?`${r} - ${a}`:r||a||""},af={labor_markup:1500,materials_markup:1500,equipment_markup:1500,subcontractors_markup:500,liability_insurance:144,bond:100,license_fee:10},VS=["Foreman","Superintendent","Operator","Laborer"],ZH=[{value:"standard",label:"Standard"},{value:"pla",label:"PLA (Project Labor Agreement)"},{value:"prevailing",label:"Prevailing Wage"}],Zv={materials:[{value:"backup_sheet",label:"Backup Sheet"},{value:"invoice",label:"Invoice"},{value:"mobilization",label:"Mobilization"},{value:"custom",label:"Custom Entry"}],equipment:[{value:"backup_sheet",label:"Backup Sheet"},{value:"invoice",label:"Invoice"},{value:"custom",label:"Custom Entry"}],subcontractors:[{value:"invoice",label:"Invoice"},{value:"quote",label:"Quote"},{value:"custom",label:"Custom Entry"}]},GS=["each","day","week","month","hour","sqft","lf","gallon","pound","ton","cy","lump sum"];function QH({project:t,company:e,areas:r,refreshKey:a,onShowToast:n,onCreateCOR:s,onViewCOR:l,onEditCOR:c}){const[f,d]=ee.useState([]),[m,v]=ee.useState(!0),[x,g]=ee.useState("all"),[b,_]=ee.useState("all"),[w,E]=ee.useState(null),[C,A]=ee.useState(new Set),[T,G]=ee.useState("recent"),[W,B]=ee.useState(new Set),[q,L]=ee.useState({start:"",end:""}),[J,D]=ee.useState(null);ee.useEffect(()=>{O(),M();const j=ot.subscribeToCORs?.(t.id,()=>{O(),M()});return()=>{j&&ot.unsubscribe?.(j)}},[t.id,a]);const O=async()=>{try{const j=await ot.getCORs(t.id);d(j||[])}catch(j){console.error("Error loading CORs:",j),n?.("Error loading change order requests","error")}finally{v(!1)}},M=async()=>{try{const j=await ot.getCORStats?.(t.id);D(j)}catch(j){console.error("Error loading COR stats:",j)}},V=async(j,F)=>{if(F?.stopPropagation(),!!confirm("Are you sure you want to delete this COR? This action cannot be undone."))try{await ot.deleteCOR(j),d(f.filter(I=>I.id!==j)),n?.("COR deleted","success"),M()}catch(I){console.error("Error deleting COR:",I),n?.("Error deleting COR","error")}},ie=async(j,F)=>{F?.stopPropagation();try{await ot.submitCORForApproval(j),await O(),n?.("COR submitted for approval","success"),M()}catch(I){console.error("Error submitting COR:",I?.message||I),n?.(I?.message||"Error submitting COR","error")}},X=ee.useMemo(()=>{let j=[...f];if(x!=="all"&&(j=j.filter(F=>F.status===x)),b!=="all"&&(j=j.filter(F=>F.area_id===b)),q.start){const F=new Date(q.start);F.setHours(0,0,0,0),j=j.filter(I=>new Date(I.created_at)>=F)}if(q.end){const F=new Date(q.end);F.setHours(23,59,59,999),j=j.filter(I=>new Date(I.created_at)<=F)}if(T==="recent"){const F=new Date;F.setDate(F.getDate()-7),F.setHours(0,0,0,0),j=j.filter(I=>new Date(I.created_at)>=F)}return j.sort((F,I)=>new Date(I.created_at)-new Date(F.created_at)),j},[f,x,b,T,q]),Z=ee.useMemo(()=>{if(T!=="all")return null;const j={};return X.forEach(F=>{const I=new Date(F.created_at),z=`${I.getFullYear()}-${String(I.getMonth()+1).padStart(2,"0")}`,ne=I.toLocaleDateString("en-US",{month:"long",year:"numeric"});j[z]||(j[z]={label:ne,cors:[],totalAmount:0}),j[z].cors.push(F),j[z].totalAmount+=F.cor_total||0}),Object.entries(j).sort((F,I)=>I[0].localeCompare(F[0]))},[X,T]);ee.useEffect(()=>{if(Z&&Z.length>0){const j=Z[0][0];B(new Set([j]))}},[Z]);const K=j=>{const F=new Set(W);F.has(j)?F.delete(j):F.add(j),B(F)},ae=ee.useMemo(()=>({all:f.length,draft:f.filter(j=>j.status==="draft").length,pending_approval:f.filter(j=>j.status==="pending_approval").length,approved:f.filter(j=>j.status==="approved").length,rejected:f.filter(j=>j.status==="rejected").length,billed:f.filter(j=>j.status==="billed").length,closed:f.filter(j=>j.status==="closed").length}),[f]);x==="all"?f.length:f.filter(j=>j.status===x).length;const fe=j=>r?.find(I=>I.id===j)?.name||"No Area",U=j=>{const F=jk(j.status);j.id;const I=j.status==="draft",z=j.status==="draft",ne=j.status==="draft";return o.jsxs("div",{className:`cor-card ${j.status}`,onClick:()=>l?.(j),onKeyDown:se=>{(se.key==="Enter"||se.key===" ")&&(se.preventDefault(),l?.(j))},tabIndex:0,role:"button","aria-label":`View COR ${j.cor_number}: ${j.title||"Untitled"}, ${F.label}, ${Xt(j.cor_total||0)}`,children:[o.jsxs("div",{className:"cor-card-header",children:[o.jsxs("div",{className:"cor-card-left",children:[o.jsx("span",{className:"cor-number",children:j.cor_number}),o.jsx("span",{className:"cor-status-badge",style:{backgroundColor:F.bgColor,color:F.color},children:F.label})]}),o.jsx("div",{className:"cor-card-right",children:o.jsx("span",{className:"cor-total",children:Xt(j.cor_total||0)})})]}),o.jsxs("div",{className:"cor-card-body",children:[o.jsx("h4",{className:"cor-title",children:j.title||"Untitled COR"}),o.jsxs("div",{className:"cor-meta",children:[j.area_id&&o.jsx("span",{className:"cor-area",children:fe(j.area_id)}),o.jsx("span",{className:"cor-period",children:ey(j.period_start,j.period_end)})]})]}),o.jsxs("div",{className:"cor-card-footer",children:[o.jsx("span",{className:"cor-created",children:fc(j.created_at)}),o.jsxs("div",{className:"cor-actions",onClick:se=>se.stopPropagation(),children:[ne&&o.jsx("button",{className:"cor-action-btn submit",onClick:se=>ie(j.id,se),title:"Submit for Approval","aria-label":`Submit COR ${j.cor_number} for approval`,children:o.jsx(aN,{size:14,"aria-hidden":"true"})}),I&&o.jsx("button",{className:"cor-action-btn edit",onClick:se=>{se.stopPropagation(),c?.(j)},title:"Edit","aria-label":`Edit COR ${j.cor_number}`,children:o.jsx(o2,{size:14,"aria-hidden":"true"})}),o.jsx("button",{className:"cor-action-btn view",onClick:se=>{se.stopPropagation(),l?.(j)},title:"View Details","aria-label":`View COR ${j.cor_number} details`,children:o.jsx(lT,{size:14,"aria-hidden":"true"})}),z&&o.jsx("button",{className:"cor-action-btn delete",onClick:se=>V(j.id,se),title:"Delete","aria-label":`Delete COR ${j.cor_number}`,children:o.jsx(lc,{size:14,"aria-hidden":"true"})})]})]})]},j.id)};return m?o.jsx("div",{className:"loading",children:"Loading change order requests..."}):o.jsxs("div",{className:"cor-list",children:[o.jsxs("div",{className:"cor-list-header",children:[o.jsxs("div",{className:"cor-list-info",children:[o.jsx("h3",{children:"Change Orders"}),o.jsxs("div",{className:"cor-stats-inline",children:[o.jsxs("span",{className:"cor-stat-item",children:[ae.all," total"]}),ae.pending_approval>0&&o.jsxs("span",{className:"cor-stat-item pending",children:[ae.pending_approval," pending"]}),J?.totalApproved>0&&o.jsx("span",{className:"cor-stat-item approved",children:Xt(J.totalApproved)})]})]}),o.jsxs("button",{className:"btn btn-primary btn-small",onClick:s,children:[o.jsx(Wo,{size:14})," New COR"]})]}),o.jsxs("div",{className:"cor-controls",children:[o.jsx("div",{className:"cor-filter-pills",role:"tablist",children:[{id:"all",label:"All"},{id:"draft",label:"Draft"},{id:"pending_approval",label:"Pending"},{id:"approved",label:"Approved"}].map(j=>o.jsxs("button",{role:"tab","aria-selected":x===j.id,className:`cor-pill ${x===j.id?"active":""}`,onClick:()=>g(j.id),children:[j.label,ae[j.id]>0&&o.jsx("span",{className:"cor-pill-count",children:ae[j.id]})]},j.id))}),o.jsxs("div",{className:"cor-view-toggle",children:[o.jsx("button",{className:`cor-toggle-btn ${T==="recent"?"active":""}`,onClick:()=>{G("recent"),L({start:"",end:""})},children:"Recent"}),o.jsx("button",{className:`cor-toggle-btn ${T==="all"?"active":""}`,onClick:()=>G("all"),children:"All"})]})]}),T==="all"&&o.jsxs("div",{className:"cor-date-filter",children:[o.jsx(J0,{size:14}),o.jsx("input",{type:"date",value:q.start,onChange:j=>L(F=>({...F,start:j.target.value}))}),o.jsx("span",{className:"cor-date-sep",children:"to"}),o.jsx("input",{type:"date",value:q.end,onChange:j=>L(F=>({...F,end:j.target.value}))}),(q.start||q.end)&&o.jsx("button",{className:"cor-clear-btn",onClick:()=>L({start:"",end:""}),children:"Clear"})]}),X.length===0?o.jsxs("div",{className:"cor-empty",children:[o.jsx(El,{size:24,className:"cor-empty-icon"}),o.jsxs("p",{children:["No change orders ",x!=="all"?`(${x.replace("_"," ")})`:""]}),o.jsxs("button",{className:"btn btn-primary btn-small",onClick:s,children:[o.jsx(Wo,{size:14})," Create COR"]})]}):o.jsx("div",{className:"cor-cards",children:T==="all"&&Z?Z.map(([j,F])=>o.jsxs("div",{className:"cor-month-group",children:[o.jsxs("button",{className:"cor-month-header",onClick:()=>K(j),children:[o.jsxs("div",{className:"cor-month-left",children:[W.has(j)?o.jsx(xc,{size:16}):o.jsx(Of,{size:16}),o.jsx("span",{children:F.label}),o.jsx("span",{className:"cor-month-count",children:F.cors.length})]}),o.jsx("span",{className:"cor-month-total",children:Xt(F.totalAmount)})]}),W.has(j)&&o.jsx("div",{className:"cor-month-items",children:F.cors.map(I=>U(I))})]},j)):X.map(j=>U(j))})]})}function e$({projectId:t,corId:e,onImport:r,onClose:a,onShowToast:n}){const[s,l]=ee.useState([]),[c,f]=ee.useState(!0),[d,m]=ee.useState(new Set),[v,x]=ee.useState(null),[g,b]=ee.useState(""),[_,w]=ee.useState("unassigned");ee.useEffect(()=>{E()},[t]);const E=async()=>{try{const q=await ot.getTMTickets(t);l(q||[])}catch(q){console.error("Error loading tickets:",q),n?.("Error loading tickets","error")}finally{f(!1)}},C=ee.useMemo(()=>{let q=[...s];if(_==="unassigned"?q=q.filter(L=>!L.assigned_cor_id):_==="approved"&&(q=q.filter(L=>L.status==="approved")),g){const L=g.toLowerCase();q=q.filter(J=>J.work_description?.toLowerCase().includes(L)||J.ce_pco_number?.toLowerCase().includes(L)||J.ticket_date?.includes(L))}return q.sort((L,J)=>new Date(J.ticket_date)-new Date(L.ticket_date)),q},[s,_,g]),A=q=>{const L=new Set(d);L.has(q)?L.delete(q):L.add(q),m(L)},T=()=>{d.size===C.length?m(new Set):m(new Set(C.map(q=>q.id)))},G=q=>new Date(q).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),W=q=>{const L=q.workers?.length||0,J=q.items?.length||0,D=q.materials_equipment?.filter(M=>M.type==="equipment")?.length||0;let O=0;return q.workers?.forEach(M=>{O+=(parseFloat(M.regular_hours)||0)+(parseFloat(M.overtime_hours)||0)}),{workerCount:L,itemCount:J,equipmentCount:D,laborHours:O}},B=()=>{if(d.size===0){n?.("Please select at least one ticket","error");return}const q=s.filter(O=>d.has(O.id)),L=[],J=[],D=[];q.forEach(O=>{O.workers?.forEach(M=>{L.push({id:`import-${O.id}-${M.id||Date.now()}`,labor_class:M.role||"Laborer",wage_type:"standard",regular_hours:parseFloat(M.regular_hours)||0,overtime_hours:parseFloat(M.overtime_hours)||0,regular_rate:0,overtime_rate:0,total:0,source_ticket_id:O.id,source_ticket_date:O.ticket_date})}),O.items?.forEach(M=>{J.push({id:`import-${O.id}-${M.id||Date.now()}`,description:M.description||M.name,source_type:"backup_sheet",source_reference:`Ticket ${G(O.ticket_date)}`,quantity:parseFloat(M.quantity)||1,unit:M.unit||"each",unit_cost:oc(M.unit_cost||0),total:oc((M.quantity||1)*(M.unit_cost||0)),source_ticket_id:O.id})}),O.materials_equipment?.filter(M=>M.type==="equipment").forEach(M=>{D.push({id:`import-${O.id}-${M.id||Date.now()}`,description:M.description||M.name,source_type:"backup_sheet",source_reference:`Ticket ${G(O.ticket_date)}`,quantity:parseFloat(M.quantity)||1,unit:M.unit||"day",unit_cost:oc(M.unit_cost||M.cost||0),total:oc((M.quantity||1)*(M.unit_cost||M.cost||0)),source_ticket_id:O.id})})}),r?.({ticketIds:Array.from(d),laborItems:L,materialsItems:J,equipmentItems:D}),a?.()};return c?o.jsx("div",{className:"modal-overlay",onClick:a,role:"dialog","aria-modal":"true","aria-label":"Loading tickets",children:o.jsx("div",{className:"modal-content ticket-selector-modal",onClick:q=>q.stopPropagation(),children:o.jsx("div",{className:"loading",role:"status","aria-live":"polite",children:"Loading tickets..."})})}):o.jsx("div",{className:"modal-overlay",onClick:a,role:"dialog","aria-modal":"true","aria-labelledby":"ticket-selector-title",children:o.jsxs("div",{className:"modal-content ticket-selector-modal",onClick:q=>q.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{id:"ticket-selector-title",children:"Import from T&M Tickets"}),o.jsx("button",{className:"close-btn",onClick:a,"aria-label":"Close ticket selector",children:o.jsx(Rf,{size:20,"aria-hidden":"true"})})]}),o.jsxs("div",{className:"ticket-selector-controls",children:[o.jsxs("div",{className:"ticket-search",children:[o.jsx(PT,{size:16,"aria-hidden":"true"}),o.jsx("input",{type:"text",placeholder:"Search tickets...",value:g,onChange:q=>b(q.target.value),"aria-label":"Search tickets"})]}),o.jsxs("div",{className:"ticket-filters",role:"group","aria-label":"Filter tickets by status",children:[o.jsx("button",{className:`filter-btn ${_==="unassigned"?"active":""}`,onClick:()=>w("unassigned"),"aria-pressed":_==="unassigned",children:"Unassigned"}),o.jsx("button",{className:`filter-btn ${_==="approved"?"active":""}`,onClick:()=>w("approved"),"aria-pressed":_==="approved",children:"Approved"}),o.jsx("button",{className:`filter-btn ${_==="all"?"active":""}`,onClick:()=>w("all"),"aria-pressed":_==="all",children:"All"})]})]}),o.jsxs("div",{className:"ticket-selector-header",children:[o.jsxs("label",{className:"select-all",children:[o.jsx("input",{type:"checkbox",checked:d.size===C.length&&C.length>0,onChange:T,"aria-label":`Select all ${C.length} tickets`}),o.jsxs("span",{children:["Select All (",C.length,")"]})]}),o.jsxs("span",{className:"selected-count",children:[d.size," selected"]})]}),o.jsx("div",{className:"modal-body ticket-selector-body",children:C.length===0?o.jsxs("div",{className:"ticket-empty",children:[o.jsx(El,{size:32}),o.jsx("p",{children:"No tickets found"}),_==="unassigned"&&o.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>w("all"),children:"Show all tickets"})]}):o.jsx("div",{className:"ticket-list",children:C.map(q=>{const L=W(q),J=d.has(q.id),D=v===q.id;return o.jsxs("div",{className:`ticket-item ${J?"selected":""} ${q.assigned_cor_id?"assigned":""}`,children:[o.jsxs("div",{className:"ticket-item-main",children:[o.jsx("label",{className:"ticket-checkbox",children:o.jsx("input",{type:"checkbox",checked:J,onChange:()=>A(q.id),disabled:q.assigned_cor_id&&q.assigned_cor_id!==e})}),o.jsxs("div",{className:"ticket-item-info",onClick:()=>x(D?null:q.id),children:[o.jsxs("div",{className:"ticket-item-header",children:[o.jsx("span",{className:"ticket-date",children:G(q.ticket_date)}),o.jsx("span",{className:`ticket-status ${q.status}`,children:q.status}),q.ce_pco_number&&o.jsxs("span",{className:"ticket-pco",children:["CE/PCO: ",q.ce_pco_number]})]}),o.jsx("div",{className:"ticket-item-desc",children:q.work_description||"No description"}),o.jsxs("div",{className:"ticket-item-summary",children:[L.workerCount>0&&o.jsxs("span",{children:[o.jsx(y1,{size:12})," ",L.workerCount," workers"]}),L.itemCount>0&&o.jsxs("span",{children:[o.jsx(yc,{size:12})," ",L.itemCount," items"]}),L.equipmentCount>0&&o.jsxs("span",{children:[o.jsx(ph,{size:12})," ",L.equipmentCount," equipment"]}),L.laborHours>0&&o.jsxs("span",{children:[L.laborHours," hrs"]})]})]}),o.jsx("button",{className:"ticket-expand-btn",onClick:()=>x(D?null:q.id),children:D?o.jsx(xc,{size:16}):o.jsx(Of,{size:16})})]}),D&&o.jsxs("div",{className:"ticket-item-details",children:[q.workers?.length>0&&o.jsxs("div",{className:"ticket-detail-section",children:[o.jsx("h5",{children:"Workers"}),o.jsx("ul",{children:q.workers.map((O,M)=>o.jsxs("li",{children:[O.name||O.role," - ",O.regular_hours||0," reg hrs",O.overtime_hours>0&&`, ${O.overtime_hours} OT hrs`]},M))})]}),q.items?.length>0&&o.jsxs("div",{className:"ticket-detail-section",children:[o.jsx("h5",{children:"Materials"}),o.jsx("ul",{children:q.items.map((O,M)=>o.jsxs("li",{children:[O.description||O.name," - ",O.quantity," ",O.unit]},M))})]}),q.materials_equipment?.filter(O=>O.type==="equipment").length>0&&o.jsxs("div",{className:"ticket-detail-section",children:[o.jsx("h5",{children:"Equipment"}),o.jsx("ul",{children:q.materials_equipment.filter(O=>O.type==="equipment").map((O,M)=>o.jsx("li",{children:O.description||O.name},M))})]})]})]},q.id)})})}),o.jsxs("div",{className:"modal-footer",children:[o.jsx("button",{className:"btn btn-secondary",onClick:a,children:"Cancel"}),o.jsxs("button",{className:"btn btn-primary",onClick:B,disabled:d.size===0,children:[o.jsx(R0,{size:16})," Import ",d.size," Ticket",d.size!==1?"s":""]})]})]})})}const Fp=[{id:1,label:"Title & Info",shortLabel:"Info"},{id:2,label:"Period",shortLabel:"Period"},{id:3,label:"Labor",shortLabel:"Labor"},{id:4,label:"Materials",shortLabel:"Materials"},{id:5,label:"Equipment",shortLabel:"Equipment"},{id:6,label:"Subcontractors",shortLabel:"Subs"},{id:7,label:"Markups & Fees",shortLabel:"Markups"},{id:8,label:"Summary",shortLabel:"Summary"},{id:9,label:"Submit",shortLabel:"Submit"}];function t$({project:t,company:e,areas:r,existingCOR:a,onClose:n,onSaved:s,onShowToast:l}){const[c,f]=ee.useState(1),[d,m]=ee.useState(!1),[v,x]=ee.useState([]),[g,b]=ee.useState(!1),[_,w]=ee.useState(a?.title||""),[E,C]=ee.useState(a?.scope_of_work||""),[A,T]=ee.useState(a?.area_id||""),[G,W]=ee.useState(a?.cor_number||""),[B,q]=ee.useState(a?.period_start||""),[L,J]=ee.useState(a?.period_end||""),[D,O]=ee.useState(a?.change_order_labor||[]),[M,V]=ee.useState(a?.change_order_materials||[]),[ie,X]=ee.useState(a?.change_order_equipment||[]),[Z,K]=ee.useState(a?.change_order_subcontractors||[]),[ae,fe]=ee.useState(a?.labor_markup_percent??af.labor_markup),[U,j]=ee.useState(a?.materials_markup_percent??af.materials_markup),[F,I]=ee.useState(a?.equipment_markup_percent??af.equipment_markup),[z,ne]=ee.useState(a?.subcontractors_markup_percent??af.subcontractors_markup),[se,pe]=ee.useState(a?.liability_insurance_percent??af.liability_insurance),[ye,_e]=ee.useState(a?.bond_percent??af.bond),[Le,ue]=ee.useState(a?.license_fee_percent??af.license_fee);ee.useEffect(()=>{at(),a||de()},[]);const at=async()=>{try{const xe=await ot.getLaborRates?.(e?.id,t?.work_type,t?.job_type);x(xe||[])}catch(xe){console.error("Error loading labor rates:",xe)}},ht=xe=>{const Be=xe?.toLowerCase()||"";return v.find(Pe=>Pe.role?.toLowerCase()===Be)||null},de=async()=>{try{const xe=await ot.getNextCORNumber?.(t.id);W(xe||`COR-${Date.now()}`)}catch(xe){console.error("Error generating COR number:",xe),W(`COR-${Date.now()}`)}},it=ee.useMemo(()=>({title:_,scope_of_work:E,area_id:A||null,cor_number:G,period_start:B,period_end:L,change_order_labor:D,change_order_materials:M,change_order_equipment:ie,change_order_subcontractors:Z,labor_markup_percent:ae,materials_markup_percent:U,equipment_markup_percent:F,subcontractors_markup_percent:z,liability_insurance_percent:se,bond_percent:ye,license_fee_percent:Le}),[_,E,A,G,B,L,D,M,ie,Z,ae,U,F,z,se,ye,Le]),Se=ee.useMemo(()=>R1(it),[it]),ve=xe=>{switch(xe){case 1:return _.trim()?E.trim()?!0:(l?.("Scope of work is required","error"),!1):(l?.("Title is required","error"),!1);case 2:return B?L?new Date(L)<new Date(B)?(l?.("End date must be after start date","error"),!1):!0:(l?.("End date is required","error"),!1):(l?.("Start date is required","error"),!1);default:return!0}},Ie=()=>{ve(c)&&f(Math.min(c+1,Fp.length))},wt=()=>{f(Math.max(c-1,1))},Xe=xe=>{if(xe<c)f(xe);else if(xe>c){for(let Be=c;Be<xe;Be++)if(!ve(Be))return;f(xe)}},ct=()=>{const xe=VS[0],Be=ht(xe);O([...D,{id:`temp-${Date.now()}`,labor_class:xe,wage_type:"standard",regular_hours:0,overtime_hours:0,regular_rate:Be?Math.round((parseFloat(Be.regular_rate)||0)*100):0,overtime_rate:Be?Math.round((parseFloat(Be.overtime_rate)||0)*100):0,total:0}])},jt=(xe,Be,Pe)=>{const Ct=[...D];if(Ct[xe]={...Ct[xe],[Be]:Pe},Be==="labor_class"){const Rt=ht(Pe);Rt&&(Ct[xe].regular_rate=Math.round((parseFloat(Rt.regular_rate)||0)*100),Ct[xe].overtime_rate=Math.round((parseFloat(Rt.overtime_rate)||0)*100))}const{total:gt}=JH(Ct[xe].regular_hours,Ct[xe].overtime_hours,Ct[xe].regular_rate,Ct[xe].overtime_rate);Ct[xe].total=gt,O(Ct)},Lt=xe=>{O(D.filter((Be,Pe)=>Pe!==xe))},Vt=()=>{V([...M,{id:`temp-${Date.now()}`,description:"",source_type:"backup_sheet",source_reference:"",quantity:1,unit:"each",unit_cost:0,total:0}])},$t=(xe,Be,Pe)=>{const Ct=[...M];Ct[xe]={...Ct[xe],[Be]:Pe},Ct[xe].total=WS(Ct[xe].quantity,Ct[xe].unit_cost),V(Ct)},Wt=xe=>{V(M.filter((Be,Pe)=>Pe!==xe))},Ot=()=>{X([...ie,{id:`temp-${Date.now()}`,description:"",source_type:"backup_sheet",source_reference:"",quantity:1,unit:"day",unit_cost:0,total:0}])},kt=(xe,Be,Pe)=>{const Ct=[...ie];Ct[xe]={...Ct[xe],[Be]:Pe},Ct[xe].total=WS(Ct[xe].quantity,Ct[xe].unit_cost),X(Ct)},qe=xe=>{X(ie.filter((Be,Pe)=>Pe!==xe))},Ye=()=>{K([...Z,{id:`temp-${Date.now()}`,company_name:"",description:"",source_type:"invoice",source_reference:"",amount:0,total:0}])},Pt=(xe,Be,Pe)=>{const Ct=[...Z];Ct[xe]={...Ct[xe],[Be]:Pe},Be==="amount"&&(Ct[xe].total=parseInt(Pe)||0),K(Ct)},Et=xe=>{K(Z.filter((Be,Pe)=>Pe!==xe))},Dt=xe=>{xe.laborItems?.length>0&&O([...D,...xe.laborItems]),xe.materialsItems?.length>0&&V([...M,...xe.materialsItems]),xe.equipmentItems?.length>0&&X([...ie,...xe.equipmentItems]),l?.(`Imported data from ${xe.ticketIds.length} ticket(s)`,"success")},Ce=async()=>{m(!0);try{const xe={company_id:e.id,project_id:t.id,...it,...Se,status:"draft"};let Be;a?.id?Be=await ot.updateCOR(a.id,xe):Be=await ot.createCOR(xe),Be?.id&&await ot.saveCORLineItems(Be.id,{laborItems:D,materialItems:M,equipmentItems:ie,subcontractorItems:Z}),l?.("COR saved as draft","success"),s?.(Be),n?.()}catch(xe){console.error("Error saving COR:",xe),l?.("Error saving COR","error")}finally{m(!1)}},$e=async()=>{const xe=Jv(it);if(!xe.valid){l?.(xe.errors[0],"error");return}m(!0);try{const Be={company_id:e.id,project_id:t.id,...it,...Se,status:"pending_approval"};let Pe;a?.id?(Pe=await ot.updateCOR(a.id,{...Be,status:"draft"}),await ot.saveCORLineItems(a.id,{laborItems:D,materialItems:M,equipmentItems:ie,subcontractorItems:Z}),await ot.submitCORForApproval(a.id)):(Pe=await ot.createCOR({...Be,status:"draft"}),Pe?.id&&(await ot.saveCORLineItems(Pe.id,{laborItems:D,materialItems:M,equipmentItems:ie,subcontractorItems:Z}),await ot.submitCORForApproval(Pe.id))),l?.("COR submitted for approval","success"),s?.(Pe),n?.()}catch(Be){console.error("Error submitting COR:",Be),l?.("Error submitting COR","error")}finally{m(!1)}};return o.jsxs("div",{className:"modal-overlay",onClick:n,children:[o.jsxs("div",{className:"modal-content cor-form-modal",onClick:xe=>xe.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:a?"Edit Change Order Request":"New Change Order Request"}),o.jsx("button",{className:"close-btn",onClick:n,children:o.jsx(Rf,{size:20})})]}),o.jsx("div",{className:"cor-progress-steps",children:Fp.map(xe=>o.jsxs("div",{className:`cor-step ${c>=xe.id?"active":""} ${c===xe.id?"current":""}`,onClick:()=>Xe(xe.id),children:[o.jsx("span",{className:"cor-step-number",children:xe.id}),o.jsx("span",{className:"cor-step-label",children:xe.shortLabel})]},xe.id))}),o.jsxs("div",{className:"modal-body cor-form-body",children:[c===1&&o.jsxs("div",{className:"cor-form-step",children:[o.jsx("h3",{children:"Basic Information"}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"COR Number"}),o.jsx("input",{type:"text",value:G,onChange:xe=>W(xe.target.value),placeholder:"Auto-generated",className:"input-readonly",readOnly:!0})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Title *"}),o.jsx("input",{type:"text",value:_,onChange:xe=>w(xe.target.value),placeholder:"e.g., Additional Demolition Work - Building A"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Scope of Work *"}),o.jsx("textarea",{value:E,onChange:xe=>C(xe.target.value),rows:4,placeholder:"Describe the scope of work covered by this change order..."})]}),r&&r.length>0&&o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Work Area (Optional)"}),o.jsxs("select",{value:A,onChange:xe=>T(xe.target.value),children:[o.jsx("option",{value:"",children:"No specific area"}),r.map(xe=>o.jsx("option",{value:xe.id,children:xe.name},xe.id))]})]})]}),c===2&&o.jsxs("div",{className:"cor-form-step",children:[o.jsx("h3",{children:"Work Period"}),o.jsx("p",{className:"step-description",children:"Specify the date range for this change order work."}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Start Date *"}),o.jsx("input",{type:"date",value:B,onChange:xe=>q(xe.target.value)})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"End Date *"}),o.jsx("input",{type:"date",value:L,onChange:xe=>J(xe.target.value),min:B})]})]})]}),c===3&&o.jsxs("div",{className:"cor-form-step",children:[o.jsxs("div",{className:"step-header",children:[o.jsxs("div",{children:[o.jsx("h3",{children:"Labor"}),o.jsx("p",{className:"step-description",children:"Add labor costs for this change order."})]}),o.jsxs("div",{className:"step-header-actions",children:[o.jsxs("button",{className:"btn btn-ghost",onClick:()=>b(!0),children:[o.jsx(El,{size:16})," Import from Tickets"]}),o.jsxs("button",{className:"btn btn-secondary",onClick:ct,children:[o.jsx(Wo,{size:16})," Add Labor"]})]})]}),D.length===0?o.jsxs("div",{className:"empty-items",children:[o.jsx("p",{children:"No labor items added yet."}),o.jsxs("button",{className:"btn btn-primary",onClick:ct,children:[o.jsx(Wo,{size:16})," Add First Labor Item"]})]}):o.jsx("div",{className:"line-items-list",children:D.map((xe,Be)=>o.jsxs("div",{className:"line-item labor-item",children:[o.jsxs("div",{className:"line-item-header",children:[o.jsxs("span",{className:"line-item-number",children:["#",Be+1]}),o.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>Lt(Be),children:o.jsx(lc,{size:14})})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Labor Class"}),o.jsx("select",{value:xe.labor_class,onChange:Pe=>jt(Be,"labor_class",Pe.target.value),children:VS.map(Pe=>o.jsx("option",{value:Pe,children:Pe},Pe))})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Wage Type"}),o.jsx("select",{value:xe.wage_type,onChange:Pe=>jt(Be,"wage_type",Pe.target.value),children:ZH.map(Pe=>o.jsx("option",{value:Pe.value,children:Pe.label},Pe.value))})]})]}),o.jsxs("div",{className:"form-row four-col",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Reg Hours"}),o.jsx("input",{type:"number",step:"0.5",min:"0",value:xe.regular_hours,onChange:Pe=>jt(Be,"regular_hours",Pe.target.value)})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Reg Rate ($/hr)"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:Bi(xe.regular_rate),onChange:Pe=>jt(Be,"regular_rate",oc(Pe.target.value))})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"OT Hours"}),o.jsx("input",{type:"number",step:"0.5",min:"0",value:xe.overtime_hours,onChange:Pe=>jt(Be,"overtime_hours",Pe.target.value)})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"OT Rate ($/hr)"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:Bi(xe.overtime_rate),onChange:Pe=>jt(Be,"overtime_rate",oc(Pe.target.value))})]})]}),o.jsxs("div",{className:"line-item-total",children:["Total: ",o.jsx("strong",{children:Xt(xe.total)})]})]},xe.id||Be))}),o.jsxs("div",{className:"section-subtotal",children:["Labor Subtotal: ",o.jsx("strong",{children:Xt(Se.labor_subtotal)})]})]}),c===4&&o.jsxs("div",{className:"cor-form-step",children:[o.jsxs("div",{className:"step-header",children:[o.jsxs("div",{children:[o.jsx("h3",{children:"Materials"}),o.jsx("p",{className:"step-description",children:"Add material costs for this change order."})]}),o.jsxs("button",{className:"btn btn-secondary",onClick:Vt,children:[o.jsx(Wo,{size:16})," Add Material"]})]}),M.length===0?o.jsxs("div",{className:"empty-items",children:[o.jsx("p",{children:"No materials added yet."}),o.jsxs("button",{className:"btn btn-primary",onClick:Vt,children:[o.jsx(Wo,{size:16})," Add First Material"]})]}):o.jsx("div",{className:"line-items-list",children:M.map((xe,Be)=>o.jsxs("div",{className:"line-item",children:[o.jsxs("div",{className:"line-item-header",children:[o.jsxs("span",{className:"line-item-number",children:["#",Be+1]}),o.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>Wt(Be),children:o.jsx(lc,{size:14})})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Description"}),o.jsx("input",{type:"text",value:xe.description,onChange:Pe=>$t(Be,"description",Pe.target.value),placeholder:"Material description"})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Source"}),o.jsx("select",{value:xe.source_type,onChange:Pe=>$t(Be,"source_type",Pe.target.value),children:Zv.materials.map(Pe=>o.jsx("option",{value:Pe.value,children:Pe.label},Pe.value))})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Reference"}),o.jsx("input",{type:"text",value:xe.source_reference,onChange:Pe=>$t(Be,"source_reference",Pe.target.value),placeholder:"Ticket #, Invoice #"})]})]}),o.jsxs("div",{className:"form-row three-col",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Quantity"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:xe.quantity,onChange:Pe=>$t(Be,"quantity",Pe.target.value)})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Unit"}),o.jsx("select",{value:xe.unit,onChange:Pe=>$t(Be,"unit",Pe.target.value),children:GS.map(Pe=>o.jsx("option",{value:Pe,children:Pe},Pe))})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Unit Cost ($)"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:Bi(xe.unit_cost),onChange:Pe=>$t(Be,"unit_cost",oc(Pe.target.value))})]})]}),o.jsxs("div",{className:"line-item-total",children:["Total: ",o.jsx("strong",{children:Xt(xe.total)})]})]},xe.id||Be))}),o.jsxs("div",{className:"section-subtotal",children:["Materials Subtotal: ",o.jsx("strong",{children:Xt(Se.materials_subtotal)})]})]}),c===5&&o.jsxs("div",{className:"cor-form-step",children:[o.jsxs("div",{className:"step-header",children:[o.jsxs("div",{children:[o.jsx("h3",{children:"Equipment"}),o.jsx("p",{className:"step-description",children:"Add equipment rental costs for this change order."})]}),o.jsxs("button",{className:"btn btn-secondary",onClick:Ot,children:[o.jsx(Wo,{size:16})," Add Equipment"]})]}),ie.length===0?o.jsxs("div",{className:"empty-items",children:[o.jsx("p",{children:"No equipment added yet."}),o.jsxs("button",{className:"btn btn-primary",onClick:Ot,children:[o.jsx(Wo,{size:16})," Add First Equipment"]})]}):o.jsx("div",{className:"line-items-list",children:ie.map((xe,Be)=>o.jsxs("div",{className:"line-item",children:[o.jsxs("div",{className:"line-item-header",children:[o.jsxs("span",{className:"line-item-number",children:["#",Be+1]}),o.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>qe(Be),children:o.jsx(lc,{size:14})})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Description"}),o.jsx("input",{type:"text",value:xe.description,onChange:Pe=>kt(Be,"description",Pe.target.value),placeholder:"Equipment description"})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Source"}),o.jsx("select",{value:xe.source_type,onChange:Pe=>kt(Be,"source_type",Pe.target.value),children:Zv.equipment.map(Pe=>o.jsx("option",{value:Pe.value,children:Pe.label},Pe.value))})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Reference"}),o.jsx("input",{type:"text",value:xe.source_reference,onChange:Pe=>kt(Be,"source_reference",Pe.target.value),placeholder:"Ticket #, Invoice #"})]})]}),o.jsxs("div",{className:"form-row three-col",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Quantity"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:xe.quantity,onChange:Pe=>kt(Be,"quantity",Pe.target.value)})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Unit"}),o.jsx("select",{value:xe.unit,onChange:Pe=>kt(Be,"unit",Pe.target.value),children:GS.map(Pe=>o.jsx("option",{value:Pe,children:Pe},Pe))})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Unit Cost ($)"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:Bi(xe.unit_cost),onChange:Pe=>kt(Be,"unit_cost",oc(Pe.target.value))})]})]}),o.jsxs("div",{className:"line-item-total",children:["Total: ",o.jsx("strong",{children:Xt(xe.total)})]})]},xe.id||Be))}),o.jsxs("div",{className:"section-subtotal",children:["Equipment Subtotal: ",o.jsx("strong",{children:Xt(Se.equipment_subtotal)})]})]}),c===6&&o.jsxs("div",{className:"cor-form-step",children:[o.jsxs("div",{className:"step-header",children:[o.jsxs("div",{children:[o.jsx("h3",{children:"Subcontractors"}),o.jsx("p",{className:"step-description",children:"Add subcontractor costs for this change order."})]}),o.jsxs("button",{className:"btn btn-secondary",onClick:Ye,children:[o.jsx(Wo,{size:16})," Add Subcontractor"]})]}),Z.length===0?o.jsxs("div",{className:"empty-items",children:[o.jsx("p",{children:"No subcontractors added yet."}),o.jsxs("button",{className:"btn btn-primary",onClick:Ye,children:[o.jsx(Wo,{size:16})," Add First Subcontractor"]})]}):o.jsx("div",{className:"line-items-list",children:Z.map((xe,Be)=>o.jsxs("div",{className:"line-item",children:[o.jsxs("div",{className:"line-item-header",children:[o.jsxs("span",{className:"line-item-number",children:["#",Be+1]}),o.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>Et(Be),children:o.jsx(lc,{size:14})})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Company Name"}),o.jsx("input",{type:"text",value:xe.company_name,onChange:Pe=>Pt(Be,"company_name",Pe.target.value),placeholder:"Subcontractor company name"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Description of Work"}),o.jsx("input",{type:"text",value:xe.description,onChange:Pe=>Pt(Be,"description",Pe.target.value),placeholder:"Work performed"})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Source"}),o.jsx("select",{value:xe.source_type,onChange:Pe=>Pt(Be,"source_type",Pe.target.value),children:Zv.subcontractors.map(Pe=>o.jsx("option",{value:Pe.value,children:Pe.label},Pe.value))})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Reference"}),o.jsx("input",{type:"text",value:xe.source_reference,onChange:Pe=>Pt(Be,"source_reference",Pe.target.value),placeholder:"Invoice #, Quote #"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Amount ($)"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:Bi(xe.amount),onChange:Pe=>Pt(Be,"amount",oc(Pe.target.value))})]})]}),o.jsxs("div",{className:"line-item-total",children:["Total: ",o.jsx("strong",{children:Xt(xe.total)})]})]},xe.id||Be))}),o.jsxs("div",{className:"section-subtotal",children:["Subcontractors Subtotal: ",o.jsx("strong",{children:Xt(Se.subcontractors_subtotal)})]})]}),c===7&&o.jsxs("div",{className:"cor-form-step",children:[o.jsx("h3",{children:"Markups & Fees"}),o.jsx("p",{className:"step-description",children:"Configure markup percentages and additional fees."}),o.jsxs("div",{className:"markups-section",children:[o.jsx("h4",{children:"Markups"}),o.jsxs("div",{className:"markups-grid",children:[o.jsxs("div",{className:"markup-item",children:[o.jsx("label",{children:"Labor Markup"}),o.jsxs("div",{className:"markup-input",children:[o.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:cu(ae),onChange:xe=>fe(rf(xe.target.value))}),o.jsx("span",{children:"%"})]}),o.jsxs("span",{className:"markup-amount",children:["+",Xt(Se.labor_markup_amount)]})]}),o.jsxs("div",{className:"markup-item",children:[o.jsx("label",{children:"Materials Markup"}),o.jsxs("div",{className:"markup-input",children:[o.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:cu(U),onChange:xe=>j(rf(xe.target.value))}),o.jsx("span",{children:"%"})]}),o.jsxs("span",{className:"markup-amount",children:["+",Xt(Se.materials_markup_amount)]})]}),o.jsxs("div",{className:"markup-item",children:[o.jsx("label",{children:"Equipment Markup"}),o.jsxs("div",{className:"markup-input",children:[o.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:cu(F),onChange:xe=>I(rf(xe.target.value))}),o.jsx("span",{children:"%"})]}),o.jsxs("span",{className:"markup-amount",children:["+",Xt(Se.equipment_markup_amount)]})]}),o.jsxs("div",{className:"markup-item",children:[o.jsx("label",{children:"Subcontractors Markup"}),o.jsxs("div",{className:"markup-input",children:[o.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:cu(z),onChange:xe=>ne(rf(xe.target.value))}),o.jsx("span",{children:"%"})]}),o.jsxs("span",{className:"markup-amount",children:["+",Xt(Se.subcontractors_markup_amount)]})]})]})]}),o.jsxs("div",{className:"fees-section",children:[o.jsx("h4",{children:"Additional Fees"}),o.jsxs("div",{className:"fees-grid",children:[o.jsxs("div",{className:"fee-item",children:[o.jsx("label",{children:"Liability Insurance"}),o.jsxs("div",{className:"fee-input",children:[o.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:cu(se),onChange:xe=>pe(rf(xe.target.value))}),o.jsx("span",{children:"%"})]}),o.jsxs("span",{className:"fee-amount",children:["+",Xt(Se.liability_insurance_amount)]})]}),o.jsxs("div",{className:"fee-item",children:[o.jsx("label",{children:"Bond"}),o.jsxs("div",{className:"fee-input",children:[o.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:cu(ye),onChange:xe=>_e(rf(xe.target.value))}),o.jsx("span",{children:"%"})]}),o.jsxs("span",{className:"fee-amount",children:["+",Xt(Se.bond_amount)]})]}),o.jsxs("div",{className:"fee-item",children:[o.jsx("label",{children:"City License Fee"}),o.jsxs("div",{className:"fee-input",children:[o.jsx("input",{type:"number",step:"0.001",min:"0",max:"100",value:cu(Le),onChange:xe=>ue(rf(xe.target.value))}),o.jsx("span",{children:"%"})]}),o.jsxs("span",{className:"fee-amount",children:["+",Xt(Se.license_fee_amount)]})]})]})]})]}),c===8&&o.jsxs("div",{className:"cor-form-step",children:[o.jsx("h3",{children:"Summary"}),o.jsxs("div",{className:"cor-summary",children:[o.jsxs("div",{className:"summary-header",children:[o.jsx("div",{className:"summary-title",children:_||"Untitled COR"}),o.jsx("div",{className:"summary-number",children:G})]}),o.jsxs("div",{className:"summary-section",children:[o.jsx("h4",{children:"Costs Breakdown"}),o.jsxs("div",{className:"summary-line",children:[o.jsxs("span",{children:["Labor (",D.length," items)"]}),o.jsx("span",{children:Xt(Se.labor_subtotal)})]}),o.jsxs("div",{className:"summary-line indent",children:[o.jsxs("span",{children:["+ Markup (",Nn(ae),")"]}),o.jsx("span",{children:Xt(Se.labor_markup_amount)})]}),o.jsxs("div",{className:"summary-line",children:[o.jsxs("span",{children:["Materials (",M.length," items)"]}),o.jsx("span",{children:Xt(Se.materials_subtotal)})]}),o.jsxs("div",{className:"summary-line indent",children:[o.jsxs("span",{children:["+ Markup (",Nn(U),")"]}),o.jsx("span",{children:Xt(Se.materials_markup_amount)})]}),o.jsxs("div",{className:"summary-line",children:[o.jsxs("span",{children:["Equipment (",ie.length," items)"]}),o.jsx("span",{children:Xt(Se.equipment_subtotal)})]}),o.jsxs("div",{className:"summary-line indent",children:[o.jsxs("span",{children:["+ Markup (",Nn(F),")"]}),o.jsx("span",{children:Xt(Se.equipment_markup_amount)})]}),o.jsxs("div",{className:"summary-line",children:[o.jsxs("span",{children:["Subcontractors (",Z.length," items)"]}),o.jsx("span",{children:Xt(Se.subcontractors_subtotal)})]}),o.jsxs("div",{className:"summary-line indent",children:[o.jsxs("span",{children:["+ Markup (",Nn(z),")"]}),o.jsx("span",{children:Xt(Se.subcontractors_markup_amount)})]})]}),o.jsxs("div",{className:"summary-subtotal",children:[o.jsx("span",{children:"COR Subtotal"}),o.jsx("span",{children:Xt(Se.cor_subtotal)})]}),o.jsxs("div",{className:"summary-section",children:[o.jsx("h4",{children:"Additional Fees"}),o.jsxs("div",{className:"summary-line",children:[o.jsxs("span",{children:["Liability Insurance (",Nn(se),")"]}),o.jsx("span",{children:Xt(Se.liability_insurance_amount)})]}),o.jsxs("div",{className:"summary-line",children:[o.jsxs("span",{children:["Bond (",Nn(ye),")"]}),o.jsx("span",{children:Xt(Se.bond_amount)})]}),o.jsxs("div",{className:"summary-line",children:[o.jsxs("span",{children:["City License Fee (",Nn(Le),")"]}),o.jsx("span",{children:Xt(Se.license_fee_amount)})]})]}),o.jsxs("div",{className:"summary-total",children:[o.jsx("span",{children:"COR Total"}),o.jsx("span",{children:Xt(Se.cor_total)})]})]})]}),c===9&&o.jsxs("div",{className:"cor-form-step",children:[o.jsx("h3",{children:"Submit Change Order Request"}),o.jsxs("div",{className:"submit-preview",children:[o.jsxs("div",{className:"preview-card",children:[o.jsxs("div",{className:"preview-header",children:[o.jsx("span",{className:"preview-number",children:G}),o.jsx("span",{className:"preview-total",children:Xt(Se.cor_total)})]}),o.jsx("div",{className:"preview-title",children:_}),o.jsx("div",{className:"preview-scope",children:E})]}),(()=>{const xe=Jv(it);return xe.valid?o.jsx("div",{className:"validation-success",children:"Ready to submit for approval!"}):o.jsxs("div",{className:"validation-errors",children:[o.jsx(mh,{size:20}),o.jsxs("div",{children:[o.jsx("strong",{children:"Please fix the following issues:"}),o.jsx("ul",{children:xe.errors.map((Be,Pe)=>o.jsx("li",{children:Be},Pe))})]})]})})(),o.jsxs("div",{className:"submit-actions",children:[o.jsxs("button",{className:"btn btn-secondary",onClick:Ce,disabled:d,children:[o.jsx(lw,{size:16})," Save as Draft"]}),o.jsxs("button",{className:"btn btn-primary",onClick:$e,disabled:d||!Jv(it).valid,children:[o.jsx(aN,{size:16})," Submit for Approval"]})]})]})]})]}),o.jsxs("div",{className:"modal-footer cor-form-footer",children:[o.jsx("div",{className:"footer-left",children:c>1&&o.jsxs("button",{className:"btn btn-secondary",onClick:wt,disabled:d,children:[o.jsx(GC,{size:16})," Back"]})}),o.jsx("div",{className:"footer-center",children:o.jsxs("span",{className:"step-indicator",children:["Step ",c," of ",Fp.length]})}),o.jsxs("div",{className:"footer-right",children:[c<Fp.length&&o.jsxs("button",{className:"btn btn-primary",onClick:Ie,disabled:d,children:["Next ",o.jsx(Of,{size:16})]}),c>1&&c<9&&o.jsxs("button",{className:"btn btn-ghost",onClick:Ce,disabled:d,children:[o.jsx(lw,{size:14})," Save Draft"]})]})]})]}),g&&o.jsx(e$,{projectId:t.id,corId:a?.id,onImport:Dt,onClose:()=>b(!1),onShowToast:l})]})}const r$=t=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:[30,41,59]},a$=t=>new Promise(e=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{const a=document.createElement("canvas");a.width=r.width,a.height=r.height,a.getContext("2d").drawImage(r,0,0),e(a.toDataURL("image/png"))},r.onerror=()=>e(null),r.src=t});async function n$(t,e,r,a={}){const n=new lr,s=n.internal.pageSize.getWidth(),l=n.internal.pageSize.getHeight(),c=20;let f=c;const d=R1(t),m=a.primaryColor?r$(a.primaryColor):[30,58,138],v=[241,245,249];let x=null;if(a.logoUrl)try{x=await a$(a.logoUrl)}catch(W){console.error("Error loading logo:",W)}if(x)try{n.addImage(x,"PNG",c,f,40,15),f+=20}catch{n.setFontSize(16),n.setFont("helvetica","bold"),n.setTextColor(...m),n.text(r?.name||"Company Name",c,f+10),f+=20}else n.setFontSize(16),n.setFont("helvetica","bold"),n.setTextColor(...m),n.text(r?.name||"Company Name",c,f+10),f+=20;n.setFontSize(20),n.setFont("helvetica","bold"),n.setTextColor(0,0,0),n.text("CHANGE ORDER REQUEST",c,f),f+=10,n.setFontSize(12),n.setFont("helvetica","normal"),n.setTextColor(100,100,100),n.text(t.cor_number||"COR-XXXX",c,f);const g=t.status?.replace("_"," ").toUpperCase()||"DRAFT";n.setTextColor(...m),n.text(g,s-c-n.getTextWidth(g),f),f+=12,n.setDrawColor(...m),n.setLineWidth(.5),n.line(c,f,s-c,f),f+=10,n.setFontSize(10),n.setTextColor(0,0,0);const b=c,_=s/2;n.setFont("helvetica","bold"),n.text("Project:",b,f),n.setFont("helvetica","normal"),n.text(e?.name||"Project Name",b+25,f),n.setFont("helvetica","bold"),n.text("Job #:",_,f),n.setFont("helvetica","normal"),n.text(e?.job_number||"N/A",_+25,f),f+=6,n.setFont("helvetica","bold"),n.text("Period:",b,f),n.setFont("helvetica","normal"),n.text(ey(t.period_start,t.period_end),b+25,f),n.setFont("helvetica","bold"),n.text("Date:",_,f),n.setFont("helvetica","normal"),n.text(fc(t.created_at),_+25,f),f+=10,n.setFont("helvetica","bold"),n.setFontSize(12),n.text(t.title||"Untitled Change Order",c,f),f+=8,n.setFont("helvetica","normal"),n.setFontSize(10),n.setTextColor(80,80,80);const w=n.splitTextToSize(t.scope_of_work||"No scope of work provided.",s-c*2);n.text(w,c,f),f+=w.length*5+10,t.change_order_labor?.length>0&&(n.setFont("helvetica","bold"),n.setFontSize(11),n.setTextColor(0,0,0),n.text("LABOR",c,f),f+=6,Kd(n,{startY:f,head:[["Class","Type","Reg Hrs","Reg Rate","OT Hrs","OT Rate","Total"]],body:t.change_order_labor.map(W=>[W.labor_class,W.wage_type,W.regular_hours.toString(),`$${Bi(W.regular_rate)}/hr`,W.overtime_hours?.toString()||"-",W.overtime_hours?`$${Bi(W.overtime_rate)}/hr`:"-",Xt(W.total)]),foot:[[{content:`Subtotal: ${Xt(d.labor_subtotal)}`,colSpan:5,styles:{halign:"right",fontStyle:"bold"}},{content:`+${Nn(t.labor_markup_percent||1500)} Markup`,colSpan:1,styles:{halign:"right"}},{content:Xt(d.labor_subtotal+d.labor_markup_amount),styles:{fontStyle:"bold"}}]],margin:{left:c,right:c},headStyles:{fillColor:m,textColor:[255,255,255],fontStyle:"bold",fontSize:8},bodyStyles:{fontSize:8},footStyles:{fillColor:v,textColor:[0,0,0],fontSize:8},theme:"striped"}),f=n.lastAutoTable.finalY+10),t.change_order_materials?.length>0&&(f>l-80&&(n.addPage(),f=c),n.setFont("helvetica","bold"),n.setFontSize(11),n.setTextColor(0,0,0),n.text("MATERIALS",c,f),f+=6,Kd(n,{startY:f,head:[["Description","Source","Qty","Unit","Unit Cost","Total"]],body:t.change_order_materials.map(W=>[W.description,W.source_reference||W.source_type,W.quantity.toString(),W.unit,`$${Bi(W.unit_cost)}`,Xt(W.total)]),foot:[[{content:`Subtotal: ${Xt(d.materials_subtotal)}`,colSpan:4,styles:{halign:"right",fontStyle:"bold"}},{content:`+${Nn(t.materials_markup_percent||1500)} Markup`,colSpan:1,styles:{halign:"right"}},{content:Xt(d.materials_subtotal+d.materials_markup_amount),styles:{fontStyle:"bold"}}]],margin:{left:c,right:c},headStyles:{fillColor:m,textColor:[255,255,255],fontStyle:"bold",fontSize:8},bodyStyles:{fontSize:8},footStyles:{fillColor:v,textColor:[0,0,0],fontSize:8},theme:"striped"}),f=n.lastAutoTable.finalY+10),t.change_order_equipment?.length>0&&(f>l-80&&(n.addPage(),f=c),n.setFont("helvetica","bold"),n.setFontSize(11),n.setTextColor(0,0,0),n.text("EQUIPMENT",c,f),f+=6,Kd(n,{startY:f,head:[["Description","Source","Qty","Unit","Unit Cost","Total"]],body:t.change_order_equipment.map(W=>[W.description,W.source_reference||W.source_type,W.quantity.toString(),W.unit,`$${Bi(W.unit_cost)}`,Xt(W.total)]),foot:[[{content:`Subtotal: ${Xt(d.equipment_subtotal)}`,colSpan:4,styles:{halign:"right",fontStyle:"bold"}},{content:`+${Nn(t.equipment_markup_percent||1500)} Markup`,colSpan:1,styles:{halign:"right"}},{content:Xt(d.equipment_subtotal+d.equipment_markup_amount),styles:{fontStyle:"bold"}}]],margin:{left:c,right:c},headStyles:{fillColor:m,textColor:[255,255,255],fontStyle:"bold",fontSize:8},bodyStyles:{fontSize:8},footStyles:{fillColor:v,textColor:[0,0,0],fontSize:8},theme:"striped"}),f=n.lastAutoTable.finalY+10),t.change_order_subcontractors?.length>0&&(f>l-80&&(n.addPage(),f=c),n.setFont("helvetica","bold"),n.setFontSize(11),n.setTextColor(0,0,0),n.text("SUBCONTRACTORS",c,f),f+=6,Kd(n,{startY:f,head:[["Company","Description","Source","Amount"]],body:t.change_order_subcontractors.map(W=>[W.company_name,W.description,W.source_reference||W.source_type,Xt(W.total)]),foot:[[{content:`Subtotal: ${Xt(d.subcontractors_subtotal)}`,colSpan:2,styles:{halign:"right",fontStyle:"bold"}},{content:`+${Nn(t.subcontractors_markup_percent||500)} Markup`,colSpan:1,styles:{halign:"right"}},{content:Xt(d.subcontractors_subtotal+d.subcontractors_markup_amount),styles:{fontStyle:"bold"}}]],margin:{left:c,right:c},headStyles:{fillColor:m,textColor:[255,255,255],fontStyle:"bold",fontSize:8},bodyStyles:{fontSize:8},footStyles:{fillColor:v,textColor:[0,0,0],fontSize:8},theme:"striped"}),f=n.lastAutoTable.finalY+10),f>l-100&&(n.addPage(),f=c),n.setFillColor(...v),n.roundedRect(c,f,s-c*2,70,3,3,"F"),f+=10,n.setFontSize(10),n.setFont("helvetica","normal"),n.setTextColor(0,0,0);const E=c+10,C=s-c-60;n.text("COR Subtotal:",E,f),n.setFont("helvetica","bold"),n.text(Xt(d.cor_subtotal),C,f,{align:"right"}),f+=8,n.setFont("helvetica","normal"),n.setFontSize(9),n.text(`Liability Insurance (${Nn(t.liability_insurance_percent||144)}):`,E,f),n.text(Xt(d.liability_insurance_amount),C,f,{align:"right"}),f+=6,n.text(`Bond (${Nn(t.bond_percent||100)}):`,E,f),n.text(Xt(d.bond_amount),C,f,{align:"right"}),f+=6,n.text(`City License Fee (${Nn(t.license_fee_percent||10)}):`,E,f),n.text(Xt(d.license_fee_amount),C,f,{align:"right"}),f+=10,n.setFillColor(...m),n.roundedRect(E-5,f-3,s-c*2-10,16,2,2,"F"),n.setTextColor(255,255,255),n.setFontSize(12),n.setFont("helvetica","bold"),n.text("COR TOTAL:",E,f+8),n.text(Xt(d.cor_total),C,f+8,{align:"right"}),f+=25,f>l-120&&(n.addPage(),f=c),f+=10,n.setTextColor(0,0,0),n.setFontSize(10),n.setFont("helvetica","bold"),n.text("AUTHORIZATION",c,f),f+=15,n.setFont("helvetica","normal"),n.setFontSize(9),n.setDrawColor(0,0,0);const A=(W,B,q,L,J,D,O)=>{n.setFont("helvetica","bold"),n.setFontSize(8),n.text(B,c,W),n.setFont("helvetica","normal"),n.setFontSize(9);const M=W+20;if(n.line(c,M,c+70,M),n.text("Signature",c,M+8),n.line(c+85,M,c+145,M),n.text("Title / Company",c+85,M+8),n.line(s-c-40,M,s-c,M),n.text("Date",s-c-40,M+8),q)try{if(n.addImage(q,"PNG",c,M-18,60,18),L&&(n.setFontSize(8),n.text(L,c,M+15)),J||D){const V=[J,D].filter(Boolean).join(" - ");n.text(V,c+85,M-5)}O&&n.text(fc(O),s-c-40,M-5)}catch(V){console.error("Error adding signature:",V)}return M+25};f=A(f,"GC AUTHORIZATION",t.gc_signature_data||t.gc_signature,t.gc_signature_name||t.gc_signer_name,t.gc_signature_title,t.gc_signature_company,t.gc_signature_date||t.signed_at),f+=10,f=A(f,"CLIENT AUTHORIZATION",t.client_signature_data,t.client_signature_name,t.client_signature_title,t.client_signature_company,t.client_signature_date);const T=l-10;n.setFontSize(8),n.setTextColor(150,150,150),n.text(`Generated on ${new Date().toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`,c,T),n.text("Page 1",s-c,T,{align:"right"});const G=`${t.cor_number||"COR"}_${e?.job_number||"export"}.pdf`;n.save(G)}function s$({onSave:t,onClose:e,signerName:r=""}){const a=ee.useRef(null),[n,s]=ee.useState(r),[l,c]=ee.useState(!1),[f,d]=ee.useState(!1),m=()=>{const C=a.current;return C?C.getContext("2d"):null},v=C=>{const A=a.current;if(!A)return{x:0,y:0};const T=A.getBoundingClientRect(),G=A.width/T.width,W=A.height/T.height,B=C.touches?C.touches[0].clientX:C.clientX,q=C.touches?C.touches[0].clientY:C.clientY;return{x:(B-T.left)*G,y:(q-T.top)*W}},x=C=>{C.preventDefault();const A=m();if(!A)return;const{x:T,y:G}=v(C);A.beginPath(),A.moveTo(T,G),d(!0),c(!0)},g=C=>{if(!f)return;C.preventDefault();const A=m();if(!A)return;const{x:T,y:G}=v(C);A.lineTo(T,G),A.stroke()},b=()=>{d(!1)},_=()=>{const C=a.current,A=m();!C||!A||(A.clearRect(0,0,C.width,C.height),c(!1))},w=C=>{if(!C)return;a.current=C;const A=C.getContext("2d");A.strokeStyle="#1e293b",A.lineWidth=2,A.lineCap="round",A.lineJoin="round"},E=()=>{if(!l||!n.trim())return;const C=a.current;if(!C)return;const A=C.toDataURL("image/png");t({signature:A,signerName:n.trim(),signedAt:new Date().toISOString()})};return o.jsx("div",{className:"modal-overlay",onClick:e,role:"dialog","aria-modal":"true","aria-labelledby":"signature-title",children:o.jsxs("div",{className:"modal-content signature-modal",onClick:C=>C.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{id:"signature-title",children:"GC Signature"}),o.jsx("button",{className:"close-btn",onClick:e,"aria-label":"Close signature modal",children:o.jsx(Rf,{size:20,"aria-hidden":"true"})})]}),o.jsxs("div",{className:"modal-body signature-body",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"signer-name",children:"Signer Name *"}),o.jsx("input",{id:"signer-name",type:"text",value:n,onChange:C=>s(C.target.value),placeholder:"Enter full name","aria-required":"true"})]}),o.jsxs("div",{className:"signature-area",children:[o.jsxs("div",{className:"signature-label",id:"signature-instructions",children:[o.jsx(eN,{size:16,"aria-hidden":"true"}),o.jsx("span",{children:"Sign below"})]}),o.jsxs("div",{className:"signature-canvas-container",children:[o.jsx("canvas",{ref:w,width:500,height:200,className:"signature-canvas",onMouseDown:x,onMouseMove:g,onMouseUp:b,onMouseLeave:b,onTouchStart:x,onTouchMove:g,onTouchEnd:b,role:"img","aria-label":"Signature drawing area. Use mouse or touch to draw your signature.","aria-describedby":"signature-instructions",tabIndex:0}),!l&&o.jsx("div",{className:"signature-placeholder",children:"Sign here"})]}),o.jsxs("button",{className:"btn btn-ghost btn-small",onClick:_,disabled:!l,"aria-label":"Clear signature",children:[o.jsx(rN,{size:14,"aria-hidden":"true"})," Clear"]})]}),o.jsx("p",{className:"signature-legal",role:"note",children:"By signing above, I acknowledge that I have reviewed and approve this Change Order Request."})]}),o.jsxs("div",{className:"modal-footer",children:[o.jsx("button",{className:"btn btn-secondary",onClick:e,"aria-label":"Cancel and close",children:"Cancel"}),o.jsxs("button",{className:"btn btn-primary",onClick:E,disabled:!l||!n.trim(),"aria-label":"Save signature",children:[o.jsx(R0,{size:16,"aria-hidden":"true"})," Save Signature"]})]})]})})}function i$({cor:t,project:e,company:r,areas:a,onClose:n,onEdit:s,onShowToast:l,onStatusChange:c}){const[f,d]=ee.useState(!0),[m,v]=ee.useState(t),[x,g]=ee.useState(!1),[b,_]=ee.useState(!1);ee.useEffect(()=>{(async()=>{try{const O=await ot.getCORById(t.id);O&&v(O)}catch(O){console.error("Error fetching COR details:",O),l?.("Error loading COR details","error")}finally{d(!1)}})()},[t.id]);const w=ee.useMemo(()=>R1(m),[m]),E=jk(m.status),C=m.status==="pending_approval",A=m.status==="draft",T=D=>a?.find(M=>M.id===D)?.name||null,G=async()=>{if(confirm("Approve this change order request?")){d(!0);try{await ot.approveCOR(m.id),v({...m,status:"approved",approved_at:new Date().toISOString()}),l?.("COR approved","success"),c?.()}catch(D){console.error("Error approving COR:",D),l?.("Error approving COR","error")}finally{d(!1)}}},W=async()=>{const D=prompt("Enter rejection reason (optional):");if(D!==null){d(!0);try{await ot.rejectCOR(m.id,D),v({...m,status:"rejected",rejection_reason:D}),l?.("COR rejected","success"),c?.()}catch(O){console.error("Error rejecting COR:",O),l?.("Error rejecting COR","error")}finally{d(!1)}}},B=async()=>{if(confirm("Mark this COR as billed?")){d(!0);try{await ot.markCORAsBilled(m.id),v({...m,status:"billed"}),l?.("COR marked as billed","success"),c?.()}catch(D){console.error("Error marking COR as billed:",D),l?.("Error updating status","error")}finally{d(!1)}}},q=async D=>{d(!0);try{await ot.saveCORSignature?.(m.id,{gc_signature:D.signature,gc_signer_name:D.signerName,signed_at:D.signedAt}),v({...m,gc_signature:D.signature,gc_signer_name:D.signerName,signed_at:D.signedAt}),g(!1),l?.("Signature saved","success"),c?.()}catch(O){console.error("Error saving signature:",O),l?.("Error saving signature","error")}finally{d(!1)}},L=m.status==="approved"&&!m.gc_signature,J=async()=>{try{l?.("Generating PDF...","info"),await n$(m,e,r),l?.("PDF downloaded","success")}catch(D){console.error("Error exporting PDF:",D),l?.("Error generating PDF","error")}};return f?o.jsx("div",{className:"modal-overlay",onClick:n,children:o.jsx("div",{className:"modal-content cor-detail-modal",onClick:D=>D.stopPropagation(),children:o.jsx("div",{className:"cor-detail-loading",children:"Loading COR details..."})})}):o.jsxs("div",{className:"modal-overlay",onClick:n,role:"dialog","aria-modal":"true","aria-labelledby":"cor-detail-title",children:[o.jsxs("div",{className:"modal-content cor-detail-modal",onClick:D=>D.stopPropagation(),children:[o.jsxs("div",{className:"modal-header cor-detail-header",children:[o.jsxs("div",{className:"cor-detail-title-row",children:[o.jsxs("div",{children:[o.jsx("div",{className:"cor-detail-number",children:m.cor_number}),o.jsx("h2",{id:"cor-detail-title",children:m.title||"Untitled COR"})]}),o.jsx("button",{className:"close-btn",onClick:n,"aria-label":"Close COR details",children:o.jsx(Rf,{size:20,"aria-hidden":"true"})})]}),o.jsxs("div",{className:"cor-detail-meta",children:[o.jsx("span",{className:"cor-detail-status",style:{backgroundColor:E.bgColor,color:E.color},children:E.label}),T(m.area_id)&&o.jsx("span",{className:"cor-detail-area",children:T(m.area_id)}),o.jsxs("span",{className:"cor-detail-period",children:[o.jsx(Xp,{size:14})," ",ey(m.period_start,m.period_end)]})]})]}),o.jsxs("div",{className:"modal-body cor-detail-body",children:[o.jsxs("div",{className:"cor-detail-section",children:[o.jsxs("h3",{children:[o.jsx(El,{size:18})," Scope of Work"]}),o.jsx("p",{className:"cor-scope-text",children:m.scope_of_work||"No scope of work provided."})]}),o.jsxs("div",{className:"cor-detail-section pricing-breakdown",children:[o.jsxs("h3",{children:[o.jsx(D0,{size:18})," Pricing Breakdown"]}),o.jsxs("div",{className:"pricing-category",children:[o.jsxs("div",{className:"category-header",children:[o.jsxs("div",{className:"category-title",children:[o.jsx(y1,{size:16}),o.jsx("span",{children:"Labor"})]}),o.jsx("span",{className:"category-subtotal",children:Xt(w.labor_subtotal)})]}),m.change_order_labor?.length>0?o.jsx("div",{className:"category-items",children:o.jsxs("table",{className:"pricing-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Class"}),o.jsx("th",{children:"Type"}),o.jsx("th",{children:"Reg Hrs"}),o.jsx("th",{children:"Reg Rate"}),o.jsx("th",{children:"OT Hrs"}),o.jsx("th",{children:"OT Rate"}),o.jsx("th",{className:"text-right",children:"Total"})]})}),o.jsx("tbody",{children:m.change_order_labor.map((D,O)=>o.jsxs("tr",{children:[o.jsx("td",{children:D.labor_class}),o.jsx("td",{children:D.wage_type}),o.jsx("td",{children:D.regular_hours}),o.jsxs("td",{children:["$",Bi(D.regular_rate),"/hr"]}),o.jsx("td",{children:D.overtime_hours||"-"}),o.jsx("td",{children:D.overtime_hours?`$${Bi(D.overtime_rate)}/hr`:"-"}),o.jsx("td",{className:"text-right",children:Xt(D.total)})]},O))})]})}):o.jsx("div",{className:"category-empty",children:"No labor items"}),o.jsxs("div",{className:"category-markup",children:[o.jsxs("span",{children:["Markup (",Nn(m.labor_markup_percent||1500),")"]}),o.jsxs("span",{children:["+",Xt(w.labor_markup_amount)]})]})]}),o.jsxs("div",{className:"pricing-category",children:[o.jsxs("div",{className:"category-header",children:[o.jsxs("div",{className:"category-title",children:[o.jsx(yc,{size:16}),o.jsx("span",{children:"Materials"})]}),o.jsx("span",{className:"category-subtotal",children:Xt(w.materials_subtotal)})]}),m.change_order_materials?.length>0?o.jsx("div",{className:"category-items",children:o.jsxs("table",{className:"pricing-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Description"}),o.jsx("th",{children:"Source"}),o.jsx("th",{children:"Qty"}),o.jsx("th",{children:"Unit"}),o.jsx("th",{children:"Unit Cost"}),o.jsx("th",{className:"text-right",children:"Total"})]})}),o.jsx("tbody",{children:m.change_order_materials.map((D,O)=>o.jsxs("tr",{children:[o.jsx("td",{children:D.description}),o.jsx("td",{children:D.source_reference||D.source_type}),o.jsx("td",{children:D.quantity}),o.jsx("td",{children:D.unit}),o.jsxs("td",{children:["$",Bi(D.unit_cost)]}),o.jsx("td",{className:"text-right",children:Xt(D.total)})]},O))})]})}):o.jsx("div",{className:"category-empty",children:"No material items"}),o.jsxs("div",{className:"category-markup",children:[o.jsxs("span",{children:["Markup (",Nn(m.materials_markup_percent||1500),")"]}),o.jsxs("span",{children:["+",Xt(w.materials_markup_amount)]})]})]}),o.jsxs("div",{className:"pricing-category",children:[o.jsxs("div",{className:"category-header",children:[o.jsxs("div",{className:"category-title",children:[o.jsx(ph,{size:16}),o.jsx("span",{children:"Equipment"})]}),o.jsx("span",{className:"category-subtotal",children:Xt(w.equipment_subtotal)})]}),m.change_order_equipment?.length>0?o.jsx("div",{className:"category-items",children:o.jsxs("table",{className:"pricing-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Description"}),o.jsx("th",{children:"Source"}),o.jsx("th",{children:"Qty"}),o.jsx("th",{children:"Unit"}),o.jsx("th",{children:"Unit Cost"}),o.jsx("th",{className:"text-right",children:"Total"})]})}),o.jsx("tbody",{children:m.change_order_equipment.map((D,O)=>o.jsxs("tr",{children:[o.jsx("td",{children:D.description}),o.jsx("td",{children:D.source_reference||D.source_type}),o.jsx("td",{children:D.quantity}),o.jsx("td",{children:D.unit}),o.jsxs("td",{children:["$",Bi(D.unit_cost)]}),o.jsx("td",{className:"text-right",children:Xt(D.total)})]},O))})]})}):o.jsx("div",{className:"category-empty",children:"No equipment items"}),o.jsxs("div",{className:"category-markup",children:[o.jsxs("span",{children:["Markup (",Nn(m.equipment_markup_percent||1500),")"]}),o.jsxs("span",{children:["+",Xt(w.equipment_markup_amount)]})]})]}),o.jsxs("div",{className:"pricing-category",children:[o.jsxs("div",{className:"category-header",children:[o.jsxs("div",{className:"category-title",children:[o.jsx(O0,{size:16}),o.jsx("span",{children:"Subcontractors"})]}),o.jsx("span",{className:"category-subtotal",children:Xt(w.subcontractors_subtotal)})]}),m.change_order_subcontractors?.length>0?o.jsx("div",{className:"category-items",children:o.jsxs("table",{className:"pricing-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Company"}),o.jsx("th",{children:"Description"}),o.jsx("th",{children:"Source"}),o.jsx("th",{className:"text-right",children:"Amount"})]})}),o.jsx("tbody",{children:m.change_order_subcontractors.map((D,O)=>o.jsxs("tr",{children:[o.jsx("td",{children:D.company_name}),o.jsx("td",{children:D.description}),o.jsx("td",{children:D.source_reference||D.source_type}),o.jsx("td",{className:"text-right",children:Xt(D.total)})]},O))})]})}):o.jsx("div",{className:"category-empty",children:"No subcontractor items"}),o.jsxs("div",{className:"category-markup",children:[o.jsxs("span",{children:["Markup (",Nn(m.subcontractors_markup_percent||500),")"]}),o.jsxs("span",{children:["+",Xt(w.subcontractors_markup_amount)]})]})]}),o.jsxs("div",{className:"cor-subtotal-row",children:[o.jsx("span",{children:"COR Subtotal"}),o.jsx("span",{children:Xt(w.cor_subtotal)})]}),o.jsxs("div",{className:"pricing-category fees-category",children:[o.jsxs("div",{className:"category-header",children:[o.jsxs("div",{className:"category-title",children:[o.jsx(CT,{size:16}),o.jsx("span",{children:"Additional Fees"})]}),o.jsx("span",{className:"category-subtotal",children:Xt(w.additional_fees_total)})]}),o.jsxs("div",{className:"fees-list",children:[o.jsxs("div",{className:"fee-row",children:[o.jsxs("div",{className:"fee-label",children:[o.jsx(nN,{size:14}),o.jsxs("span",{children:["Liability Insurance (",Nn(m.liability_insurance_percent||144),")"]})]}),o.jsx("span",{className:"fee-amount",children:Xt(w.liability_insurance_amount)})]}),o.jsxs("div",{className:"fee-row",children:[o.jsxs("div",{className:"fee-label",children:[o.jsx(El,{size:14}),o.jsxs("span",{children:["Bond (",Nn(m.bond_percent||100),")"]})]}),o.jsx("span",{className:"fee-amount",children:Xt(w.bond_amount)})]}),o.jsxs("div",{className:"fee-row",children:[o.jsxs("div",{className:"fee-label",children:[o.jsx(n2,{size:14}),o.jsxs("span",{children:["City License Fee (",Nn(m.license_fee_percent||10),")"]})]}),o.jsx("span",{className:"fee-amount",children:Xt(w.license_fee_amount)})]})]})]}),o.jsxs("div",{className:"cor-total-row",children:[o.jsx("span",{children:"COR TOTAL"}),o.jsx("span",{children:Xt(w.cor_total)})]})]}),(m.gc_signature_data||m.gc_signature||m.client_signature_data)&&o.jsxs("div",{className:"cor-detail-section signature-section",children:[o.jsxs("h3",{children:[o.jsx(UT,{size:18})," Signatures"]}),o.jsxs("div",{className:"dual-signatures",children:[(m.gc_signature_data||m.gc_signature)&&o.jsxs("div",{className:"signature-block",children:[o.jsx("span",{className:"signature-label",children:"GC Authorization"}),o.jsxs("div",{className:"signature-display",children:[o.jsx("img",{src:m.gc_signature_data||m.gc_signature,alt:"GC Signature",className:"signature-image"}),o.jsxs("div",{className:"signature-info",children:[o.jsx("span",{className:"signer-name",children:m.gc_signature_name||m.gc_signer_name}),(m.gc_signature_title||m.gc_signature_company)&&o.jsxs("span",{className:"signer-org",children:[m.gc_signature_title,m.gc_signature_title&&m.gc_signature_company&&" - ",m.gc_signature_company]}),o.jsxs("span",{className:"signed-date",children:["Signed: ",fc(m.gc_signature_date||m.signed_at)]})]})]})]}),m.client_signature_data&&o.jsxs("div",{className:"signature-block",children:[o.jsx("span",{className:"signature-label",children:"Client Authorization"}),o.jsxs("div",{className:"signature-display",children:[o.jsx("img",{src:m.client_signature_data,alt:"Client Signature",className:"signature-image"}),o.jsxs("div",{className:"signature-info",children:[o.jsx("span",{className:"signer-name",children:m.client_signature_name}),(m.client_signature_title||m.client_signature_company)&&o.jsxs("span",{className:"signer-org",children:[m.client_signature_title,m.client_signature_title&&m.client_signature_company&&" - ",m.client_signature_company]}),o.jsxs("span",{className:"signed-date",children:["Signed: ",fc(m.client_signature_date)]})]})]})]})]})]}),m.status==="rejected"&&m.rejection_reason&&o.jsxs("div",{className:"cor-detail-section rejection-section",children:[o.jsxs("h3",{children:[o.jsx(sw,{size:18})," Rejection Reason"]}),o.jsx("p",{className:"rejection-text",children:m.rejection_reason})]})]}),o.jsxs("div",{className:"modal-footer cor-detail-footer",children:[o.jsxs("div",{className:"footer-info",children:[o.jsxs("span",{children:["Created: ",fc(m.created_at)]}),m.approved_at&&o.jsxs("span",{children:["Approved: ",fc(m.approved_at)]})]}),o.jsxs("div",{className:"footer-actions",role:"group","aria-label":"COR actions",children:[A&&o.jsxs("button",{className:"btn btn-secondary",onClick:()=>s?.(m),disabled:f,"aria-label":"Edit this COR",children:[o.jsx(o2,{size:16,"aria-hidden":"true"})," Edit"]}),C&&o.jsxs(o.Fragment,{children:[o.jsxs("button",{className:"btn btn-danger",onClick:W,disabled:f,"aria-label":"Reject this COR",children:[o.jsx(sw,{size:16,"aria-hidden":"true"})," Reject"]}),o.jsxs("button",{className:"btn btn-success",onClick:G,disabled:f,"aria-label":"Approve this COR",children:[o.jsx(pf,{size:16,"aria-hidden":"true"})," Approve"]})]}),L&&o.jsxs("button",{className:"btn btn-success",onClick:()=>g(!0),disabled:f,"aria-label":"Get GC signature for this COR",children:[o.jsx(jT,{size:16,"aria-hidden":"true"})," Get GC Signature"]}),(m.status==="approved"||m.status==="pending_approval")&&o.jsxs("button",{className:"btn btn-secondary",onClick:()=>_(!0),disabled:f,"aria-label":"Get shareable signature link",children:[o.jsx(i2,{size:16,"aria-hidden":"true"})," Get Signature Link"]}),m.status==="approved"&&o.jsxs("button",{className:"btn btn-primary",onClick:B,disabled:f,"aria-label":"Mark this COR as billed",children:[o.jsx(D0,{size:16,"aria-hidden":"true"})," Mark Billed"]}),o.jsxs("button",{className:"btn btn-secondary",onClick:J,"aria-label":"Export COR to PDF",children:[o.jsx(nT,{size:16,"aria-hidden":"true"})," Export PDF"]})]})]})]}),x&&o.jsx(s$,{onSave:q,onClose:()=>g(!1),signerName:""}),b&&o.jsx(cN,{documentType:"cor",documentId:m.id,companyId:r?.id,projectId:e?.id,documentTitle:`COR ${m.cor_number}: ${m.title||"Untitled"}`,onClose:()=>_(!1),onShowToast:l})]})}const ou=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t||0),o$=t=>new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric"});function l$({dailyBurn:t,totalBurn:e,daysWorked:r,laborCost:a,haulOffCost:n,progress:s,contractValue:l,laborByDate:c=[],haulOffByDate:f=[]}){const[d,m]=ee.useState(!1),v=l*(s/100)*.6,x=e<=v?"on-budget":e<=v*1.2?"warning":"over-budget",g={"on-budget":"On Budget",warning:"Watch Closely","over-budget":"Over Budget"}[x],b=x==="on-budget"?sN:x==="warning"?bT:$T,w=s>0?e/(s/100):0,E=[],C={};c.forEach(T=>{C[T.date]||(C[T.date]={date:T.date,labor:0,haulOff:0,total:0}),C[T.date].labor=T.cost||0,C[T.date].total+=T.cost||0}),f.forEach(T=>{C[T.date]||(C[T.date]={date:T.date,labor:0,haulOff:0,total:0}),C[T.date].haulOff=T.cost||0,C[T.date].total+=T.cost||0}),Object.values(C).sort((T,G)=>new Date(G.date)-new Date(T.date)).slice(0,10).forEach(T=>E.push(T));const A=Math.max(...E.map(T=>T.total),1);return o.jsxs("div",{className:"burn-rate-card",children:[o.jsxs("div",{className:"burn-rate-header",children:[o.jsxs("div",{className:"burn-rate-title",children:[o.jsx(fT,{size:18,className:"burn-icon"}),o.jsx("h3",{children:"Burn Rate"})]}),o.jsxs("div",{className:`burn-status ${x}`,children:[o.jsx(b,{size:14}),o.jsx("span",{children:g})]})]}),o.jsxs("div",{className:"burn-rate-hero",children:[o.jsxs("div",{className:"burn-rate-main",children:[o.jsx("span",{className:"burn-rate-value",children:ou(t)}),o.jsx("span",{className:"burn-rate-unit",children:"/day"})]}),r>0&&o.jsxs("div",{className:"burn-rate-context",children:["Based on ",r," work day",r!==1?"s":""]})]}),o.jsxs("div",{className:"burn-rate-summary",children:[o.jsxs("div",{className:"burn-summary-item",children:[o.jsx("span",{className:"burn-summary-label",children:"Total Spent"}),o.jsx("span",{className:"burn-summary-value",children:ou(e)})]}),o.jsx("div",{className:"burn-summary-divider"}),o.jsxs("div",{className:"burn-summary-item",children:[o.jsx("span",{className:"burn-summary-label",children:"Labor"}),o.jsx("span",{className:"burn-summary-value",children:ou(a)})]}),o.jsx("div",{className:"burn-summary-divider"}),o.jsxs("div",{className:"burn-summary-item",children:[o.jsx("span",{className:"burn-summary-label",children:"Disposal"}),o.jsx("span",{className:"burn-summary-value",children:ou(n)})]})]}),s>0&&o.jsxs("div",{className:"burn-projection",children:[o.jsx("span",{className:"projection-label",children:"Projected at completion:"}),o.jsx("span",{className:`projection-value ${w>l*.7?"warning":""}`,children:ou(w)})]}),E.length>0&&o.jsxs("button",{className:"burn-rate-expand",onClick:()=>m(!d),children:[d?o.jsx(s2,{size:16}):o.jsx(xc,{size:16}),o.jsxs("span",{children:[d?"Hide":"View"," Daily Breakdown"]})]}),d&&E.length>0&&o.jsxs("div",{className:"burn-rate-details",children:[o.jsxs("div",{className:"burn-details-header",children:[o.jsx("span",{children:"Date"}),o.jsx("span",{children:"Labor"}),o.jsx("span",{children:"Disposal"}),o.jsx("span",{children:"Total"})]}),E.map(T=>o.jsxs("div",{className:"burn-details-row",children:[o.jsx("span",{className:"burn-date",children:o$(T.date)}),o.jsx("span",{className:"burn-labor",children:T.labor>0?ou(T.labor):"-"}),o.jsx("span",{className:"burn-hauloff",children:T.haulOff>0?ou(T.haulOff):"-"}),o.jsxs("span",{className:"burn-total",children:[o.jsx("span",{className:"burn-bar",style:{width:`${T.total/A*100}%`}}),o.jsx("span",{className:"burn-amount",children:ou(T.total)})]})]},T.date))]})]})}const Qv=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t||0),Lp={labor:{label:"Labor",Icon:Ys,color:"#3b82f6"},disposal:{label:"Disposal",Icon:ph,color:"#10b981"},equipment:{label:"Equipment",Icon:Q0,color:"#f59e0b"},materials:{label:"Materials",Icon:yc,color:"#8b5cf6"},subcontractor:{label:"Subcontractor",Icon:y1,color:"#ec4899"},other:{label:"Other",Icon:Z4,color:"#6b7280"}};function c$({laborCost:t=0,haulOffCost:e=0,customCosts:r=[],onAddCost:a,onDeleteCost:n}){const[s,l]=ee.useState(!1),[c,f]=ee.useState(null),d=[];t>0&&d.push({category:"labor",label:"Labor",amount:t,source:"auto",description:"From crew check-ins"}),e>0&&d.push({category:"disposal",label:"Disposal",amount:e,source:"auto",description:"From haul-off logs"});const m={};r.forEach(g=>{m[g.category]||(m[g.category]={category:g.category,items:[],total:0}),m[g.category].items.push(g),m[g.category].total+=parseFloat(g.amount)||0}),Object.values(m).forEach(g=>{const b=Lp[g.category]||Lp.other;d.push({category:g.category,label:b.label,amount:g.total,source:"manual",items:g.items})});const v=d.reduce((g,b)=>g+b.amount,0);d.forEach(g=>{g.percentage=v>0?g.amount/v*100:0}),d.sort((g,b)=>b.amount-g.amount);const x=g=>{f(c===g?null:g)};return o.jsxs("div",{className:"cost-contributors-card",children:[o.jsxs("div",{className:"cost-contributors-header",children:[o.jsx("h3",{children:"Cost Contributors"}),o.jsx("span",{className:"cost-total",children:Qv(v)})]}),d.length===0?o.jsxs("div",{className:"cost-empty",children:[o.jsx("p",{children:"No costs recorded yet"}),o.jsx("small",{children:"Costs will appear as crew checks in and haul-offs are logged"})]}):o.jsx("div",{className:"cost-breakdown",children:d.map(g=>{const b=Lp[g.category]||Lp.other,_=b.Icon,w=g.items&&g.items.length>0,E=c===g.category;return o.jsxs("div",{className:"cost-category",children:[o.jsxs("div",{className:`cost-category-row ${w?"expandable":""}`,onClick:()=>w&&x(g.category),children:[o.jsx("div",{className:"cost-category-bar-container",children:o.jsx("div",{className:"cost-category-bar",style:{width:`${Math.max(g.percentage,2)}%`,backgroundColor:b.color}})}),o.jsxs("div",{className:"cost-category-info",children:[o.jsxs("div",{className:"cost-category-label",children:[o.jsx(_,{size:14,style:{color:b.color}}),o.jsx("span",{children:g.label}),g.source==="auto"&&o.jsx("span",{className:"cost-auto-badge",children:"Auto"}),w&&(E?o.jsx(s2,{size:14}):o.jsx(xc,{size:14}))]}),o.jsxs("div",{className:"cost-category-values",children:[o.jsx("span",{className:"cost-amount",children:Qv(g.amount)}),o.jsxs("span",{className:"cost-percent",children:[Math.round(g.percentage),"%"]})]})]})]}),E&&w&&o.jsx("div",{className:"cost-category-items",children:g.items.map(C=>o.jsxs("div",{className:"cost-item",children:[o.jsxs("div",{className:"cost-item-info",children:[o.jsx("span",{className:"cost-item-desc",children:C.description}),o.jsx("span",{className:"cost-item-date",children:new Date(C.cost_date).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),o.jsxs("div",{className:"cost-item-actions",children:[o.jsx("span",{className:"cost-item-amount",children:Qv(C.amount)}),n&&o.jsx("button",{className:"cost-item-delete",onClick:A=>{A.stopPropagation(),confirm("Delete this cost entry?")&&n(C.id)},children:o.jsx(lc,{size:14})})]})]},C.id))})]},g.category)})}),a&&o.jsxs("button",{className:"cost-add-btn",onClick:a,children:[o.jsx(Wo,{size:16}),o.jsx("span",{children:"Add Cost"})]})]})}const nf=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t||0);function u$({revenue:t,totalCosts:e,contractValue:r,progress:a}){const n=t-e,s=t>0?n/t*100:0,l=r,c=a>0?e/(a/100):e,f=l-c,d=l>0?f/l*100:0,m=s>=20,v=s>=0&&s<20,x=s<0,g=m?"healthy":v?"warning":"loss",b=m?"On Track":v?"Watch Margin":"Over Cost",_=m?pf:v?mh:sN;return o.jsxs("div",{className:`profitability-card ${g}`,children:[o.jsxs("div",{className:"profitability-header",children:[o.jsx("h3",{children:"Profitability"}),o.jsxs("div",{className:`profitability-status ${g}`,children:[o.jsx(_,{size:14}),o.jsx("span",{children:b})]})]}),o.jsxs("div",{className:"profitability-metrics",children:[o.jsxs("div",{className:"profit-metric",children:[o.jsxs("div",{className:"profit-metric-header",children:[o.jsx("span",{className:"profit-metric-label",children:"Current Margin"}),o.jsxs("span",{className:`profit-metric-value ${s<0?"negative":""}`,children:[Math.round(s),"%"]})]}),o.jsx("div",{className:"profit-bar-container",children:o.jsx("div",{className:`profit-bar ${s<0?"negative":s<20?"warning":"healthy"}`,style:{width:`${Math.min(Math.abs(s),100)}%`}})})]}),a>10&&o.jsxs("div",{className:"profit-metric",children:[o.jsxs("div",{className:"profit-metric-header",children:[o.jsx("span",{className:"profit-metric-label",children:"Projected Final"}),o.jsxs("span",{className:`profit-metric-value ${d<0?"negative":""}`,children:[Math.round(d),"%"]})]}),o.jsx("div",{className:"profit-bar-container",children:o.jsx("div",{className:`profit-bar ${d<0?"negative":d<20?"warning":"healthy"}`,style:{width:`${Math.min(Math.abs(d),100)}%`}})})]})]}),o.jsxs("div",{className:"profitability-summary",children:[o.jsxs("div",{className:"profit-row",children:[o.jsx("span",{className:"profit-label",children:"Revenue Earned"}),o.jsx("span",{className:"profit-value",children:nf(t)})]}),o.jsxs("div",{className:"profit-row",children:[o.jsx("span",{className:"profit-label",children:"Total Costs"}),o.jsxs("span",{className:"profit-value negative",children:["- ",nf(e)]})]}),o.jsxs("div",{className:"profit-row profit-total",children:[o.jsx("span",{className:"profit-label",children:"Current Profit"}),o.jsxs("span",{className:`profit-value ${n<0?"negative":"positive"}`,children:[n>=0?"":"-",nf(Math.abs(n))]})]})]}),a>10&&o.jsxs("div",{className:"profitability-insight",children:[m&&o.jsxs("p",{children:["At ",Math.round(a),"% complete, you're at ",nf(n)," profit.",f>0&&` Projected final profit: ${nf(f)}`]}),v&&o.jsxs("p",{children:["Margins are thin. Consider reviewing costs or scope.",f<0&&` Trending toward ${nf(f)} loss.`]}),x&&o.jsxs("p",{children:["Currently over cost by ",nf(Math.abs(n)),". Immediate review recommended."]})]})]})}const f$=[{value:"labor",label:"Labor",Icon:Ys,description:"Additional labor costs"},{value:"materials",label:"Materials",Icon:yc,description:"Materials and supplies"},{value:"equipment",label:"Equipment",Icon:Q0,description:"Equipment rental or purchase"},{value:"subcontractor",label:"Subcontractor",Icon:y1,description:"Subcontractor work"},{value:"disposal",label:"Disposal",Icon:ph,description:"Additional disposal costs"},{value:"other",label:"Other",Icon:Z4,description:"Miscellaneous costs"}];function d$({onClose:t,onSave:e,saving:r=!1}){const[a,n]=ee.useState({category:"materials",description:"",amount:"",cost_date:new Date().toISOString().split("T")[0],notes:""}),[s,l]=ee.useState({}),c=(m,v)=>{n(x=>({...x,[m]:v})),s[m]&&l(x=>({...x,[m]:null}))},f=()=>{const m={};a.description.trim()||(m.description="Description is required");const v=parseFloat(a.amount);return(isNaN(v)||v<=0)&&(m.amount="Enter a valid amount"),a.cost_date||(m.cost_date="Date is required"),l(m),Object.keys(m).length===0},d=m=>{m.preventDefault(),f()&&e(a)};return o.jsx("div",{className:"modal-overlay",onClick:t,role:"dialog","aria-modal":"true",children:o.jsxs("div",{className:"modal-content add-cost-modal",onClick:m=>m.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsxs("h2",{children:[o.jsx(D0,{size:20}),"Add Cost"]}),o.jsx("button",{className:"close-btn",onClick:t,"aria-label":"Close",children:o.jsx(Rf,{size:20})})]}),o.jsxs("form",{onSubmit:d,children:[o.jsxs("div",{className:"modal-body",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Category *"}),o.jsx("div",{className:"category-grid",children:f$.map(m=>{const v=m.Icon,x=a.category===m.value;return o.jsxs("button",{type:"button",className:`category-option ${x?"selected":""}`,onClick:()=>c("category",m.value),children:[o.jsx(v,{size:18}),o.jsx("span",{className:"category-label",children:m.label})]},m.value)})})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"cost-description",children:"Description *"}),o.jsx("input",{id:"cost-description",type:"text",value:a.description,onChange:m=>c("description",m.target.value),placeholder:"e.g., Excavator rental - Week 1",className:s.description?"error":""}),s.description&&o.jsx("span",{className:"form-error",children:s.description})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"cost-amount",children:"Amount *"}),o.jsxs("div",{className:"input-with-prefix",children:[o.jsx("span",{className:"input-prefix",children:"$"}),o.jsx("input",{id:"cost-amount",type:"number",step:"0.01",min:"0",value:a.amount,onChange:m=>c("amount",m.target.value),placeholder:"0.00",className:s.amount?"error":""})]}),s.amount&&o.jsx("span",{className:"form-error",children:s.amount})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"cost-date",children:"Date *"}),o.jsx("input",{id:"cost-date",type:"date",value:a.cost_date,onChange:m=>c("cost_date",m.target.value),className:s.cost_date?"error":""}),s.cost_date&&o.jsx("span",{className:"form-error",children:s.cost_date})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"cost-notes",children:"Notes (optional)"}),o.jsx("textarea",{id:"cost-notes",value:a.notes,onChange:m=>c("notes",m.target.value),placeholder:"Additional details...",rows:2})]})]}),o.jsxs("div",{className:"modal-footer",children:[o.jsx("button",{type:"button",className:"btn btn-secondary",onClick:t,disabled:r,children:"Cancel"}),o.jsx("button",{type:"submit",className:"btn btn-primary",disabled:r,children:r?"Saving...":"Add Cost"})]})]})]})})}function h$({company:t,onShowToast:e,navigateToProjectId:r,onProjectNavigated:a}){const[n,s]=ee.useState([]),[l,c]=ee.useState([]),[f,d]=ee.useState(null),[m,v]=ee.useState([]),[x,g]=ee.useState(!0),[b,_]=ee.useState(!1),[w,E]=ee.useState(null),[C,A]=ee.useState(!1),[T,G]=ee.useState(!1),[W,B]=ee.useState(!1),[q,L]=ee.useState("overview"),[J,D]=ee.useState([]),[O,M]=ee.useState(!1),[V,ie]=ee.useState(null),[X,Z]=ee.useState(!1),[K,ae]=ee.useState(null),[fe,U]=ee.useState(0),[j,F]=ee.useState(!1),[I,z]=ee.useState(!1);ee.useEffect(()=>{t?.id&&(se(),ne())},[t?.id]);const ne=async()=>{try{const qe=await ot.getDumpSites(t.id);D(qe||[])}catch(qe){console.error("Error loading dump sites:",qe)}};ee.useEffect(()=>{if(r&&n.length>0){const qe=n.find(Ye=>Ye.id===r);qe&&(d(qe),a?.())}},[r,n]),ee.useEffect(()=>{if(f){pe(f.id);const qe=ot.subscribeToAreas(f.id,Ye=>{pe(f.id)});return()=>ot.unsubscribe(qe)}},[f]);const se=async()=>{try{const qe=await ot.getProjects(t?.id);s(qe);const Ye=await Promise.all(qe.map(async Pt=>{const Et=await ot.getAreas(Pt.id),Dt=await ot.getTMTickets(Pt.id),Ce=await ot.getChangeOrderTotals(Pt.id),$e=await ot.getDailyReports(Pt.id,100),xe=await ot.getInjuryReports(Pt.id),Be=await ot.getMaterialRequests(Pt.id),Pe=await ot.calculateManDayCosts(Pt.id,t?.id,Pt.work_type||"demolition",Pt.job_type||"standard"),Ct=await ot.calculateHaulOffCosts(Pt.id),gt=await ot.getProjectCosts(Pt.id),Rt=_x(Et),It=Ce?.totalApprovedValue||0,pr=Pt.contract_value+It,sa=Rt/100*pr,fa=Dt.filter(we=>we.status==="pending").length,Nt=new Date;Nt.setDate(Nt.getDate()-7);const Ea=$e.filter(we=>new Date(we.report_date)>=Nt).length,rr=gt.reduce((we,je)=>we+(parseFloat(je.amount)||0),0),ya=Pe?.totalCost||0,vn=Ct?.totalCost||0,Da=ya+vn+rr,an=sa-Da,qt=sa>0?an/sa*100:0,Kt=Pe?.byDate?.length||0,re=Ct?.daysWithHaulOff||0,Ne=Math.max(Kt,re),me=ya+vn,ge=Ne>0?me/Ne:0;return{...Pt,areas:Et,progress:Rt,billable:sa,changeOrderValue:It,revisedContractValue:pr,changeOrderPending:Ce?.pendingCount||0,totalTickets:Dt.length,pendingTickets:fa,approvedTickets:Dt.filter(we=>we.status==="approved").length,dailyReportsCount:$e.length,recentDailyReports:Ea,injuryReportsCount:xe.length,lastDailyReport:$e[0]?.report_date||null,pendingMaterialRequests:Be.filter(we=>we.status==="pending").length,totalMaterialRequests:Be.length,laborCost:ya,laborDaysWorked:Kt,laborManDays:Pe?.totalManDays||0,laborByDate:Pe?.byDate||[],dailyBurn:ge,haulOffCost:vn,haulOffLoads:Ct?.totalLoads||0,haulOffDays:re,haulOffByType:Ct?.byWasteType||{},haulOffByDate:Ct?.byDate||[],customCosts:gt,customCostTotal:rr,totalBurn:me,totalBurnDays:Ne,allCostsTotal:Da,currentProfit:an,profitMargin:qt}}));c(Ye)}catch(qe){console.error("Error loading projects:",qe),e("Error loading projects","error")}finally{g(!1)}},pe=async qe=>{try{const Ye=await ot.getAreas(qe);v(Ye)}catch(Ye){console.error("Error loading areas:",Ye)}},ye=qe=>{d(qe)},_e=()=>{d(null),v([]),_(!1),E(null),L("overview"),se()},Le=()=>{E({name:f.name,job_number:f.job_number||"",address:f.address||"",general_contractor:f.general_contractor||"",client_contact:f.client_contact||"",client_phone:f.client_phone||"",contract_value:f.contract_value,work_type:f.work_type||"demolition",job_type:f.job_type||"standard",pin:f.pin||"",default_dump_site_id:f.default_dump_site_id||"",areas:m.map(qe=>({id:qe.id,name:qe.name,weight:qe.weight,isNew:!1}))}),_(!0)},ue=()=>{_(!1),E(null)},at=(qe,Ye)=>{E(Pt=>({...Pt,[qe]:Ye}))},ht=(qe,Ye,Pt)=>{E(Et=>({...Et,areas:Et.areas.map((Dt,Ce)=>Ce===qe?{...Dt,[Ye]:Pt}:Dt)}))},de=()=>{E(qe=>({...qe,areas:[...qe.areas,{id:null,name:"",weight:"",isNew:!0}]}))},it=qe=>{w.areas.length>1&&E(Ye=>({...Ye,areas:Ye.areas.filter((Pt,Et)=>Et!==qe)}))},Se=async()=>{if(!w.name.trim()){e("Please enter a project name","error");return}const qe=parseFloat(w.contract_value);if(!qe||qe<=0){e("Please enter a valid contract value","error");return}if(w.pin&&w.pin.length!==4){e("PIN must be 4 digits","error");return}if(w.pin&&w.pin!==f.pin&&!await ot.isPinAvailable(w.pin,f.id)){e("This PIN is already in use","error");return}const Ye=w.areas.filter(Et=>Et.name.trim()&&parseFloat(Et.weight)>0);if(Ye.length===0){e("Please add at least one area","error");return}if(Ye.reduce((Et,Dt)=>Et+parseFloat(Dt.weight),0)!==100){e("Area weights must total 100%","error");return}A(!0);try{await ot.updateProject(f.id,{name:w.name.trim(),job_number:w.job_number?.trim()||null,address:w.address?.trim()||null,general_contractor:w.general_contractor?.trim()||null,client_contact:w.client_contact?.trim()||null,client_phone:w.client_phone?.trim()||null,contract_value:qe,work_type:w.work_type||"demolition",job_type:w.job_type||"standard",pin:w.pin||null,default_dump_site_id:w.default_dump_site_id||null});const Et=m.map($e=>$e.id),Dt=w.areas.filter($e=>$e.id).map($e=>$e.id);for(const $e of Et)Dt.includes($e)||await ot.deleteArea($e);for(let $e=0;$e<Ye.length;$e++){const xe=Ye[$e];xe.id?await ot.updateArea(xe.id,{name:xe.name.trim(),weight:parseFloat(xe.weight),sort_order:$e}):await ot.createArea({project_id:f.id,name:xe.name.trim(),weight:parseFloat(xe.weight),status:"not_started",sort_order:$e})}const Ce=await ot.getProject(f.id);d(Ce),await pe(f.id),_(!1),E(null),e("Project updated!","success")}catch(Et){console.error("Error saving project:",Et?.message||Et),e(Et?.message||"Error saving changes","error")}finally{A(!1)}},ve=async()=>{if(confirm("Are you sure you want to delete this project? This cannot be undone."))try{await ot.deleteProject(f.id),e("Project deleted","success"),_e()}catch(qe){console.error("Error deleting project:",qe),e("Error deleting project","error")}};if(x)return o.jsxs("div",{className:"loading",children:[o.jsx("div",{className:"spinner"}),"Loading projects..."]});if(f){const qe=_x(m),Ye=l.find(gt=>gt.id===f.id),Pt=Ye?.changeOrderValue||0,Et=f.contract_value+Pt,Dt=qe/100*Et;if(b&&w){const gt=w.areas.reduce((Rt,It)=>Rt+(parseFloat(It.weight)||0),0);return o.jsxs("div",{children:[o.jsx("button",{className:"btn btn-secondary btn-small",onClick:ue,style:{marginBottom:"1.5rem"},children:" Cancel"}),o.jsx("h1",{children:"Edit Project"}),o.jsx("p",{className:"subtitle",children:"Update project details"}),o.jsxs("div",{className:"card",children:[o.jsx("h3",{children:"Basic Info"}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",style:{flex:2},children:[o.jsx("label",{children:"Project Name *"}),o.jsx("input",{type:"text",value:w.name,onChange:Rt=>at("name",Rt.target.value),placeholder:"e.g., Downtown Office Demolition"})]}),o.jsxs("div",{className:"form-group",style:{flex:1},children:[o.jsx("label",{children:"Job Number"}),o.jsx("input",{type:"text",value:w.job_number,onChange:Rt=>at("job_number",Rt.target.value),placeholder:"e.g., 2024-001"})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Project Address"}),o.jsx("input",{type:"text",value:w.address,onChange:Rt=>at("address",Rt.target.value),placeholder:"123 Main St, City, State 12345"})]})]}),o.jsxs("div",{className:"card",children:[o.jsx("h3",{children:"Client & Contractor"}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"General Contractor"}),o.jsx("input",{type:"text",value:w.general_contractor,onChange:Rt=>at("general_contractor",Rt.target.value),placeholder:"e.g., ABC Construction"})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Client Contact"}),o.jsx("input",{type:"text",value:w.client_contact,onChange:Rt=>at("client_contact",Rt.target.value),placeholder:"Contact name"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Client Phone"}),o.jsx("input",{type:"tel",value:w.client_phone,onChange:Rt=>at("client_phone",Rt.target.value),placeholder:"(555) 123-4567"})]})]})]}),o.jsxs("div",{className:"card",children:[o.jsx("h3",{children:"Financials & Settings"}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Contract Value ($) *"}),o.jsx("input",{type:"number",value:w.contract_value,onChange:Rt=>at("contract_value",Rt.target.value),placeholder:"0"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Foreman PIN"}),o.jsx("input",{type:"text",value:w.pin,onChange:Rt=>at("pin",Rt.target.value.replace(/\D/g,"").slice(0,4)),placeholder:"4 digits",maxLength:4}),o.jsx("span",{className:"form-hint",children:"Used for field crew access"})]})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Work Type"}),o.jsxs("select",{value:w.work_type,onChange:Rt=>at("work_type",Rt.target.value),children:[o.jsx("option",{value:"demolition",children:"Demolition"}),o.jsx("option",{value:"environmental",children:"Environmental"})]}),o.jsx("span",{className:"form-hint",children:"Affects labor rate calculations"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Job Type"}),o.jsxs("select",{value:w.job_type,onChange:Rt=>at("job_type",Rt.target.value),children:[o.jsx("option",{value:"standard",children:"Standard"}),o.jsx("option",{value:"prevailing_wage",children:"Prevailing Wage"})]})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Default Dump Site"}),o.jsxs("select",{value:w.default_dump_site_id,onChange:Rt=>at("default_dump_site_id",Rt.target.value),children:[o.jsx("option",{value:"",children:"-- Select Dump Site --"}),J.map(Rt=>o.jsx("option",{value:Rt.id,children:Rt.name},Rt.id))]}),o.jsx("span",{className:"form-hint",children:"Used for haul-off tracking and cost estimates"})]})]}),o.jsxs("div",{className:"card",children:[o.jsx("h3",{children:"Areas"}),o.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.9rem",marginBottom:"1rem"},children:"Weights must total 100%."}),w.areas.map((Rt,It)=>o.jsxs("div",{className:"area-row",children:[o.jsx("input",{type:"text",placeholder:"Area name",value:Rt.name,onChange:pr=>ht(It,"name",pr.target.value)}),o.jsx("input",{type:"number",placeholder:"%",value:Rt.weight,onChange:pr=>ht(It,"weight",pr.target.value)}),o.jsx("button",{className:"remove-btn",onClick:()=>it(It),children:""})]},It)),o.jsxs("div",{className:"weight-total",children:[o.jsx("span",{className:"weight-total-label",children:"Total Weight:"}),o.jsxs("span",{className:`weight-total-value ${gt===100?"valid":"invalid"}`,children:[gt,"%"]})]}),o.jsx("button",{className:"btn btn-secondary",onClick:de,children:"+ Add Area"})]}),o.jsx("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem"},children:o.jsx("button",{className:"btn btn-primary",onClick:Se,disabled:C,style:{flex:1},children:C?"Saving...":"Save Changes"})}),o.jsx("button",{className:"btn btn-danger btn-full",onClick:ve,children:"Delete Project"})]})}const Ce=m.filter(gt=>gt.status==="done").length,$e=m.filter(gt=>gt.status==="working").length,xe=m.filter(gt=>gt.status==="not_started").length,Be=Et>0?Math.round(Dt/Et*100):0,Pe=Pt>0,Ct=[{id:"overview",label:"Overview",Icon:pT},{id:"financials",label:"Financials",Icon:D0},{id:"reports",label:"Reports",Icon:gu},{id:"activity",label:"Activity",Icon:Z0},{id:"info",label:"Info",Icon:Q4}];return o.jsxs("div",{className:"project-view tabbed",children:[o.jsxs("div",{className:"pv-sticky-header",children:[o.jsxs("div",{className:"pv-header-row",children:[o.jsxs("button",{className:"pv-back",onClick:_e,children:[o.jsx("span",{children:""}),o.jsx("span",{children:"Back"})]}),o.jsxs("div",{className:"pv-actions",children:[o.jsx("button",{className:"pv-action",onClick:()=>G(!0),children:"Share"}),o.jsx("button",{className:"pv-action",onClick:()=>B(!0),children:"Alerts"}),o.jsx("button",{className:"pv-action",onClick:Le,children:"Edit"})]})]}),o.jsxs("div",{className:"pv-header-title",children:[o.jsx("h1",{children:f.name}),(f.job_number||f.work_type)&&o.jsxs("span",{className:"pv-header-meta",children:[f.job_number&&`Job #${f.job_number}`,f.job_number&&f.work_type&&"  ",f.work_type]})]}),o.jsxs("div",{className:"pv-metrics-bar",children:[o.jsxs("div",{className:"pv-metric",children:[o.jsxs("span",{className:"pv-metric-value",children:[qe,"%"]}),o.jsx("span",{className:"pv-metric-label",children:"Complete"})]}),o.jsx("div",{className:"pv-metric-divider"}),o.jsxs("div",{className:"pv-metric",children:[o.jsx("span",{className:"pv-metric-value",children:Xn(Dt)}),o.jsx("span",{className:"pv-metric-label",children:"Billed"})]}),o.jsx("div",{className:"pv-metric-divider"}),o.jsxs("div",{className:"pv-metric",children:[o.jsx("span",{className:"pv-metric-value highlight",children:Xn(Et-Dt)}),o.jsx("span",{className:"pv-metric-label",children:"Remaining"})]})]}),o.jsx("div",{className:"pv-tabs",children:Ct.map(gt=>o.jsxs("button",{className:`pv-tab ${q===gt.id?"active":""}`,onClick:()=>L(gt.id),children:[o.jsx(gt.Icon,{size:16,className:"pv-tab-icon"}),o.jsx("span",{className:"pv-tab-label",children:gt.label})]},gt.id))})]}),o.jsxs("div",{className:"pv-tab-content",children:[q==="overview"&&o.jsxs("div",{className:"pv-tab-panel",children:[o.jsxs("div",{className:"pv-card pv-health-card",children:[o.jsxs("div",{className:"pv-health-header",children:[o.jsxs("div",{className:"pv-health-status",children:[o.jsx("span",{className:`pv-health-indicator ${qe>=100?"complete":qe>0?"active":"pending"}`}),o.jsx("span",{className:"pv-health-label",children:qe>=100?"Complete":qe>0?"In Progress":"Not Started"})]}),o.jsxs("div",{className:"pv-health-percent",children:[qe,"%"]})]}),o.jsx("div",{className:"pv-health-bar",children:o.jsx("div",{className:"pv-health-fill",style:{width:`${qe}%`}})}),o.jsx("div",{className:"pv-health-context",children:o.jsxs("span",{children:[Ce," of ",m.length," work areas complete"]})})]}),o.jsxs("div",{className:"pv-card",children:[o.jsxs("div",{className:"pv-card-header",children:[o.jsx("h3",{children:"Work Areas"}),o.jsxs("div",{className:"pv-area-summary",children:[Ce>0&&o.jsxs("span",{className:"pv-count done",children:[Ce," Complete"]}),$e>0&&o.jsxs("span",{className:"pv-count working",children:[$e," Active"]}),xe>0&&o.jsxs("span",{className:"pv-count pending",children:[xe," Pending"]})]})]}),o.jsx("div",{className:"pv-areas-grid",children:m.map(gt=>o.jsxs("div",{className:`pv-area-card ${gt.status}`,children:[o.jsxs("div",{className:"pv-area-status",children:[gt.status==="done"&&o.jsx("span",{className:"pv-check",children:""}),gt.status==="working"&&o.jsx("span",{className:"pv-working",children:""}),gt.status==="not_started"&&o.jsx("span",{className:"pv-pending",children:""})]}),o.jsxs("div",{className:"pv-area-info",children:[o.jsx("span",{className:"pv-area-name",children:gt.name}),o.jsxs("span",{className:"pv-area-weight",children:[gt.weight,"% of contract"]})]})]},gt.id))})]}),(Ye?.pendingTickets>0||Ye?.pendingMaterialRequests>0)&&o.jsxs("div",{className:"pv-card pv-attention-card",children:[o.jsx("h3",{children:"Needs Attention"}),o.jsxs("div",{className:"pv-attention-items",children:[Ye?.pendingTickets>0&&o.jsxs("div",{className:"pv-attention-item",onClick:()=>L("financials"),children:[o.jsx("span",{className:"pv-attention-count",children:Ye.pendingTickets}),o.jsx("span",{className:"pv-attention-label",children:"T&M tickets awaiting approval"}),o.jsx("span",{className:"pv-attention-arrow",children:""})]}),Ye?.pendingMaterialRequests>0&&o.jsxs("div",{className:"pv-attention-item",onClick:()=>L("activity"),children:[o.jsx("span",{className:"pv-attention-count",children:Ye.pendingMaterialRequests}),o.jsx("span",{className:"pv-attention-label",children:"Material requests pending review"}),o.jsx("span",{className:"pv-attention-arrow",children:""})]})]})]})]}),q==="financials"&&o.jsxs("div",{className:"pv-tab-panel financials-tab",children:[o.jsx("div",{className:"financials-hero",children:o.jsxs("div",{className:"financials-hero-grid",children:[o.jsxs("div",{className:"fin-metric",children:[o.jsx("div",{className:"fin-metric-label",children:"Contract"}),o.jsx("div",{className:"fin-metric-value",children:Xn(Et)}),Pe&&o.jsxs("div",{className:"fin-metric-detail green",children:["+",Xn(Pt)," COs"]})]}),o.jsxs("div",{className:"fin-metric",children:[o.jsx("div",{className:"fin-metric-label",children:"Earned"}),o.jsx("div",{className:"fin-metric-value",children:Xn(Dt)}),o.jsx("div",{className:"fin-metric-bar",children:o.jsx("div",{className:"fin-metric-fill",style:{width:`${Be}%`}})})]}),o.jsxs("div",{className:"fin-metric",children:[o.jsx("div",{className:"fin-metric-label",children:"Costs"}),o.jsx("div",{className:"fin-metric-value",children:Xn(Ye?.allCostsTotal||0)}),Dt>0&&o.jsxs("div",{className:`fin-metric-detail ${(Ye?.allCostsTotal||0)/Dt>.6?"warning":""}`,children:[Math.round((Ye?.allCostsTotal||0)/Dt*100),"% of revenue"]})]}),o.jsxs("div",{className:"fin-metric",children:[o.jsx("div",{className:"fin-metric-label",children:"Profit"}),o.jsx("div",{className:`fin-metric-value ${(Ye?.currentProfit||0)<0?"negative":"positive"}`,children:Xn(Ye?.currentProfit||0)}),o.jsxs("div",{className:`fin-metric-detail ${(Ye?.profitMargin||0)<20?"warning":""}`,children:[Math.round(Ye?.profitMargin||0),"% margin"]})]})]})}),o.jsxs("div",{className:"financials-analysis-row",children:[o.jsx(l$,{dailyBurn:Ye?.dailyBurn||0,totalBurn:Ye?.totalBurn||0,daysWorked:Ye?.totalBurnDays||0,laborCost:Ye?.laborCost||0,haulOffCost:Ye?.haulOffCost||0,progress:qe,contractValue:Et,laborByDate:Ye?.laborByDate||[],haulOffByDate:Ye?.haulOffByDate||[]}),o.jsx(u$,{revenue:Dt,totalCosts:Ye?.allCostsTotal||0,contractValue:Et,progress:qe})]}),o.jsx(c$,{laborCost:Ye?.laborCost||0,haulOffCost:Ye?.haulOffCost||0,customCosts:Ye?.customCosts||[],onAddCost:()=>F(!0),onDeleteCost:async gt=>{try{await ot.deleteProjectCost(gt),se(),e("Cost deleted","success")}catch{e("Error deleting cost","error")}}}),o.jsxs("div",{className:"financials-pipeline",children:[o.jsxs("div",{className:"pipeline-header",children:[o.jsx("h2",{children:"Extra Work"}),o.jsxs("div",{className:"pipeline-flow",children:[o.jsx("span",{className:"pipeline-step",children:"T&M Tickets"}),o.jsx("span",{className:"pipeline-arrow",children:""}),o.jsx("span",{className:"pipeline-step active",children:"Change Orders"})]})]}),o.jsxs("div",{className:"pipeline-content",children:[o.jsxs("div",{className:"pipeline-section",children:[o.jsxs("div",{className:"pipeline-section-header",children:[o.jsx("h3",{children:"T&M Tickets"}),o.jsxs("span",{className:"pipeline-badge",children:[Ye?.totalTickets||0," total",Ye?.pendingTickets>0&&`  ${Ye.pendingTickets} pending`]})]}),o.jsx(qH,{project:f,company:t,onShowToast:e})]}),o.jsx("div",{className:"pipeline-section",children:o.jsx(QH,{project:f,company:t,areas:m,refreshKey:fe,onShowToast:e,onCreateCOR:()=>{ie(null),M(!0)},onViewCOR:gt=>{ae(gt),Z(!0)},onEditCOR:gt=>{ie(gt),M(!0)}})})]})]}),o.jsxs("details",{className:"financials-details",children:[o.jsxs("summary",{className:"financials-details-summary",children:[o.jsx(Ys,{size:16}),o.jsx("span",{children:"Labor Details"}),o.jsx("span",{className:"financials-details-value",children:Xn(Ye?.laborCost||0)})]}),o.jsx("div",{className:"financials-details-content",children:o.jsx(KH,{project:f,company:t,onShowToast:e})})]})]}),q==="reports"&&o.jsxs("div",{className:"pv-tab-panel",children:[o.jsxs("div",{className:"pv-card pv-reports-summary",children:[o.jsx("h3",{children:"Field Documentation Summary"}),o.jsxs("div",{className:"pv-reports-stats",children:[o.jsxs("div",{className:"pv-report-stat",children:[o.jsx("span",{className:"pv-report-stat-value",children:Ye?.dailyReportsCount||0}),o.jsx("span",{className:"pv-report-stat-label",children:"Daily Reports Filed"})]}),o.jsxs("div",{className:"pv-report-stat",children:[o.jsx("span",{className:"pv-report-stat-value",children:Ye?.recentDailyReports||0}),o.jsx("span",{className:"pv-report-stat-label",children:"Reports This Week"})]}),o.jsxs("div",{className:"pv-report-stat injury",children:[o.jsx("span",{className:"pv-report-stat-value",children:Ye?.injuryReportsCount||0}),o.jsx("span",{className:"pv-report-stat-label",children:"Injury Reports"})]})]}),Ye?.lastDailyReport&&o.jsxs("div",{className:"pv-last-report",children:["Last report filed: ",new Date(Ye.lastDailyReport).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]})]}),o.jsx(YH,{project:f,company:t,onShowToast:e}),o.jsx($H,{project:f,companyId:t?.id||f?.company_id,company:t,onShowToast:e})]}),q==="activity"&&o.jsxs("div",{className:"pv-tab-panel",children:[o.jsxs("div",{className:"pv-card pv-activity-summary",children:[o.jsx("h3",{children:"Project Activity Status"}),o.jsxs("div",{className:"pv-activity-stats",children:[o.jsxs("div",{className:`pv-activity-stat ${Ye?.pendingMaterialRequests>0?"has-pending":""}`,children:[o.jsx("span",{className:"pv-activity-stat-value",children:Ye?.pendingMaterialRequests||0}),o.jsx("span",{className:"pv-activity-stat-label",children:"Pending Requests"})]}),o.jsxs("div",{className:"pv-activity-stat",children:[o.jsx("span",{className:"pv-activity-stat-value",children:Ye?.totalMaterialRequests||0}),o.jsx("span",{className:"pv-activity-stat-label",children:"Total Requests"})]})]})]}),o.jsx(VH,{project:f,company:t,onShowToast:e}),o.jsx("div",{className:"pv-messages-full",children:o.jsx(XH,{project:f,company:t,userName:t?.name||"Office",onShowToast:e})})]}),q==="info"&&o.jsxs("div",{className:"pv-tab-panel",children:[o.jsxs("div",{className:"pv-card pv-info-card",children:[o.jsxs("div",{className:"pv-info-header",children:[o.jsx("h3",{children:"Project Details"}),o.jsx("button",{className:"btn btn-secondary btn-sm",onClick:Le,children:"Edit Project"})]}),o.jsxs("div",{className:"pv-info-grid",children:[o.jsxs("div",{className:"pv-info-section",children:[o.jsx("div",{className:"pv-info-section-title",children:"Basic Information"}),o.jsxs("div",{className:"pv-info-row",children:[o.jsx("span",{className:"pv-info-label",children:"Project Name"}),o.jsx("span",{className:"pv-info-value",children:f.name})]}),f.job_number&&o.jsxs("div",{className:"pv-info-row",children:[o.jsx("span",{className:"pv-info-label",children:"Job Number"}),o.jsx("span",{className:"pv-info-value",children:f.job_number})]}),f.address&&o.jsxs("div",{className:"pv-info-row",children:[o.jsxs("span",{className:"pv-info-label",children:[o.jsx(xT,{size:14,className:"pv-info-icon"}),"Address"]}),o.jsx("span",{className:"pv-info-value",children:f.address})]})]}),o.jsxs("div",{className:"pv-info-section",children:[o.jsxs("div",{className:"pv-info-section-title",children:[o.jsx(n2,{size:16,className:"pv-info-icon"}),"Client & Contractor"]}),f.general_contractor?o.jsxs("div",{className:"pv-info-row",children:[o.jsx("span",{className:"pv-info-label",children:"General Contractor"}),o.jsx("span",{className:"pv-info-value",children:f.general_contractor})]}):o.jsx("div",{className:"pv-info-empty",children:"No general contractor specified"}),f.client_contact&&o.jsxs("div",{className:"pv-info-row",children:[o.jsx("span",{className:"pv-info-label",children:"Client Contact"}),o.jsx("span",{className:"pv-info-value",children:f.client_contact})]}),f.client_phone&&o.jsxs("div",{className:"pv-info-row",children:[o.jsxs("span",{className:"pv-info-label",children:[o.jsx(OT,{size:14,className:"pv-info-icon"}),"Phone"]}),o.jsx("a",{href:`tel:${f.client_phone}`,className:"pv-info-value pv-info-link",children:f.client_phone})]})]}),o.jsxs("div",{className:"pv-info-section",children:[o.jsx("div",{className:"pv-info-section-title",children:"Project Settings"}),o.jsxs("div",{className:"pv-info-row",children:[o.jsx("span",{className:"pv-info-label",children:"Work Type"}),o.jsx("span",{className:"pv-info-value pv-info-badge",children:f.work_type==="environmental"?"Environmental":"Demolition"})]}),o.jsxs("div",{className:"pv-info-row",children:[o.jsx("span",{className:"pv-info-label",children:"Job Type"}),o.jsx("span",{className:"pv-info-value pv-info-badge",children:f.job_type==="prevailing_wage"?"Prevailing Wage":"Standard"})]}),f.pin&&o.jsxs("div",{className:"pv-info-row",children:[o.jsx("span",{className:"pv-info-label",children:"Foreman PIN"}),o.jsx("span",{className:"pv-info-value pv-info-mono",children:f.pin})]}),f.default_dump_site_id&&o.jsxs("div",{className:"pv-info-row",children:[o.jsx("span",{className:"pv-info-label",children:"Default Dump Site"}),o.jsx("span",{className:"pv-info-value",children:J.find(gt=>gt.id===f.default_dump_site_id)?.name||"Unknown"})]})]}),o.jsxs("div",{className:"pv-info-section",children:[o.jsxs("div",{className:"pv-info-section-title",children:[o.jsx(D0,{size:16,className:"pv-info-icon"}),"Contract"]}),o.jsxs("div",{className:"pv-info-row",children:[o.jsx("span",{className:"pv-info-label",children:"Original Contract"}),o.jsx("span",{className:"pv-info-value pv-info-currency",children:Xn(f.contract_value)})]}),Pt>0&&o.jsxs("div",{className:"pv-info-row",children:[o.jsx("span",{className:"pv-info-label",children:"Change Orders"}),o.jsxs("span",{className:"pv-info-value pv-info-currency positive",children:["+",Xn(Pt)]})]}),o.jsxs("div",{className:"pv-info-row pv-info-total",children:[o.jsx("span",{className:"pv-info-label",children:"Current Value"}),o.jsx("span",{className:"pv-info-value pv-info-currency",children:Xn(Et)})]})]})]})]}),o.jsxs("div",{className:"pv-card",children:[o.jsxs("h3",{children:["Work Areas (",m.length,")"]}),o.jsx("div",{className:"pv-info-areas",children:m.map(gt=>o.jsxs("div",{className:`pv-info-area ${gt.status}`,children:[o.jsx("span",{className:"pv-info-area-name",children:gt.name}),o.jsxs("span",{className:"pv-info-area-weight",children:[gt.weight,"%"]}),o.jsx("span",{className:`pv-info-area-status status-badge ${gt.status}`,children:gt.status==="done"?"Complete":gt.status==="working"?"In Progress":"Not Started"})]},gt.id))})]})]})]}),T&&o.jsx(zH,{project:f,onClose:()=>G(!1),onShareCreated:gt=>{e("Share link created successfully!","success")}}),W&&o.jsx("div",{className:"notification-settings-modal",children:o.jsx(WH,{project:f,company:t,onShowToast:e,onClose:()=>B(!1)})}),O&&o.jsx(t$,{project:f,company:t,areas:m,existingCOR:V,onClose:()=>{M(!1),ie(null)},onSaved:()=>{M(!1),ie(null),U(gt=>gt+1)},onShowToast:e}),X&&K&&o.jsx(i$,{cor:K,project:f,company:t,areas:m,onClose:()=>{Z(!1),ae(null)},onEdit:gt=>{Z(!1),ae(null),ie(gt),M(!0)},onShowToast:e,onStatusChange:()=>{}}),j&&o.jsx(d$,{onClose:()=>F(!1),saving:I,onSave:async gt=>{try{z(!0),await ot.addProjectCost(f.id,t.id,gt),F(!1),se(),e("Cost added successfully","success")}catch(Rt){console.error("Error adding cost:",Rt),e("Error adding cost","error")}finally{z(!1)}}})]})}if(n.length===0)return o.jsxs("div",{className:"empty-state",children:[o.jsx(gu,{size:48,className:"empty-state-icon"}),o.jsx("h3",{children:"No Projects Yet"}),o.jsx("p",{children:"Create your first project to get started"})]});const Ie=l.reduce((qe,Ye)=>qe+(Ye.contract_value||0),0),wt=l.reduce((qe,Ye)=>qe+(Ye.changeOrderValue||0),0),Xe=Ie+wt,ct=l.reduce((qe,Ye)=>qe+(Ye.billable||0),0),jt=Xe-ct,Lt=Xe>0?Math.round(ct/Xe*100):0,Vt=l.filter(qe=>qe.progress>=100).length,$t=l.filter(qe=>qe.progress<100&&qe.billable<=(qe.revisedContractValue||qe.contract_value)*(qe.progress/100)*1.1).length,Wt=l.filter(qe=>qe.billable>(qe.revisedContractValue||qe.contract_value)*.9&&qe.progress<90).length,Ot=l.filter(qe=>qe.billable>(qe.revisedContractValue||qe.contract_value)).length,kt=l.filter(qe=>(qe.changeOrderValue||0)>0).length;return o.jsxs("div",{children:[o.jsxs("div",{className:"business-overview",children:[o.jsxs("div",{className:"bo-header",children:[o.jsx("h2",{className:"bo-title",children:"Portfolio Overview"}),o.jsxs("div",{className:"bo-project-count",children:[n.length," Active Project",n.length!==1?"s":""]})]}),o.jsxs("div",{className:"bo-financial",children:[o.jsx("div",{className:"bo-progress-bar",children:o.jsx("div",{className:"bo-progress-fill",style:{width:`${Math.min(Lt,100)}%`}})}),o.jsxs("div",{className:"bo-financial-row",children:[o.jsxs("div",{className:"bo-metric primary",children:[o.jsx("span",{className:"bo-metric-value",children:Xn(ct)}),o.jsx("span",{className:"bo-metric-label",children:"Earned Revenue"})]}),o.jsx("div",{className:"bo-metric-separator",children:"of"}),o.jsxs("div",{className:"bo-metric primary",children:[o.jsx("span",{className:"bo-metric-value",children:Xn(Xe)}),o.jsx("span",{className:"bo-metric-label",children:"Total Portfolio"})]}),o.jsxs("div",{className:"bo-metric highlight",children:[o.jsx("span",{className:"bo-metric-value",children:Xn(jt)}),o.jsx("span",{className:"bo-metric-label",children:"Remaining to Bill"})]})]}),wt>0&&o.jsxs("div",{className:"bo-change-orders",children:[o.jsxs("div",{className:"bo-co-item",children:[o.jsx("span",{className:"bo-co-label",children:"Original Contracts"}),o.jsx("span",{className:"bo-co-value",children:Xn(Ie)})]}),o.jsxs("div",{className:"bo-co-item bo-co-added",children:[o.jsxs("span",{className:"bo-co-label",children:["+ Change Orders (",kt," project",kt!==1?"s":"",")"]}),o.jsxs("span",{className:"bo-co-value",children:["+",Xn(wt)]})]})]})]}),o.jsxs("div",{className:"bo-health",children:[o.jsx("div",{className:"bo-health-title",children:"Project Health"}),o.jsxs("div",{className:"bo-health-pills",children:[Vt>0&&o.jsxs("div",{className:"bo-pill complete",children:[o.jsx("span",{className:"bo-pill-count",children:Vt}),o.jsx("span",{className:"bo-pill-label",children:"Complete"})]}),$t>0&&o.jsxs("div",{className:"bo-pill on-track",children:[o.jsx("span",{className:"bo-pill-count",children:$t}),o.jsx("span",{className:"bo-pill-label",children:"On Track"})]}),Wt>0&&o.jsxs("div",{className:"bo-pill at-risk",children:[o.jsx("span",{className:"bo-pill-count",children:Wt}),o.jsx("span",{className:"bo-pill-label",children:"At Risk"})]}),Ot>0&&o.jsxs("div",{className:"bo-pill over-budget",children:[o.jsx("span",{className:"bo-pill-count",children:Ot}),o.jsx("span",{className:"bo-pill-label",children:"Over Budget"})]})]})]})]}),o.jsxs("div",{className:"dashboard-header",children:[o.jsx("h2",{children:"Projects"}),o.jsxs("span",{className:"project-count",children:[n.length," active"]})]}),o.jsx("div",{className:"project-list",children:l.map(qe=>o.jsx(m$,{project:qe,onClick:()=>ye(qe)},qe.id))})]})}function m$({project:t,onClick:e}){const r=iN(t.areas||[]),a=a8(t.areas||[]),n=t.contract_value-t.billable,s=t.billable>t.contract_value*.9&&t.progress<90;return o.jsxs("div",{className:`project-card enhanced ${s?"at-risk":""}`,onClick:e,children:[o.jsxs("div",{className:"project-card-header",children:[o.jsxs("div",{children:[o.jsx("div",{className:"project-card-name",children:t.name}),o.jsx("div",{className:"project-card-value",children:Xn(t.contract_value)})]}),o.jsx("span",{className:`status-badge ${r}`,children:a})]}),o.jsxs("div",{className:"project-stats-row",children:[o.jsxs("div",{className:"project-stat",children:[o.jsxs("span",{className:"stat-value",children:[t.progress,"%"]}),o.jsx("span",{className:"stat-label",children:"Complete"})]}),o.jsxs("div",{className:"project-stat",children:[o.jsx("span",{className:"stat-value",children:Xn(t.billable)}),o.jsx("span",{className:"stat-label",children:"Billable"})]}),o.jsxs("div",{className:"project-stat",children:[o.jsx("span",{className:`stat-value ${n<0?"negative":""}`,children:Xn(Math.abs(n))}),o.jsx("span",{className:"stat-label",children:n>=0?"Remaining":"Over Budget"})]})]}),o.jsx("div",{className:"mini-progress-bar",children:o.jsx("div",{className:"mini-progress-fill",style:{width:`${t.progress}%`}})}),(t.pendingTickets>0||t.totalTickets>0)&&o.jsxs("div",{className:"project-badges",children:[t.pendingTickets>0&&o.jsxs("span",{className:"badge pending",children:[t.pendingTickets," Pending T&M"]}),t.approvedTickets>0&&o.jsxs("span",{className:"badge approved",children:[t.approvedTickets," Approved T&M"]})]})]})}function p$({onProjectCreated:t,onShowToast:e}){const[r,a]=ee.useState(""),[n,s]=ee.useState(""),[l,c]=ee.useState(""),[f,d]=ee.useState(""),[m,v]=ee.useState(""),[x,g]=ee.useState(""),[b,_]=ee.useState("demolition"),[w,E]=ee.useState("standard"),[C,A]=ee.useState([{name:"",weight:"",group:""},{name:"",weight:"",group:""},{name:"",weight:"",group:""}]),[T,G]=ee.useState(!1),[W,B]=ee.useState(!1),[q,L]=ee.useState(!1),[J,D]=ee.useState([]),O=ee.useRef(null),M=C.reduce((pe,ye)=>pe+(parseFloat(ye.weight)||0),0),V=pe=>{const ye=pe.replace(/\D/g,"").slice(0,4);g(ye)},ie=()=>{const pe=Math.floor(1e3+Math.random()*9e3).toString();g(pe)},X=(pe,ye,_e)=>{A(Le=>Le.map((ue,at)=>at===pe?{...ue,[ye]:_e}:ue))},Z=()=>{A(pe=>[...pe,{name:"",weight:"",group:""}])},K=pe=>{C.length>1&&A(ye=>ye.filter((_e,Le)=>Le!==pe))},ae=()=>{a(""),s(""),c(""),d(""),v(""),g(""),_("demolition"),E("standard"),A([{name:"",weight:"",group:""},{name:"",weight:"",group:""},{name:"",weight:"",group:""}]),L(!1),D([])},fe=()=>{O.current?.click()},U=pe=>new Promise((ye,_e)=>{const Le=new FileReader;Le.onload=ue=>{try{const at=new Uint8Array(ue.target.result),ht=Rx(at,{type:"array"}),de=ht.SheetNames[0],it=ht.Sheets[de],Se=lu.sheet_to_json(it,{header:1}),ve=[];let Ie="General";const wt=/^\$?\d{1,3}(,\d{3})*(\.\d{2})?$/,Xe=/^(\d+\.?\d*|[A-Z]\.?\d*)$/i,ct=/^(SF|LF|EA|LS|Days?|MD|Load|CY|SY|GAL|TON)$/i,jt=/^\d{1,3}(,\d{3})*$|^\d+$/,Lt=/^(Item|#|No\.?|Description|Scheduled|Value|Amount|Quantity|Unit|Total|Application|Balance|Completed|Stored|Retainage)/i;for(const Wt of Se){if(!Wt||Wt.length===0)continue;const Ot=Wt.map($e=>$e==null?"":String($e).trim()).filter($e=>$e.length>0);if(Ot.length===0)continue;const kt=Ot.join(" ");if(Lt.test(Ot[0])||Ot.length>1&&Lt.test(Ot[1])||/^(Total|Subtotal|Grand Total|Base Bid|Contract Sum)/i.test(kt))continue;const qe=Ot.some($e=>wt.test($e.replace(/[$,]/g,"")+($e.includes(".")?"":".00")));if((!qe&&Ot.length<=3&&/^(L\d|Level|Floor|\d+(?:st|nd|rd|th)|Plaza|Street|Basement|Roof|Penthouse|Site|Exterior|Interior|Misc|MEP|ABATEMENT|DEMOLITION|UNIVERSAL|SOFT|TRASH|DEMO|Phase|Division|Section|Area|Building|Wing)/i.test(Ot[0])||Ot.length===2&&Xe.test(Ot[0])&&!qe&&!/^\d+\.\d+$/.test(Ot[0]))&&!qe){Ie=(Ot.find(xe=>!Xe.test(xe)&&xe.length>1)||Ot.join(" ")).replace(/\s*\(\d{1,3}(?:,\d{3})*\s*SF\)\s*$/i,"").replace(/\s*[-:]\s*$/,"").trim();continue}let Pt="",Et=!1,Dt="";const Ce=[];for(let $e=0;$e<Ot.length;$e++){const xe=Ot[$e];if($e===0&&Xe.test(xe)){Dt=xe;continue}if(!/^ID-\d+$/i.test(xe)&&!/^KN\s*\d+$/i.test(xe)){if(wt.test(xe.replace(/[$,]/g,"")+(xe.includes(".")?"":".00"))||/^\$/.test(xe)){Et=!0;continue}if(jt.test(xe.replace(/,/g,""))){Et=!0;continue}ct.test(xe)||/^\d+\.?\d*%$/.test(xe)||xe.length>1&&!Xe.test(xe)&&Ce.push(xe)}}Pt=Ce.join(" ").trim(),Pt=Pt.replace(/\s+/g," ").replace(/^[-]\s*/,"").trim(),!(Pt.length<3)&&(/^(Plan|Page|Total|Base Bid|Payment|Condition|Exclusion|Subtotal)/i.test(Pt)||Et&&Pt.length>=3&&ve.push({name:Pt,group:Ie,itemNumber:Dt,selected:!0}))}const Vt=new Set,$t=ve.filter(Wt=>{const Ot=`${Wt.group}:${Wt.name}`;return Vt.has(Ot)?!1:(Vt.add(Ot),!0)});ye($t)}catch(at){_e(at)}},Le.onerror=()=>_e(new Error("Failed to read file")),Le.readAsArrayBuffer(pe)}),j=async pe=>{const ye=pe.target.files?.[0];if(!ye)return;const _e=ye.name.split(".").pop().toLowerCase();if(!["xlsx","xls","csv"].includes(_e)){e("Please upload an Excel file (.xlsx, .xls, or .csv)","error");return}B(!0);try{const Le=await U(ye);if(Le.length===0){e("No tasks found. Check Excel format.","error"),B(!1);return}D(Le),L(!0),e(`Found ${Le.length} tasks`,"success")}catch(Le){console.error("Excel import error:",Le),e("Error reading Excel file","error")}finally{B(!1),O.current&&(O.current.value="")}},F=pe=>{D(ye=>ye.map((_e,Le)=>Le===pe?{..._e,selected:!_e.selected}:_e))},I=()=>{const pe=J.filter(Le=>Le.selected);if(pe.length===0){e("Please select at least one task","error");return}const ye=Math.round(100/pe.length*100)/100,_e=pe.map((Le,ue)=>({name:Le.name,weight:ue===pe.length-1?(100-ye*(pe.length-1)).toFixed(2):ye.toFixed(2),group:Le.group}));A(_e),L(!1),e("Tasks imported!","success")},z=async()=>{if(!r.trim()){e("Please enter a project name","error");return}const pe=parseFloat(m);if(!pe||pe<=0){e("Please enter a valid contract value","error");return}if(x.length!==4){e("Please enter a 4-digit PIN","error");return}if(!await ot.isPinAvailable(x)){e("This PIN is already in use. Try another.","error");return}const _e=C.filter(Le=>Le.name.trim()&&parseFloat(Le.weight)>0);if(_e.length===0){e("Please add at least one area","error");return}if(Math.abs(M-100)>.1){e("Area weights must total 100%","error");return}G(!0);try{const Le=await ot.createProject({name:r.trim(),job_number:n.trim()||null,address:l.trim()||null,general_contractor:f.trim()||null,contract_value:pe,pin:x,work_type:b,job_type:w});for(let ue=0;ue<_e.length;ue++)await ot.createArea({project_id:Le.id,name:_e[ue].name.trim(),weight:parseFloat(_e[ue].weight),group_name:_e[ue].group||null,status:"not_started",sort_order:ue});e("Project created!","success"),ae(),t()}catch(Le){console.error("Error creating project:",Le),e("Error creating project","error")}finally{G(!1)}};if(q){const pe=[...new Set(J.map(_e=>_e.group))],ye=J.filter(_e=>_e.selected).length;return o.jsxs("div",{children:[o.jsx("h1",{children:"Review Imported Tasks"}),o.jsx("p",{className:"subtitle",children:"Select the tasks to include in your project"}),o.jsx("div",{className:"import-summary",children:o.jsxs("span",{children:[ye," of ",J.length," tasks selected"]})}),pe.map(_e=>{const Le=J.filter(at=>at.group===_e),ue=Le.filter(at=>at.selected).length;return o.jsxs("div",{className:"card import-group",children:[o.jsxs("div",{className:"import-group-header",children:[o.jsx("h3",{children:_e}),o.jsxs("span",{className:"import-group-count",children:[ue,"/",Le.length]})]}),o.jsx("div",{className:"import-task-list",children:Le.map(at=>{const ht=J.indexOf(at);return o.jsxs("label",{className:"import-task-item",children:[o.jsx("input",{type:"checkbox",checked:at.selected,onChange:()=>F(ht)}),o.jsx("span",{className:"import-task-name",children:at.name})]},ht)})})]},_e)}),o.jsxs("div",{className:"import-actions",children:[o.jsx("button",{className:"btn btn-secondary",onClick:()=>L(!1),children:"Cancel"}),o.jsxs("button",{className:"btn btn-primary",onClick:I,children:["Use Selected Tasks (",ye,")"]})]})]})}const ne=C.reduce((pe,ye,_e)=>{const Le=ye.group||"General";return pe[Le]||(pe[Le]=[]),pe[Le].push({...ye,originalIndex:_e}),pe},{}),se=Object.keys(ne).length>1||Object.keys(ne).length===1&&!ne.General;return o.jsxs("div",{children:[o.jsx("h1",{children:"New Project"}),o.jsx("p",{className:"subtitle",children:"Set up a new project to track"}),o.jsxs("div",{className:"card",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Project Name"}),o.jsx("input",{type:"text",placeholder:"e.g., Sunrise Apartments",value:r,onChange:pe=>a(pe.target.value)})]}),o.jsxs("div",{className:"form-row-2",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Job Number"}),o.jsx("input",{type:"text",placeholder:"e.g., 4032",value:n,onChange:pe=>s(pe.target.value)})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Contract Value ($)"}),o.jsx("input",{type:"number",placeholder:"e.g., 365000",value:m,onChange:pe=>v(pe.target.value)})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Project Address"}),o.jsx("input",{type:"text",placeholder:"e.g., 123 Main St, Los Angeles, CA 90001",value:l,onChange:pe=>c(pe.target.value)})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"General Contractor"}),o.jsx("input",{type:"text",placeholder:"e.g., ABC Construction Inc.",value:f,onChange:pe=>d(pe.target.value)})]}),o.jsxs("div",{className:"form-row-2",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Work Type"}),o.jsxs("div",{className:"project-type-toggle",children:[o.jsx("button",{type:"button",className:`toggle-btn ${b==="demolition"?"active":""}`,onClick:()=>_("demolition"),children:"Demolition"}),o.jsx("button",{type:"button",className:`toggle-btn ${b==="abatement"?"active":""}`,onClick:()=>_("abatement"),children:"Abatement"})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Job Type"}),o.jsxs("div",{className:"project-type-toggle",children:[o.jsx("button",{type:"button",className:`toggle-btn ${w==="standard"?"active":""}`,onClick:()=>E("standard"),children:"Standard"}),o.jsx("button",{type:"button",className:`toggle-btn ${w==="pla"?"active":""}`,onClick:()=>E("pla"),children:"PLA"})]})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Foreman PIN (4 digits)"}),o.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.85rem",marginBottom:"0.5rem"},children:"Foremen will enter this PIN to access this project"}),o.jsxs("div",{className:"pin-input-row",children:[o.jsx("input",{type:"text",placeholder:"e.g., 2847",value:x,onChange:pe=>V(pe.target.value),maxLength:4,className:"pin-input"}),o.jsx("button",{type:"button",className:"btn btn-secondary",onClick:ie,children:"Generate"})]})]})]}),o.jsxs("div",{className:"card",children:[o.jsxs("div",{className:"areas-header",children:[o.jsxs("div",{children:[o.jsx("h3",{children:"Areas / Tasks"}),o.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.9rem",marginTop:"0.25rem"},children:"Define the areas for this project. Weights must total 100%."})]}),o.jsxs("div",{className:"import-btn-container",children:[o.jsx("input",{ref:O,type:"file",accept:".xlsx,.xls,.csv",onChange:j,style:{display:"none"}}),o.jsx("button",{className:"btn btn-secondary btn-small",onClick:fe,disabled:W,children:W?"Reading...":" Import Excel"})]})]}),se?Object.entries(ne).map(([pe,ye])=>o.jsxs("div",{className:"area-group",children:[o.jsx("div",{className:"area-group-header",children:pe}),ye.map(_e=>o.jsxs("div",{className:"area-row",children:[o.jsx("input",{type:"text",placeholder:"Task name",value:_e.name,onChange:Le=>X(_e.originalIndex,"name",Le.target.value)}),o.jsx("input",{type:"number",placeholder:"%",min:"0",max:"100",value:_e.weight,onChange:Le=>X(_e.originalIndex,"weight",Le.target.value)}),o.jsx("button",{className:"remove-btn",onClick:()=>K(_e.originalIndex),children:""})]},_e.originalIndex))]},pe)):C.map((pe,ye)=>o.jsxs("div",{className:"area-row",children:[o.jsx("input",{type:"text",placeholder:"Area name (e.g., Level 1)",value:pe.name,onChange:_e=>X(ye,"name",_e.target.value)}),o.jsx("input",{type:"number",placeholder:"%",min:"0",max:"100",value:pe.weight,onChange:_e=>X(ye,"weight",_e.target.value)}),o.jsx("button",{className:"remove-btn",onClick:()=>K(ye),children:""})]},ye)),o.jsxs("div",{className:"weight-total",children:[o.jsx("span",{className:"weight-total-label",children:"Total Weight:"}),o.jsxs("span",{className:`weight-total-value ${Math.abs(M-100)<.1?"valid":"invalid"}`,children:[M.toFixed(1),"%"]})]}),o.jsx("button",{className:"btn btn-secondary",onClick:Z,children:"+ Add Area"})]}),o.jsx("button",{className:"btn btn-primary btn-full",onClick:z,disabled:T,children:T?"Creating...":"Create Project"})]})}function g$({company:t,onShowToast:e}){const{branding:r,updateBranding:a,uploadBrandingImage:n,loading:s}=hh(),[l,c]=ee.useState(!1),[f,d]=ee.useState(!1),[m,v]=ee.useState(r),[x,g]=ee.useState(""),[b,_]=ee.useState(!1),w=ee.useRef(null),E=ee.useRef(null),C=ee.useRef(null);ee.useEffect(()=>{t?.id&&A()},[t?.id]);const A=async()=>{try{const{data:V,error:ie}=await Re.from("companies").select("office_code").eq("id",t.id).single();!ie&&V?.office_code&&g(V.office_code)}catch(V){console.error("Error loading office code:",V)}},T=async()=>{if(confirm("Regenerate office code? Current code will stop working immediately.")){_(!0);try{const V=Math.random().toString(36).substring(2,8).toUpperCase(),{error:ie}=await Re.from("companies").update({office_code:V}).eq("id",t.id);if(ie)throw ie;g(V),e?.("Office code regenerated","success")}catch(V){console.error("Error regenerating code:",V),e?.("Error regenerating code","error")}finally{_(!1)}}},G=()=>{navigator.clipboard.writeText(x),e?.("Office code copied to clipboard","success")},W=t?.subscription_tier||"free",B=["pro","business","enterprise"].includes(W),q=["business","enterprise"].includes(W),L=W==="enterprise",J=(V,ie)=>{v(X=>({...X,[V]:ie}))},D=async(V,ie)=>{if(V){if(V.size>5*1024*1024){e?.("Image must be smaller than 5MB","error");return}if(!V.type.startsWith("image/")){e?.("Please upload an image file","error");return}try{const X=await n(V,ie);X.success?(J(`${ie}_url`,X.url),e?.(`${ie.charAt(0).toUpperCase()+ie.slice(1)} uploaded successfully`,"success")):e?.(X.error||"Failed to upload image","error")}catch(X){console.error("Upload error:",X),e?.("Failed to upload image","error")}}},O=async()=>{try{c(!0);const V=/^#[0-9A-F]{6}$/i;if(!V.test(m.primary_color)){e?.("Primary color must be a valid hex color (e.g., #3B82F6)","error");return}if(!V.test(m.secondary_color)){e?.("Secondary color must be a valid hex color (e.g., #1E40AF)","error");return}const ie=await a(m);ie.success?e?.("Branding settings saved successfully!","success"):e?.(ie.error||"Failed to save branding settings","error")}catch(V){console.error("Save error:",V),e?.("Failed to save branding settings","error")}finally{c(!1)}},M=()=>{f?(document.documentElement.style.setProperty("--primary-color",r.primary_color),document.documentElement.style.setProperty("--secondary-color",r.secondary_color),document.title=r.custom_app_name||"FieldSync"):(document.documentElement.style.setProperty("--primary-color",m.primary_color),document.documentElement.style.setProperty("--secondary-color",m.secondary_color),document.title=m.custom_app_name||"FieldSync"),d(!f)};return s?o.jsxs("div",{className:"settings-loading",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading branding settings..."})]}):o.jsxs("div",{className:"branding-settings",children:[o.jsxs("div",{className:"settings-header",children:[o.jsx("h2",{children:" Branding Settings"}),W==="free"&&o.jsx("div",{className:"tier-badge tier-free",children:"Free Plan - Upgrade for branding options"}),W==="pro"&&o.jsx("div",{className:"tier-badge tier-pro",children:"Pro Plan"}),W==="business"&&o.jsx("div",{className:"tier-badge tier-business",children:"Business Plan"}),W==="enterprise"&&o.jsx("div",{className:"tier-badge tier-enterprise",children:"Enterprise Plan"})]}),o.jsxs("div",{className:"settings-section security-section",children:[o.jsx("h3",{children:"Security"}),o.jsxs("div",{className:"setting-item",children:[o.jsx("label",{children:"Office Code"}),o.jsx("p",{className:"help-text",style:{marginBottom:"0.75rem"},children:"Share this code with office staff only. Required to create new office accounts."}),o.jsxs("div",{className:"office-code-display",children:[o.jsx("code",{className:"office-code-value",children:x||"------"}),o.jsx("button",{className:"btn-secondary btn-small",onClick:G,disabled:!x,children:"Copy"}),o.jsx("button",{className:"btn-secondary btn-small",onClick:T,disabled:b,children:b?"...":"Regenerate"})]}),o.jsx("p",{className:"help-text",style:{marginTop:"0.5rem",color:"var(--accent-amber)"},children:"Field workers should NOT have this code - they use project PINs only."})]}),o.jsxs("div",{className:"setting-item",children:[o.jsx("label",{children:"Company Code"}),o.jsx("p",{className:"help-text",style:{marginBottom:"0.75rem"},children:"Public code for employees to find your company."}),o.jsxs("div",{className:"office-code-display",children:[o.jsx("code",{className:"office-code-value",children:t?.code||"------"}),o.jsx("button",{className:"btn-secondary btn-small",onClick:()=>{navigator.clipboard.writeText(t?.code||""),e?.("Company code copied","success")},disabled:!t?.code,children:"Copy"})]})]})]}),o.jsxs("div",{className:"settings-section",children:[o.jsx("h3",{children:"Visual Identity"}),o.jsxs("div",{className:"setting-item",children:[o.jsx("label",{children:"Logo"}),B?o.jsxs(o.Fragment,{children:[m.logo_url&&o.jsx("div",{className:"logo-preview",children:o.jsx("img",{src:m.logo_url,alt:"Logo preview"})}),o.jsx("input",{ref:w,type:"file",accept:"image/*",style:{display:"none"},onChange:V=>D(V.target.files[0],"logo")}),o.jsx("button",{className:"btn-secondary",onClick:()=>w.current?.click(),children:m.logo_url?"Change Logo":"Upload Logo"}),o.jsx("p",{className:"help-text",children:"Recommended: 200x60px, PNG with transparent background"})]}):o.jsx("div",{className:"upgrade-notice",children:o.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize your logo"})})]}),o.jsxs("div",{className:"setting-item",children:[o.jsx("label",{htmlFor:"app-name",children:"App Name"}),B?o.jsxs(o.Fragment,{children:[o.jsx("input",{id:"app-name",type:"text",className:"input",value:m.custom_app_name||"",onChange:V=>J("custom_app_name",V.target.value),placeholder:"FieldSync",maxLength:50}),o.jsx("p",{className:"help-text",children:"This name appears in the browser tab and throughout the app"})]}):o.jsx("div",{className:"upgrade-notice",children:o.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize your app name"})})]}),o.jsxs("div",{className:"setting-item",children:[o.jsx("label",{htmlFor:"primary-color",children:"Primary Color"}),B?o.jsxs("div",{className:"color-input-group",children:[o.jsx("input",{id:"primary-color",type:"color",value:m.primary_color||"#3B82F6",onChange:V=>J("primary_color",V.target.value),className:"color-picker"}),o.jsx("input",{type:"text",className:"input color-text",value:m.primary_color||"#3B82F6",onChange:V=>J("primary_color",V.target.value),placeholder:"#3B82F6",pattern:"^#[0-9A-Fa-f]{6}$"})]}):o.jsx("div",{className:"upgrade-notice",children:o.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize colors"})})]}),o.jsxs("div",{className:"setting-item",children:[o.jsx("label",{htmlFor:"secondary-color",children:"Secondary Color"}),B?o.jsxs("div",{className:"color-input-group",children:[o.jsx("input",{id:"secondary-color",type:"color",value:m.secondary_color||"#1E40AF",onChange:V=>J("secondary_color",V.target.value),className:"color-picker"}),o.jsx("input",{type:"text",className:"input color-text",value:m.secondary_color||"#1E40AF",onChange:V=>J("secondary_color",V.target.value),placeholder:"#1E40AF",pattern:"^#[0-9A-Fa-f]{6}$"})]}):o.jsx("div",{className:"upgrade-notice",children:o.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize colors"})})]}),o.jsxs("div",{className:"setting-item",children:[o.jsx("label",{children:"Favicon"}),B?o.jsxs(o.Fragment,{children:[m.favicon_url&&o.jsx("div",{className:"favicon-preview",children:o.jsx("img",{src:m.favicon_url,alt:"Favicon preview"})}),o.jsx("input",{ref:E,type:"file",accept:"image/*",style:{display:"none"},onChange:V=>D(V.target.files[0],"favicon")}),o.jsx("button",{className:"btn-secondary",onClick:()=>E.current?.click(),children:m.favicon_url?"Change Favicon":"Upload Favicon"}),o.jsx("p",{className:"help-text",children:"Recommended: 32x32px or 64x64px, PNG or ICO format"})]}):o.jsx("div",{className:"upgrade-notice",children:o.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize your favicon"})})]}),o.jsxs("div",{className:"setting-item",children:[o.jsx("label",{children:"Login Background"}),q?o.jsxs(o.Fragment,{children:[m.login_background_url&&o.jsx("div",{className:"background-preview",children:o.jsx("img",{src:m.login_background_url,alt:"Background preview"})}),o.jsx("input",{ref:C,type:"file",accept:"image/*",style:{display:"none"},onChange:V=>D(V.target.files[0],"login_background")}),o.jsx("button",{className:"btn-secondary",onClick:()=>C.current?.click(),children:m.login_background_url?"Change Background":"Upload Background"}),o.jsx("p",{className:"help-text",children:"Recommended: 1920x1080px, JPG or PNG"})]}):o.jsx("div",{className:"upgrade-notice",children:o.jsx("p",{children:" Upgrade to Business or Enterprise to customize login background"})})]})]}),o.jsxs("div",{className:"settings-section",children:[o.jsx("h3",{children:"White-Label Options"}),o.jsxs("div",{className:"setting-item",children:[o.jsxs("label",{className:"checkbox-label",children:[o.jsx("input",{type:"checkbox",checked:m.hide_fieldsync_branding||!1,onChange:V=>J("hide_fieldsync_branding",V.target.checked),disabled:!q}),o.jsx("span",{children:'Hide "Powered by FieldSync"'})]}),!q&&o.jsx("p",{className:"help-text",children:" Business or Enterprise plan required"})]})]}),o.jsxs("div",{className:"settings-section",children:[o.jsx("h3",{children:"Email Branding"}),o.jsxs("div",{className:"setting-item",children:[o.jsx("label",{htmlFor:"email-from-name",children:"From Name"}),o.jsx("input",{id:"email-from-name",type:"text",className:"input",value:m.email_from_name||"",onChange:V=>J("email_from_name",V.target.value),placeholder:"Your Company Name",disabled:!q}),!q&&o.jsx("p",{className:"help-text",children:" Business or Enterprise plan required"})]}),o.jsxs("div",{className:"setting-item",children:[o.jsx("label",{htmlFor:"email-from-address",children:"From Email"}),o.jsx("input",{id:"email-from-address",type:"email",className:"input",value:m.email_from_address||"",onChange:V=>J("email_from_address",V.target.value),placeholder:"noreply@yourcompany.com",disabled:!q}),!q&&o.jsx("p",{className:"help-text",children:" Business or Enterprise plan required"})]})]}),o.jsxs("div",{className:"settings-section",children:[o.jsx("h3",{children:"Custom Domain"}),o.jsxs("div",{className:"setting-item",children:[o.jsx("label",{htmlFor:"custom-domain",children:"Domain"}),L?o.jsxs(o.Fragment,{children:[o.jsx("input",{id:"custom-domain",type:"text",className:"input",value:m.custom_domain||"",onChange:V=>J("custom_domain",V.target.value),placeholder:"app.yourcompany.com"}),m.custom_domain&&o.jsx("div",{className:`domain-status ${m.domain_verified?"verified":"pending"}`,children:m.domain_verified?o.jsx(o.Fragment,{children:" Connected"}):o.jsx(o.Fragment,{children:" DNS setup required"})}),o.jsx("p",{className:"help-text",children:"Contact support to configure DNS and SSL certificate for your custom domain"})]}):o.jsxs("div",{className:"upgrade-notice",children:[o.jsx("p",{children:" Enterprise plan required for custom domain support"}),o.jsx("p",{className:"help-text",children:"Custom domains allow you to host the app at your own URL (e.g., app.yourcompany.com)"})]})]})]}),o.jsxs("div",{className:"settings-actions",children:[o.jsx("button",{className:"btn-secondary",onClick:M,children:f?"Exit Preview":"Preview Changes"}),o.jsx("button",{className:"btn-primary",onClick:O,disabled:l||!B,children:l?"Saving...":"Save Changes"})]}),f&&o.jsx("div",{className:"preview-banner",children:"Preview Mode Active - Your changes are not yet saved"})]})}const ex=["foreman","operator","laborer"],tx=["demolition","abatement"],rx=["standard","pla"];function v$({company:t,onShowToast:e}){const[r,a]=ee.useState({}),[n,s]=ee.useState(!1),[l,c]=ee.useState(!1),[f,d]=ee.useState("demolition"),[m,v]=ee.useState(!0);ee.useEffect(()=>{t?.id&&g()},[t?.id]);const x=()=>{const A={};return tx.forEach(T=>{A[T]={},rx.forEach(G=>{A[T][G]={},ex.forEach(W=>{A[T][G][W]={regular:"",overtime:""}})})}),A},g=async()=>{if(!Ue){a(x()),v(!1);return}const A=x();try{const{data:T,error:G}=await Re.from("labor_rates").select("*").eq("company_id",t.id);if(G){a(A),v(!1);return}T&&T.length>0&&T.forEach(W=>{A[W.work_type]&&A[W.work_type][W.job_type]&&A[W.work_type][W.job_type][W.role]&&(A[W.work_type][W.job_type][W.role]={regular:W.regular_rate||"",overtime:W.overtime_rate||""})}),a(A)}catch(T){console.error("Error loading labor rates:",T),a(A)}finally{v(!1)}},b=async()=>{if(!Ue){e("Labor rates require database connection","error");return}c(!0);try{await Re.from("labor_rates").delete().eq("company_id",t.id);const A=[];tx.forEach(G=>{rx.forEach(W=>{ex.forEach(B=>{const q=r[G]?.[W]?.[B]||{regular:0,overtime:0};A.push({company_id:t.id,role:B,work_type:G,job_type:W,regular_rate:parseFloat(q.regular)||0,overtime_rate:parseFloat(q.overtime)||0})})})});const{error:T}=await Re.from("labor_rates").insert(A);if(T)throw T;e("Labor rates saved","success"),s(!1)}catch(A){console.error("Error saving labor rates:",A),e("Error saving rates: "+(A.message||"Unknown error"),"error")}finally{c(!1)}},_=(A,T,G,W,B)=>{a(q=>({...q,[A]:{...q[A],[T]:{...q[A]?.[T],[G]:{...q[A]?.[T]?.[G],[W]:B}}}}))},w=A=>A.charAt(0).toUpperCase()+A.slice(1),E=A=>A.charAt(0).toUpperCase()+A.slice(1),C=A=>A==="pla"?"PLA (Prevailing Wage)":"Standard (Private)";return m?o.jsx("div",{className:"loading",children:"Loading labor rates..."}):o.jsxs("div",{className:"pricing-section",children:[o.jsxs("div",{className:"pricing-section-header",children:[o.jsxs("div",{children:[o.jsx("h2",{children:"Labor Rates"}),o.jsx("p",{className:"section-desc",children:"Configure hourly rates by role, work type, and job classification"})]}),n?o.jsxs("div",{className:"rate-actions",children:[o.jsx("button",{className:"btn btn-secondary",onClick:()=>{s(!1),g()},children:"Cancel"}),o.jsx("button",{className:"btn btn-primary",onClick:b,disabled:l,children:l?"Saving...":"Save All Rates"})]}):o.jsx("button",{className:"btn btn-primary",onClick:()=>s(!0),children:"Edit Rates"})]}),o.jsx("div",{className:"work-type-tabs",children:tx.map(A=>o.jsx("button",{className:`work-type-tab ${f===A?"active":""}`,onClick:()=>d(A),children:E(A)},A))}),o.jsx("div",{className:"labor-rates-container",children:rx.map(A=>o.jsxs("div",{className:"job-type-section",children:[o.jsx("h3",{className:"job-type-header",children:C(A)}),o.jsxs("div",{className:"rates-table",children:[o.jsxs("div",{className:"rates-table-header",children:[o.jsx("div",{className:"rate-cell role-cell",children:"Role"}),o.jsx("div",{className:"rate-cell",children:"Regular"}),o.jsx("div",{className:"rate-cell",children:"Overtime"})]}),ex.map(T=>{const G=r[f]?.[A]?.[T]||{regular:"",overtime:""};return o.jsxs("div",{className:"rates-table-row",children:[o.jsx("div",{className:"rate-cell role-cell",children:w(T)}),o.jsx("div",{className:"rate-cell",children:n?o.jsxs("div",{className:"rate-input-inline",children:[o.jsx("span",{children:"$"}),o.jsx("input",{type:"number",value:G.regular,onChange:W=>_(f,A,T,"regular",W.target.value),placeholder:"0.00",step:"0.01"}),o.jsx("span",{children:"/hr"})]}):o.jsxs("span",{className:"rate-value",children:["$",(parseFloat(G.regular)||0).toFixed(2),"/hr"]})}),o.jsx("div",{className:"rate-cell",children:n?o.jsxs("div",{className:"rate-input-inline",children:[o.jsx("span",{children:"$"}),o.jsx("input",{type:"number",value:G.overtime,onChange:W=>_(f,A,T,"overtime",W.target.value),placeholder:"0.00",step:"0.01"}),o.jsx("span",{children:"/hr"})]}):o.jsxs("span",{className:"rate-value ot",children:["$",(parseFloat(G.overtime)||0).toFixed(2),"/hr"]})})]},T)})]})]},A))})]})}const Pp=["Containment","PPE","Disposal","Equipment"];function x$({company:t,onShowToast:e}){const[r,a]=ee.useState([]),[n,s]=ee.useState(!0),[l,c]=ee.useState("all"),[f,d]=ee.useState(null),[m,v]=ee.useState(!1),[x,g]=ee.useState({name:"",category:"Equipment",unit:"each",cost_per_unit:""}),[b,_]=ee.useState([]),[w,E]=ee.useState(!1);ee.useEffect(()=>{t?.id&&C()},[t?.id]);const C=async()=>{s(!0);try{const D=await ot.getAllMaterialsEquipment(t.id);a(D||[]),A(D||[])}catch(D){console.error("Error loading items:",D),e("Error loading materials","error")}finally{s(!1)}},A=D=>{const O={},M=[];D.filter(ie=>ie.active!==!1).forEach(ie=>{const X=ie.name.toLowerCase().trim();O[X]||(O[X]=[]),O[X].push(ie)}),Object.entries(O).forEach(([ie,X])=>{X.length>1&&M.push({name:ie,items:X})}),_(M)},T=async D=>{try{const O=D.items.filter(ie=>ie.cost_per_unit>0),M=O.length>0?O[0]:D.items[0],V=D.items.filter(ie=>ie.id!==M.id);for(const ie of V)await ot.deleteMaterialEquipment(ie.id);e(`Merged ${D.items.length} items into one`,"success"),C()}catch(O){console.error("Error merging duplicates:",O),e("Error merging duplicates","error")}},G=async()=>{if(confirm(`Merge all ${b.length} duplicate groups?`))try{for(const D of b){const O=D.items.filter(ie=>ie.cost_per_unit>0),M=O.length>0?O[0]:D.items[0],V=D.items.filter(ie=>ie.id!==M.id);for(const ie of V)await ot.deleteMaterialEquipment(ie.id)}e("All duplicates merged!","success"),C(),E(!1)}catch(D){console.error("Error merging all duplicates:",D),e("Error merging duplicates","error")}},W=async()=>{if(!x.name.trim()){e("Enter item name","error");return}try{await ot.createMaterialEquipment({company_id:t.id,name:x.name.trim(),category:x.category,unit:x.unit||"each",cost_per_unit:parseFloat(x.cost_per_unit)||0,active:!0}),e("Item added","success"),g({name:"",category:"Equipment",unit:"each",cost_per_unit:""}),v(!1),C()}catch(D){console.error("Error adding item:",D),e("Error adding item","error")}},B=async D=>{try{await ot.updateMaterialEquipment(D.id,{name:D.name,category:D.category,unit:D.unit,cost_per_unit:parseFloat(D.cost_per_unit)||0}),e("Item updated","success"),d(null),C()}catch(O){console.error("Error updating item:",O),e("Error updating item","error")}},q=async D=>{if(confirm("Delete this item?"))try{await ot.deleteMaterialEquipment(D),e("Item deleted","success"),C()}catch(O){console.error("Error deleting item:",O),e("Error deleting item","error")}},L=l==="all"?r.filter(D=>D.active!==!1):r.filter(D=>D.category===l&&D.active!==!1),J=L.reduce((D,O)=>{const M=O.category||"Other";return D[M]||(D[M]=[]),D[M].push(O),D},{});return n?o.jsx("div",{className:"loading",children:"Loading materials..."}):o.jsxs("div",{className:"pricing-section",children:[o.jsxs("div",{className:"materials-header",children:[o.jsxs("div",{className:"materials-title",children:[o.jsx("h2",{children:"Materials & Equipment"}),o.jsxs("span",{className:"materials-count",children:[r.filter(D=>D.active!==!1).length," items"]})]}),o.jsxs("div",{className:"materials-actions",children:[b.length>0&&o.jsxs("button",{className:`btn btn-warning ${w?"active":""}`,onClick:()=>E(!w),children:[b.length," Duplicates"]}),o.jsx("button",{className:"btn btn-primary",onClick:()=>v(!0),children:"+ Add Item"})]})]}),w&&b.length>0&&o.jsxs("div",{className:"duplicates-panel",children:[o.jsxs("div",{className:"duplicates-header",children:[o.jsx("h3",{children:"Duplicate Items Found"}),o.jsxs("button",{className:"btn btn-success btn-small",onClick:G,children:["Merge All (",b.length,")"]})]}),o.jsx("div",{className:"duplicates-list",children:b.map((D,O)=>o.jsxs("div",{className:"duplicate-group",children:[o.jsxs("div",{className:"duplicate-name",children:['"',D.name,'" x ',D.items.length]}),o.jsx("div",{className:"duplicate-items",children:D.items.map(M=>o.jsxs("span",{className:"duplicate-item",children:[M.category," - $",M.cost_per_unit||0]},M.id))}),o.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>T(D),children:"Merge"})]},O))})]}),m&&o.jsxs("div",{className:"add-item-form",children:[o.jsx("h3",{children:"Add New Item"}),o.jsxs("div",{className:"form-row",children:[o.jsx("input",{type:"text",placeholder:"Item Name",value:x.name,onChange:D=>g({...x,name:D.target.value}),autoFocus:!0}),o.jsx("select",{value:x.category,onChange:D=>g({...x,category:D.target.value}),children:Pp.map(D=>o.jsx("option",{value:D,children:D},D))})]}),o.jsxs("div",{className:"form-row",children:[o.jsx("input",{type:"text",placeholder:"Unit (e.g., each, day, hour)",value:x.unit,onChange:D=>g({...x,unit:D.target.value})}),o.jsx("input",{type:"number",placeholder:"Cost per unit",value:x.cost_per_unit,onChange:D=>g({...x,cost_per_unit:D.target.value}),step:"0.01"})]}),o.jsxs("div",{className:"form-actions",children:[o.jsx("button",{className:"btn btn-secondary",onClick:()=>v(!1),children:"Cancel"}),o.jsx("button",{className:"btn btn-primary",onClick:W,children:"Add Item"})]})]}),o.jsxs("div",{className:"materials-filter",children:[o.jsx("button",{className:`filter-tab ${l==="all"?"active":""}`,onClick:()=>c("all"),children:"All"}),Pp.map(D=>o.jsxs("button",{className:`filter-tab ${l===D?"active":""}`,onClick:()=>c(D),children:[D,o.jsx("span",{className:"filter-count",children:r.filter(O=>O.category===D&&O.active!==!1).length})]},D))]}),o.jsxs("div",{className:"materials-list",children:[l==="all"?Object.entries(J).map(([D,O])=>o.jsxs("div",{className:"materials-category",children:[o.jsx("h3",{className:"category-header",children:D}),o.jsx("div",{className:"category-items",children:O.map(M=>o.jsx(YS,{item:M,editingItem:f,setEditingItem:d,handleUpdateItem:B,handleDeleteItem:q,categories:Pp},M.id))})]},D)):o.jsxs("div",{className:"materials-category",children:[o.jsx("h3",{className:"category-header",children:l}),o.jsx("div",{className:"category-items",children:L.map(D=>o.jsx(YS,{item:D,editingItem:f,setEditingItem:d,handleUpdateItem:B,handleDeleteItem:q,categories:Pp},D.id))})]}),L.length===0&&o.jsx("div",{className:"empty-state",children:o.jsx("p",{children:"No items in this category"})})]})]})}function YS({item:t,editingItem:e,setEditingItem:r,handleUpdateItem:a,handleDeleteItem:n,categories:s}){return e?.id===t.id?o.jsx("div",{className:"material-item",children:o.jsxs("div",{className:"item-edit-form",children:[o.jsx("input",{type:"text",value:e.name,onChange:l=>r({...e,name:l.target.value})}),o.jsx("select",{value:e.category,onChange:l=>r({...e,category:l.target.value}),children:s.map(l=>o.jsx("option",{value:l,children:l},l))}),o.jsx("input",{type:"text",value:e.unit,onChange:l=>r({...e,unit:l.target.value}),placeholder:"Unit"}),o.jsx("input",{type:"number",value:e.cost_per_unit,onChange:l=>r({...e,cost_per_unit:l.target.value}),placeholder:"Cost",step:"0.01"}),o.jsxs("div",{className:"edit-actions",children:[o.jsx("button",{className:"btn btn-success btn-small",onClick:()=>a(e),children:"Save"}),o.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>r(null),children:"Cancel"})]})]})}):o.jsxs("div",{className:"material-item",children:[o.jsxs("div",{className:"item-info",children:[o.jsx("span",{className:"item-name",children:t.name}),o.jsx("span",{className:"item-unit",children:t.unit||"each"})]}),o.jsxs("div",{className:"item-cost",children:["$",(t.cost_per_unit||0).toFixed(2)]}),o.jsxs("div",{className:"item-actions",children:[o.jsx("button",{className:"btn-icon",onClick:()=>r({...t}),title:"Edit",children:o.jsx(tN,{size:16})}),o.jsx("button",{className:"btn-icon danger",onClick:()=>n(t.id),title:"Delete",children:o.jsx(lc,{size:16})})]})]})}const y$=[{id:"trash",label:"Trash",description:"General debris"},{id:"metal",label:"Metal",description:"Scrap metal (recyclable)"},{id:"copper",label:"Copper",description:"Copper scrap (recyclable)"},{id:"concrete",label:"Concrete",description:"Concrete/masonry"},{id:"hazardous",label:"Hazardous",description:"Hazardous materials"}];function _$({company:t,onShowToast:e}){const[r,a]=ee.useState([]),[n,s]=ee.useState(!0),[l,c]=ee.useState(!1),[f,d]=ee.useState(null),[m,v]=ee.useState({name:"",address:"",notes:""}),[x,g]=ee.useState(!1),[b,_]=ee.useState({}),w=ee.useRef({});ee.useEffect(()=>{t?.id&&E()},[t?.id]),ee.useEffect(()=>()=>{Object.values(w.current).forEach(L=>clearTimeout(L))},[]);const E=async()=>{s(!0);try{const L=await ot.getDumpSites(t.id);a(L||[])}catch(L){console.error("Error loading dump sites:",L),e("Error loading dump sites","error")}finally{s(!1)}},C=async()=>{if(!m.name.trim()){e("Please enter a site name","error");return}g(!0);try{await ot.createDumpSite(t.id,m.name,m.address,m.notes),e("Dump site added","success"),v({name:"",address:"",notes:""}),c(!1),E()}catch(L){console.error("Error adding dump site:",L),e("Error adding dump site","error")}finally{g(!1)}},A=async()=>{if(!f?.name.trim()){e("Please enter a site name","error");return}g(!0);try{await ot.updateDumpSite(f.id,{name:f.name,address:f.address,notes:f.notes}),e("Dump site updated","success"),d(null),E()}catch(L){console.error("Error updating dump site:",L),e("Error updating dump site","error")}finally{g(!1)}},T=async L=>{if(confirm("Are you sure you want to delete this dump site?"))try{await ot.deleteDumpSite(L),e("Dump site deleted","success"),E()}catch(J){console.error("Error deleting dump site:",J),e("Error deleting dump site","error")}},G=ee.useCallback(async(L,J,D)=>{try{await ot.setDumpSiteRate(L,J,D),a(O=>O.map(M=>{if(M.id===L){const V=[...M.dump_site_rates||[]],ie=V.findIndex(X=>X.waste_type===J);return ie>=0?V[ie]={...V[ie],estimated_cost_per_load:D}:V.push({waste_type:J,estimated_cost_per_load:D}),{...M,dump_site_rates:V}}return M})),_(O=>{const M={...O};return delete M[`${L}-${J}`],M})}catch(O){console.error("Error saving rate:",O?.message||O),e("Error saving rate","error")}},[e]),W=(L,J,D)=>{const O=`${L}-${J}`;_(M=>({...M,[O]:D})),w.current[O]&&clearTimeout(w.current[O]),w.current[O]=setTimeout(()=>{const M=parseFloat(D)||0;G(L,J,M)},500)},B=(L,J)=>{const D=`${L.id}-${J}`;return b[D]!==void 0?b[D]:L.dump_site_rates?.find(M=>M.waste_type===J)?.estimated_cost_per_load??""},q=L=>{if(L===""||L===null||L===void 0)return"";const J=parseFloat(L);return J<0?`-$${Math.abs(J).toFixed(0)}`:`$${J.toFixed(0)}`};return n?o.jsx("div",{className:"loading",children:"Loading dump sites..."}):o.jsxs("div",{className:"pricing-section",children:[o.jsxs("div",{className:"dump-site-header",children:[o.jsxs("div",{children:[o.jsx("h2",{children:"Disposal & Haul-Off"}),o.jsx("p",{className:"section-desc",children:"Configure dump sites and estimated costs per load for each waste type. Use negative values for recyclables (metal, copper) to indicate revenue."})]}),o.jsx("button",{className:"btn btn-primary",onClick:()=>c(!0),children:"+ Add Dump Site"})]}),l&&o.jsxs("div",{className:"dump-site-form card",children:[o.jsx("h4",{children:"Add Dump Site"}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Site Name *"}),o.jsx("input",{type:"text",value:m.name,onChange:L=>v({...m,name:L.target.value}),placeholder:"e.g., Metro Landfill"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Address"}),o.jsx("input",{type:"text",value:m.address,onChange:L=>v({...m,address:L.target.value}),placeholder:"123 Main St, City"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Notes"}),o.jsx("input",{type:"text",value:m.notes,onChange:L=>v({...m,notes:L.target.value}),placeholder:"Operating hours, contact, etc."})]}),o.jsxs("div",{className:"form-actions",children:[o.jsx("button",{className:"btn btn-secondary",onClick:()=>c(!1),children:"Cancel"}),o.jsx("button",{className:"btn btn-primary",onClick:C,disabled:x,children:x?"Adding...":"Add Site"})]})]}),r.length===0?o.jsxs("div",{className:"dump-site-empty",children:[o.jsx("p",{children:"No dump sites configured yet."}),o.jsx("p",{children:"Add a dump site to start tracking haul-off costs."})]}):o.jsx("div",{className:"dump-sites-list",children:r.map(L=>o.jsxs("div",{className:"dump-site-card card",children:[f?.id===L.id?o.jsxs("div",{className:"dump-site-edit",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Site Name *"}),o.jsx("input",{type:"text",value:f.name,onChange:J=>d({...f,name:J.target.value})})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Address"}),o.jsx("input",{type:"text",value:f.address||"",onChange:J=>d({...f,address:J.target.value})})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Notes"}),o.jsx("input",{type:"text",value:f.notes||"",onChange:J=>d({...f,notes:J.target.value})})]}),o.jsxs("div",{className:"form-actions",children:[o.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>d(null),children:"Cancel"}),o.jsx("button",{className:"btn btn-primary btn-sm",onClick:A,disabled:x,children:x?"Saving...":"Save"})]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"dump-site-info",children:[o.jsx("div",{className:"dump-site-name",children:L.name}),L.address&&o.jsx("div",{className:"dump-site-address",children:L.address}),L.notes&&o.jsx("div",{className:"dump-site-notes",children:L.notes})]}),o.jsxs("div",{className:"dump-site-actions",children:[o.jsx("button",{className:"btn-icon",onClick:()=>d({...L}),title:"Edit",children:o.jsx(tN,{size:16})}),o.jsx("button",{className:"btn-icon",onClick:()=>T(L.id),title:"Delete",children:o.jsx(lc,{size:16})})]})]}),o.jsxs("div",{className:"dump-site-rates",children:[o.jsx("div",{className:"rates-header",children:"Estimated Cost per Load"}),o.jsx("div",{className:"rates-grid",children:y$.map(J=>o.jsxs("div",{className:"rate-item",children:[o.jsxs("label",{children:[o.jsx("span",{className:"rate-label",children:J.label}),o.jsx("span",{className:"rate-desc",children:J.description})]}),o.jsxs("div",{className:"rate-input-wrapper",children:[o.jsx("span",{className:"rate-prefix",children:"$"}),o.jsx("input",{type:"number",className:"rate-input",value:B(L,J.id),onChange:D=>W(L.id,J.id,D.target.value),placeholder:"0"})]}),B(L,J.id)!==""&&o.jsxs("span",{className:`rate-preview ${parseFloat(B(L,J.id))<0?"revenue":"cost"}`,children:[q(B(L,J.id)),"/load"]})]},J.id))}),o.jsx("div",{className:"rates-note",children:"Tip: Use negative values for recyclables that generate revenue (e.g., -50 for metal)"})]})]},L.id))})]})}const b$=[{id:"labor",label:"Labor Rates",Icon:Ys},{id:"materials",label:"Materials & Equipment",Icon:Q0},{id:"disposal",label:"Disposal & Haul-Off",Icon:ph}];function w$({company:t,onShowToast:e}){const[r,a]=ee.useState("labor");return o.jsxs("div",{className:"pricing-manager",children:[o.jsxs("div",{className:"pricing-header",children:[o.jsx("h1",{children:"Pricing Configuration"}),o.jsx("p",{className:"pricing-subtitle",children:"Set up labor rates, materials pricing, and disposal costs"})]}),o.jsx("div",{className:"pricing-tabs",children:b$.map(n=>o.jsxs("button",{className:`pricing-tab ${r===n.id?"active":""}`,onClick:()=>a(n.id),children:[o.jsx(n.Icon,{size:18,className:"pricing-tab-icon"}),o.jsx("span",{className:"pricing-tab-label",children:n.label})]},n.id))}),o.jsxs("div",{className:"pricing-content",children:[r==="labor"&&o.jsx(v$,{company:t,onShowToast:e}),r==="materials"&&o.jsx(x$,{company:t,onShowToast:e}),r==="disposal"&&o.jsx(_$,{company:t,onShowToast:e})]})]})}function S$({shareToken:t}){const[e,r]=ee.useState(!0),[a,n]=ee.useState(null),[s,l]=ee.useState(null),[c,f]=ee.useState(0),{branding:d}=hh();ee.useEffect(()=>{m()},[t]);const m=async()=>{r(!0),n(null);try{const T=await ot.getPublicProjectData(t);if(!T){n("This share link is invalid or has expired.");return}l(T)}catch(T){console.error("Error loading public data:",T),n("Failed to load project data.")}finally{r(!1)}},v=T=>T?new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",x=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(T);if(e)return o.jsxs("div",{className:"public-view",children:[o.jsxs("div",{className:"loading-container",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading project..."})]}),o.jsx("style",{children:ax})]});if(a)return o.jsxs("div",{className:"public-view",children:[o.jsxs("div",{className:"error-container",children:[o.jsx("div",{className:"error-icon",children:o.jsx(x1,{size:48})}),o.jsx("h2",{children:a}),o.jsx("p",{children:"Please contact the project owner for a valid link."})]}),o.jsx("style",{children:ax})]});const{share:g,project:b,progress:_,areas:w,photos:E,dailyReports:C,tmTickets:A}=s;return o.jsxs("div",{className:"public-view",children:[o.jsx("header",{className:"public-header",children:o.jsxs("div",{className:"container",children:[o.jsx(Nl,{size:"large"}),o.jsx("div",{className:"header-meta",children:o.jsxs("span",{className:"last-updated",children:["Last updated: ",v(b.updated_at||b.created_at)]})})]})}),o.jsx("main",{className:"public-main",children:o.jsxs("div",{className:"container",children:[o.jsxs("div",{className:"project-header",children:[o.jsx("h1",{children:b.name}),b.address&&o.jsx("p",{className:"project-address",children:b.address})]}),g.permissions.progress&&o.jsxs("div",{className:"public-card progress-card",children:[o.jsx("h2",{children:"Project Progress"}),o.jsxs("div",{className:"progress-visual",children:[o.jsxs("div",{className:"progress-circle",children:[o.jsxs("svg",{viewBox:"0 0 100 100",children:[o.jsx("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"#e5e7eb",strokeWidth:"8"}),o.jsx("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"var(--primary-color, #3b82f6)",strokeWidth:"8",strokeDasharray:`${_*2.827} 282.7`,strokeLinecap:"round",transform:"rotate(-90 50 50)"})]}),o.jsxs("div",{className:"progress-percentage",children:[_,"%"]})]}),o.jsxs("div",{className:"progress-details",children:[o.jsx("div",{className:"progress-label",children:"Complete"}),w&&w.length>0&&o.jsxs("div",{className:"areas-summary",children:[w.filter(T=>T.status==="done").length," of ",w.length," areas completed"]})]})]}),w&&w.length>0&&o.jsxs("div",{className:"areas-list",children:[o.jsx("h3",{children:"Work Areas"}),w.map(T=>o.jsxs("div",{className:"area-item",children:[o.jsxs("div",{className:"area-info",children:[o.jsx("span",{className:"area-name",children:T.name}),o.jsxs("span",{className:"area-weight",children:[T.weight,"%"]})]}),o.jsx("div",{className:`area-status status-${T.status}`,children:T.status==="done"?" Complete":T.status==="working"?" In Progress":" Not Started"})]},T.id))]})]}),g.permissions.photos&&E&&E.length>0&&o.jsxs("div",{className:"public-card photos-card",children:[o.jsx("h2",{children:"Recent Photos"}),o.jsxs("div",{className:"photos-carousel",children:[o.jsxs("div",{className:"carousel-main",children:[E[c]&&o.jsx("img",{src:E[c].url,alt:`Project photo from ${v(E[c].date)}`,className:"carousel-image"}),o.jsx("div",{className:"carousel-date",children:v(E[c]?.date)})]}),o.jsx("div",{className:"carousel-thumbnails",children:E.slice(0,10).map((T,G)=>o.jsx("div",{className:`thumbnail ${G===c?"active":""}`,onClick:()=>f(G),children:o.jsx("img",{src:T.url,alt:`Thumbnail ${G+1}`})},G))}),E.length>1&&o.jsxs("div",{className:"carousel-controls",children:[o.jsx("button",{onClick:()=>f(T=>T>0?T-1:E.length-1),className:"carousel-btn",children:""}),o.jsxs("span",{className:"carousel-counter",children:[c+1," / ",E.length]}),o.jsx("button",{onClick:()=>f(T=>T<E.length-1?T+1:0),className:"carousel-btn",children:""})]})]})]}),g.permissions.daily_reports&&C&&C.length>0&&o.jsxs("div",{className:"public-card reports-card",children:[o.jsx("h2",{children:"Daily Reports"}),o.jsx("div",{className:"reports-list",children:C.map((T,G)=>o.jsxs("div",{className:"report-item",children:[o.jsx("div",{className:"report-date",children:v(T.report_date)}),o.jsxs("div",{className:"report-content",children:[T.crew_count&&o.jsxs("div",{className:"report-field",children:[o.jsx("strong",{children:"Crew:"})," ",T.crew_count," workers"]}),T.tasks_completed&&o.jsxs("div",{className:"report-field",children:[o.jsx("strong",{children:"Tasks Completed:"})," ",T.tasks_completed]}),T.weather&&o.jsxs("div",{className:"report-field",children:[o.jsx("strong",{children:"Weather:"})," ",T.weather]}),T.notes&&o.jsxs("div",{className:"report-field",children:[o.jsx("strong",{children:"Notes:"})," ",T.notes]})]})]},G))})]}),g.permissions.tm_tickets&&A&&A.length>0&&o.jsxs("div",{className:"public-card tm-card",children:[o.jsx("h2",{children:"Time & Materials Tickets"}),o.jsx("div",{className:"tm-list",children:A.map((T,G)=>o.jsxs("div",{className:"tm-item",children:[o.jsxs("div",{className:"tm-header",children:[o.jsx("span",{className:"tm-date",children:v(T.work_date)}),o.jsx("span",{className:`tm-status status-${T.status}`,children:T.status})]}),T.description&&o.jsx("div",{className:"tm-description",children:T.description}),T.total_amount&&o.jsxs("div",{className:"tm-amount",children:["Total: ",x(T.total_amount)]})]},G))})]})]})}),o.jsx("footer",{className:"public-footer",children:o.jsx("div",{className:"container",children:!d?.hide_fieldsync_branding&&o.jsx("p",{children:"Powered by FieldSync"})})}),o.jsx("style",{children:ax})]})}const ax=`
  .public-view {
    min-height: 100vh;
    background-color: #f9fafb;
    display: flex;
    flex-direction: column;
  }

  .container {
    max-width: 1000px;
    margin: 0 auto;
    padding: 0 1rem;
    width: 100%;
  }

  /* Header */
  .public-header {
    background-color: white;
    border-bottom: 1px solid #e5e7eb;
    padding: 1.5rem 0;
  }

  .public-header .container {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .header-meta {
    font-size: 0.875rem;
    color: #6b7280;
  }

  /* Main Content */
  .public-main {
    flex: 1;
    padding: 2rem 0;
  }

  .project-header {
    margin-bottom: 2rem;
  }

  .project-header h1 {
    font-size: 2rem;
    margin: 0 0 0.5rem 0;
    color: #111827;
  }

  .project-address {
    font-size: 1rem;
    color: #6b7280;
    margin: 0;
  }

  /* Cards */
  .public-card {
    background-color: white;
    border-radius: 12px;
    padding: 2rem;
    margin-bottom: 1.5rem;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  }

  .public-card h2 {
    font-size: 1.5rem;
    margin: 0 0 1.5rem 0;
    color: #111827;
  }

  .public-card h3 {
    font-size: 1.125rem;
    margin: 1.5rem 0 1rem 0;
    color: #374151;
  }

  /* Progress Card */
  .progress-visual {
    display: flex;
    align-items: center;
    gap: 2rem;
    margin-bottom: 2rem;
  }

  .progress-circle {
    position: relative;
    width: 150px;
    height: 150px;
    flex-shrink: 0;
  }

  .progress-circle svg {
    width: 100%;
    height: 100%;
  }

  .progress-percentage {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 2rem;
    font-weight: bold;
    color: var(--primary-color, #3b82f6);
  }

  .progress-details {
    flex: 1;
  }

  .progress-label {
    font-size: 1.25rem;
    font-weight: 600;
    color: #111827;
    margin-bottom: 0.5rem;
  }

  .areas-summary {
    font-size: 1rem;
    color: #6b7280;
  }

  /* Areas List */
  .areas-list {
    border-top: 1px solid #e5e7eb;
    padding-top: 1rem;
  }

  .area-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem 0;
    border-bottom: 1px solid #f3f4f6;
  }

  .area-item:last-child {
    border-bottom: none;
  }

  .area-info {
    flex: 1;
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-right: 1rem;
  }

  .area-name {
    font-weight: 500;
    color: #374151;
  }

  .area-weight {
    color: #6b7280;
    font-size: 0.875rem;
  }

  .area-status {
    padding: 0.25rem 0.75rem;
    border-radius: 6px;
    font-size: 0.875rem;
    font-weight: 500;
    white-space: nowrap;
  }

  .area-status.status-done {
    background-color: #d1fae5;
    color: #065f46;
  }

  .area-status.status-working {
    background-color: #fef3c7;
    color: #92400e;
  }

  .area-status.status-not_started {
    background-color: #f3f4f6;
    color: #6b7280;
  }

  /* Photos Carousel */
  .photos-carousel {
    position: relative;
  }

  .carousel-main {
    position: relative;
    width: 100%;
    height: 400px;
    background-color: #111827;
    border-radius: 8px;
    overflow: hidden;
    margin-bottom: 1rem;
  }

  .carousel-image {
    width: 100%;
    height: 100%;
    object-fit: contain;
  }

  .carousel-date {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
    color: white;
    padding: 1rem;
    text-align: center;
  }

  .carousel-thumbnails {
    display: flex;
    gap: 0.5rem;
    overflow-x: auto;
    padding-bottom: 0.5rem;
    margin-bottom: 1rem;
  }

  .thumbnail {
    flex-shrink: 0;
    width: 80px;
    height: 80px;
    border-radius: 4px;
    overflow: hidden;
    cursor: pointer;
    border: 2px solid transparent;
    transition: border-color 0.2s;
  }

  .thumbnail:hover {
    border-color: #d1d5db;
  }

  .thumbnail.active {
    border-color: var(--primary-color, #3b82f6);
  }

  .thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .carousel-controls {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 1rem;
  }

  .carousel-btn {
    background-color: white;
    border: 1px solid #d1d5db;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 1.25rem;
    transition: background-color 0.2s;
  }

  .carousel-btn:hover {
    background-color: #f3f4f6;
  }

  .carousel-counter {
    font-size: 0.875rem;
    color: #6b7280;
  }

  /* Daily Reports */
  .reports-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .report-item {
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 1rem;
  }

  .report-date {
    font-weight: 600;
    color: #111827;
    margin-bottom: 0.75rem;
    font-size: 1.125rem;
  }

  .report-content {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .report-field {
    color: #374151;
    line-height: 1.5;
  }

  .report-field strong {
    color: #111827;
  }

  /* T&M Tickets */
  .tm-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .tm-item {
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 1rem;
  }

  .tm-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
  }

  .tm-date {
    font-weight: 600;
    color: #111827;
  }

  .tm-status {
    padding: 0.25rem 0.75rem;
    border-radius: 6px;
    font-size: 0.875rem;
    font-weight: 500;
    text-transform: capitalize;
  }

  .tm-status.status-approved {
    background-color: #d1fae5;
    color: #065f46;
  }

  .tm-status.status-pending {
    background-color: #fef3c7;
    color: #92400e;
  }

  .tm-status.status-rejected {
    background-color: #fee2e2;
    color: #991b1b;
  }

  .tm-description {
    color: #374151;
    margin-bottom: 0.5rem;
  }

  .tm-amount {
    font-size: 1.125rem;
    font-weight: 600;
    color: var(--primary-color, #3b82f6);
  }

  /* Footer */
  .public-footer {
    background-color: white;
    border-top: 1px solid #e5e7eb;
    padding: 2rem 0;
    margin-top: auto;
  }

  .public-footer p {
    text-align: center;
    color: #6b7280;
    margin: 0;
    font-size: 0.875rem;
  }

  /* Loading & Error States */
  .loading-container,
  .error-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    padding: 2rem;
  }

  .spinner {
    width: 50px;
    height: 50px;
    border: 4px solid #e5e7eb;
    border-top-color: var(--primary-color, #3b82f6);
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  .loading-container p {
    margin-top: 1rem;
    color: #6b7280;
  }

  .error-icon {
    font-size: 4rem;
    margin-bottom: 1rem;
  }

  .error-container h2 {
    color: #111827;
    margin: 0 0 0.5rem 0;
  }

  .error-container p {
    color: #6b7280;
    margin: 0;
  }

  /* Mobile Responsive */
  @media (max-width: 768px) {
    .project-header h1 {
      font-size: 1.5rem;
    }

    .public-card {
      padding: 1.5rem;
    }

    .progress-visual {
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    .progress-circle {
      width: 120px;
      height: 120px;
    }

    .progress-percentage {
      font-size: 1.5rem;
    }

    .carousel-main {
      height: 300px;
    }

    .area-item {
      flex-direction: column;
      align-items: flex-start;
      gap: 0.5rem;
    }

    .area-info {
      width: 100%;
      margin-right: 0;
    }
  }
`;function N$({onSave:t,onClose:e,slot:r=1,documentType:a="cor",documentTitle:n="",signerName:s="",signerTitle:l="",signerCompany:c=""}){const f=ee.useRef(null),[d,m]=ee.useState(s),[v,x]=ee.useState(l),[g,b]=ee.useState(c),[_,w]=ee.useState(!1),[E,C]=ee.useState(!1),[A,T]=ee.useState(!1),G=r===1?"GC Authorization":"Client Authorization",W=a==="cor"?"Change Order Request":"T&M Work Order",B=()=>{const X=f.current;return X?X.getContext("2d"):null},q=X=>{const Z=f.current;if(!Z)return{x:0,y:0};const K=Z.getBoundingClientRect(),ae=Z.width/K.width,fe=Z.height/K.height,U=X.touches?X.touches[0].clientX:X.clientX,j=X.touches?X.touches[0].clientY:X.clientY;return{x:(U-K.left)*ae,y:(j-K.top)*fe}},L=X=>{X.preventDefault();const Z=B();if(!Z)return;const{x:K,y:ae}=q(X);Z.beginPath(),Z.moveTo(K,ae),C(!0),w(!0)},J=X=>{if(!E)return;X.preventDefault();const Z=B();if(!Z)return;const{x:K,y:ae}=q(X);Z.lineTo(K,ae),Z.stroke()},D=()=>{C(!1)},O=()=>{const X=f.current,Z=B();!X||!Z||(Z.clearRect(0,0,X.width,X.height),w(!1))},M=X=>{if(!X)return;f.current=X;const Z=X.getContext("2d");Z.strokeStyle="#1e293b",Z.lineWidth=2,Z.lineCap="round",Z.lineJoin="round"},V=_&&d.trim()&&A,ie=()=>{if(!V)return;const X=f.current;if(!X)return;const Z=X.toDataURL("image/png");t({signature:Z,signerName:d.trim(),signerTitle:v.trim()||null,signerCompany:g.trim()||null,signedAt:new Date().toISOString()})};return o.jsx("div",{className:"modal-overlay",onClick:e,role:"dialog","aria-modal":"true","aria-labelledby":"signature-title",children:o.jsxs("div",{className:"modal-content signature-modal enhanced",onClick:X=>X.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsxs("div",{className:"signature-header-info",children:[o.jsx("h2",{id:"signature-title",children:G}),n&&o.jsx("span",{className:"signature-doc-ref",children:n})]}),o.jsx("button",{className:"close-btn",onClick:e,"aria-label":"Close signature modal",children:o.jsx(Rf,{size:20,"aria-hidden":"true"})})]}),o.jsxs("div",{className:"modal-body signature-body",children:[o.jsxs("div",{className:"signature-slot-badge",children:[o.jsx(nN,{size:14}),o.jsxs("span",{children:["Signature ",r," of 2"]})]}),o.jsxs("div",{className:"signature-fields",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"signer-name",children:"Print Name *"}),o.jsx("input",{id:"signer-name",type:"text",value:d,onChange:X=>m(X.target.value),placeholder:"Enter your full legal name","aria-required":"true"})]}),o.jsxs("div",{className:"signature-fields-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"signer-title",children:"Title"}),o.jsx("input",{id:"signer-title",type:"text",value:v,onChange:X=>x(X.target.value),placeholder:"e.g., Project Manager"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"signer-company",children:"Company"}),o.jsx("input",{id:"signer-company",type:"text",value:g,onChange:X=>b(X.target.value),placeholder:"e.g., ABC Construction"})]})]})]}),o.jsxs("div",{className:"signature-area",children:[o.jsxs("div",{className:"signature-label",id:"signature-instructions",children:[o.jsx(eN,{size:16,"aria-hidden":"true"}),o.jsx("span",{children:"Draw your signature below"})]}),o.jsxs("div",{className:"signature-canvas-container",children:[o.jsx("canvas",{ref:M,width:500,height:180,className:"signature-canvas",onMouseDown:L,onMouseMove:J,onMouseUp:D,onMouseLeave:D,onTouchStart:L,onTouchMove:J,onTouchEnd:D,role:"img","aria-label":"Signature drawing area. Use mouse or touch to draw your signature.","aria-describedby":"signature-instructions",tabIndex:0}),!_&&o.jsx("div",{className:"signature-placeholder",children:"Sign here"})]}),o.jsxs("button",{className:"btn btn-ghost btn-small",onClick:O,disabled:!_,"aria-label":"Clear signature",children:[o.jsx(rN,{size:14,"aria-hidden":"true"})," Clear"]})]}),o.jsx("div",{className:"signature-acknowledgment",children:o.jsxs("label",{className:"checkbox-label",children:[o.jsx("input",{type:"checkbox",checked:A,onChange:X=>T(X.target.checked)}),o.jsxs("span",{children:["I acknowledge that this electronic signature is legally binding and that I have reviewed and approve this ",W,". I understand that my signature, name, and IP address will be recorded for verification purposes."]})]})})]}),o.jsxs("div",{className:"modal-footer",children:[o.jsx("button",{className:"btn btn-secondary",onClick:e,"aria-label":"Cancel and close",children:"Cancel"}),o.jsxs("button",{className:"btn btn-primary",onClick:ie,disabled:!V,"aria-label":"Submit signature",children:[o.jsx(R0,{size:16,"aria-hidden":"true"})," Submit Signature"]})]})]})})}const nx=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(t||0),o0=t=>t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"";function j$({signatureToken:t}){const[e,r]=ee.useState(!0),[a,n]=ee.useState(null),[s,l]=ee.useState(null),[c,f]=ee.useState(null),[d,m]=ee.useState(!1),[v,x]=ee.useState(null),[g,b]=ee.useState(!1),[_,w]=ee.useState(!1),[E,C]=ee.useState(null);ee.useEffect(()=>{A()},[t]);const A=async()=>{try{r(!0),n(null);const Z=await ot.getSignatureRequestByToken(t);if(!Z){n("This signature link is invalid or has expired.");return}if(Z.status==="completed"){n("This document has already been fully signed.");return}if(Z.status==="revoked"){n("This signature link has been revoked.");return}if(Z.status==="expired"){n("This signature link has expired.");return}l(Z);const K=await ot.getDocumentForSigning(Z.document_type,Z.document_id);if(!K){n("The document associated with this link could not be found.");return}f(K)}catch(Z){console.error("Error loading signature data:",Z),n("Unable to load signature request. Please try again.")}finally{r(!1)}},T=()=>{if(!s)return{slot1:null,slot2:null,availableSlots:[]};const Z=s.signatures||[],K=Z.find(U=>U.signature_slot===1),ae=Z.find(U=>U.signature_slot===2),fe=[];return K||fe.push(1),ae||fe.push(2),{slot1:K,slot2:ae,availableSlots:fe}},G=async()=>{try{return(await(await fetch("https://api.ipify.org?format=json")).json()).ip}catch{return null}},W=async Z=>{if(!(!s||!v))try{b(!0);const K=await G(),ae=await ot.addSignature(s.id,v,{...Z,ipAddress:K,userAgent:navigator.userAgent});await ot.syncSignatureToDocument(ae,s),await A(),m(!1),x(null),C(`Signature ${v} has been recorded successfully.`),setTimeout(()=>C(null),5e3)}catch(K){console.error("Error submitting signature:",K),n("Failed to submit signature. Please try again.")}finally{b(!1)}},B=Z=>{x(Z),m(!0)};if(e)return o.jsx("div",{className:"signature-page",children:o.jsxs("div",{className:"signature-page-loading",children:[o.jsx("div",{className:"loading-spinner"}),o.jsx("p",{children:"Loading document..."})]})});if(a)return o.jsx("div",{className:"signature-page",children:o.jsxs("div",{className:"signature-page-error",children:[o.jsx(mh,{size:48}),o.jsx("h2",{children:"Unable to Load Document"}),o.jsx("p",{children:a})]})});const{slot1:q,slot2:L,availableSlots:J}=T(),D=J.length===0,O=s?.document_type==="cor",M=c?.projects?.companies,V=c?.projects,X=(()=>{if(O)return{title:`COR ${c.cor_number}`,subtitle:c.title||"Change Order Request",amount:c.cor_total,period:c.period_start&&c.period_end?`${o0(c.period_start)} - ${o0(c.period_end)}`:null,status:c.status};{const Z=c.t_and_m_workers?.length||0,K=c.t_and_m_workers?.reduce((ae,fe)=>ae+(fe.hours||0),0)||0;return{title:"T&M Ticket",subtitle:c.ce_pco_number?`CE/PCO: ${c.ce_pco_number}`:"Time & Materials",amount:c.change_order_value,period:o0(c.work_date),status:c.status,workers:Z,hours:K}}})();return o.jsxs("div",{className:"signature-page",children:[o.jsxs("header",{className:"signature-page-header",children:[M?.logo_url?o.jsx("img",{src:M.logo_url,alt:M.name,className:"company-logo"}):o.jsx("div",{className:"company-logo-placeholder",children:o.jsx(n2,{size:24})}),o.jsxs("div",{className:"company-info",children:[o.jsx("h1",{children:M?.name||"FieldSync"}),o.jsx("span",{className:"doc-type-label",children:"Document Signature"})]})]}),E&&o.jsxs("div",{className:"signature-success-banner",children:[o.jsx(pf,{size:18}),E]}),o.jsxs("main",{className:"signature-page-content",children:[o.jsxs("div",{className:"signature-document-card",children:[o.jsxs("div",{className:"document-card-header",children:[o.jsx(El,{size:20}),o.jsxs("div",{className:"document-card-title",children:[o.jsx("h2",{children:X.title}),o.jsx("span",{className:"document-subtitle",children:X.subtitle})]})]}),o.jsxs("div",{className:"document-card-details",children:[o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"detail-label",children:"Project"}),o.jsx("span",{className:"detail-value",children:V?.name})]}),V?.job_number&&o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"detail-label",children:"Job #"}),o.jsx("span",{className:"detail-value",children:V.job_number})]}),X.amount>0&&o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"detail-label",children:"Amount"}),o.jsx("span",{className:"detail-value amount",children:nx(X.amount)})]}),X.period&&o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"detail-label",children:O?"Period":"Work Date"}),o.jsx("span",{className:"detail-value",children:X.period})]}),!O&&X.workers>0&&o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"detail-label",children:"Workers"}),o.jsxs("span",{className:"detail-value",children:[X.workers," (",X.hours," hrs)"]})]})]}),o.jsxs("button",{className:"expand-details-btn",onClick:()=>w(!_),children:[_?o.jsx(s2,{size:16}):o.jsx(xc,{size:16}),_?"Hide Details":"View Full Details"]}),_&&o.jsx("div",{className:"document-full-details",children:O?o.jsxs(o.Fragment,{children:[c.description&&o.jsxs("div",{className:"detail-section",children:[o.jsx("h4",{children:"Description"}),o.jsx("p",{children:c.description})]}),c.change_order_labor?.length>0&&o.jsxs("div",{className:"detail-section",children:[o.jsxs("h4",{children:["Labor (",c.change_order_labor.length," items)"]}),o.jsxs("ul",{children:[c.change_order_labor.slice(0,5).map((Z,K)=>o.jsxs("li",{children:[Z.description,": ",Z.hours,"hrs @ ",nx(Z.rate),"/hr"]},K)),c.change_order_labor.length>5&&o.jsxs("li",{className:"more-items",children:["+",c.change_order_labor.length-5," more items"]})]})]}),c.change_order_materials?.length>0&&o.jsxs("div",{className:"detail-section",children:[o.jsxs("h4",{children:["Materials (",c.change_order_materials.length," items)"]}),o.jsxs("ul",{children:[c.change_order_materials.slice(0,5).map((Z,K)=>o.jsxs("li",{children:[Z.description,": ",Z.quantity," @ ",nx(Z.unit_cost)]},K)),c.change_order_materials.length>5&&o.jsxs("li",{className:"more-items",children:["+",c.change_order_materials.length-5," more items"]})]})]})]}):o.jsxs(o.Fragment,{children:[c.notes&&o.jsxs("div",{className:"detail-section",children:[o.jsx("h4",{children:"Work Description"}),o.jsx("p",{children:c.notes})]}),c.t_and_m_workers?.length>0&&o.jsxs("div",{className:"detail-section",children:[o.jsx("h4",{children:"Workers"}),o.jsx("ul",{children:c.t_and_m_workers.map((Z,K)=>o.jsxs("li",{children:[Z.name,": ",Z.hours,"hrs ",Z.overtime_hours>0&&`(+${Z.overtime_hours} OT)`]},K))})]})]})})]}),o.jsxs("div",{className:"signature-status-section",children:[o.jsx("h3",{children:"Signatures Required"}),o.jsxs("div",{className:`signature-slot-card ${q?"signed":"unsigned"}`,children:[o.jsxs("div",{className:"slot-header",children:[q?o.jsx(pf,{size:20,className:"status-icon signed"}):o.jsx(Xp,{size:20,className:"status-icon pending"}),o.jsx("span",{className:"slot-label",children:"Signature 1 - GC Authorization"})]}),q?o.jsxs("div",{className:"slot-signed-info",children:[o.jsxs("div",{className:"signer-details",children:[o.jsx("span",{className:"signer-name",children:q.signer_name}),(q.signer_title||q.signer_company)&&o.jsxs("span",{className:"signer-org",children:[q.signer_title,q.signer_title&&q.signer_company&&" - ",q.signer_company]})]}),o.jsxs("span",{className:"signed-date",children:["Signed ",o0(q.signed_at)]})]}):o.jsx("button",{className:"btn btn-primary sign-btn",onClick:()=>B(1),disabled:g,children:"Sign as GC"})]}),o.jsxs("div",{className:`signature-slot-card ${L?"signed":"unsigned"}`,children:[o.jsxs("div",{className:"slot-header",children:[L?o.jsx(pf,{size:20,className:"status-icon signed"}):o.jsx(Xp,{size:20,className:"status-icon pending"}),o.jsx("span",{className:"slot-label",children:"Signature 2 - Client Authorization"})]}),L?o.jsxs("div",{className:"slot-signed-info",children:[o.jsxs("div",{className:"signer-details",children:[o.jsx("span",{className:"signer-name",children:L.signer_name}),(L.signer_title||L.signer_company)&&o.jsxs("span",{className:"signer-org",children:[L.signer_title,L.signer_title&&L.signer_company&&" - ",L.signer_company]})]}),o.jsxs("span",{className:"signed-date",children:["Signed ",o0(L.signed_at)]})]}):o.jsx("button",{className:"btn btn-primary sign-btn",onClick:()=>B(2),disabled:g,children:"Sign as Client"})]}),D&&o.jsxs("div",{className:"fully-signed-message",children:[o.jsx(pf,{size:24}),o.jsx("p",{children:"This document has been fully signed by all parties."})]})]})]}),o.jsx("footer",{className:"signature-page-footer",children:o.jsx("p",{children:"Powered by FieldSync"})}),d&&v&&o.jsx(N$,{slot:v,documentType:s.document_type,documentTitle:X.title,onSave:W,onClose:()=>{m(!1),x(null)}})]})}function k$({company:t,projects:e,userId:r,onNotificationClick:a,onShowToast:n}){const[s,l]=ee.useState([]),[c,f]=ee.useState(0),[d,m]=ee.useState(!1),[v,x]=ee.useState(!1),[g,b]=ee.useState({}),_=ee.useRef(null);ee.useRef(null);const w=ee.useRef(null);ee.useEffect(()=>{r&&E()},[r]);const E=async()=>{try{const O=await ot.getUserNotificationPreferences(r),M={};O.forEach(V=>{M[V.project_id]=V.notification_types||[]}),b(M)}catch(O){console.error("Error loading user preferences:",O)}},C=(O,M)=>g[O]?g[O].length===0?!1:g[O].includes(M):!0;ee.useEffect(()=>{if(!t?.id||!e||e.length===0)return;A();const O=T();return()=>{O&&ot.unsubscribe(O)}},[t?.id,e,g]),ee.useEffect(()=>()=>{w.current&&(w.current.close().catch(()=>{}),w.current=null)},[]),ee.useEffect(()=>{function O(M){_.current&&!_.current.contains(M.target)&&m(!1)}return document.addEventListener("mousedown",O),()=>document.removeEventListener("mousedown",O)},[]);const A=async()=>{if(!e||e.length===0)return;const O=[];for(const M of e)try{C(M.id,"message")&&(await ot.getMessages(M.id,20)).filter(X=>X.sender_type==="field"&&!X.is_read).forEach(X=>{O.push({id:`msg-${X.id}`,type:"message",title:"New Message",message:X.message?.slice(0,50)+(X.message?.length>50?"...":""),projectId:M.id,projectName:M.name,senderName:X.sender_name,createdAt:X.created_at,isRead:X.is_read,data:X})}),C(M.id,"material_request")&&(await ot.getMaterialRequests(M.id,"pending")).forEach(ie=>{O.push({id:`req-${ie.id}`,type:"material_request",title:"Material Request",message:`${ie.items?.length||0} items requested`,projectId:M.id,projectName:M.name,senderName:ie.requested_by,priority:ie.priority,createdAt:ie.created_at,isRead:!1,data:ie})})}catch(V){console.error("Error loading notifications for project:",M.id,V)}try{(await ot.getCompanyInjuryReports(t.id,"open")).slice(0,5).forEach(V=>{if(C(V.project_id,"injury_report")){const ie=e.find(X=>X.id===V.project_id);O.push({id:`injury-${V.id}`,type:"injury_report",title:"Safety Report",message:`${V.injury_type} - ${V.injured_person_name}`,projectId:V.project_id,projectName:ie?.name||"Unknown Project",senderName:V.reported_by_name,createdAt:V.created_at,isRead:V.status!=="open",data:V})}})}catch(M){console.error("Error loading injury reports:",M)}O.sort((M,V)=>new Date(V.createdAt)-new Date(M.createdAt)),l(O.slice(0,50)),f(O.filter(M=>!M.isRead).length)},T=()=>{if(!t?.id||!e||e.length===0)return null;const O=e.map(V=>V.id),M=ot.subscribeToCompanyActivity(t.id,O,{onMessage:V=>{if(V.new?.sender_type==="field"){if(!C(V.new.project_id,"message"))return;G({id:`msg-${V.new.id}`,type:"message",title:"New Message",message:V.new.message?.slice(0,50)+(V.new.message?.length>50?"...":""),projectId:V.new.project_id,projectName:e.find(ie=>ie.id===V.new.project_id)?.name||"Project",senderName:V.new.sender_name,createdAt:V.new.created_at,isRead:!1,data:V.new})}},onMaterialRequest:V=>{C(V.new.project_id,"material_request")&&G({id:`req-${V.new.id}`,type:"material_request",title:"Material Request",message:`${V.new.items?.length||0} items requested`,projectId:V.new.project_id,projectName:e.find(ie=>ie.id===V.new.project_id)?.name||"Project",senderName:V.new.requested_by,priority:V.new.priority,createdAt:V.new.created_at,isRead:!1,data:V.new})},onTMTicket:V=>{if(V.eventType==="INSERT"){if(!C(V.new.project_id,"tm_ticket"))return;G({id:`tm-${V.new.id}`,type:"tm_ticket",title:"New T&M Ticket",message:`Submitted by ${V.new.created_by_name||"Field"}`,projectId:V.new.project_id,projectName:e.find(ie=>ie.id===V.new.project_id)?.name||"Project",senderName:V.new.created_by_name,createdAt:V.new.created_at,isRead:!1,data:V.new})}},onInjuryReport:V=>{C(V.new.project_id,"injury_report")&&G({id:`injury-${V.new.id}`,type:"injury_report",title:"Safety Report",message:`${V.new.injury_type} - ${V.new.injured_person_name}`,projectId:V.new.project_id,projectName:e.find(ie=>ie.id===V.new.project_id)?.name||"Project",senderName:V.new.reported_by_name,createdAt:V.new.created_at,isRead:!1,data:V.new})}});return M&&x(!0),M},G=O=>{l(V=>[O,...V.slice(0,49)]),f(V=>V+1),W();const M=B(O.type);n?.(`${M} ${O.title}: ${O.message}`,"info")},W=()=>{try{(!w.current||w.current.state==="closed")&&(w.current=new(window.AudioContext||window.webkitAudioContext));const O=w.current;O.state==="suspended"&&O.resume();const M=O.createOscillator(),V=O.createGain();M.connect(V),V.connect(O.destination),M.frequency.value=800,M.type="sine",V.gain.value=.3,M.start(),M.stop(O.currentTime+.15),setTimeout(()=>{if(!w.current||w.current.state==="closed")return;const ie=w.current.createOscillator(),X=w.current.createGain();ie.connect(X),X.connect(w.current.destination),ie.frequency.value=1e3,ie.type="sine",X.gain.value=.3,ie.start(),ie.stop(w.current.currentTime+.15)},150)}catch{}},B=O=>{switch(O){case"message":return o.jsx(Z0,{size:16});case"material_request":return o.jsx(yc,{size:16});case"injury_report":return o.jsx(mh,{size:16});case"tm_ticket":return o.jsx(gu,{size:16});default:return o.jsx(BC,{size:16})}},q=O=>{switch(O){case"message":return"blue";case"material_request":return"orange";case"injury_report":return"red";case"tm_ticket":return"green";default:return"gray"}},L=O=>{l(M=>M.map(V=>V.id===O.id?{...V,isRead:!0}:V)),f(M=>Math.max(0,M-1)),m(!1),a?.(O)},J=async()=>{for(const O of e)try{await ot.markMessagesRead(O.id,"office")}catch{}l(O=>O.map(M=>({...M,isRead:!0}))),f(0)},D=O=>{const M=new Date(O),ie=new Date-M,X=Math.floor(ie/6e4),Z=Math.floor(ie/36e5),K=Math.floor(ie/864e5);return X<1?"Just now":X<60?`${X}m ago`:Z<24?`${Z}h ago`:K<7?`${K}d ago`:M.toLocaleDateString()};return o.jsxs("div",{className:"notification-center",ref:_,children:[o.jsxs("button",{className:`notification-bell ${c>0?"has-notifications":""}`,onClick:()=>m(!d),title:`${c} unread notifications`,children:[o.jsx("span",{className:"bell-icon",children:""}),c>0&&o.jsx("span",{className:"notification-badge",children:c>99?"99+":c}),v&&o.jsx("span",{className:"connection-dot"})]}),d&&o.jsxs("div",{className:"notification-dropdown",children:[o.jsxs("div",{className:"notification-header",children:[o.jsx("h4",{children:"Notifications"}),c>0&&o.jsx("button",{className:"mark-all-read",onClick:J,children:"Mark all read"})]}),o.jsx("div",{className:"notification-list",children:s.length===0?o.jsxs("div",{className:"notification-empty",children:[o.jsx("span",{className:"empty-icon",children:""}),o.jsx("p",{children:"No notifications yet"}),o.jsx("small",{children:"You'll see updates from the field here"})]}):s.map(O=>o.jsxs("div",{className:`notification-item ${O.isRead?"read":"unread"} ${q(O.type)}`,onClick:()=>L(O),children:[o.jsx("div",{className:"notification-icon",children:B(O.type)}),o.jsxs("div",{className:"notification-content",children:[o.jsxs("div",{className:"notification-title",children:[O.title,O.priority==="urgent"&&o.jsx("span",{className:"priority-badge urgent",children:"URGENT"})]}),o.jsx("div",{className:"notification-message",children:O.message}),o.jsxs("div",{className:"notification-meta",children:[o.jsx("span",{className:"notification-project",children:O.projectName}),o.jsx("span",{className:"notification-time",children:D(O.createdAt)})]})]}),!O.isRead&&o.jsx("div",{className:"unread-dot"})]},O.id))}),s.length>0&&o.jsx("div",{className:"notification-footer",children:o.jsx("button",{className:"view-all-btn",onClick:()=>{m(!1),a?.({type:"view_all"})},children:"View All Activity"})})]})]})}class l0 extends ee.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,r){this.setState({error:e,errorInfo:r}),console.error("ErrorBoundary caught an error:",e,r)}handleRetry=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};handleReload=()=>{window.location.reload()};render(){return this.state.hasError?o.jsx("div",{className:"error-boundary",children:o.jsxs("div",{className:"error-boundary-content",children:[o.jsx("div",{className:"error-icon",children:o.jsx(x1,{size:48})}),o.jsx("h2",{children:"Something went wrong"}),o.jsx("p",{children:"We're sorry, but something unexpected happened. Please try again."}),o.jsxs("div",{className:"error-actions",children:[o.jsx("button",{className:"btn btn-primary",onClick:this.handleRetry,children:"Try Again"}),o.jsx("button",{className:"btn btn-secondary",onClick:this.handleReload,children:"Reload Page"})]}),!1]})}):this.props.children}}function XS(){const[t,e]=ee.useState(p0()),[r,a]=ee.useState(0),[n,s]=ee.useState(!1),[l,c]=ee.useState(!1);return ee.useEffect(()=>{const f=G4(async m=>{e(m),m&&l&&(s(!0),setTimeout(()=>s(!1),3e3)),m||c(!0);const v=await sv();a(v)});sv().then(a);const d=setInterval(async()=>{if(!p0()){const m=await sv();a(m)}},5e3);return()=>{f(),clearInterval(d)}},[l]),t&&r===0&&!n?null:o.jsxs("div",{className:`offline-indicator ${t?"online":"offline"} ${n?"synced":""}`,children:[o.jsx("div",{className:"offline-indicator-content",children:t?n?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"online-icon",children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("polyline",{points:"20 6 9 17 4 12"})})}),o.jsx("span",{className:"offline-text",children:"Changes synced!"})]}):r>0?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"syncing-icon",children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("polyline",{points:"23 4 23 10 17 10"}),o.jsx("polyline",{points:"1 20 1 14 7 14"}),o.jsx("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"})]})}),o.jsxs("span",{className:"offline-text",children:["Syncing ",r,"..."]})]}):null:o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"offline-icon",children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"}),o.jsx("path",{d:"M16.72 11.06A10.94 10.94 0 0 1 19 12.55"}),o.jsx("path",{d:"M5 12.55a10.94 10.94 0 0 1 5.17-2.39"}),o.jsx("path",{d:"M10.71 5.05A16 16 0 0 1 22.58 9"}),o.jsx("path",{d:"M1.42 9a15.91 15.91 0 0 1 4.7-2.88"}),o.jsx("path",{d:"M8.53 16.11a6 6 0 0 1 6.95 0"}),o.jsx("line",{x1:"12",y1:"20",x2:"12.01",y2:"20"})]})}),o.jsxs("span",{className:"offline-text",children:["Offline",r>0&&o.jsxs("span",{className:"pending-badge",children:[r," pending"]})]})]})}),o.jsx("style",{children:`
        .offline-indicator {
          position: fixed;
          bottom: 20px;
          left: 50%;
          transform: translateX(-50%);
          z-index: 9999;
          padding: 10px 16px;
          border-radius: 24px;
          font-size: 14px;
          font-weight: 500;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
          animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
          from {
            transform: translateX(-50%) translateY(20px);
            opacity: 0;
          }
          to {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
          }
        }

        .offline-indicator.offline {
          background: #1f2937;
          color: #fbbf24;
        }

        .offline-indicator.online {
          background: #065f46;
          color: #d1fae5;
        }

        .offline-indicator.synced {
          background: #065f46;
          color: #d1fae5;
        }

        .offline-indicator-content {
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .offline-icon,
        .online-icon,
        .syncing-icon {
          display: flex;
          align-items: center;
        }

        .syncing-icon svg {
          animation: spin 1s linear infinite;
        }

        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }

        .offline-text {
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .pending-badge {
          background: rgba(251, 191, 36, 0.2);
          padding: 2px 8px;
          border-radius: 12px;
          font-size: 12px;
        }

        @media (max-width: 480px) {
          .offline-indicator {
            bottom: 70px; /* Above mobile nav */
            left: 16px;
            right: 16px;
            transform: none;
          }
        }
      `})]})}function E$(){const[t,e]=ee.useState("entry"),[r,a]=ee.useState(null),[n,s]=ee.useState(null),[l,c]=ee.useState([]),[f,d]=ee.useState([]),[m,v]=ee.useState(null),[x,g]=ee.useState(null),[b,_]=ee.useState(null),[w,E]=ee.useState(!0),[C,A]=ee.useState("dashboard"),[T,G]=ee.useState(null),[W,B]=ee.useState(!1),[q,L]=ee.useState(null);ee.useEffect(()=>{const U=window.location.pathname,j=U.match(/^\/view\/([a-zA-Z0-9]+)$/),F=U.match(/^\/sign\/([a-zA-Z0-9_]+)$/);j?(g(j[1]),e("public"),E(!1)):F?(_(F[1]),e("signature"),E(!1)):J()},[]);const J=async()=>{try{const{data:{user:U}}=await Re.auth.getUser();if(!U){E(!1);return}const{data:j,error:F}=await Re.from("users").select("*").eq("id",U.id).single();if(j){a(j);const I=await ot.getUserCompanies(U.id);c(I);const z=localStorage.getItem("selectedCompanyId");let ne=null;if(z&&I.find(se=>se.id===z))ne=I.find(se=>se.id===z);else if(I.length>0)ne=I[0];else if(j.company_id){const{data:se}=await Re.from("companies").select("*").eq("id",j.company_id).single();ne=se}if(ne){const{data:se}=await Re.from("companies").select("*").eq("id",ne.id).single();s(se),e("office")}}}catch(U){console.error("Auth check error:",U)}finally{E(!1)}},D=U=>{v(U),e("foreman")},O=async(U,j)=>{try{const{data:F,error:I}=await Re.auth.signInWithPassword({email:U,password:j});if(I){X(I.message||"Invalid credentials","error");return}const{data:z,error:ne}=await Re.from("users").select("*").eq("id",F.user.id).single();if(ne){console.error("User fetch error:",ne),X("Error loading profile","error");return}if(z){a(z);const se=await ot.getUserCompanies(F.user.id);c(se);const pe=localStorage.getItem("selectedCompanyId");let ye=null;if(pe&&se.find(_e=>_e.id===pe))ye=se.find(_e=>_e.id===pe);else if(se.length>0)ye=se[0];else if(z.company_id){const{data:_e}=await Re.from("companies").select("*").eq("id",z.company_id).single();ye=_e}if(ye){const{data:_e}=await Re.from("companies").select("*").eq("id",ye.id).single();s(_e),e("office")}else X("No company access. Please contact admin.","error")}else X("Profile not found. Please contact admin.","error")}catch(F){console.error("Login error:",F),X("Login failed","error")}},M=async U=>{try{const{data:j}=await Re.from("companies").select("*").eq("id",U).single();j&&(s(j),localStorage.setItem("selectedCompanyId",U),B(!1),A("dashboard"),X(`Switched to ${j.name}`,"success"))}catch(j){console.error("Switch company error:",j),X("Error switching company","error")}},V=async()=>{try{await RC.signOut(),a(null),s(null),c([]),e("entry"),A("dashboard"),localStorage.removeItem("selectedCompanyId")}catch(U){console.error("Logout error:",U),X("Error signing out","error")}},ie=()=>{v(null),e("entry")},X=(U,j="")=>{G({message:U,type:j})},Z=()=>{A("dashboard"),n?.id&&K()},K=async()=>{if(n?.id)try{const U=await ot.getProjects(n.id);d(U)}catch(U){console.error("Error loading projects:",U)}};ee.useEffect(()=>{n?.id&&t==="office"&&K()},[n?.id,t]);const ae=U=>{if(U.type==="view_all"){A("dashboard"),L(null);return}A("dashboard"),U.projectId&&L(U.projectId)},fe=()=>{L(null)};return w?o.jsx(Pd,{companyId:n?.id,children:o.jsxs("div",{className:"loading-screen",children:[o.jsx(Nl,{className:"loading-logo"}),o.jsx("div",{className:"spinner"})]})}):t==="entry"?o.jsxs(Pd,{children:[o.jsx(l0,{children:o.jsx(r8,{onForemanAccess:D,onOfficeLogin:O,onShowToast:X})}),T&&o.jsx(du,{message:T.message,type:T.type,onClose:()=>G(null)})]}):t==="public"&&x?o.jsxs(Pd,{children:[o.jsx(l0,{children:o.jsx(S$,{shareToken:x})}),T&&o.jsx(du,{message:T.message,type:T.type,onClose:()=>G(null)})]}):t==="signature"&&b?o.jsxs(Pd,{children:[o.jsx(l0,{children:o.jsx(j$,{signatureToken:b})}),T&&o.jsx(du,{message:T.message,type:T.type,onClose:()=>G(null)})]}):t==="foreman"&&m?o.jsxs(Pd,{companyId:m.company_id,children:[o.jsx(l0,{children:o.jsx(f8,{project:m,companyId:m.company_id,onShowToast:X,onExit:ie})}),o.jsx(XS,{}),T&&o.jsx(du,{message:T.message,type:T.type,onClose:()=>G(null)})]}):o.jsx(Pd,{companyId:n?.id,children:o.jsxs("div",{children:[!Ue&&o.jsx("div",{className:"demo-banner",children:"Demo Mode - Data saved locally in your browser"}),o.jsx("nav",{className:"nav",children:o.jsxs("div",{className:"nav-content",children:[o.jsx(Nl,{}),o.jsxs("div",{className:"nav-tabs",children:[o.jsx("button",{className:`nav-tab ${C==="dashboard"?"active":""}`,onClick:()=>A("dashboard"),children:"Dashboard"}),o.jsx("button",{className:`nav-tab ${C==="setup"?"active":""}`,onClick:()=>A("setup"),children:"+ New Project"}),o.jsx("button",{className:`nav-tab ${C==="pricing"?"active":""}`,onClick:()=>A("pricing"),children:"Pricing"}),o.jsx("button",{className:`nav-tab ${C==="branding"?"active":""}`,onClick:()=>A("branding"),children:"Branding"})]}),o.jsxs("div",{className:"nav-user",children:[o.jsx(k$,{company:n,projects:f,userId:r?.id,onNotificationClick:ae,onShowToast:X}),l.length>1&&o.jsxs("div",{className:"company-switcher",children:[o.jsxs("button",{className:"company-switcher-btn",onClick:()=>B(!W),children:[n?.name||"Select Company",o.jsx("span",{className:"switcher-arrow",children:""})]}),W&&o.jsx("div",{className:"company-dropdown",children:l.map(U=>o.jsxs("button",{className:`company-option ${U.id===n?.id?"active":""}`,onClick:()=>M(U.id),children:[U.name,U.id===n?.id&&o.jsx("span",{className:"check",children:""})]},U.id))})]}),l.length<=1&&n&&o.jsx("span",{className:"nav-company-name",children:n.name}),o.jsx("span",{className:"nav-user-name",children:r?.name||r?.email}),o.jsx("button",{className:"nav-logout",onClick:V,children:"Sign Out"})]})]})}),o.jsx(l0,{children:o.jsxs("div",{className:"container",children:[C==="dashboard"&&o.jsx(h$,{company:n,onShowToast:X,navigateToProjectId:q,onProjectNavigated:fe}),C==="setup"&&o.jsx(p$,{onProjectCreated:Z,onShowToast:X}),C==="pricing"&&o.jsx(w$,{company:n,onShowToast:X}),C==="branding"&&o.jsx(g$,{company:n,onShowToast:X})]},n?.id)}),o.jsx(XS,{}),T&&o.jsx(du,{message:T.message,type:T.type,onClose:()=>G(null)})]})})}VE.createRoot(document.getElementById("root")).render(o.jsx(IE.StrictMode,{children:o.jsx(E$,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(t=>{console.log("SW registered:",t.scope),setInterval(()=>{t.update()},6e4)}).catch(t=>{console.log("SW registration failed:",t)})});export{va as _,A$ as c,Gx as g};
