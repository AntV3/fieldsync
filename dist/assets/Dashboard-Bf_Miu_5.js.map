{"version":3,"mappings":"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","names":["_extends","n","e","t","r","ownKeys","o","_objectSpread","_defineProperty","_toPropertyKey","i","_toPrimitive","SIZE","defaultLegendContentDefaultProps","Icon","_ref","data","iconType","inactiveColor","halfSize","sixthSize","thirdSize","color","preferredIcon","_data$payload","React.createElement","React.isValidElement","iconProps","React.cloneElement","Symbols","Items","props","payload","iconSize","layout","formatter","viewBox","itemStyle","svgStyle","entry","finalFormatter","className","clsx","finalValue","adaptEventsOfChild","Surface","DefaultLegendContent","outsideProps","resolveDefaultProps","align","finalStyle","useLegendPayload","useAppSelector","selectLegendPayload","_excluded","_objectWithoutProperties","_objectWithoutPropertiesLoose","defaultUniqBy","LegendContent","contextPayload","otherProps","finalPayload","getUniqPayload","contentProps","getDefaultPosition","style","margin","chartWidth","chartHeight","box","verticalAlign","hPos","vPos","LegendSettingsDispatcher","dispatch","useAppDispatch","useEffect","setLegendSettings","LegendSizeDispatcher","setLegendSize","getWidthOrHeight","height","width","maxWidth","isNumber","legendDefaultProps","Legend","legendPortalFromContext","useLegendPortal","useMargin","widthFromProps","heightFromProps","wrapperStyle","portalFromProps","lastBoundingBox","updateBoundingBox","useElementOffset","useChartWidth","useChartHeight","widthOrHeight","outerStyle","legendPortal","legendElement","createPortal","renderLine","option","line","isWellBehavedNumber","getHorizontalLineEndPoints","yCoord","ifOverflow","position","yAxisOrientation","scales","x","coord","isNan","points","getVerticalLineEndPoints","xCoord","xAxisOrientation","y","getSegmentLineEndPoints","segment","p","getEndPoints","isFixedX","isNumOrStr","isFixedY","ReportReferenceLine","addLine","removeLine","ReferenceLineImpl","xAxisId","yAxisId","shape","isPanorama","useIsPanorama","clipPathId","useClipPathId","xAxis","state","selectXAxisSettings","yAxis","selectYAxisSettings","xAxisScale","selectAxisScale","yAxisScale","useViewBox","createLabeledScales","endPoints","x1","y1","x2","y2","clipPath","lineProps","svgPropertiesAndEvents","rect","rectWithCoords","ZIndexLayer","Layer","CartesianLabelContextProvider","CartesianLabelFromLabelProp","referenceLineDefaultProps","DefaultZIndexes","ReferenceLine","React.Fragment","selectXAxisWithScale","graphicalItemId","selectAxisWithScale","selectXAxisIdFromGraphicalItemId","selectXAxisTicks","selectTicksOfGraphicalItem","selectYAxisWithScale","selectYAxisIdFromGraphicalItemId","selectYAxisTicks","selectBandSize","createSelector","selectChartLayout","xAxisTicks","yAxisTicks","isCategoricalAxis","getBandSizeOfAxis","pickAreaId","_state","id","selectSynchronisedAreaSettings","selectUnfilteredCartesianItems","graphicalItems","item","selectNumericalAxisType","isXAxisCategorical","selectNumericalAxisIdFromGraphicalItemId","axisType","selectNumericalAxisStackGroups","selectStackGroups","selectGraphicalItemStackedData","areaSettings","stackGroups","_stackGroups$stackId","stackId","stackSeriesIdentifier","getStackSeriesIdentifier","groups","found","v","selectArea","selectChartDataWithIndexesIfNotInPanoramaPosition3","selectChartBaseValue","stackedData","bandSize","chartBaseValue","chartData","dataStartIndex","dataEndIndex","displayedData","computeArea","_excluded2","getLegendItemColor","stroke","fill","computeLegendPayloadFromAreaData","dataKey","name","legendType","hide","getTooltipNameProp","SetAreaTooltipEntrySettings","React.memo","strokeWidth","unit","tooltipType","tooltipEntrySettings","SetTooltipEntrySettings","AreaDotsWrapper","_ref2","needClip","dot","areaProps","svgPropertiesNoEvents","Dots","AreaLabelListProvider","_ref3","showLabels","children","labelListEntries","point","_point$x","_point$y","CartesianLabelListContextProvider","StaticArea","_ref4","baseLine","type","connectNulls","isRange","propsWithoutId","allOtherProps","propsWithEvents","Curve","VerticalRect","_ref5","_points$","_points","alpha","startY","endY","maxX","HorizontalRect","_ref6","_points$2","_points2","startX","endX","maxY","ClipRect","_ref7","AreaWithAnimation","_ref8","previousPointsRef","previousBaselineRef","isAnimationActive","animationBegin","animationDuration","animationEasing","onAnimationStart","onAnimationEnd","animationInput","useMemo","animationId","useAnimationId","useCartesianChartLayout","isAnimating","setIsAnimating","useState","handleAnimationEnd","useCallback","handleAnimationStart","prevPoints","prevBaseLine","JavascriptAnimate","prevPointsDiffFactor","stepPoints","index","prevPointIndex","prev","interpolate","stepBaseLine","isNullish","LabelListFromLabelProp","RenderArea","_ref9","useRef","AreaWithState","PureComponent","top","left","zIndex","layerClass","getRadiusAndStrokeWidthFromDot","clipDot","isClipDot","dotSize","activePointsClipPath","GraphicalItemClipPath","ActivePoints","defaultAreaProps","AreaImpl","_useAppSelector","_resolveDefaultProps","activeDot","fillOpacity","everythingElse","useChartLayout","chartName","useChartName","useNeedsClip","plotArea","usePlotArea","Global","getBaseValue","itemBaseValue","baseValue","numericAxis","domain","domainMax","domainMin","_ref0","hasStack","isHorizontalLayout","_valueAsArray$","_valueAsArray","valueAsArray","rawValue","getValueByDataKey","value1","isBreakPoint","getCateCoordinateOfLine","AreaFn","RegisterGraphicalItemId","SetLegendPayload","SetCartesianGraphicalItem","getNormalizedStackId","Area","propsAreEqual","allowedTooltipTypes","AreaChart","forwardRef","ref","CartesianChart","arrayTooltipSearcher","ErrorSeverity","ErrorCategory","categorizeError","error","message","code","getUserMessage","category","context","handleError","options","operation","severity","showToast","userMessage","companyId","projectId","userId","silent","rethrow","observe","toastType","safeAsync","fn","fallback","DEFAULT_THRESHOLDS","FACTOR_WEIGHTS","calculateFactorScore","value","thresholds","range","getFactorStatus","score","calculateBudgetFactor","totalCosts","earnedRevenue","ratio","status","label","calculateScheduleFactor","actualProgress","expectedProgress","variance","absVariance","calculateCORExposureFactor","pendingCORValue","contractValue","exposure","formatNumber","calculateActivityFactor","lastReportDate","lastDate","daysSince","calculateSafetyFactor","injuryCount","count","calculateRiskScore","project","weights","budgetFactor","scheduleFactor","corFactor","activityFactor","safetyFactor","compositeScore","overallStatus","summaryLabel","generateSmartAlerts","riskResult","alerts","factors","priorityOrder","a","b","calculateProjections","costPerPercent","estimatedCompletionCost","estimatedFinalMargin","estimatedCompletionDate","startDate","now","daysElapsed","progressPerDay","daysRemaining","num","UniversalSearch","isOpen","onClose","onSelectProject","onSelectTicket","onSelectCOR","onShowToast","query","setQuery","results","setResults","loading","setLoading","selectedIndex","setSelectedIndex","inputRef","searchTimeoutRef","focusTimeoutRef","performSearch","searchQuery","searchResults","db","handleInputChange","allResults","all","c","w","hasResults","handleKeyDown","handleSelect","jsx","jsxs","Search","X","Fragment","FolderOpen","idx","globalIdx","ChevronRight","FileText","ticket","ClipboardList","cor","Users","worker","Command","useUniversalSearch","setIsOpen","SmartAlerts","onAction","onDismiss","maxVisible","dismissedIds","setDismissedIds","visibleAlerts","alert","handleDismiss","alertId","SmartAlertCard","title","description","action","actionTarget","projectName","XCircle","AlertTriangle","Info","handleAction","ArrowRight","ManDayCosts","company","costData","setCostData","expanded","setExpanded","loadCostData","subscription","formatCurrency","amount","formatDate","dateStr","getRoleLabel","role","HardHat","roleEntries","day","ProgressBillingCard","memo","areas","corStats","onCreateDraw","onViewDraw","drawRequests","setDrawRequests","originalContract","sum","area","approvedCOs","revisedContract","loadDrawRequests","drawRequestOps","billingTotals","completedDraws","dr","billedToDate","retentionHeld","progress","nextDrawNumber","getStatusBadge","FileSpreadsheet","Plus","ProjectEquipmentCard","onAddEquipment","onEditEquipment","projectEquipment","setProjectEquipment","totalCost","setTotalCost","loadEquipment","equipmentOps","cost","handleMarkReturned","equipmentItem","handleDelete","activeEquipment","returnedEquipment","Truck","ChevronUp","ChevronDown","days","Calendar","RotateCcw","Edit2","Trash2","BurnRateCard","dailyBurn","totalBurn","daysWorked","laborCost","materialsEquipmentCost","laborByDate","materialsEquipmentByDate","expectedBurnAtProgress","burnStatus","statusLabel","StatusIcon","TrendingDown","Minus","TrendingUp","projectedTotalCost","combinedByDate","dateMap","d","maxDailyCost","Flame","chartColors","animationConfig","costCategories","timeRanges","formatChartCurrency","formatChartDate","gradientDefs","buildFinancialTimeSeries","projectData","tmTickets","haulOffByDate","customCosts","dateSet","sortedDates","revenueByDate","totalWeight","completionDate","areaWeight","areaValue","cumulativeCost","cumulativeTMValue","tmByDate","date","ticketValue","workers","regHours","otHours","regRate","otRate","items","qty","unitCost","customByDate","materialsEquipmentByDateMap","cumulativeRevenue","haulOffCost","customCost","dailyTotalCost","tmDayValue","dailyRevenue","revenue","filterByTimeRange","cutoff","buildCostDistribution","segments","grouped","cat","catConfig","total","s","calculateTrend","key","recent","first","last","change","ChartTooltip","active","FinancialTrendChart","onDrillDown","timeRange","setTimeRange","hoveredLine","setHoveredLine","allData","selectedRange","costsTrend","revenueTrend","handleClick","TrendIcon","trend","ResponsiveContainer","grad","CartesianGrid","XAxis","YAxis","Tooltip","CostDonut","onSegmentClick","activeIndex","setActiveIndex","handleMouseEnter","_","handleMouseLeave","CustomTooltip","renderLegend","PieChart","Pie","Cell","categoryInfo","Wrench","Package","MoreHorizontal","CostContributorsCard","onAddCost","onDeleteCost","showChart","setShowChart","expandedCategory","setExpandedCategory","costBreakdown","customByCategory","group","info","toggleCategory","handleSegmentClick","hasItems","isExpanded","ProfitabilityCard","currentProfit","currentMargin","projectedRevenue","projectedCosts","projectedProfit","projectedMargin","isHealthy","isWarning","isLoss","CheckCircle","AlertCircle","LOAD_TYPES","getLoadTypeInfo","DisposalSummary","period","loads","setLoads","loadData","err","loadsByType","acc","load","loadsByDate","totalLoads","l","hasLoads","percentage","formattedDate","dayLoadsByType","typeInfo","PROJECT_ROLE_OPTIONS","ProjectTeam","user","isAdmin","teamMembers","setTeamMembers","companyMembers","setCompanyMembers","showAddModal","setShowAddModal","selectedUser","setSelectedUser","selectedRole","setSelectedRole","actionLoading","setActionLoading","loadProjectTeam","loadCompanyMembers","existingUserIds","tm","available","m","handleAddMember","handleUpdateRole","member","newRole","handleRemoveMember","UserPlus","UserMinus","Skeleton","borderRadius","variant","variantStyles","showProgress","CardSkeleton","lines","showHeader","showAction","showAvatar","h","TicketSkeleton","HeroMetricsSkeleton","ErrorState","onRetry","retryLabel","CustomIcon","WifiOff","RefreshCw","EmptyState","actionLabel","required","hint","onChange","onBlur","placeholder","disabled","min","max","step","pattern","autoComplete","ariaLabel","ariaDescribedBy","inputId","errorId","selectId","rows","maxLength","textareaId","CountBadge","size","pulse","prevCount","setPrevCount","animating","setAnimating","timer","MiniProgress","showLabel","animated","autoVariant","TrendIndicator","previousValue","format","inverted","showValue","diff","percentChange","direction","formatValue","absChange","showArea","areaPoints","icons","Check","Clock","current","previous","delta","isPositive","isNegative","val","radius","circumference","offset","showCloseButton","closeOnOverlayClick","closeOnEscape","footer","modalRef","previousActiveElement","titleId","originalOverflow","focusableElements","firstElement","lastElement","handleOverlayClick","sizeClasses","MetricCard","formattedValue","subLabel","progressLabel","variantColors","HeroMetrics","profit","corApprovedValue","previousData","profitMargin","costRatio","revenueProgress","costProgress","profitVariant","costVariant","DollarSign","Receipt","PiggyBank","NAV_ITEMS","BarChart3","FinancialsNav","activeSection","onSectionChange","collapsed","onToggleCollapse","onMobileClose","stats","corCount","ticketCount","corPending","ticketPending","billableCount","invoiceCount","getBadge","itemId","PanelLeftOpen","ChevronLeft","isActive","badge","showConnector","OverviewProgressGauge","areasComplete","totalAreas","areasWorking","animatedProgress","setAnimatedProgress","animationRef","startValue","endValue","duration","startTime","animate","currentTime","elapsed","progressRatio","eased","getProgressColor","OverviewFinancialCard","disposalCost","equipmentCost","materialsCost","otherCost","hasBreakdown","widthPercent","TMList","lazy","__vitePreload","ShareModal","InjuryReportsList","NotificationSettings","DailyReportsList","CORList","CORForm","CORDetail","CORLogPreview","CORLog","BillingCenter","DrawRequestModal","EquipmentModal","AddCostModal","DocumentsTab","Dashboard","navigateToProjectId","onProjectNavigated","projects","setProjects","projectsData","setProjectsData","selectedProject","setSelectedProject","setAreas","editMode","setEditMode","editData","setEditData","saving","setSaving","showShareModal","setShowShareModal","showNotificationSettings","setShowNotificationSettings","activeProjectTab","setActiveProjectTab","financialsSection","setFinancialsSection","financialsSidebarCollapsed","setFinancialsSidebarCollapsed","financialsSidebarMobileOpen","setFinancialsSidebarMobileOpen","corListExpanded","setCORListExpanded","corDisplayMode","setCORDisplayMode","tmViewMode","setTMViewMode","dumpSites","setDumpSites","showCORForm","setShowCORForm","editingCOR","setEditingCOR","showCORDetail","setShowCORDetail","viewingCOR","setViewingCOR","corRefreshKey","setCORRefreshKey","showAddCostModal","setShowAddCostModal","savingCost","setSavingCost","showEquipmentModal","setShowEquipmentModal","editingEquipment","setEditingEquipment","equipmentRefreshKey","setEquipmentRefreshKey","showDrawRequestModal","setShowDrawRequestModal","editingDrawRequest","setEditingDrawRequest","drawRequestRefreshKey","setDrawRequestRefreshKey","isSearchOpen","setSearchOpen","closeSearch","refreshTimeoutRef","pendingAreasRefreshRef","pendingCORRefreshRef","projectDetailsCacheRef","CACHE_TTL_MS","debouncedRefresh","refreshAreas","refreshCOR","loadAreas","loadProjects","loadDumpSites","projectIdsRef","projectIdsKey","currentIds","sites","lastNavigatedIdRef","subscriptions","areasSub","dailyReportsSub","checkinsSub","haulOffsSub","corsSub","sub","loadProjectDetails","forceRefresh","cacheKey","cached","projectAreas","tickets","changeOrderData","dailyReports","injuryReports","laborCosts","haulOffCosts","progressData","calculateValueProgress","changeOrderValue","revisedContractValue","billable","pendingTickets","oneWeekAgo","recentDailyReports","customCostTotal","ticketDate","ticketMaterialsCost","materialsEquipmentByDateArray","allCostsTotal","laborDays","materialsDays","totalBurnDays","scheduleInsights","calculateScheduleInsights","enhancedData","enhanced","completedAreas","handleSelectProject","detailedProject","handleBack","handleEditClick","handleCancelEdit","handleEditChange","field","handleAreaEditChange","handleAddArea","handleRemoveArea","handleSaveEdit","contractVal","validAreas","existingAreaIds","editAreaIds","areaId","updatedProject","handleDeleteProject","progressCalculations","portfolioMetrics","totalOriginalContract","totalChangeOrders","totalPortfolioValue","totalEarned","totalRemaining","weightedCompletion","totalPendingCORValue","totalPendingCORCount","projectHealth","complete","onTrack","atRisk","overBudget","withChangeOrders","scheduleMetrics","ahead","behind","overLabor","underLabor","onTrackLabor","riskAnalysis","projectRisks","riskInput","projections","alertsWithProject","allAlerts","priority","handleAlertAction","target","checkAutoArchive","shouldAutoArchive","handleAddEquipment","handleEditEquipment","handleCreateDraw","handleViewDraw","drawRequest","handleViewAllTickets","handleToggleFinancialsSidebar","handleToggleMobileSidebar","handleCloseMobileSidebar","handleToggleCORList","handleBackToTMPreview","handleViewFullCORLog","handleCreateCOR","handleViewCOR","handleEditCOR","handleAddCost","handleDeleteCost","costId","financialsNavStats","projectsComplete","projectsOnTrack","projectsAtRisk","projectsOverBudget","projectsWithChangeOrders","scheduleAhead","scheduleOnTrack","scheduleBehind","laborOver","laborUnder","laborOnTrack","hasAnyScheduleData","hasAnyLaborData","isValueBased","earnedValue","totalSOVValue","site","areasNotStarted","pendingCount","tabs","LayoutGrid","tab","Menu","section","Suspense","MapPin","Building2","Phone","share","projectRisk","EnhancedProjectCard","riskScore","riskStatus","onClick","getOverallStatus","getOverallStatusLabel","isAtRisk","riskColors","riskStyle"],"ignoreList":[0,1,2,3,4,5,6],"sources":["../../node_modules/recharts/es6/component/DefaultLegendContent.js","../../node_modules/recharts/es6/context/legendPayloadContext.js","../../node_modules/recharts/es6/component/Legend.js","../../node_modules/recharts/es6/cartesian/ReferenceLine.js","../../node_modules/recharts/es6/state/selectors/areaSelectors.js","../../node_modules/recharts/es6/cartesian/Area.js","../../node_modules/recharts/es6/chart/AreaChart.js","../../src/lib/errorHandler.js","../../src/lib/riskCalculations.js","../../src/components/UniversalSearch.jsx","../../src/components/dashboard/SmartAlerts.jsx","../../src/components/ManDayCosts.jsx","../../src/components/billing/ProgressBillingCard.jsx","../../src/components/equipment/ProjectEquipmentCard.jsx","../../src/components/BurnRateCard.jsx","../../src/components/charts/chartConfig.js","../../src/lib/chartDataTransforms.js","../../src/components/charts/ChartTooltip.jsx","../../src/components/charts/FinancialTrendChart.jsx","../../src/components/charts/CostDonut.jsx","../../src/components/CostContributorsCard.jsx","../../src/components/ProfitabilityCard.jsx","../../src/components/DisposalSummary.jsx","../../src/components/ProjectTeam.jsx","../../src/components/ui/Skeleton.jsx","../../src/components/ui/ErrorState.jsx","../../src/components/ui/FormField.jsx","../../src/components/ui/MicroVis.jsx","../../src/components/ui/Modal.jsx","../../src/components/HeroMetrics.jsx","../../src/components/FinancialsNav.jsx","../../src/components/overview/OverviewProgressGauge.jsx","../../src/components/overview/OverviewFinancialCard.jsx","../../src/components/Dashboard.jsx"],"sourcesContent":["function _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n/**\n * @fileOverview Default Legend Content\n */\nimport * as React from 'react';\nimport { clsx } from 'clsx';\nimport { Surface } from '../container/Surface';\nimport { Symbols } from '../shape/Symbols';\nimport { adaptEventsOfChild } from '../util/types';\nimport { resolveDefaultProps } from '../util/resolveDefaultProps';\nvar SIZE = 32;\nvar defaultLegendContentDefaultProps = {\n  align: 'center',\n  iconSize: 14,\n  inactiveColor: '#ccc',\n  layout: 'horizontal',\n  verticalAlign: 'middle'\n};\nfunction Icon(_ref) {\n  var {\n    data,\n    iconType,\n    inactiveColor\n  } = _ref;\n  var halfSize = SIZE / 2;\n  var sixthSize = SIZE / 6;\n  var thirdSize = SIZE / 3;\n  var color = data.inactive ? inactiveColor : data.color;\n  var preferredIcon = iconType !== null && iconType !== void 0 ? iconType : data.type;\n  if (preferredIcon === 'none') {\n    return null;\n  }\n  if (preferredIcon === 'plainline') {\n    var _data$payload;\n    return /*#__PURE__*/React.createElement(\"line\", {\n      strokeWidth: 4,\n      fill: \"none\",\n      stroke: color,\n      strokeDasharray: (_data$payload = data.payload) === null || _data$payload === void 0 ? void 0 : _data$payload.strokeDasharray,\n      x1: 0,\n      y1: halfSize,\n      x2: SIZE,\n      y2: halfSize,\n      className: \"recharts-legend-icon\"\n    });\n  }\n  if (preferredIcon === 'line') {\n    return /*#__PURE__*/React.createElement(\"path\", {\n      strokeWidth: 4,\n      fill: \"none\",\n      stroke: color,\n      d: \"M0,\".concat(halfSize, \"h\").concat(thirdSize, \"\\n            A\").concat(sixthSize, \",\").concat(sixthSize, \",0,1,1,\").concat(2 * thirdSize, \",\").concat(halfSize, \"\\n            H\").concat(SIZE, \"M\").concat(2 * thirdSize, \",\").concat(halfSize, \"\\n            A\").concat(sixthSize, \",\").concat(sixthSize, \",0,1,1,\").concat(thirdSize, \",\").concat(halfSize),\n      className: \"recharts-legend-icon\"\n    });\n  }\n  if (preferredIcon === 'rect') {\n    return /*#__PURE__*/React.createElement(\"path\", {\n      stroke: \"none\",\n      fill: color,\n      d: \"M0,\".concat(SIZE / 8, \"h\").concat(SIZE, \"v\").concat(SIZE * 3 / 4, \"h\").concat(-SIZE, \"z\"),\n      className: \"recharts-legend-icon\"\n    });\n  }\n  if (/*#__PURE__*/React.isValidElement(data.legendIcon)) {\n    var iconProps = _objectSpread({}, data);\n    delete iconProps.legendIcon;\n    return /*#__PURE__*/React.cloneElement(data.legendIcon, iconProps);\n  }\n  return /*#__PURE__*/React.createElement(Symbols, {\n    fill: color,\n    cx: halfSize,\n    cy: halfSize,\n    size: SIZE,\n    sizeType: \"diameter\",\n    type: preferredIcon\n  });\n}\nfunction Items(props) {\n  var {\n    payload,\n    iconSize,\n    layout,\n    formatter,\n    inactiveColor,\n    iconType\n  } = props;\n  var viewBox = {\n    x: 0,\n    y: 0,\n    width: SIZE,\n    height: SIZE\n  };\n  var itemStyle = {\n    display: layout === 'horizontal' ? 'inline-block' : 'block',\n    marginRight: 10\n  };\n  var svgStyle = {\n    display: 'inline-block',\n    verticalAlign: 'middle',\n    marginRight: 4\n  };\n  return payload.map((entry, i) => {\n    var finalFormatter = entry.formatter || formatter;\n    var className = clsx({\n      'recharts-legend-item': true,\n      [\"legend-item-\".concat(i)]: true,\n      inactive: entry.inactive\n    });\n    if (entry.type === 'none') {\n      return null;\n    }\n    var color = entry.inactive ? inactiveColor : entry.color;\n    var finalValue = finalFormatter ? finalFormatter(entry.value, entry, i) : entry.value;\n    return /*#__PURE__*/React.createElement(\"li\", _extends({\n      className: className,\n      style: itemStyle,\n      key: \"legend-item-\".concat(i)\n    }, adaptEventsOfChild(props, entry, i)), /*#__PURE__*/React.createElement(Surface, {\n      width: iconSize,\n      height: iconSize,\n      viewBox: viewBox,\n      style: svgStyle,\n      \"aria-label\": \"\".concat(finalValue, \" legend icon\")\n    }, /*#__PURE__*/React.createElement(Icon, {\n      data: entry,\n      iconType: iconType,\n      inactiveColor: inactiveColor\n    })), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"recharts-legend-item-text\",\n      style: {\n        color\n      }\n    }, finalValue));\n  });\n}\nexport var DefaultLegendContent = outsideProps => {\n  var props = resolveDefaultProps(outsideProps, defaultLegendContentDefaultProps);\n  var {\n    payload,\n    layout,\n    align\n  } = props;\n  if (!payload || !payload.length) {\n    return null;\n  }\n  var finalStyle = {\n    padding: 0,\n    margin: 0,\n    textAlign: layout === 'horizontal' ? align : 'left'\n  };\n  return /*#__PURE__*/React.createElement(\"ul\", {\n    className: \"recharts-default-legend\",\n    style: finalStyle\n  }, /*#__PURE__*/React.createElement(Items, _extends({}, props, {\n    payload: payload\n  })));\n};","import { useAppSelector } from '../state/hooks';\nimport { selectLegendPayload } from '../state/selectors/legendSelectors';\n\n/**\n * Use this hook in Legend, or anywhere else where you want to read the current Legend items.\n * @return all Legend items ready to be rendered\n */\nexport function useLegendPayload() {\n  return useAppSelector(selectLegendPayload);\n}","var _excluded = [\"contextPayload\"];\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _objectWithoutProperties(e, t) { if (null == e) return {}; var o, r, i = _objectWithoutPropertiesLoose(e, t); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(e); for (r = 0; r < n.length; r++) o = n[r], -1 === t.indexOf(o) && {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]); } return i; }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (-1 !== e.indexOf(n)) continue; t[n] = r[n]; } return t; }\nimport * as React from 'react';\nimport { useEffect } from 'react';\nimport { createPortal } from 'react-dom';\nimport { useLegendPortal } from '../context/legendPortalContext';\nimport { DefaultLegendContent } from './DefaultLegendContent';\nimport { isNumber } from '../util/DataUtils';\nimport { getUniqPayload } from '../util/payload/getUniqPayload';\nimport { useLegendPayload } from '../context/legendPayloadContext';\nimport { useElementOffset } from '../util/useElementOffset';\nimport { useChartHeight, useChartWidth, useMargin } from '../context/chartLayoutContext';\nimport { setLegendSettings, setLegendSize } from '../state/legendSlice';\nimport { useAppDispatch } from '../state/hooks';\nimport { resolveDefaultProps } from '../util/resolveDefaultProps';\nfunction defaultUniqBy(entry) {\n  return entry.value;\n}\nfunction LegendContent(props) {\n  var {\n      contextPayload\n    } = props,\n    otherProps = _objectWithoutProperties(props, _excluded);\n  var finalPayload = getUniqPayload(contextPayload, props.payloadUniqBy, defaultUniqBy);\n  var contentProps = _objectSpread(_objectSpread({}, otherProps), {}, {\n    payload: finalPayload\n  });\n  if (/*#__PURE__*/React.isValidElement(props.content)) {\n    return /*#__PURE__*/React.cloneElement(props.content, contentProps);\n  }\n  if (typeof props.content === 'function') {\n    return /*#__PURE__*/React.createElement(props.content, contentProps);\n  }\n  return /*#__PURE__*/React.createElement(DefaultLegendContent, contentProps);\n}\nfunction getDefaultPosition(style, props, margin, chartWidth, chartHeight, box) {\n  var {\n    layout,\n    align,\n    verticalAlign\n  } = props;\n  var hPos, vPos;\n  if (!style || (style.left === undefined || style.left === null) && (style.right === undefined || style.right === null)) {\n    if (align === 'center' && layout === 'vertical') {\n      hPos = {\n        left: ((chartWidth || 0) - box.width) / 2\n      };\n    } else {\n      hPos = align === 'right' ? {\n        right: margin && margin.right || 0\n      } : {\n        left: margin && margin.left || 0\n      };\n    }\n  }\n  if (!style || (style.top === undefined || style.top === null) && (style.bottom === undefined || style.bottom === null)) {\n    if (verticalAlign === 'middle') {\n      vPos = {\n        top: ((chartHeight || 0) - box.height) / 2\n      };\n    } else {\n      vPos = verticalAlign === 'bottom' ? {\n        bottom: margin && margin.bottom || 0\n      } : {\n        top: margin && margin.top || 0\n      };\n    }\n  }\n  return _objectSpread(_objectSpread({}, hPos), vPos);\n}\nfunction LegendSettingsDispatcher(props) {\n  var dispatch = useAppDispatch();\n  useEffect(() => {\n    dispatch(setLegendSettings(props));\n  }, [dispatch, props]);\n  return null;\n}\nfunction LegendSizeDispatcher(props) {\n  var dispatch = useAppDispatch();\n  useEffect(() => {\n    dispatch(setLegendSize(props));\n    return () => {\n      dispatch(setLegendSize({\n        width: 0,\n        height: 0\n      }));\n    };\n  }, [dispatch, props]);\n  return null;\n}\nfunction getWidthOrHeight(layout, height, width, maxWidth) {\n  if (layout === 'vertical' && isNumber(height)) {\n    return {\n      height\n    };\n  }\n  if (layout === 'horizontal') {\n    return {\n      width: width || maxWidth\n    };\n  }\n  return null;\n}\nexport var legendDefaultProps = {\n  align: 'center',\n  iconSize: 14,\n  itemSorter: 'value',\n  layout: 'horizontal',\n  verticalAlign: 'bottom'\n};\nexport function Legend(outsideProps) {\n  var props = resolveDefaultProps(outsideProps, legendDefaultProps);\n  var contextPayload = useLegendPayload();\n  var legendPortalFromContext = useLegendPortal();\n  var margin = useMargin();\n  var {\n    width: widthFromProps,\n    height: heightFromProps,\n    wrapperStyle,\n    portal: portalFromProps\n  } = props;\n  // The contextPayload is not used directly inside the hook, but we need the onBBoxUpdate call\n  // when the payload changes, therefore it's here as a dependency.\n  var [lastBoundingBox, updateBoundingBox] = useElementOffset([contextPayload]);\n  var chartWidth = useChartWidth();\n  var chartHeight = useChartHeight();\n  if (chartWidth == null || chartHeight == null) {\n    return null;\n  }\n  var maxWidth = chartWidth - ((margin === null || margin === void 0 ? void 0 : margin.left) || 0) - ((margin === null || margin === void 0 ? void 0 : margin.right) || 0);\n  var widthOrHeight = getWidthOrHeight(props.layout, heightFromProps, widthFromProps, maxWidth);\n  // if the user supplies their own portal, only use their defined wrapper styles\n  var outerStyle = portalFromProps ? wrapperStyle : _objectSpread(_objectSpread({\n    position: 'absolute',\n    width: (widthOrHeight === null || widthOrHeight === void 0 ? void 0 : widthOrHeight.width) || widthFromProps || 'auto',\n    height: (widthOrHeight === null || widthOrHeight === void 0 ? void 0 : widthOrHeight.height) || heightFromProps || 'auto'\n  }, getDefaultPosition(wrapperStyle, props, margin, chartWidth, chartHeight, lastBoundingBox)), wrapperStyle);\n  var legendPortal = portalFromProps !== null && portalFromProps !== void 0 ? portalFromProps : legendPortalFromContext;\n  if (legendPortal == null || contextPayload == null) {\n    return null;\n  }\n  var legendElement = /*#__PURE__*/React.createElement(\"div\", {\n    className: \"recharts-legend-wrapper\",\n    style: outerStyle,\n    ref: updateBoundingBox\n  }, /*#__PURE__*/React.createElement(LegendSettingsDispatcher, {\n    layout: props.layout,\n    align: props.align,\n    verticalAlign: props.verticalAlign,\n    itemSorter: props.itemSorter\n  }), !portalFromProps && /*#__PURE__*/React.createElement(LegendSizeDispatcher, {\n    width: lastBoundingBox.width,\n    height: lastBoundingBox.height\n  }), /*#__PURE__*/React.createElement(LegendContent, _extends({}, props, widthOrHeight, {\n    margin: margin,\n    chartWidth: chartWidth,\n    chartHeight: chartHeight,\n    contextPayload: contextPayload\n  })));\n  return /*#__PURE__*/createPortal(legendElement, legendPortal);\n}\nLegend.displayName = 'Legend';","function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\n/**\n * @fileOverview Reference Line\n */\nimport * as React from 'react';\nimport { useEffect } from 'react';\nimport { clsx } from 'clsx';\nimport { Layer } from '../container/Layer';\nimport { CartesianLabelContextProvider, CartesianLabelFromLabelProp } from '../component/Label';\nimport { isNan, isNumOrStr } from '../util/DataUtils';\nimport { createLabeledScales, rectWithCoords } from '../util/CartesianUtils';\nimport { useViewBox } from '../context/chartLayoutContext';\nimport { addLine, removeLine } from '../state/referenceElementsSlice';\nimport { useAppDispatch, useAppSelector } from '../state/hooks';\nimport { selectAxisScale, selectXAxisSettings, selectYAxisSettings } from '../state/selectors/axisSelectors';\nimport { useIsPanorama } from '../context/PanoramaContext';\nimport { useClipPathId } from '../container/ClipPathProvider';\nimport { svgPropertiesAndEvents } from '../util/svgPropertiesAndEvents';\nimport { resolveDefaultProps } from '../util/resolveDefaultProps';\nimport { ZIndexLayer } from '../zIndex/ZIndexLayer';\nimport { DefaultZIndexes } from '../zIndex/DefaultZIndexes';\nimport { isWellBehavedNumber } from '../util/isWellBehavedNumber';\n\n/**\n * Single point that defines one end of a segment.\n * These coordinates are in data space, meaning that you should provide\n * values that correspond to the data domain of the axes.\n * So you would provide a value of `Page A` to indicate the data value `Page A`\n * and then recharts will convert that to pixels.\n *\n * Likewise for numbers. If your x-axis goes from 0 to 100,\n * and you want the line to end at 50, you would provide `50` here.\n */\n\n/**\n * This excludes `viewBox` prop from svg for two reasons:\n * 1. The components wants viewBox of object type, and svg wants string\n *    - so there's a conflict, and the component will throw if it gets string\n * 2. Internally the component calls `svgPropertiesNoEvents` which filters the viewBox away anyway\n */\n\nvar renderLine = (option, props) => {\n  var line;\n  if (/*#__PURE__*/React.isValidElement(option)) {\n    // @ts-expect-error element cloning is not typed\n    line = /*#__PURE__*/React.cloneElement(option, props);\n  } else if (typeof option === 'function') {\n    line = option(props);\n  } else {\n    if (!isWellBehavedNumber(props.x1) || !isWellBehavedNumber(props.y1) || !isWellBehavedNumber(props.x2) || !isWellBehavedNumber(props.y2)) {\n      return null;\n    }\n    line = /*#__PURE__*/React.createElement(\"line\", _extends({}, props, {\n      className: \"recharts-reference-line-line\"\n    }));\n  }\n  return line;\n};\nvar getHorizontalLineEndPoints = (yCoord, ifOverflow, position, yAxisOrientation, scales, viewBox) => {\n  var {\n    x,\n    width\n  } = viewBox;\n  var coord = scales.y.apply(yCoord, {\n    position\n  });\n  // don't render the line if the scale can't compute a result that makes sense\n  if (isNan(coord)) return null;\n  if (ifOverflow === 'discard' && !scales.y.isInRange(coord)) {\n    return null;\n  }\n  var points = [{\n    x: x + width,\n    y: coord\n  }, {\n    x,\n    y: coord\n  }];\n  return yAxisOrientation === 'left' ? points.reverse() : points;\n};\nvar getVerticalLineEndPoints = (xCoord, ifOverflow, position, xAxisOrientation, scales, viewBox) => {\n  var {\n    y,\n    height\n  } = viewBox;\n  var coord = scales.x.apply(xCoord, {\n    position\n  });\n  // don't render the line if the scale can't compute a result that makes sense\n  if (isNan(coord)) return null;\n  if (ifOverflow === 'discard' && !scales.x.isInRange(coord)) {\n    return null;\n  }\n  var points = [{\n    x: coord,\n    y: y + height\n  }, {\n    x: coord,\n    y\n  }];\n  return xAxisOrientation === 'top' ? points.reverse() : points;\n};\nvar getSegmentLineEndPoints = (segment, ifOverflow, position, scales) => {\n  var points = segment.map(p => scales.apply(p, {\n    position\n  }));\n  if (ifOverflow === 'discard' && points.some(p => !scales.isInRange(p))) {\n    return null;\n  }\n  return points;\n};\nexport var getEndPoints = (scales, viewBox, position, xAxisOrientation, yAxisOrientation, props) => {\n  var {\n    x: xCoord,\n    y: yCoord,\n    segment,\n    ifOverflow\n  } = props;\n  var isFixedX = isNumOrStr(xCoord);\n  var isFixedY = isNumOrStr(yCoord);\n  if (isFixedY) {\n    return getHorizontalLineEndPoints(yCoord, ifOverflow, position, yAxisOrientation, scales, viewBox);\n  }\n  if (isFixedX) {\n    return getVerticalLineEndPoints(xCoord, ifOverflow, position, xAxisOrientation, scales, viewBox);\n  }\n  if (segment != null && segment.length === 2) {\n    return getSegmentLineEndPoints(segment, ifOverflow, position, scales);\n  }\n  return null;\n};\nfunction ReportReferenceLine(props) {\n  var dispatch = useAppDispatch();\n  useEffect(() => {\n    dispatch(addLine(props));\n    return () => {\n      dispatch(removeLine(props));\n    };\n  });\n  return null;\n}\nfunction ReferenceLineImpl(props) {\n  var {\n    xAxisId,\n    yAxisId,\n    shape,\n    className,\n    ifOverflow\n  } = props;\n  var isPanorama = useIsPanorama();\n  var clipPathId = useClipPathId();\n  var xAxis = useAppSelector(state => selectXAxisSettings(state, xAxisId));\n  var yAxis = useAppSelector(state => selectYAxisSettings(state, yAxisId));\n  var xAxisScale = useAppSelector(state => selectAxisScale(state, 'xAxis', xAxisId, isPanorama));\n  var yAxisScale = useAppSelector(state => selectAxisScale(state, 'yAxis', yAxisId, isPanorama));\n  var viewBox = useViewBox();\n  if (!clipPathId || !viewBox || xAxis == null || yAxis == null || xAxisScale == null || yAxisScale == null) {\n    return null;\n  }\n  var scales = createLabeledScales({\n    x: xAxisScale,\n    y: yAxisScale\n  });\n  var endPoints = getEndPoints(scales, viewBox, props.position, xAxis.orientation, yAxis.orientation, props);\n  if (!endPoints) {\n    return null;\n  }\n  var [{\n    x: x1,\n    y: y1\n  }, {\n    x: x2,\n    y: y2\n  }] = endPoints;\n  var clipPath = ifOverflow === 'hidden' ? \"url(#\".concat(clipPathId, \")\") : undefined;\n  var lineProps = _objectSpread(_objectSpread({\n    clipPath\n  }, svgPropertiesAndEvents(props)), {}, {\n    x1,\n    y1,\n    x2,\n    y2\n  });\n  var rect = rectWithCoords({\n    x1,\n    y1,\n    x2,\n    y2\n  });\n  return /*#__PURE__*/React.createElement(ZIndexLayer, {\n    zIndex: props.zIndex\n  }, /*#__PURE__*/React.createElement(Layer, {\n    className: clsx('recharts-reference-line', className)\n  }, renderLine(shape, lineProps), /*#__PURE__*/React.createElement(CartesianLabelContextProvider, _extends({}, rect, {\n    lowerWidth: rect.width,\n    upperWidth: rect.width\n  }), /*#__PURE__*/React.createElement(CartesianLabelFromLabelProp, {\n    label: props.label\n  }), props.children)));\n}\nexport var referenceLineDefaultProps = {\n  ifOverflow: 'discard',\n  xAxisId: 0,\n  yAxisId: 0,\n  fill: 'none',\n  stroke: '#ccc',\n  fillOpacity: 1,\n  strokeWidth: 1,\n  position: 'middle',\n  zIndex: DefaultZIndexes.line\n};\n/**\n * @provides CartesianLabelContext\n */\nexport function ReferenceLine(outsideProps) {\n  var props = resolveDefaultProps(outsideProps, referenceLineDefaultProps);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(ReportReferenceLine, {\n    yAxisId: props.yAxisId,\n    xAxisId: props.xAxisId,\n    ifOverflow: props.ifOverflow,\n    x: props.x,\n    y: props.y,\n    segment: props.segment\n  }), /*#__PURE__*/React.createElement(ReferenceLineImpl, props));\n}\nReferenceLine.displayName = 'ReferenceLine';","import { createSelector } from 'reselect';\nimport { computeArea } from '../../cartesian/Area';\nimport { selectAxisWithScale, selectStackGroups, selectTicksOfGraphicalItem, selectUnfilteredCartesianItems } from './axisSelectors';\nimport { selectChartLayout } from '../../context/chartLayoutContext';\nimport { selectChartDataWithIndexesIfNotInPanoramaPosition3 } from './dataSelectors';\nimport { getBandSizeOfAxis, isCategoricalAxis } from '../../util/ChartUtils';\nimport { getStackSeriesIdentifier } from '../../util/stacks/getStackSeriesIdentifier';\nimport { selectChartBaseValue } from './rootPropsSelectors';\nimport { selectXAxisIdFromGraphicalItemId, selectYAxisIdFromGraphicalItemId } from './graphicalItemSelectors';\nvar selectXAxisWithScale = (state, graphicalItemId, isPanorama) => selectAxisWithScale(state, 'xAxis', selectXAxisIdFromGraphicalItemId(state, graphicalItemId), isPanorama);\nvar selectXAxisTicks = (state, graphicalItemId, isPanorama) => selectTicksOfGraphicalItem(state, 'xAxis', selectXAxisIdFromGraphicalItemId(state, graphicalItemId), isPanorama);\nvar selectYAxisWithScale = (state, graphicalItemId, isPanorama) => selectAxisWithScale(state, 'yAxis', selectYAxisIdFromGraphicalItemId(state, graphicalItemId), isPanorama);\nvar selectYAxisTicks = (state, graphicalItemId, isPanorama) => selectTicksOfGraphicalItem(state, 'yAxis', selectYAxisIdFromGraphicalItemId(state, graphicalItemId), isPanorama);\nvar selectBandSize = createSelector([selectChartLayout, selectXAxisWithScale, selectYAxisWithScale, selectXAxisTicks, selectYAxisTicks], (layout, xAxis, yAxis, xAxisTicks, yAxisTicks) => {\n  if (isCategoricalAxis(layout, 'xAxis')) {\n    return getBandSizeOfAxis(xAxis, xAxisTicks, false);\n  }\n  return getBandSizeOfAxis(yAxis, yAxisTicks, false);\n});\nvar pickAreaId = (_state, id) => id;\n\n/*\n * There is a race condition problem because we read some data from props and some from the state.\n * The state is updated through a dispatch and is one render behind,\n * and so we have this weird one tick render where the displayedData in one selector have the old dataKey\n * but the new dataKey in another selector.\n *\n * A proper fix is to either move everything into the state, or read the dataKey always from props\n * - but this is a smaller change.\n */\nvar selectSynchronisedAreaSettings = createSelector([selectUnfilteredCartesianItems, pickAreaId], (graphicalItems, id) => graphicalItems.filter(item => item.type === 'area').find(item => item.id === id));\nvar selectNumericalAxisType = state => {\n  var layout = selectChartLayout(state);\n  var isXAxisCategorical = isCategoricalAxis(layout, 'xAxis');\n  return isXAxisCategorical ? 'yAxis' : 'xAxis';\n};\nvar selectNumericalAxisIdFromGraphicalItemId = (state, graphicalItemId) => {\n  var axisType = selectNumericalAxisType(state);\n  if (axisType === 'yAxis') {\n    return selectYAxisIdFromGraphicalItemId(state, graphicalItemId);\n  }\n  return selectXAxisIdFromGraphicalItemId(state, graphicalItemId);\n};\nvar selectNumericalAxisStackGroups = (state, graphicalItemId, isPanorama) => selectStackGroups(state, selectNumericalAxisType(state), selectNumericalAxisIdFromGraphicalItemId(state, graphicalItemId), isPanorama);\nexport var selectGraphicalItemStackedData = createSelector([selectSynchronisedAreaSettings, selectNumericalAxisStackGroups], (areaSettings, stackGroups) => {\n  var _stackGroups$stackId;\n  if (areaSettings == null || stackGroups == null) {\n    return undefined;\n  }\n  var {\n    stackId\n  } = areaSettings;\n  var stackSeriesIdentifier = getStackSeriesIdentifier(areaSettings);\n  if (stackId == null || stackSeriesIdentifier == null) {\n    return undefined;\n  }\n  var groups = (_stackGroups$stackId = stackGroups[stackId]) === null || _stackGroups$stackId === void 0 ? void 0 : _stackGroups$stackId.stackedData;\n  var found = groups === null || groups === void 0 ? void 0 : groups.find(v => v.key === stackSeriesIdentifier);\n  if (found == null) {\n    return undefined;\n  }\n  return found.map(item => [item[0], item[1]]);\n});\nexport var selectArea = createSelector([selectChartLayout, selectXAxisWithScale, selectYAxisWithScale, selectXAxisTicks, selectYAxisTicks, selectGraphicalItemStackedData, selectChartDataWithIndexesIfNotInPanoramaPosition3, selectBandSize, selectSynchronisedAreaSettings, selectChartBaseValue], (layout, xAxis, yAxis, xAxisTicks, yAxisTicks, stackedData, _ref, bandSize, areaSettings, chartBaseValue) => {\n  var {\n    chartData,\n    dataStartIndex,\n    dataEndIndex\n  } = _ref;\n  if (areaSettings == null || layout !== 'horizontal' && layout !== 'vertical' || xAxis == null || yAxis == null || xAxisTicks == null || yAxisTicks == null || xAxisTicks.length === 0 || yAxisTicks.length === 0 || bandSize == null) {\n    return undefined;\n  }\n  var {\n    data\n  } = areaSettings;\n  var displayedData;\n  if (data && data.length > 0) {\n    displayedData = data;\n  } else {\n    displayedData = chartData === null || chartData === void 0 ? void 0 : chartData.slice(dataStartIndex, dataEndIndex + 1);\n  }\n  if (displayedData == null) {\n    return undefined;\n  }\n  return computeArea({\n    layout,\n    xAxis,\n    yAxis,\n    xAxisTicks,\n    yAxisTicks,\n    dataStartIndex,\n    areaSettings,\n    stackedData,\n    displayedData,\n    chartBaseValue,\n    bandSize\n  });\n});","var _excluded = [\"id\"],\n  _excluded2 = [\"activeDot\", \"animationBegin\", \"animationDuration\", \"animationEasing\", \"connectNulls\", \"dot\", \"fill\", \"fillOpacity\", \"hide\", \"isAnimationActive\", \"legendType\", \"stroke\", \"xAxisId\", \"yAxisId\"];\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction _objectWithoutProperties(e, t) { if (null == e) return {}; var o, r, i = _objectWithoutPropertiesLoose(e, t); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(e); for (r = 0; r < n.length; r++) o = n[r], -1 === t.indexOf(o) && {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]); } return i; }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (-1 !== e.indexOf(n)) continue; t[n] = r[n]; } return t; }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nimport * as React from 'react';\nimport { PureComponent, useCallback, useMemo, useRef, useState } from 'react';\nimport { clsx } from 'clsx';\nimport { Curve } from '../shape/Curve';\nimport { Layer } from '../container/Layer';\nimport { CartesianLabelListContextProvider, LabelListFromLabelProp } from '../component/LabelList';\nimport { Dots } from '../component/Dots';\nimport { Global } from '../util/Global';\nimport { interpolate, isNan, isNullish, isNumber } from '../util/DataUtils';\nimport { getCateCoordinateOfLine, getNormalizedStackId, getTooltipNameProp, getValueByDataKey } from '../util/ChartUtils';\nimport { isClipDot } from '../util/ReactUtils';\nimport { ActivePoints } from '../component/ActivePoints';\nimport { SetTooltipEntrySettings } from '../state/SetTooltipEntrySettings';\nimport { GraphicalItemClipPath, useNeedsClip } from './GraphicalItemClipPath';\nimport { selectArea } from '../state/selectors/areaSelectors';\nimport { useIsPanorama } from '../context/PanoramaContext';\nimport { useCartesianChartLayout, useChartLayout } from '../context/chartLayoutContext';\nimport { useChartName } from '../state/selectors/selectors';\nimport { SetLegendPayload } from '../state/SetLegendPayload';\nimport { useAppSelector } from '../state/hooks';\nimport { useAnimationId } from '../util/useAnimationId';\nimport { resolveDefaultProps } from '../util/resolveDefaultProps';\nimport { isWellBehavedNumber } from '../util/isWellBehavedNumber';\nimport { usePlotArea } from '../hooks';\nimport { RegisterGraphicalItemId } from '../context/RegisterGraphicalItemId';\nimport { SetCartesianGraphicalItem } from '../state/SetGraphicalItem';\nimport { svgPropertiesNoEvents } from '../util/svgPropertiesNoEvents';\nimport { JavascriptAnimate } from '../animation/JavascriptAnimate';\nimport { getRadiusAndStrokeWidthFromDot } from '../util/getRadiusAndStrokeWidthFromDot';\nimport { svgPropertiesAndEvents } from '../util/svgPropertiesAndEvents';\nimport { ZIndexLayer } from '../zIndex/ZIndexLayer';\nimport { DefaultZIndexes } from '../zIndex/DefaultZIndexes';\nimport { propsAreEqual } from '../util/propsAreEqual';\n\n/**\n * @inline\n */\n\n/**\n * Internal props, combination of external props + defaultProps + private Recharts state\n */\n\n/**\n * External props, intended for end users to fill in\n */\n\n/**\n * Because of naming conflict, we are forced to ignore certain (valid) SVG attributes.\n */\n\nfunction getLegendItemColor(stroke, fill) {\n  return stroke && stroke !== 'none' ? stroke : fill;\n}\nvar computeLegendPayloadFromAreaData = props => {\n  var {\n    dataKey,\n    name,\n    stroke,\n    fill,\n    legendType,\n    hide\n  } = props;\n  return [{\n    inactive: hide,\n    dataKey,\n    type: legendType,\n    color: getLegendItemColor(stroke, fill),\n    value: getTooltipNameProp(name, dataKey),\n    payload: props\n  }];\n};\nvar SetAreaTooltipEntrySettings = /*#__PURE__*/React.memo(_ref => {\n  var {\n    dataKey,\n    data,\n    stroke,\n    strokeWidth,\n    fill,\n    name,\n    hide,\n    unit,\n    tooltipType,\n    id\n  } = _ref;\n  var tooltipEntrySettings = {\n    dataDefinedOnItem: data,\n    positions: undefined,\n    settings: {\n      stroke,\n      strokeWidth,\n      fill,\n      dataKey,\n      nameKey: undefined,\n      name: getTooltipNameProp(name, dataKey),\n      hide,\n      type: tooltipType,\n      color: getLegendItemColor(stroke, fill),\n      unit,\n      graphicalItemId: id\n    }\n  };\n  return /*#__PURE__*/React.createElement(SetTooltipEntrySettings, {\n    tooltipEntrySettings: tooltipEntrySettings\n  });\n});\nfunction AreaDotsWrapper(_ref2) {\n  var {\n    clipPathId,\n    points,\n    props\n  } = _ref2;\n  var {\n    needClip,\n    dot,\n    dataKey\n  } = props;\n  var areaProps = svgPropertiesNoEvents(props);\n  return /*#__PURE__*/React.createElement(Dots, {\n    points: points,\n    dot: dot,\n    className: \"recharts-area-dots\",\n    dotClassName: \"recharts-area-dot\",\n    dataKey: dataKey,\n    baseProps: areaProps,\n    needClip: needClip,\n    clipPathId: clipPathId\n  });\n}\nfunction AreaLabelListProvider(_ref3) {\n  var {\n    showLabels,\n    children,\n    points\n  } = _ref3;\n  var labelListEntries = points.map(point => {\n    var _point$x, _point$y;\n    var viewBox = {\n      x: (_point$x = point.x) !== null && _point$x !== void 0 ? _point$x : 0,\n      y: (_point$y = point.y) !== null && _point$y !== void 0 ? _point$y : 0,\n      width: 0,\n      lowerWidth: 0,\n      upperWidth: 0,\n      height: 0\n    };\n    return _objectSpread(_objectSpread({}, viewBox), {}, {\n      value: point.value,\n      payload: point.payload,\n      parentViewBox: undefined,\n      viewBox,\n      fill: undefined\n    });\n  });\n  return /*#__PURE__*/React.createElement(CartesianLabelListContextProvider, {\n    value: showLabels ? labelListEntries : undefined\n  }, children);\n}\nfunction StaticArea(_ref4) {\n  var {\n    points,\n    baseLine,\n    needClip,\n    clipPathId,\n    props\n  } = _ref4;\n  var {\n    layout,\n    type,\n    stroke,\n    connectNulls,\n    isRange\n  } = props;\n  var {\n      id\n    } = props,\n    propsWithoutId = _objectWithoutProperties(props, _excluded);\n  var allOtherProps = svgPropertiesNoEvents(propsWithoutId);\n  var propsWithEvents = svgPropertiesAndEvents(propsWithoutId);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, (points === null || points === void 0 ? void 0 : points.length) > 1 && /*#__PURE__*/React.createElement(Layer, {\n    clipPath: needClip ? \"url(#clipPath-\".concat(clipPathId, \")\") : undefined\n  }, /*#__PURE__*/React.createElement(Curve, _extends({}, propsWithEvents, {\n    id: id,\n    points: points,\n    connectNulls: connectNulls,\n    type: type,\n    baseLine: baseLine,\n    layout: layout,\n    stroke: \"none\",\n    className: \"recharts-area-area\"\n  })), stroke !== 'none' && /*#__PURE__*/React.createElement(Curve, _extends({}, allOtherProps, {\n    className: \"recharts-area-curve\",\n    layout: layout,\n    type: type,\n    connectNulls: connectNulls,\n    fill: \"none\",\n    points: points\n  })), stroke !== 'none' && isRange && /*#__PURE__*/React.createElement(Curve, _extends({}, allOtherProps, {\n    className: \"recharts-area-curve\",\n    layout: layout,\n    type: type,\n    connectNulls: connectNulls,\n    fill: \"none\",\n    points: baseLine\n  }))), /*#__PURE__*/React.createElement(AreaDotsWrapper, {\n    points: points,\n    props: propsWithoutId,\n    clipPathId: clipPathId\n  }));\n}\nfunction VerticalRect(_ref5) {\n  var _points$, _points;\n  var {\n    alpha,\n    baseLine,\n    points,\n    strokeWidth\n  } = _ref5;\n  var startY = (_points$ = points[0]) === null || _points$ === void 0 ? void 0 : _points$.y;\n  var endY = (_points = points[points.length - 1]) === null || _points === void 0 ? void 0 : _points.y;\n  if (!isWellBehavedNumber(startY) || !isWellBehavedNumber(endY)) {\n    return null;\n  }\n  var height = alpha * Math.abs(startY - endY);\n  var maxX = Math.max(...points.map(entry => entry.x || 0));\n  if (isNumber(baseLine)) {\n    maxX = Math.max(baseLine, maxX);\n  } else if (baseLine && Array.isArray(baseLine) && baseLine.length) {\n    maxX = Math.max(...baseLine.map(entry => entry.x || 0), maxX);\n  }\n  if (isNumber(maxX)) {\n    return /*#__PURE__*/React.createElement(\"rect\", {\n      x: 0,\n      y: startY < endY ? startY : startY - height,\n      width: maxX + (strokeWidth ? parseInt(\"\".concat(strokeWidth), 10) : 1),\n      height: Math.floor(height)\n    });\n  }\n  return null;\n}\nfunction HorizontalRect(_ref6) {\n  var _points$2, _points2;\n  var {\n    alpha,\n    baseLine,\n    points,\n    strokeWidth\n  } = _ref6;\n  var startX = (_points$2 = points[0]) === null || _points$2 === void 0 ? void 0 : _points$2.x;\n  var endX = (_points2 = points[points.length - 1]) === null || _points2 === void 0 ? void 0 : _points2.x;\n  if (!isWellBehavedNumber(startX) || !isWellBehavedNumber(endX)) {\n    return null;\n  }\n  var width = alpha * Math.abs(startX - endX);\n  var maxY = Math.max(...points.map(entry => entry.y || 0));\n  if (isNumber(baseLine)) {\n    maxY = Math.max(baseLine, maxY);\n  } else if (baseLine && Array.isArray(baseLine) && baseLine.length) {\n    maxY = Math.max(...baseLine.map(entry => entry.y || 0), maxY);\n  }\n  if (isNumber(maxY)) {\n    return /*#__PURE__*/React.createElement(\"rect\", {\n      x: startX < endX ? startX : startX - width,\n      y: 0,\n      width: width,\n      height: Math.floor(maxY + (strokeWidth ? parseInt(\"\".concat(strokeWidth), 10) : 1))\n    });\n  }\n  return null;\n}\nfunction ClipRect(_ref7) {\n  var {\n    alpha,\n    layout,\n    points,\n    baseLine,\n    strokeWidth\n  } = _ref7;\n  if (layout === 'vertical') {\n    return /*#__PURE__*/React.createElement(VerticalRect, {\n      alpha: alpha,\n      points: points,\n      baseLine: baseLine,\n      strokeWidth: strokeWidth\n    });\n  }\n  return /*#__PURE__*/React.createElement(HorizontalRect, {\n    alpha: alpha,\n    points: points,\n    baseLine: baseLine,\n    strokeWidth: strokeWidth\n  });\n}\nfunction AreaWithAnimation(_ref8) {\n  var {\n    needClip,\n    clipPathId,\n    props,\n    previousPointsRef,\n    previousBaselineRef\n  } = _ref8;\n  var {\n    points,\n    baseLine,\n    isAnimationActive,\n    animationBegin,\n    animationDuration,\n    animationEasing,\n    onAnimationStart,\n    onAnimationEnd\n  } = props;\n  var animationInput = useMemo(() => ({\n    points,\n    baseLine\n  }), [points, baseLine]);\n  var animationId = useAnimationId(animationInput, 'recharts-area-');\n  var layout = useCartesianChartLayout();\n  var [isAnimating, setIsAnimating] = useState(false);\n  var showLabels = !isAnimating;\n  var handleAnimationEnd = useCallback(() => {\n    if (typeof onAnimationEnd === 'function') {\n      onAnimationEnd();\n    }\n    setIsAnimating(false);\n  }, [onAnimationEnd]);\n  var handleAnimationStart = useCallback(() => {\n    if (typeof onAnimationStart === 'function') {\n      onAnimationStart();\n    }\n    setIsAnimating(true);\n  }, [onAnimationStart]);\n  if (layout == null) {\n    return null;\n  }\n  var prevPoints = previousPointsRef.current;\n  var prevBaseLine = previousBaselineRef.current;\n  return /*#__PURE__*/React.createElement(AreaLabelListProvider, {\n    showLabels: showLabels,\n    points: points\n  }, props.children, /*#__PURE__*/React.createElement(JavascriptAnimate, {\n    animationId: animationId,\n    begin: animationBegin,\n    duration: animationDuration,\n    isActive: isAnimationActive,\n    easing: animationEasing,\n    onAnimationEnd: handleAnimationEnd,\n    onAnimationStart: handleAnimationStart,\n    key: animationId\n  }, t => {\n    if (prevPoints) {\n      var prevPointsDiffFactor = prevPoints.length / points.length;\n      var stepPoints =\n      /*\n       * Here it is important that at the very end of the animation, on the last frame,\n       * we render the original points without any interpolation.\n       * This is needed because the code above is checking for reference equality to decide if the animation should run\n       * and if we create a new array instance (even if the numbers were the same)\n       * then we would break animations.\n       */\n      t === 1 ? points : points.map((entry, index) => {\n        var prevPointIndex = Math.floor(index * prevPointsDiffFactor);\n        if (prevPoints[prevPointIndex]) {\n          var prev = prevPoints[prevPointIndex];\n          return _objectSpread(_objectSpread({}, entry), {}, {\n            x: interpolate(prev.x, entry.x, t),\n            y: interpolate(prev.y, entry.y, t)\n          });\n        }\n        return entry;\n      });\n      var stepBaseLine;\n      if (isNumber(baseLine)) {\n        stepBaseLine = interpolate(prevBaseLine, baseLine, t);\n      } else if (isNullish(baseLine) || isNan(baseLine)) {\n        stepBaseLine = interpolate(prevBaseLine, 0, t);\n      } else {\n        stepBaseLine = baseLine.map((entry, index) => {\n          var prevPointIndex = Math.floor(index * prevPointsDiffFactor);\n          if (Array.isArray(prevBaseLine) && prevBaseLine[prevPointIndex]) {\n            var prev = prevBaseLine[prevPointIndex];\n            return _objectSpread(_objectSpread({}, entry), {}, {\n              x: interpolate(prev.x, entry.x, t),\n              y: interpolate(prev.y, entry.y, t)\n            });\n          }\n          return entry;\n        });\n      }\n      if (t > 0) {\n        /*\n         * We need to keep the refs in the parent component because we need to remember the last shape of the animation\n         * even if AreaWithAnimation is unmounted as that happens when changing props.\n         *\n         * And we need to update the refs here because here is where the interpolation is computed.\n         * Eslint doesn't like changing function arguments, but we need it so here is an eslint-disable.\n         */\n        // eslint-disable-next-line no-param-reassign\n        previousPointsRef.current = stepPoints;\n        // eslint-disable-next-line no-param-reassign\n        previousBaselineRef.current = stepBaseLine;\n      }\n      return /*#__PURE__*/React.createElement(StaticArea, {\n        points: stepPoints,\n        baseLine: stepBaseLine,\n        needClip: needClip,\n        clipPathId: clipPathId,\n        props: props\n      });\n    }\n    if (t > 0) {\n      // eslint-disable-next-line no-param-reassign\n      previousPointsRef.current = points;\n      // eslint-disable-next-line no-param-reassign\n      previousBaselineRef.current = baseLine;\n    }\n    return /*#__PURE__*/React.createElement(Layer, null, isAnimationActive && /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"clipPath\", {\n      id: \"animationClipPath-\".concat(clipPathId)\n    }, /*#__PURE__*/React.createElement(ClipRect, {\n      alpha: t,\n      points: points,\n      baseLine: baseLine,\n      layout: layout,\n      strokeWidth: props.strokeWidth\n    }))), /*#__PURE__*/React.createElement(Layer, {\n      clipPath: \"url(#animationClipPath-\".concat(clipPathId, \")\")\n    }, /*#__PURE__*/React.createElement(StaticArea, {\n      points: points,\n      baseLine: baseLine,\n      needClip: needClip,\n      clipPathId: clipPathId,\n      props: props\n    })));\n  }), /*#__PURE__*/React.createElement(LabelListFromLabelProp, {\n    label: props.label\n  }));\n}\n\n/*\n * This components decides if the area should be animated or not.\n * It also holds the state of the animation.\n */\nfunction RenderArea(_ref9) {\n  var {\n    needClip,\n    clipPathId,\n    props\n  } = _ref9;\n  /*\n   * These two must be refs, not state!\n   * Because we want to store the most recent shape of the animation in case we have to interrupt the animation;\n   * that happens when user initiates another animation before the current one finishes.\n   *\n   * If this was a useState, then every step in the animation would trigger a re-render.\n   * So, useRef it is.\n   */\n  var previousPointsRef = useRef(null);\n  var previousBaselineRef = useRef();\n  return /*#__PURE__*/React.createElement(AreaWithAnimation, {\n    needClip: needClip,\n    clipPathId: clipPathId,\n    props: props,\n    previousPointsRef: previousPointsRef,\n    previousBaselineRef: previousBaselineRef\n  });\n}\nclass AreaWithState extends PureComponent {\n  render() {\n    var {\n      hide,\n      dot,\n      points,\n      className,\n      top,\n      left,\n      needClip,\n      xAxisId,\n      yAxisId,\n      width,\n      height,\n      id,\n      baseLine,\n      zIndex\n    } = this.props;\n    if (hide) {\n      return null;\n    }\n    var layerClass = clsx('recharts-area', className);\n    var clipPathId = id;\n    var {\n      r,\n      strokeWidth\n    } = getRadiusAndStrokeWidthFromDot(dot);\n    var clipDot = isClipDot(dot);\n    var dotSize = r * 2 + strokeWidth;\n    var activePointsClipPath = needClip ? \"url(#clipPath-\".concat(clipDot ? '' : 'dots-').concat(clipPathId, \")\") : undefined;\n    return /*#__PURE__*/React.createElement(ZIndexLayer, {\n      zIndex: zIndex\n    }, /*#__PURE__*/React.createElement(Layer, {\n      className: layerClass\n    }, needClip && /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(GraphicalItemClipPath, {\n      clipPathId: clipPathId,\n      xAxisId: xAxisId,\n      yAxisId: yAxisId\n    }), !clipDot && /*#__PURE__*/React.createElement(\"clipPath\", {\n      id: \"clipPath-dots-\".concat(clipPathId)\n    }, /*#__PURE__*/React.createElement(\"rect\", {\n      x: left - dotSize / 2,\n      y: top - dotSize / 2,\n      width: width + dotSize,\n      height: height + dotSize\n    }))), /*#__PURE__*/React.createElement(RenderArea, {\n      needClip: needClip,\n      clipPathId: clipPathId,\n      props: this.props\n    })), /*#__PURE__*/React.createElement(ActivePoints, {\n      points: points,\n      mainColor: getLegendItemColor(this.props.stroke, this.props.fill),\n      itemDataKey: this.props.dataKey,\n      activeDot: this.props.activeDot,\n      clipPath: activePointsClipPath\n    }), this.props.isRange && Array.isArray(baseLine) && /*#__PURE__*/React.createElement(ActivePoints, {\n      points: baseLine,\n      mainColor: getLegendItemColor(this.props.stroke, this.props.fill),\n      itemDataKey: this.props.dataKey,\n      activeDot: this.props.activeDot,\n      clipPath: activePointsClipPath\n    }));\n  }\n}\nexport var defaultAreaProps = {\n  activeDot: true,\n  animationBegin: 0,\n  animationDuration: 1500,\n  animationEasing: 'ease',\n  connectNulls: false,\n  dot: false,\n  fill: '#3182bd',\n  fillOpacity: 0.6,\n  hide: false,\n  isAnimationActive: 'auto',\n  legendType: 'line',\n  stroke: '#3182bd',\n  strokeWidth: 1,\n  type: 'linear',\n  label: false,\n  xAxisId: 0,\n  yAxisId: 0,\n  zIndex: DefaultZIndexes.area\n};\nfunction AreaImpl(props) {\n  var _useAppSelector;\n  var _resolveDefaultProps = resolveDefaultProps(props, defaultAreaProps),\n    {\n      activeDot,\n      animationBegin,\n      animationDuration,\n      animationEasing,\n      connectNulls,\n      dot,\n      fill,\n      fillOpacity,\n      hide,\n      isAnimationActive,\n      legendType,\n      stroke,\n      xAxisId,\n      yAxisId\n    } = _resolveDefaultProps,\n    everythingElse = _objectWithoutProperties(_resolveDefaultProps, _excluded2);\n  var layout = useChartLayout();\n  var chartName = useChartName();\n  var {\n    needClip\n  } = useNeedsClip(xAxisId, yAxisId);\n  var isPanorama = useIsPanorama();\n  var {\n    points,\n    isRange,\n    baseLine\n  } = (_useAppSelector = useAppSelector(state => selectArea(state, props.id, isPanorama))) !== null && _useAppSelector !== void 0 ? _useAppSelector : {};\n  var plotArea = usePlotArea();\n  if (layout !== 'horizontal' && layout !== 'vertical' || plotArea == null) {\n    // Can't render Area in an unsupported layout\n    return null;\n  }\n  if (chartName !== 'AreaChart' && chartName !== 'ComposedChart') {\n    // There is nothing stopping us from rendering Area in other charts, except for historical reasons. Do we want to allow that?\n    return null;\n  }\n  var {\n    height,\n    width,\n    x: left,\n    y: top\n  } = plotArea;\n  if (!points || !points.length) {\n    return null;\n  }\n  return /*#__PURE__*/React.createElement(AreaWithState, _extends({}, everythingElse, {\n    activeDot: activeDot,\n    animationBegin: animationBegin,\n    animationDuration: animationDuration,\n    animationEasing: animationEasing,\n    baseLine: baseLine,\n    connectNulls: connectNulls,\n    dot: dot,\n    fill: fill,\n    fillOpacity: fillOpacity,\n    height: height,\n    hide: hide,\n    layout: layout,\n    isAnimationActive: isAnimationActive === 'auto' ? !Global.isSsr : isAnimationActive,\n    isRange: isRange,\n    legendType: legendType,\n    needClip: needClip,\n    points: points,\n    stroke: stroke,\n    width: width,\n    left: left,\n    top: top,\n    xAxisId: xAxisId,\n    yAxisId: yAxisId\n  }));\n}\nexport var getBaseValue = (layout, chartBaseValue, itemBaseValue, xAxis, yAxis) => {\n  // The baseValue can be defined both on the AreaChart, and on the Area.\n  // The value for the item takes precedence.\n  var baseValue = itemBaseValue !== null && itemBaseValue !== void 0 ? itemBaseValue : chartBaseValue;\n  if (isNumber(baseValue)) {\n    return baseValue;\n  }\n  var numericAxis = layout === 'horizontal' ? yAxis : xAxis;\n  // @ts-expect-error d3scale .domain() returns unknown, Math.max expects number\n  var domain = numericAxis.scale.domain();\n  if (numericAxis.type === 'number') {\n    var domainMax = Math.max(domain[0], domain[1]);\n    var domainMin = Math.min(domain[0], domain[1]);\n    if (baseValue === 'dataMin') {\n      return domainMin;\n    }\n    if (baseValue === 'dataMax') {\n      return domainMax;\n    }\n    return domainMax < 0 ? domainMax : Math.max(Math.min(domain[0], domain[1]), 0);\n  }\n  if (baseValue === 'dataMin') {\n    return domain[0];\n  }\n  if (baseValue === 'dataMax') {\n    return domain[1];\n  }\n  return domain[0];\n};\nexport function computeArea(_ref0) {\n  var {\n    areaSettings: {\n      connectNulls,\n      baseValue: itemBaseValue,\n      dataKey\n    },\n    stackedData,\n    layout,\n    chartBaseValue,\n    xAxis,\n    yAxis,\n    displayedData,\n    dataStartIndex,\n    xAxisTicks,\n    yAxisTicks,\n    bandSize\n  } = _ref0;\n  var hasStack = stackedData && stackedData.length;\n  var baseValue = getBaseValue(layout, chartBaseValue, itemBaseValue, xAxis, yAxis);\n  var isHorizontalLayout = layout === 'horizontal';\n  var isRange = false;\n  var points = displayedData.map((entry, index) => {\n    var _valueAsArray$, _valueAsArray;\n    var valueAsArray;\n    if (hasStack) {\n      valueAsArray = stackedData[dataStartIndex + index];\n    } else {\n      var rawValue = getValueByDataKey(entry, dataKey);\n      if (!Array.isArray(rawValue)) {\n        // @ts-expect-error getValueByDataKey is not checking its return value\n        valueAsArray = [baseValue, rawValue];\n      } else {\n        // @ts-expect-error getValueByDataKey is not checking its return value\n        valueAsArray = rawValue;\n        isRange = true;\n      }\n    }\n    var value1 = (_valueAsArray$ = (_valueAsArray = valueAsArray) === null || _valueAsArray === void 0 ? void 0 : _valueAsArray[1]) !== null && _valueAsArray$ !== void 0 ? _valueAsArray$ : null;\n    var isBreakPoint = value1 == null || hasStack && !connectNulls && getValueByDataKey(entry, dataKey) == null;\n    if (isHorizontalLayout) {\n      return {\n        x: getCateCoordinateOfLine({\n          axis: xAxis,\n          ticks: xAxisTicks,\n          bandSize,\n          entry,\n          index\n        }),\n        y: isBreakPoint ? null : yAxis.scale(value1),\n        value: valueAsArray,\n        payload: entry\n      };\n    }\n    return {\n      x: isBreakPoint ? null : xAxis.scale(value1),\n      y: getCateCoordinateOfLine({\n        axis: yAxis,\n        ticks: yAxisTicks,\n        bandSize,\n        entry,\n        index\n      }),\n      value: valueAsArray,\n      payload: entry\n    };\n  });\n  var baseLine;\n  if (hasStack || isRange) {\n    baseLine = points.map(entry => {\n      var x = Array.isArray(entry.value) ? entry.value[0] : null;\n      if (isHorizontalLayout) {\n        return {\n          x: entry.x,\n          y: x != null && entry.y != null ? yAxis.scale(x) : null,\n          payload: entry.payload\n        };\n      }\n      return {\n        x: x != null ? xAxis.scale(x) : null,\n        y: entry.y,\n        payload: entry.payload\n      };\n    });\n  } else {\n    baseLine = isHorizontalLayout ? yAxis.scale(baseValue) : xAxis.scale(baseValue);\n  }\n  return {\n    points,\n    baseLine,\n    isRange\n  };\n}\nfunction AreaFn(outsideProps) {\n  var props = resolveDefaultProps(outsideProps, defaultAreaProps);\n  var isPanorama = useIsPanorama();\n  // Report all props to Redux store first, before calling any hooks, to avoid circular dependencies.\n  return /*#__PURE__*/React.createElement(RegisterGraphicalItemId, {\n    id: props.id,\n    type: \"area\"\n  }, id => /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(SetLegendPayload, {\n    legendPayload: computeLegendPayloadFromAreaData(props)\n  }), /*#__PURE__*/React.createElement(SetAreaTooltipEntrySettings, {\n    dataKey: props.dataKey,\n    data: props.data,\n    stroke: props.stroke,\n    strokeWidth: props.strokeWidth,\n    fill: props.fill,\n    name: props.name,\n    hide: props.hide,\n    unit: props.unit,\n    tooltipType: props.tooltipType,\n    id: id\n  }), /*#__PURE__*/React.createElement(SetCartesianGraphicalItem, {\n    type: \"area\",\n    id: id,\n    data: props.data,\n    dataKey: props.dataKey,\n    xAxisId: props.xAxisId,\n    yAxisId: props.yAxisId,\n    zAxisId: 0,\n    stackId: getNormalizedStackId(props.stackId),\n    hide: props.hide,\n    barSize: undefined,\n    baseValue: props.baseValue,\n    isPanorama: isPanorama,\n    connectNulls: props.connectNulls\n  }), /*#__PURE__*/React.createElement(AreaImpl, _extends({}, props, {\n    id: id\n  }))));\n}\n\n/**\n * @provides LabelListContext\n * @consumes CartesianChartContext\n */\nexport var Area = /*#__PURE__*/React.memo(AreaFn, propsAreEqual);\nArea.displayName = 'Area';","import * as React from 'react';\nimport { forwardRef } from 'react';\nimport { arrayTooltipSearcher } from '../state/optionsSlice';\nimport { CartesianChart } from './CartesianChart';\nvar allowedTooltipTypes = ['axis'];\n\n/**\n * @provides CartesianViewBoxContext\n * @provides CartesianChartContext\n */\nexport var AreaChart = /*#__PURE__*/forwardRef((props, ref) => {\n  return /*#__PURE__*/React.createElement(CartesianChart, {\n    chartName: \"AreaChart\",\n    defaultTooltipEventType: \"axis\",\n    validateTooltipEventTypes: allowedTooltipTypes,\n    tooltipPayloadSearcher: arrayTooltipSearcher,\n    categoricalChartProps: props,\n    ref: ref\n  });\n});","/**\n * FieldSync Error Handling Utility\n *\n * Centralized error handling with proper logging, user feedback, and recovery.\n * Eliminates silent failures and provides consistent error handling patterns.\n *\n * Usage:\n *   import { handleError, withErrorHandling, safeAsync } from './errorHandler'\n *\n *   // Wrap async operations\n *   const data = await safeAsync(\n *     () => db.getTMTickets(projectId),\n *     { fallback: [], context: { operation: 'getTMTickets', projectId } }\n *   )\n *\n *   // Handle errors with toast\n *   try { ... } catch (error) {\n *     handleError(error, { operation: 'saveTicket', showToast: onShowToast })\n *   }\n */\n\nimport { observe } from './observability'\n\n// Error severity levels\nexport const ErrorSeverity = {\n  INFO: 'info',\n  WARNING: 'warning',\n  ERROR: 'error',\n  CRITICAL: 'critical'\n}\n\n// Error categories\nexport const ErrorCategory = {\n  DATABASE: 'database',\n  NETWORK: 'network',\n  AUTH: 'auth',\n  VALIDATION: 'validation',\n  STORAGE: 'storage',\n  SYNC: 'sync',\n  GENERAL: 'general'\n}\n\n/**\n * Determine error category from error object\n */\nfunction categorizeError(error) {\n  const message = error?.message?.toLowerCase() || ''\n  const code = error?.code?.toLowerCase() || ''\n\n  if (message.includes('fetch') || message.includes('network') || message.includes('offline')) {\n    return ErrorCategory.NETWORK\n  }\n  if (message.includes('auth') || message.includes('unauthorized') || code.includes('auth')) {\n    return ErrorCategory.AUTH\n  }\n  if (message.includes('storage') || message.includes('bucket') || message.includes('upload')) {\n    return ErrorCategory.STORAGE\n  }\n  if (message.includes('validation') || message.includes('invalid') || message.includes('required')) {\n    return ErrorCategory.VALIDATION\n  }\n  if (message.includes('sync') || message.includes('conflict')) {\n    return ErrorCategory.SYNC\n  }\n  if (error?.code || message.includes('database') || message.includes('supabase')) {\n    return ErrorCategory.DATABASE\n  }\n\n  return ErrorCategory.GENERAL\n}\n\n/**\n * Get user-friendly error message\n */\nfunction getUserMessage(error, category, context) {\n  // Custom message provided\n  if (context?.userMessage) {\n    return context.userMessage\n  }\n\n  // Network errors\n  if (category === ErrorCategory.NETWORK) {\n    return 'Network connection issue. Your changes will sync when back online.'\n  }\n\n  // Auth errors\n  if (category === ErrorCategory.AUTH) {\n    return 'Session expired. Please sign in again.'\n  }\n\n  // Storage errors\n  if (category === ErrorCategory.STORAGE) {\n    return 'Failed to upload file. Please try again.'\n  }\n\n  // Validation errors - show actual message\n  if (category === ErrorCategory.VALIDATION) {\n    return error?.message || 'Please check your input and try again.'\n  }\n\n  // Sync errors\n  if (category === ErrorCategory.SYNC) {\n    return 'Sync conflict detected. Please refresh and try again.'\n  }\n\n  // Database/general errors with operation context\n  if (context?.operation) {\n    const operation = context.operation.replace(/([A-Z])/g, ' $1').toLowerCase().trim()\n    return `Failed to ${operation}. Please try again.`\n  }\n\n  return 'Something went wrong. Please try again.'\n}\n\n/**\n * Main error handler\n *\n * @param {Error} error - The error object\n * @param {Object} options - Error handling options\n * @param {string} options.operation - Name of the operation that failed\n * @param {string} options.category - Error category (auto-detected if not provided)\n * @param {string} options.severity - Error severity (default: 'error')\n * @param {Function} options.showToast - Toast function to show user feedback\n * @param {string} options.userMessage - Custom user-facing message\n * @param {string} options.companyId - Company ID for context\n * @param {string} options.projectId - Project ID for context\n * @param {string} options.userId - User ID for context\n * @param {boolean} options.silent - If true, don't show toast (still logs)\n * @param {boolean} options.rethrow - If true, rethrow the error after handling\n */\nexport function handleError(error, options = {}) {\n  const {\n    operation = 'unknown',\n    category = categorizeError(error),\n    severity = ErrorSeverity.ERROR,\n    showToast,\n    userMessage,\n    companyId,\n    projectId,\n    userId,\n    silent = false,\n    rethrow = false\n  } = options\n\n  // Log to observability system\n  observe.error(category, {\n    message: error?.message || 'Unknown error',\n    code: error?.code,\n    severity,\n    operation,\n    company_id: companyId,\n    project_id: projectId,\n    user_id: userId,\n    extra: {\n      stack: error?.stack,\n      name: error?.name\n    }\n  })\n\n  // Show user feedback unless silent\n  if (!silent && showToast) {\n    const message = getUserMessage(error, category, { operation, userMessage })\n    const toastType = severity === ErrorSeverity.WARNING ? 'warning' : 'error'\n    showToast(message, toastType)\n  }\n\n  // Rethrow if requested\n  if (rethrow) {\n    throw error\n  }\n\n  return null\n}\n\n/**\n * Safe async wrapper - executes async function with error handling\n * Returns fallback value on error instead of throwing\n *\n * @param {Function} fn - Async function to execute\n * @param {Object} options - Options\n * @param {any} options.fallback - Value to return on error (default: null)\n * @param {Object} options.context - Context for error logging\n * @param {Function} options.showToast - Toast function\n * @param {boolean} options.silent - Don't show toast on error\n */\nexport async function safeAsync(fn, options = {}) {\n  const { fallback = null, context = {}, showToast, silent = true } = options\n\n  try {\n    return await fn()\n  } catch (error) {\n    handleError(error, {\n      ...context,\n      showToast,\n      silent\n    })\n    return fallback\n  }\n}\n\n/**\n * Higher-order function to wrap async functions with error handling\n *\n * @param {Function} fn - Async function to wrap\n * @param {Object} defaultOptions - Default error handling options\n */\nexport function withErrorHandling(fn, defaultOptions = {}) {\n  return async function(...args) {\n    try {\n      return await fn.apply(this, args)\n    } catch (error) {\n      handleError(error, defaultOptions)\n      return defaultOptions.fallback ?? null\n    }\n  }\n}\n\n/**\n * Create a safe version of a database operation\n * Logs errors and returns fallback instead of throwing\n *\n * @param {string} operation - Operation name for logging\n * @param {any} fallback - Fallback value on error\n */\nexport function createSafeOperation(operation, fallback = null) {\n  return (fn) => async (...args) => {\n    try {\n      return await fn(...args)\n    } catch (error) {\n      observe.error(ErrorCategory.DATABASE, {\n        message: error?.message || 'Unknown error',\n        operation,\n        severity: ErrorSeverity.ERROR\n      })\n      return fallback\n    }\n  }\n}\n\n/**\n * Batch multiple async operations with individual error handling\n * Returns results array with nulls for failed operations\n *\n * @param {Array<{fn: Function, fallback: any, context: Object}>} operations\n */\nexport async function safeBatch(operations) {\n  return Promise.all(\n    operations.map(({ fn, fallback = null, context = {} }) =>\n      safeAsync(fn, { fallback, context, silent: true })\n    )\n  )\n}\n\n/**\n * Retry wrapper for flaky operations\n *\n * @param {Function} fn - Async function to retry\n * @param {Object} options - Retry options\n * @param {number} options.maxRetries - Max retry attempts (default: 3)\n * @param {number} options.baseDelay - Base delay in ms (default: 1000)\n * @param {Function} options.shouldRetry - Function to determine if error is retryable\n */\nexport async function withRetry(fn, options = {}) {\n  const {\n    maxRetries = 3,\n    baseDelay = 1000,\n    shouldRetry = (error) => {\n      const message = error?.message?.toLowerCase() || ''\n      return message.includes('network') || message.includes('fetch') || message.includes('timeout')\n    }\n  } = options\n\n  let lastError\n\n  for (let attempt = 0; attempt < maxRetries; attempt++) {\n    try {\n      return await fn()\n    } catch (error) {\n      lastError = error\n\n      if (!shouldRetry(error) || attempt === maxRetries - 1) {\n        throw error\n      }\n\n      // Exponential backoff\n      const delay = baseDelay * Math.pow(2, attempt)\n      await new Promise(resolve => setTimeout(resolve, delay))\n    }\n  }\n\n  throw lastError\n}\n\nexport default {\n  handleError,\n  safeAsync,\n  withErrorHandling,\n  createSafeOperation,\n  safeBatch,\n  withRetry,\n  ErrorSeverity,\n  ErrorCategory\n}\n","/**\n * Risk Score Calculation Engine\n *\n * Calculates a composite risk score (0-100) for projects\n * based on multiple factors. Lower score = healthier project.\n *\n * Factors and weights:\n * - Budget Health: 30% - Cost ratio vs earned revenue\n * - Schedule Health: 25% - Progress vs expected progress\n * - COR Exposure: 20% - Pending COR value as % of contract\n * - Activity Cadence: 15% - Days since last daily report\n * - Safety Status: 10% - Recent injury reports\n */\n\n// Default thresholds (can be overridden per company)\nexport const DEFAULT_THRESHOLDS = {\n  budget: {\n    healthy: 0.60,   // Green if costs < 60% of revenue\n    warning: 0.75,   // Yellow if 60-75%\n    critical: 0.85   // Red if > 85%\n  },\n  schedule: {\n    healthy: 0.05,   // Green if within 5% of plan\n    warning: 0.15,   // Yellow if 5-15% behind\n    critical: 0.25   // Red if > 25% behind\n  },\n  corExposure: {\n    healthy: 0.05,   // Green if pending CORs < 5% of contract\n    warning: 0.15,   // Yellow if 5-15%\n    critical: 0.25   // Red if > 25%\n  },\n  activity: {\n    healthy: 1,      // Green if report within 1 day\n    warning: 3,      // Yellow if 2-3 days\n    critical: 5      // Red if > 5 days\n  },\n  safety: {\n    healthy: 0,      // Green if 0 incidents in 30 days\n    warning: 1,      // Yellow if 1 incident\n    critical: 2      // Red if 2+ incidents\n  }\n}\n\n// Factor weights (must sum to 1.0)\nexport const FACTOR_WEIGHTS = {\n  budget: 0.30,\n  schedule: 0.25,\n  corExposure: 0.20,\n  activity: 0.15,\n  safety: 0.10\n}\n\n/**\n * Calculate individual factor score (0-100)\n * 0 = healthy, 100 = critical\n */\nfunction calculateFactorScore(value, thresholds) {\n  if (value <= thresholds.healthy) return 0\n  if (value >= thresholds.critical) return 100\n\n  // Linear interpolation between healthy and critical\n  const range = thresholds.critical - thresholds.healthy\n  const excess = value - thresholds.healthy\n  return (excess / range) * 100\n}\n\n/**\n * Get status label for a factor score\n */\nfunction getFactorStatus(score) {\n  if (score <= 25) return 'healthy'\n  if (score <= 60) return 'warning'\n  return 'critical'\n}\n\n/**\n * Calculate budget health factor\n *\n * @param {number} totalCosts - Total costs to date\n * @param {number} earnedRevenue - Earned revenue to date\n * @param {object} thresholds - Custom thresholds (optional)\n */\nexport function calculateBudgetFactor(totalCosts, earnedRevenue, thresholds = DEFAULT_THRESHOLDS.budget) {\n  if (!earnedRevenue || earnedRevenue <= 0) {\n    // No revenue yet - can't calculate ratio\n    return { score: 0, status: 'healthy', ratio: 0, label: 'No revenue yet' }\n  }\n\n  const ratio = totalCosts / earnedRevenue\n\n  const score = calculateFactorScore(ratio, thresholds)\n  const status = getFactorStatus(score)\n\n  let label\n  if (ratio < thresholds.healthy) {\n    label = `Costs at ${(ratio * 100).toFixed(0)}% of revenue`\n  } else if (ratio < thresholds.warning) {\n    label = `Costs at ${(ratio * 100).toFixed(0)}% - monitor closely`\n  } else {\n    label = `Costs at ${(ratio * 100).toFixed(0)}% - review immediately`\n  }\n\n  return { score, status, ratio, label }\n}\n\n/**\n * Calculate schedule health factor\n *\n * @param {number} actualProgress - Actual completion percentage (0-100)\n * @param {number} expectedProgress - Expected completion percentage (0-100)\n * @param {object} thresholds - Custom thresholds (optional)\n */\nexport function calculateScheduleFactor(actualProgress, expectedProgress, thresholds = DEFAULT_THRESHOLDS.schedule) {\n  if (!expectedProgress || expectedProgress <= 0) {\n    // No schedule baseline - assume on track\n    return { score: 0, status: 'healthy', variance: 0, label: 'No schedule baseline' }\n  }\n\n  // Variance as a ratio (negative = behind)\n  const variance = (expectedProgress - actualProgress) / expectedProgress\n  const absVariance = Math.max(0, variance) // Only penalize being behind\n\n  const score = calculateFactorScore(absVariance, thresholds)\n  const status = getFactorStatus(score)\n\n  let label\n  if (variance <= 0) {\n    label = actualProgress >= 100 ? 'Complete' : 'On or ahead of schedule'\n  } else if (variance < thresholds.warning) {\n    label = `${(variance * 100).toFixed(0)}% behind schedule`\n  } else {\n    label = `${(variance * 100).toFixed(0)}% behind - needs attention`\n  }\n\n  return { score, status, variance, label }\n}\n\n/**\n * Calculate COR exposure factor\n *\n * @param {number} pendingCORValue - Total value of pending CORs\n * @param {number} contractValue - Total contract value\n * @param {object} thresholds - Custom thresholds (optional)\n */\nexport function calculateCORExposureFactor(pendingCORValue, contractValue, thresholds = DEFAULT_THRESHOLDS.corExposure) {\n  if (!contractValue || contractValue <= 0) {\n    return { score: 0, status: 'healthy', exposure: 0, label: 'No contract value' }\n  }\n\n  const exposure = pendingCORValue / contractValue\n\n  const score = calculateFactorScore(exposure, thresholds)\n  const status = getFactorStatus(score)\n\n  let label\n  if (exposure < thresholds.healthy) {\n    label = pendingCORValue > 0 ? `$${formatNumber(pendingCORValue)} pending` : 'No pending CORs'\n  } else if (exposure < thresholds.warning) {\n    label = `$${formatNumber(pendingCORValue)} pending (${(exposure * 100).toFixed(0)}% of contract)`\n  } else {\n    label = `High exposure: $${formatNumber(pendingCORValue)} (${(exposure * 100).toFixed(0)}%)`\n  }\n\n  return { score, status, exposure, label }\n}\n\n/**\n * Calculate activity cadence factor\n *\n * @param {Date|string} lastReportDate - Date of last daily report\n * @param {object} thresholds - Custom thresholds (optional)\n */\nexport function calculateActivityFactor(lastReportDate, thresholds = DEFAULT_THRESHOLDS.activity) {\n  if (!lastReportDate) {\n    return { score: 100, status: 'critical', daysSince: null, label: 'No reports filed' }\n  }\n\n  const lastDate = new Date(lastReportDate)\n  const now = new Date()\n  const daysSince = Math.floor((now - lastDate) / (1000 * 60 * 60 * 24))\n\n  const score = calculateFactorScore(daysSince, thresholds)\n  const status = getFactorStatus(score)\n\n  let label\n  if (daysSince === 0) {\n    label = 'Report filed today'\n  } else if (daysSince === 1) {\n    label = 'Report filed yesterday'\n  } else if (daysSince <= thresholds.warning) {\n    label = `Last report ${daysSince} days ago`\n  } else {\n    label = `No report in ${daysSince} days - may be stalled`\n  }\n\n  return { score, status, daysSince, label }\n}\n\n/**\n * Calculate safety factor\n *\n * @param {number} injuryCount - Number of injury reports in last 30 days\n * @param {object} thresholds - Custom thresholds (optional)\n */\nexport function calculateSafetyFactor(injuryCount, thresholds = DEFAULT_THRESHOLDS.safety) {\n  const count = injuryCount || 0\n\n  const score = calculateFactorScore(count, thresholds)\n  const status = getFactorStatus(score)\n\n  let label\n  if (count === 0) {\n    label = 'No incidents'\n  } else if (count === 1) {\n    label = '1 incident in last 30 days'\n  } else {\n    label = `${count} incidents - safety review needed`\n  }\n\n  return { score, status, count, label }\n}\n\n/**\n * Calculate composite risk score\n *\n * @param {object} project - Project data object\n * @param {object} options - Optional custom thresholds and weights\n * @returns {object} Risk score result with breakdown\n */\nexport function calculateRiskScore(project, options = {}) {\n  const thresholds = { ...DEFAULT_THRESHOLDS, ...options.thresholds }\n  const weights = { ...FACTOR_WEIGHTS, ...options.weights }\n\n  // Calculate individual factors\n  const budgetFactor = calculateBudgetFactor(\n    project.totalCosts,\n    project.earnedRevenue,\n    thresholds.budget\n  )\n\n  const scheduleFactor = calculateScheduleFactor(\n    project.actualProgress,\n    project.expectedProgress,\n    thresholds.schedule\n  )\n\n  const corFactor = calculateCORExposureFactor(\n    project.pendingCORValue,\n    project.contractValue,\n    thresholds.corExposure\n  )\n\n  const activityFactor = calculateActivityFactor(\n    project.lastReportDate,\n    thresholds.activity\n  )\n\n  const safetyFactor = calculateSafetyFactor(\n    project.recentInjuryCount,\n    thresholds.safety\n  )\n\n  // Calculate weighted composite score\n  const compositeScore = Math.round(\n    budgetFactor.score * weights.budget +\n    scheduleFactor.score * weights.schedule +\n    corFactor.score * weights.corExposure +\n    activityFactor.score * weights.activity +\n    safetyFactor.score * weights.safety\n  )\n\n  // Determine overall status\n  let overallStatus\n  if (compositeScore <= 25) {\n    overallStatus = 'healthy'\n  } else if (compositeScore <= 60) {\n    overallStatus = 'warning'\n  } else {\n    overallStatus = 'critical'\n  }\n\n  // Generate summary label\n  let summaryLabel\n  if (overallStatus === 'healthy') {\n    summaryLabel = 'Project is on track'\n  } else if (overallStatus === 'warning') {\n    summaryLabel = 'Some factors need attention'\n  } else {\n    summaryLabel = 'Immediate review recommended'\n  }\n\n  return {\n    score: compositeScore,\n    status: overallStatus,\n    label: summaryLabel,\n    factors: {\n      budget: { ...budgetFactor, weight: weights.budget },\n      schedule: { ...scheduleFactor, weight: weights.schedule },\n      corExposure: { ...corFactor, weight: weights.corExposure },\n      activity: { ...activityFactor, weight: weights.activity },\n      safety: { ...safetyFactor, weight: weights.safety }\n    }\n  }\n}\n\n/**\n * Generate smart alerts based on risk factors\n *\n * @param {object} riskResult - Result from calculateRiskScore\n * @param {object} project - Project data for context\n * @returns {array} Array of alert objects\n */\nexport function generateSmartAlerts(riskResult, project) {\n  const alerts = []\n\n  const { factors } = riskResult\n\n  // Critical alerts (priority 1)\n  if (factors.budget.status === 'critical') {\n    alerts.push({\n      type: 'critical',\n      title: 'Budget Alert',\n      description: factors.budget.label,\n      action: 'Review costs immediately',\n      actionTarget: 'financials',\n      projectId: project.id\n    })\n  }\n\n  if (factors.activity.status === 'critical') {\n    alerts.push({\n      type: 'critical',\n      title: 'Activity Alert',\n      description: factors.activity.label,\n      action: 'Check project status',\n      actionTarget: 'overview',\n      projectId: project.id\n    })\n  }\n\n  if (factors.safety.status === 'critical') {\n    alerts.push({\n      type: 'critical',\n      title: 'Safety Alert',\n      description: factors.safety.label,\n      action: 'Review safety reports',\n      actionTarget: 'reports',\n      projectId: project.id\n    })\n  }\n\n  // Warning alerts (priority 2)\n  if (factors.budget.status === 'warning') {\n    alerts.push({\n      type: 'warning',\n      title: 'Budget Watch',\n      description: factors.budget.label,\n      action: 'Monitor costs',\n      actionTarget: 'financials',\n      projectId: project.id\n    })\n  }\n\n  if (factors.schedule.status === 'critical' || factors.schedule.status === 'warning') {\n    alerts.push({\n      type: factors.schedule.status === 'critical' ? 'critical' : 'warning',\n      title: 'Schedule Alert',\n      description: factors.schedule.label,\n      action: 'Review progress',\n      actionTarget: 'overview',\n      projectId: project.id\n    })\n  }\n\n  if (factors.corExposure.status === 'warning' || factors.corExposure.status === 'critical') {\n    alerts.push({\n      type: factors.corExposure.status === 'critical' ? 'critical' : 'warning',\n      title: 'COR Exposure',\n      description: factors.corExposure.label,\n      action: 'Review pending CORs',\n      actionTarget: 'cors',\n      projectId: project.id\n    })\n  }\n\n  // Info alerts (priority 3)\n  if (factors.activity.status === 'warning') {\n    alerts.push({\n      type: 'info',\n      title: 'Activity Notice',\n      description: factors.activity.label,\n      action: 'File daily report',\n      actionTarget: 'reports',\n      projectId: project.id\n    })\n  }\n\n  // Sort by priority\n  const priorityOrder = { critical: 0, warning: 1, info: 2 }\n  alerts.sort((a, b) => priorityOrder[a.type] - priorityOrder[b.type])\n\n  return alerts\n}\n\n/**\n * Calculate projections based on current trends\n */\nexport function calculateProjections(project) {\n  const { actualProgress, totalCosts, earnedRevenue, contractValue } = project\n\n  // Guard against division by zero\n  if (!actualProgress || actualProgress <= 0) {\n    return {\n      estimatedCompletionCost: null,\n      estimatedFinalMargin: null,\n      estimatedCompletionDate: null\n    }\n  }\n\n  // Project final cost based on current burn rate\n  const costPerPercent = totalCosts / actualProgress\n  const estimatedCompletionCost = Math.round(costPerPercent * 100)\n\n  // Calculate projected margin\n  const estimatedFinalMargin = contractValue > 0\n    ? ((contractValue - estimatedCompletionCost) / contractValue) * 100\n    : 0\n\n  // If we have start date and progress, estimate completion\n  // (This is simplified - real implementation would use more sophisticated projection)\n  let estimatedCompletionDate = null\n  if (project.startDate && actualProgress > 0 && actualProgress < 100) {\n    const startDate = new Date(project.startDate)\n    const now = new Date()\n    const daysElapsed = Math.max(1, (now - startDate) / (1000 * 60 * 60 * 24))\n    const progressPerDay = actualProgress / daysElapsed\n    const remainingProgress = 100 - actualProgress\n    const daysRemaining = remainingProgress / progressPerDay\n\n    estimatedCompletionDate = new Date(now.getTime() + daysRemaining * 24 * 60 * 60 * 1000)\n  }\n\n  return {\n    estimatedCompletionCost,\n    estimatedFinalMargin,\n    estimatedCompletionDate,\n    costPerPercent\n  }\n}\n\n// Helper function\nfunction formatNumber(num) {\n  if (num >= 1000000) {\n    return (num / 1000000).toFixed(1) + 'M'\n  }\n  if (num >= 1000) {\n    return (num / 1000).toFixed(0) + 'K'\n  }\n  return num.toFixed(0)\n}\n\nexport default {\n  calculateRiskScore,\n  generateSmartAlerts,\n  calculateProjections,\n  calculateBudgetFactor,\n  calculateScheduleFactor,\n  calculateCORExposureFactor,\n  calculateActivityFactor,\n  calculateSafetyFactor,\n  DEFAULT_THRESHOLDS,\n  FACTOR_WEIGHTS\n}\n","import { useState, useEffect, useRef, useCallback } from 'react'\nimport { Search, X, FolderOpen, FileText, Users, ClipboardList, ChevronRight, Command } from 'lucide-react'\nimport { db } from '../lib/supabase'\n\nexport default function UniversalSearch({\n  isOpen,\n  onClose,\n  companyId,\n  onSelectProject,\n  onSelectTicket,\n  onSelectCOR,\n  onShowToast\n}) {\n  const [query, setQuery] = useState('')\n  const [results, setResults] = useState({ projects: [], tickets: [], cors: [], workers: [] })\n  const [loading, setLoading] = useState(false)\n  const [selectedIndex, setSelectedIndex] = useState(0)\n  const inputRef = useRef(null)\n  const searchTimeoutRef = useRef(null)\n  const focusTimeoutRef = useRef(null)\n\n  // Cleanup timers on unmount\n  useEffect(() => {\n    return () => {\n      if (searchTimeoutRef.current) clearTimeout(searchTimeoutRef.current)\n      if (focusTimeoutRef.current) clearTimeout(focusTimeoutRef.current)\n    }\n  }, [])\n\n  // Focus input when modal opens\n  useEffect(() => {\n    if (isOpen) {\n      setQuery('')\n      setResults({ projects: [], tickets: [], cors: [], workers: [] })\n      setSelectedIndex(0)\n      focusTimeoutRef.current = setTimeout(() => inputRef.current?.focus(), 50)\n    }\n  }, [isOpen])\n\n  // Debounced search\n  const performSearch = useCallback(async (searchQuery) => {\n    if (!searchQuery.trim() || searchQuery.length < 2) {\n      setResults({ projects: [], tickets: [], cors: [], workers: [] })\n      return\n    }\n\n    setLoading(true)\n    try {\n      const searchResults = await db.universalSearch(companyId, searchQuery.trim())\n      setResults(searchResults)\n      setSelectedIndex(0)\n    } catch (error) {\n      console.error('Search error:', error)\n      onShowToast?.('Search failed', 'error')\n    } finally {\n      setLoading(false)\n    }\n  }, [companyId, onShowToast])\n\n  // Handle input change with debounce\n  const handleInputChange = (e) => {\n    const value = e.target.value\n    setQuery(value)\n\n    // Clear previous timeout\n    if (searchTimeoutRef.current) {\n      clearTimeout(searchTimeoutRef.current)\n    }\n\n    // Debounce search\n    searchTimeoutRef.current = setTimeout(() => {\n      performSearch(value)\n    }, 200)\n  }\n\n  // Get all results as flat array for keyboard navigation\n  const getAllResults = () => {\n    const all = []\n    results.projects.forEach(p => all.push({ type: 'project', data: p }))\n    results.tickets.forEach(t => all.push({ type: 'ticket', data: t }))\n    results.cors.forEach(c => all.push({ type: 'cor', data: c }))\n    results.workers.forEach(w => all.push({ type: 'worker', data: w }))\n    return all\n  }\n\n  const allResults = getAllResults()\n  const hasResults = allResults.length > 0\n\n  // Handle keyboard navigation\n  const handleKeyDown = (e) => {\n    if (e.key === 'Escape') {\n      onClose()\n    } else if (e.key === 'ArrowDown') {\n      e.preventDefault()\n      setSelectedIndex(prev => Math.min(prev + 1, allResults.length - 1))\n    } else if (e.key === 'ArrowUp') {\n      e.preventDefault()\n      setSelectedIndex(prev => Math.max(prev - 1, 0))\n    } else if (e.key === 'Enter' && hasResults) {\n      e.preventDefault()\n      handleSelect(allResults[selectedIndex])\n    }\n  }\n\n  // Handle selection\n  const handleSelect = (item) => {\n    if (!item) return\n\n    switch (item.type) {\n      case 'project':\n        onSelectProject?.(item.data)\n        break\n      case 'ticket':\n        onSelectTicket?.(item.data)\n        break\n      case 'cor':\n        onSelectCOR?.(item.data)\n        break\n      case 'worker':\n        // Navigate to project where worker was last seen\n        if (item.data.lastProject) {\n          onSelectProject?.(item.data.lastProject)\n        }\n        break\n    }\n    onClose()\n  }\n\n  // Get icon for result type\n  const getIcon = (type) => {\n    switch (type) {\n      case 'project': return FolderOpen\n      case 'ticket': return FileText\n      case 'cor': return ClipboardList\n      case 'worker': return Users\n      default: return FileText\n    }\n  }\n\n  // Get label for result type\n  const getTypeLabel = (type) => {\n    switch (type) {\n      case 'project': return 'Project'\n      case 'ticket': return 'T&M Ticket'\n      case 'cor': return 'Change Order'\n      case 'worker': return 'Worker'\n      default: return type\n    }\n  }\n\n  if (!isOpen) return null\n\n  return (\n    <div className=\"universal-search-overlay\" onClick={onClose}>\n      <div className=\"universal-search-modal\" onClick={e => e.stopPropagation()}>\n        {/* Search Input */}\n        <div className=\"universal-search-input-wrapper\">\n          <Search size={20} className=\"universal-search-icon\" />\n          <input\n            ref={inputRef}\n            type=\"text\"\n            value={query}\n            onChange={handleInputChange}\n            onKeyDown={handleKeyDown}\n            placeholder=\"Search projects, tickets, CORs, workers...\"\n            className=\"universal-search-input\"\n            autoComplete=\"off\"\n            autoCorrect=\"off\"\n            spellCheck=\"false\"\n          />\n          {query && (\n            <button className=\"universal-search-clear\" onClick={() => setQuery('')}>\n              <X size={16} />\n            </button>\n          )}\n          <div className=\"universal-search-shortcut\">\n            <span>esc</span>\n          </div>\n        </div>\n\n        {/* Results */}\n        <div className=\"universal-search-results\">\n          {loading ? (\n            <div className=\"universal-search-loading\">\n              <div className=\"spinner-small\"></div>\n              <span>Searching...</span>\n            </div>\n          ) : !query.trim() ? (\n            <div className=\"universal-search-empty\">\n              <div className=\"universal-search-tip\">\n                <Command size={14} />\n                <span>Type to search across all data</span>\n              </div>\n              <div className=\"universal-search-hints\">\n                <span>Projects</span>\n                <span>T&M Tickets</span>\n                <span>Change Orders</span>\n                <span>Workers</span>\n              </div>\n            </div>\n          ) : !hasResults ? (\n            <div className=\"universal-search-no-results\">\n              <span>No results for \"{query}\"</span>\n            </div>\n          ) : (\n            <>\n              {/* Projects */}\n              {results.projects.length > 0 && (\n                <div className=\"universal-search-section\">\n                  <div className=\"universal-search-section-header\">\n                    <FolderOpen size={14} />\n                    <span>Projects</span>\n                  </div>\n                  {results.projects.map((project, idx) => {\n                    const globalIdx = idx\n                    return (\n                      <button\n                        key={project.id}\n                        className={`universal-search-item ${selectedIndex === globalIdx ? 'selected' : ''}`}\n                        onClick={() => handleSelect({ type: 'project', data: project })}\n                        onMouseEnter={() => setSelectedIndex(globalIdx)}\n                      >\n                        <FolderOpen size={18} />\n                        <div className=\"universal-search-item-content\">\n                          <span className=\"universal-search-item-title\">{project.name}</span>\n                          {project.job_number && (\n                            <span className=\"universal-search-item-meta\">#{project.job_number}</span>\n                          )}\n                        </div>\n                        <ChevronRight size={16} className=\"universal-search-item-arrow\" />\n                      </button>\n                    )\n                  })}\n                </div>\n              )}\n\n              {/* T&M Tickets */}\n              {results.tickets.length > 0 && (\n                <div className=\"universal-search-section\">\n                  <div className=\"universal-search-section-header\">\n                    <FileText size={14} />\n                    <span>T&M Tickets</span>\n                  </div>\n                  {results.tickets.map((ticket, idx) => {\n                    const globalIdx = results.projects.length + idx\n                    return (\n                      <button\n                        key={ticket.id}\n                        className={`universal-search-item ${selectedIndex === globalIdx ? 'selected' : ''}`}\n                        onClick={() => handleSelect({ type: 'ticket', data: ticket })}\n                        onMouseEnter={() => setSelectedIndex(globalIdx)}\n                      >\n                        <FileText size={18} />\n                        <div className=\"universal-search-item-content\">\n                          <span className=\"universal-search-item-title\">\n                            {ticket.description?.substring(0, 50) || 'T&M Ticket'}\n                            {ticket.description?.length > 50 && '...'}\n                          </span>\n                          <span className=\"universal-search-item-meta\">\n                            {ticket.projectName}  {ticket.work_date}\n                          </span>\n                        </div>\n                        <span className={`universal-search-item-badge ${ticket.status}`}>\n                          {ticket.status}\n                        </span>\n                      </button>\n                    )\n                  })}\n                </div>\n              )}\n\n              {/* Change Orders */}\n              {results.cors.length > 0 && (\n                <div className=\"universal-search-section\">\n                  <div className=\"universal-search-section-header\">\n                    <ClipboardList size={14} />\n                    <span>Change Orders</span>\n                  </div>\n                  {results.cors.map((cor, idx) => {\n                    const globalIdx = results.projects.length + results.tickets.length + idx\n                    return (\n                      <button\n                        key={cor.id}\n                        className={`universal-search-item ${selectedIndex === globalIdx ? 'selected' : ''}`}\n                        onClick={() => handleSelect({ type: 'cor', data: cor })}\n                        onMouseEnter={() => setSelectedIndex(globalIdx)}\n                      >\n                        <ClipboardList size={18} />\n                        <div className=\"universal-search-item-content\">\n                          <span className=\"universal-search-item-title\">\n                            {cor.cor_number ? `COR #${cor.cor_number}: ` : ''}{cor.title}\n                          </span>\n                          <span className=\"universal-search-item-meta\">\n                            {cor.projectName}\n                          </span>\n                        </div>\n                        <span className={`universal-search-item-badge ${cor.status}`}>\n                          {cor.status}\n                        </span>\n                      </button>\n                    )\n                  })}\n                </div>\n              )}\n\n              {/* Workers */}\n              {results.workers.length > 0 && (\n                <div className=\"universal-search-section\">\n                  <div className=\"universal-search-section-header\">\n                    <Users size={14} />\n                    <span>Workers</span>\n                  </div>\n                  {results.workers.map((worker, idx) => {\n                    const globalIdx = results.projects.length + results.tickets.length + results.cors.length + idx\n                    return (\n                      <button\n                        key={`${worker.name}-${idx}`}\n                        className={`universal-search-item ${selectedIndex === globalIdx ? 'selected' : ''}`}\n                        onClick={() => handleSelect({ type: 'worker', data: worker })}\n                        onMouseEnter={() => setSelectedIndex(globalIdx)}\n                      >\n                        <Users size={18} />\n                        <div className=\"universal-search-item-content\">\n                          <span className=\"universal-search-item-title\">{worker.name}</span>\n                          <span className=\"universal-search-item-meta\">\n                            {worker.role}  {worker.projectName}\n                          </span>\n                        </div>\n                        <ChevronRight size={16} className=\"universal-search-item-arrow\" />\n                      </button>\n                    )\n                  })}\n                </div>\n              )}\n            </>\n          )}\n        </div>\n\n        {/* Footer */}\n        <div className=\"universal-search-footer\">\n          <div className=\"universal-search-footer-hint\">\n            <span className=\"key\"></span> navigate\n          </div>\n          <div className=\"universal-search-footer-hint\">\n            <span className=\"key\"></span> select\n          </div>\n          <div className=\"universal-search-footer-hint\">\n            <span className=\"key\">esc</span> close\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\n// Hook for keyboard shortcut\nexport function useUniversalSearch() {\n  const [isOpen, setIsOpen] = useState(false)\n\n  useEffect(() => {\n    const handleKeyDown = (e) => {\n      // Cmd+K (Mac) or Ctrl+K (Windows/Linux)\n      if ((e.metaKey || e.ctrlKey) && e.key === 'k') {\n        e.preventDefault()\n        setIsOpen(prev => !prev)\n      }\n    }\n\n    document.addEventListener('keydown', handleKeyDown)\n    return () => document.removeEventListener('keydown', handleKeyDown)\n  }, [])\n\n  return { isOpen, setIsOpen, open: () => setIsOpen(true), close: () => setIsOpen(false) }\n}\n","import React, { useState, useCallback } from 'react'\nimport { AlertTriangle, XCircle, Info, X, ArrowRight } from 'lucide-react'\n\n/**\n * SmartAlerts\n *\n * Container for displaying prioritized actionable alerts.\n * Alerts can be dismissed and are sorted by priority.\n *\n * @param {array} alerts - Array of alert objects\n * @param {function} onAction - Callback when alert action is clicked\n * @param {function} onDismiss - Callback when alert is dismissed\n * @param {number} maxVisible - Maximum alerts to show (default: 3)\n */\nexport function SmartAlerts({\n  alerts = [],\n  onAction,\n  onDismiss,\n  maxVisible = 3,\n  className = ''\n}) {\n  const [dismissedIds, setDismissedIds] = useState(new Set())\n\n  const visibleAlerts = alerts\n    .filter(alert => !dismissedIds.has(alert.id || `${alert.projectId}-${alert.type}-${alert.title}`))\n    .slice(0, maxVisible)\n\n  const handleDismiss = useCallback((alert) => {\n    const alertId = alert.id || `${alert.projectId}-${alert.type}-${alert.title}`\n    setDismissedIds(prev => new Set([...prev, alertId]))\n    onDismiss?.(alert)\n  }, [onDismiss])\n\n  if (visibleAlerts.length === 0) {\n    return null\n  }\n\n  return (\n    <div\n      className={`smart-alerts ${className}`}\n      role=\"region\"\n      aria-label=\"Project alerts\"\n      aria-live=\"polite\"\n    >\n      {visibleAlerts.map((alert, index) => (\n        <SmartAlertCard\n          key={alert.id || `${alert.projectId}-${alert.type}-${index}`}\n          alert={alert}\n          onAction={onAction}\n          onDismiss={() => handleDismiss(alert)}\n        />\n      ))}\n\n      {alerts.length > maxVisible && (\n        <div className=\"smart-alerts__overflow\">\n          <span className=\"smart-alerts__overflow-text\">\n            +{alerts.length - maxVisible} more alerts\n          </span>\n        </div>\n      )}\n    </div>\n  )\n}\n\n/**\n * SmartAlertCard\n *\n * Individual alert card with icon, message, action, and dismiss.\n *\n * @param {object} alert - Alert object\n * @param {function} onAction - Action button click handler\n * @param {function} onDismiss - Dismiss button click handler\n */\nexport function SmartAlertCard({\n  alert,\n  onAction,\n  onDismiss\n}) {\n  const {\n    type = 'info',\n    title,\n    description,\n    action,\n    actionTarget,\n    projectId,\n    projectName\n  } = alert\n\n  const icons = {\n    critical: XCircle,\n    warning: AlertTriangle,\n    info: Info\n  }\n\n  const Icon = icons[type] || Info\n\n  const handleAction = () => {\n    onAction?.({\n      target: actionTarget,\n      projectId,\n      alert\n    })\n  }\n\n  return (\n    <div\n      className={`smart-alert smart-alert--${type}`}\n      role=\"alert\"\n      aria-live={type === 'critical' ? 'assertive' : 'polite'}\n    >\n      <Icon className=\"smart-alert__icon\" aria-hidden=\"true\" />\n\n      <div className=\"smart-alert__content\">\n        <div className=\"smart-alert__title\">\n          {projectName && <span className=\"smart-alert__project\">{projectName}: </span>}\n          {title}\n        </div>\n\n        {description && (\n          <div className=\"smart-alert__description\">{description}</div>\n        )}\n\n        {action && (\n          <div className=\"smart-alert__action\">\n            <button\n              type=\"button\"\n              className=\"smart-alert__action-btn\"\n              onClick={handleAction}\n            >\n              {action}\n              <ArrowRight size={14} aria-hidden=\"true\" />\n            </button>\n          </div>\n        )}\n      </div>\n\n      {onDismiss && (\n        <button\n          type=\"button\"\n          className=\"smart-alert__dismiss\"\n          onClick={onDismiss}\n          aria-label=\"Dismiss alert\"\n        >\n          <X size={18} aria-hidden=\"true\" />\n        </button>\n      )}\n    </div>\n  )\n}\n\n/**\n * AlertSummaryBanner\n *\n * Compact banner showing alert counts by type.\n * Useful when space is limited.\n *\n * @param {array} alerts - Array of alert objects\n * @param {function} onClick - Click handler to expand alerts\n */\nexport function AlertSummaryBanner({ alerts = [], onClick, className = '' }) {\n  const counts = {\n    critical: alerts.filter(a => a.type === 'critical').length,\n    warning: alerts.filter(a => a.type === 'warning').length,\n    info: alerts.filter(a => a.type === 'info').length\n  }\n\n  const total = alerts.length\n\n  if (total === 0) return null\n\n  return (\n    <button\n      type=\"button\"\n      className={`alert-summary-banner ${className}`}\n      onClick={onClick}\n      aria-label={`${total} alerts: ${counts.critical} critical, ${counts.warning} warnings, ${counts.info} info. Click to view.`}\n    >\n      {counts.critical > 0 && (\n        <span className=\"alert-summary-banner__item alert-summary-banner__item--critical\">\n          <XCircle size={14} aria-hidden=\"true\" />\n          {counts.critical}\n        </span>\n      )}\n      {counts.warning > 0 && (\n        <span className=\"alert-summary-banner__item alert-summary-banner__item--warning\">\n          <AlertTriangle size={14} aria-hidden=\"true\" />\n          {counts.warning}\n        </span>\n      )}\n      {counts.info > 0 && (\n        <span className=\"alert-summary-banner__item alert-summary-banner__item--info\">\n          <Info size={14} aria-hidden=\"true\" />\n          {counts.info}\n        </span>\n      )}\n      <ArrowRight size={14} className=\"alert-summary-banner__arrow\" aria-hidden=\"true\" />\n    </button>\n  )\n}\n\n/**\n * NoAlertsMessage\n *\n * Positive message when there are no alerts.\n */\nexport function NoAlertsMessage({ className = '' }) {\n  return (\n    <div className={`no-alerts-message ${className}`}>\n      <span className=\"no-alerts-message__icon\" aria-hidden=\"true\"></span>\n      <span className=\"no-alerts-message__text\">All projects on track</span>\n    </div>\n  )\n}\n\n/**\n * Helper to aggregate alerts from multiple projects\n */\nexport function aggregateAlerts(projectAlerts) {\n  // Flatten all alerts from all projects\n  const allAlerts = projectAlerts.flatMap(p => p.alerts || [])\n\n  // Sort by priority\n  const priorityOrder = { critical: 0, warning: 1, info: 2 }\n  allAlerts.sort((a, b) => {\n    const priorityDiff = priorityOrder[a.type] - priorityOrder[b.type]\n    if (priorityDiff !== 0) return priorityDiff\n    // Secondary sort by project name\n    return (a.projectName || '').localeCompare(b.projectName || '')\n  })\n\n  return allAlerts\n}\n\nexport default SmartAlerts\n","import { useState, useEffect } from 'react'\nimport { HardHat } from 'lucide-react'\nimport { db } from '../lib/supabase'\n\nexport default function ManDayCosts({ project, company, onShowToast }) {\n  const [costData, setCostData] = useState(null)\n  const [loading, setLoading] = useState(true)\n  const [expanded, setExpanded] = useState(false)\n\n  useEffect(() => {\n    if (project?.id && company?.id) {\n      loadCostData()\n\n      // Subscribe to crew check-in updates for real-time cost updates\n      const subscription = db.subscribeToCrewCheckins?.(project.id, () => {\n        loadCostData()\n      })\n\n      return () => {\n        if (subscription) db.unsubscribe?.(subscription)\n      }\n    }\n  }, [project?.id, company?.id])\n\n  const loadCostData = async () => {\n    try {\n      const data = await db.calculateManDayCosts(\n        project.id,\n        company.id,\n        project.work_type || 'demolition',\n        project.job_type || 'standard'\n      )\n      setCostData(data)\n    } catch (error) {\n      console.error('Error loading man day costs:', error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const formatCurrency = (amount) => {\n    return new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD',\n      minimumFractionDigits: 0,\n      maximumFractionDigits: 0\n    }).format(amount)\n  }\n\n  const formatDate = (dateStr) => {\n    return new Date(dateStr).toLocaleDateString('en-US', {\n      month: 'short',\n      day: 'numeric'\n    })\n  }\n\n  const getRoleLabel = (role) => {\n    const labels = {\n      foreman: 'Foreman',\n      supervisor: 'Supervisor',\n      operator: 'Operator',\n      laborer: 'Laborer'\n    }\n    return labels[role] || role.charAt(0).toUpperCase() + role.slice(1)\n  }\n\n  if (loading) {\n    return (\n      <div className=\"man-day-costs card\">\n        <div className=\"man-day-header\">\n          <h3>Man Day Costs</h3>\n        </div>\n        <div className=\"loading\">Loading...</div>\n      </div>\n    )\n  }\n\n  if (!costData || costData.totalManDays === 0) {\n    return (\n      <div className=\"man-day-costs card\">\n        <div className=\"man-day-header\">\n          <h3>Man Day Costs</h3>\n        </div>\n        <div className=\"man-day-empty\">\n          <span className=\"empty-icon\"><HardHat size={32} /></span>\n          <p>No crew check-ins yet</p>\n          <small>Costs will appear as crew checks in from the field</small>\n        </div>\n      </div>\n    )\n  }\n\n  const roleEntries = Object.entries(costData.byRole || {})\n\n  return (\n    <div className=\"man-day-costs card\">\n      <div className=\"man-day-header\" onClick={() => setExpanded(!expanded)}>\n        <div className=\"man-day-title-row\">\n          <h3>Man Day Costs</h3>\n          <span className=\"man-day-total\">{formatCurrency(costData.totalCost)}</span>\n        </div>\n        <button className=\"man-day-toggle\">\n          {expanded ? ' Collapse' : ' Details'}\n        </button>\n      </div>\n\n      {/* Summary Stats */}\n      <div className=\"man-day-summary\">\n        <div className=\"man-day-stat\">\n          <span className=\"stat-value\">{costData.daysWorked}</span>\n          <span className=\"stat-label\">Days Worked</span>\n        </div>\n        <div className=\"man-day-stat\">\n          <span className=\"stat-value\">{costData.totalManDays}</span>\n          <span className=\"stat-label\">Total Man Days</span>\n        </div>\n        <div className=\"man-day-stat\">\n          <span className=\"stat-value\">{formatCurrency(costData.totalCost)}</span>\n          <span className=\"stat-label\">Total Labor Cost</span>\n        </div>\n        <div className=\"man-day-stat\">\n          <span className=\"stat-value\">\n            {costData.daysWorked > 0\n              ? formatCurrency(costData.totalCost / costData.daysWorked)\n              : '$0'\n            }\n          </span>\n          <span className=\"stat-label\">Avg Cost/Day</span>\n        </div>\n      </div>\n\n      {/* Expanded Details */}\n      {expanded && (\n        <div className=\"man-day-details\">\n          {/* By Role Breakdown */}\n          {roleEntries.length > 0 && (\n            <div className=\"man-day-section\">\n              <h4>By Role</h4>\n              <div className=\"man-day-role-list\">\n                {roleEntries.map(([role, data]) => (\n                  <div key={role} className=\"man-day-role-row\">\n                    <div className=\"role-info\">\n                      <span className=\"role-name\">{getRoleLabel(role)}</span>\n                      <span className=\"role-rate\">{formatCurrency(data.rate)}/day</span>\n                    </div>\n                    <div className=\"role-stats\">\n                      <span className=\"role-count\">{data.count} days</span>\n                      <span className=\"role-cost\">{formatCurrency(data.cost)}</span>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {/* Recent Days */}\n          {costData.byDate?.length > 0 && (\n            <div className=\"man-day-section\">\n              <h4>Recent Activity</h4>\n              <div className=\"man-day-date-list\">\n                {costData.byDate.slice(0, 7).map((day, idx) => (\n                  <div key={idx} className=\"man-day-date-row\">\n                    <span className=\"date-label\">{formatDate(day.date)}</span>\n                    <span className=\"date-workers\">{day.workers} crew</span>\n                    <span className=\"date-cost\">{formatCurrency(day.cost)}</span>\n                  </div>\n                ))}\n              </div>\n              {costData.byDate.length > 7 && (\n                <p className=\"man-day-more\">\n                  + {costData.byDate.length - 7} more days\n                </p>\n              )}\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n","import { useState, useEffect, useCallback, useMemo, memo } from 'react'\nimport { FileSpreadsheet, Plus, ChevronRight, Clock, CheckCircle2, DollarSign, TrendingUp } from 'lucide-react'\nimport { drawRequestOps } from '../../lib/supabase'\nimport { formatCurrency } from '../../lib/corCalculations'\n\n/**\n * ProgressBillingCard - Summary card for progress billing / draw requests\n *\n * Shows:\n * - Contract summary (original + COs = revised)\n * - Billing progress (billed to date, retention held)\n * - Quick action to create new draw request\n * - Recent draw requests\n */\nexport default memo(function ProgressBillingCard({\n  project,\n  areas = [],\n  corStats = {},\n  onCreateDraw,\n  onViewDraw,\n  onShowToast\n}) {\n  const [drawRequests, setDrawRequests] = useState([])\n  const [loading, setLoading] = useState(true)\n\n  // Calculate contract values\n  const originalContract = useMemo(() => {\n    return areas.reduce((sum, area) => {\n      const value = (area.square_footage || 0) * (area.price_per_sqft || 0)\n      return sum + Math.round(value * 100) // Convert to cents\n    }, 0)\n  }, [areas])\n\n  const approvedCOs = useMemo(() => {\n    return (corStats?.approvedTotal || 0)\n  }, [corStats?.approvedTotal])\n\n  const revisedContract = originalContract + approvedCOs\n\n  // Load draw requests\n  const loadDrawRequests = useCallback(async () => {\n    if (!project?.id) return\n\n    try {\n      setLoading(true)\n      const data = await drawRequestOps.getProjectDrawRequests(project.id)\n      setDrawRequests(data || [])\n    } catch (error) {\n      console.error('Error loading draw requests:', error)\n    } finally {\n      setLoading(false)\n    }\n  }, [project?.id])\n\n  useEffect(() => {\n    loadDrawRequests()\n  }, [loadDrawRequests])\n\n  // Calculate billing totals from draw requests\n  const billingTotals = useMemo(() => {\n    const completedDraws = drawRequests.filter(dr =>\n      ['submitted', 'approved', 'paid'].includes(dr.status)\n    )\n\n    const billedToDate = completedDraws.reduce((sum, dr) =>\n      sum + (dr.previous_billings || 0) + (dr.current_billing || 0), 0\n    )\n\n    // Get the most recent retention amount\n    const latestDraw = completedDraws[0]\n    const retentionHeld = latestDraw?.retention_held || 0\n\n    return { billedToDate, retentionHeld }\n  }, [drawRequests])\n\n  const progress = revisedContract > 0\n    ? Math.round((billingTotals.billedToDate / revisedContract) * 100)\n    : 0\n\n  const nextDrawNumber = drawRequests.length > 0\n    ? Math.max(...drawRequests.map(dr => dr.draw_number)) + 1\n    : 1\n\n  const formatDate = (dateStr) => {\n    if (!dateStr) return ''\n    return new Date(dateStr).toLocaleDateString('en-US', {\n      month: 'short',\n      day: 'numeric'\n    })\n  }\n\n  const getStatusBadge = (status) => {\n    switch (status) {\n      case 'draft':\n        return <span className=\"badge badge-muted\">Draft</span>\n      case 'submitted':\n        return <span className=\"badge badge-warning\">Submitted</span>\n      case 'approved':\n        return <span className=\"badge badge-success\">Approved</span>\n      case 'paid':\n        return <span className=\"badge badge-info\">Paid</span>\n      case 'rejected':\n        return <span className=\"badge badge-danger\">Rejected</span>\n      default:\n        return null\n    }\n  }\n\n  return (\n    <div className=\"progress-billing-card\">\n      <div className=\"progress-billing-header\">\n        <div className=\"progress-billing-title\">\n          <FileSpreadsheet size={18} />\n          <h3>Progress Billing</h3>\n        </div>\n        <button\n          className=\"btn btn-sm btn-primary\"\n          onClick={() => onCreateDraw?.()}\n          disabled={originalContract === 0}\n          title={originalContract === 0 ? 'Add areas with contract values first' : `Create Draw #${nextDrawNumber}`}\n        >\n          <Plus size={14} />\n          <span>Draw #{nextDrawNumber}</span>\n        </button>\n      </div>\n\n      {/* Contract Summary */}\n      <div className=\"progress-billing-contract\">\n        <div className=\"contract-row\">\n          <span className=\"contract-label\">Original Contract</span>\n          <span className=\"contract-value\">{formatCurrency(originalContract)}</span>\n        </div>\n        {approvedCOs > 0 && (\n          <div className=\"contract-row co\">\n            <span className=\"contract-label\">Approved COs</span>\n            <span className=\"contract-value positive\">+{formatCurrency(approvedCOs)}</span>\n          </div>\n        )}\n        <div className=\"contract-row revised\">\n          <span className=\"contract-label\">Revised Contract</span>\n          <span className=\"contract-value\">{formatCurrency(revisedContract)}</span>\n        </div>\n      </div>\n\n      {/* Billing Progress */}\n      <div className=\"progress-billing-status\">\n        <div className=\"billing-progress-bar\">\n          <div\n            className=\"billing-progress-fill\"\n            style={{ width: `${Math.min(progress, 100)}%` }}\n          />\n        </div>\n        <div className=\"billing-stats\">\n          <div className=\"billing-stat\">\n            <span className=\"billing-stat-value\">{formatCurrency(billingTotals.billedToDate)}</span>\n            <span className=\"billing-stat-label\">Billed to Date ({progress}%)</span>\n          </div>\n          {billingTotals.retentionHeld > 0 && (\n            <div className=\"billing-stat retention\">\n              <span className=\"billing-stat-value\">-{formatCurrency(billingTotals.retentionHeld)}</span>\n              <span className=\"billing-stat-label\">Retention Held</span>\n            </div>\n          )}\n          <div className=\"billing-stat remaining\">\n            <span className=\"billing-stat-value\">{formatCurrency(revisedContract - billingTotals.billedToDate)}</span>\n            <span className=\"billing-stat-label\">Balance to Finish</span>\n          </div>\n        </div>\n      </div>\n\n      {/* Recent Draw Requests */}\n      {loading ? (\n        <div className=\"progress-billing-loading\">\n          <div className=\"loading-spinner small\" />\n        </div>\n      ) : drawRequests.length === 0 ? (\n        <div className=\"progress-billing-empty\">\n          <p>No draw requests yet</p>\n          {originalContract > 0 && (\n            <button\n              className=\"btn btn-sm btn-outline\"\n              onClick={() => onCreateDraw?.()}\n            >\n              <Plus size={14} />\n              Create First Draw Request\n            </button>\n          )}\n        </div>\n      ) : (\n        <div className=\"progress-billing-draws\">\n          <div className=\"draws-header\">\n            <span>Recent Draws</span>\n          </div>\n          <div className=\"draws-list\">\n            {drawRequests.slice(0, 3).map(dr => (\n              <button\n                key={dr.id}\n                className=\"draw-item\"\n                onClick={() => onViewDraw?.(dr)}\n              >\n                <div className=\"draw-item-info\">\n                  <span className=\"draw-number\">Draw #{dr.draw_number}</span>\n                  <span className=\"draw-date\">{formatDate(dr.period_end || dr.created_at)}</span>\n                </div>\n                <div className=\"draw-item-amount\">\n                  {formatCurrency(dr.current_billing || 0)}\n                </div>\n                {getStatusBadge(dr.status)}\n                <ChevronRight size={16} className=\"draw-item-arrow\" />\n              </button>\n            ))}\n          </div>\n          {drawRequests.length > 3 && (\n            <button className=\"btn btn-sm btn-ghost view-all-draws\">\n              View all {drawRequests.length} draws\n            </button>\n          )}\n        </div>\n      )}\n    </div>\n  )\n})\n","import { useState, useEffect, useCallback, useMemo, memo } from 'react'\nimport { Truck, Plus, Calendar, DollarSign, RotateCcw, ChevronDown, ChevronUp, Edit2, Trash2 } from 'lucide-react'\nimport { equipmentOps } from '../../lib/supabase'\nimport { formatCurrency } from '../../lib/corCalculations'\n\n// Helper function - defined outside component to avoid recreation\nconst formatDate = (dateStr) => {\n  if (!dateStr) return ''\n  return new Date(dateStr).toLocaleDateString('en-US', {\n    month: 'short',\n    day: 'numeric'\n  })\n}\n\n/**\n * ProjectEquipmentCard - Equipment tracking card for Financials Overview\n *\n * Shows equipment currently on site with daily rates and costs.\n * Allows adding new equipment and marking equipment as returned.\n */\nexport default memo(function ProjectEquipmentCard({\n  project,\n  onAddEquipment,\n  onEditEquipment,\n  onShowToast\n}) {\n  const [projectEquipment, setProjectEquipment] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [expanded, setExpanded] = useState(true)\n  const [totalCost, setTotalCost] = useState(0)\n\n  // Memoized load function to avoid stale closures\n  const loadEquipment = useCallback(async () => {\n    if (!project?.id) return\n\n    try {\n      setLoading(true)\n      const data = await equipmentOps.getProjectEquipment(project.id)\n      setProjectEquipment(data || [])\n\n      // Calculate total cost\n      const cost = equipmentOps.calculateProjectEquipmentCost(data || [])\n      setTotalCost(cost)\n    } catch (error) {\n      console.error('Error loading equipment:', error)\n      onShowToast?.('Failed to load equipment', 'error')\n    } finally {\n      setLoading(false)\n    }\n  }, [project?.id]) // onShowToast is stable (memoized in App.jsx)\n\n  // Load project equipment when project changes\n  useEffect(() => {\n    loadEquipment()\n  }, [loadEquipment])\n\n  const handleMarkReturned = useCallback(async (equipmentItem) => {\n    try {\n      await equipmentOps.markEquipmentReturned(equipmentItem.id)\n      onShowToast?.(`${equipmentItem.equipment_name} marked as returned`, 'success')\n      loadEquipment()\n    } catch (error) {\n      console.error('Error marking equipment returned:', error)\n      onShowToast?.('Failed to update equipment', 'error')\n    }\n  }, [loadEquipment]) // onShowToast is stable\n\n  const handleDelete = useCallback(async (equipmentItem) => {\n    if (!confirm(`Remove ${equipmentItem.equipment_name} from this project?`)) {\n      return\n    }\n\n    try {\n      await equipmentOps.removeEquipmentFromProject(equipmentItem.id)\n      onShowToast?.('Equipment removed', 'success')\n      loadEquipment()\n    } catch (error) {\n      console.error('Error removing equipment:', error)\n      onShowToast?.('Failed to remove equipment', 'error')\n    }\n  }, [loadEquipment]) // onShowToast is stable\n\n  // Memoize derived state to avoid recalculating on every render\n  const activeEquipment = useMemo(\n    () => projectEquipment.filter(e => !e.end_date),\n    [projectEquipment]\n  )\n\n  const returnedEquipment = useMemo(\n    () => projectEquipment.filter(e => e.end_date),\n    [projectEquipment]\n  )\n\n  return (\n    <div className=\"project-equipment-card\">\n      <div className=\"project-equipment-header\">\n        <div className=\"project-equipment-title\">\n          <Truck size={18} />\n          <h3>Equipment on Site</h3>\n          {projectEquipment.length > 0 && (\n            <span className=\"equipment-count\">{activeEquipment.length} active</span>\n          )}\n        </div>\n        <div className=\"project-equipment-actions\">\n          <button\n            className=\"btn btn-sm btn-primary\"\n            onClick={() => onAddEquipment?.()}\n            title=\"Add equipment\"\n          >\n            <Plus size={14} />\n            <span>Add</span>\n          </button>\n          {projectEquipment.length > 0 && (\n            <button\n              className=\"btn btn-sm btn-ghost\"\n              onClick={() => setExpanded(!expanded)}\n            >\n              {expanded ? <ChevronUp size={16} /> : <ChevronDown size={16} />}\n            </button>\n          )}\n        </div>\n      </div>\n\n      {loading ? (\n        <div className=\"equipment-loading\">\n          <div className=\"loading-spinner small\" />\n        </div>\n      ) : projectEquipment.length === 0 ? (\n        <div className=\"equipment-empty\">\n          <p>No equipment tracked on this project</p>\n          <button\n            className=\"btn btn-sm btn-outline\"\n            onClick={() => onAddEquipment?.()}\n          >\n            <Plus size={14} />\n            Track Equipment\n          </button>\n        </div>\n      ) : expanded ? (\n        <>\n          {/* Active Equipment */}\n          {activeEquipment.length > 0 && (\n            <div className=\"equipment-list\">\n              {activeEquipment.map(item => {\n                const days = equipmentOps.calculateDaysOnSite(item.start_date, item.end_date)\n                const cost = item.daily_rate * days\n\n                return (\n                  <div key={item.id} className=\"equipment-item active\">\n                    <div className=\"equipment-item-main\">\n                      <div className=\"equipment-item-info\">\n                        <span className=\"equipment-name\">{item.equipment_name}</span>\n                        <span className=\"equipment-meta\">\n                          <Calendar size={12} />\n                          On-site since {formatDate(item.start_date)}\n                        </span>\n                      </div>\n                      <div className=\"equipment-item-cost\">\n                        <span className=\"equipment-rate\">\n                          {formatCurrency(item.daily_rate)}/day\n                        </span>\n                        <span className=\"equipment-days\">{days} days</span>\n                        <span className=\"equipment-total\">{formatCurrency(cost)}</span>\n                      </div>\n                    </div>\n                    <div className=\"equipment-item-actions\">\n                      <button\n                        className=\"btn btn-xs btn-outline\"\n                        onClick={() => handleMarkReturned(item)}\n                        title=\"Mark as returned\"\n                      >\n                        <RotateCcw size={12} />\n                        Returned\n                      </button>\n                      <button\n                        className=\"btn btn-xs btn-ghost\"\n                        onClick={() => onEditEquipment?.(item)}\n                        title=\"Edit\"\n                      >\n                        <Edit2 size={12} />\n                      </button>\n                      <button\n                        className=\"btn btn-xs btn-ghost text-danger\"\n                        onClick={() => handleDelete(item)}\n                        title=\"Remove\"\n                      >\n                        <Trash2 size={12} />\n                      </button>\n                    </div>\n                  </div>\n                )\n              })}\n            </div>\n          )}\n\n          {/* Returned Equipment (collapsed by default) */}\n          {returnedEquipment.length > 0 && (\n            <details className=\"equipment-returned-section\">\n              <summary className=\"equipment-returned-toggle\">\n                <span>Returned Equipment ({returnedEquipment.length})</span>\n              </summary>\n              <div className=\"equipment-list returned\">\n                {returnedEquipment.map(item => {\n                  const days = equipmentOps.calculateDaysOnSite(item.start_date, item.end_date)\n                  const cost = item.daily_rate * days\n\n                  return (\n                    <div key={item.id} className=\"equipment-item returned\">\n                      <div className=\"equipment-item-main\">\n                        <div className=\"equipment-item-info\">\n                          <span className=\"equipment-name\">{item.equipment_name}</span>\n                          <span className=\"equipment-meta\">\n                            {formatDate(item.start_date)} - {formatDate(item.end_date)}\n                          </span>\n                        </div>\n                        <div className=\"equipment-item-cost\">\n                          <span className=\"equipment-days\">{days} days</span>\n                          <span className=\"equipment-total\">{formatCurrency(cost)}</span>\n                        </div>\n                      </div>\n                    </div>\n                  )\n                })}\n              </div>\n            </details>\n          )}\n\n          {/* Total */}\n          <div className=\"equipment-total-row\">\n            <span>Total Equipment Cost</span>\n            <span className=\"equipment-grand-total\">{formatCurrency(totalCost)}</span>\n          </div>\n        </>\n      ) : (\n        <div className=\"equipment-summary-collapsed\">\n          <span>{activeEquipment.length} active, {returnedEquipment.length} returned</span>\n          <span className=\"equipment-grand-total\">{formatCurrency(totalCost)}</span>\n        </div>\n      )}\n    </div>\n  )\n})\n","import { useState } from 'react'\nimport { TrendingUp, TrendingDown, Minus, ChevronDown, ChevronUp, Flame } from 'lucide-react'\n\n// Helper to format currency\nconst formatCurrency = (amount) => {\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD',\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0\n  }).format(amount || 0)\n}\n\n// Helper to format date\nconst formatDate = (dateStr) => {\n  return new Date(dateStr).toLocaleDateString('en-US', {\n    month: 'short',\n    day: 'numeric'\n  })\n}\n\nexport default function BurnRateCard({\n  dailyBurn,\n  totalBurn,\n  daysWorked,\n  laborCost,\n  materialsEquipmentCost = 0,\n  progress,\n  contractValue,\n  laborByDate = [],\n  materialsEquipmentByDate = []\n}) {\n  const [expanded, setExpanded] = useState(false)\n\n  // Calculate burn status relative to progress\n  const expectedBurnAtProgress = contractValue * (progress / 100) * 0.6 // Assume 60% cost ratio as healthy\n  const burnStatus = totalBurn <= expectedBurnAtProgress ? 'on-budget' : totalBurn <= expectedBurnAtProgress * 1.2 ? 'warning' : 'over-budget'\n\n  const statusLabel = {\n    'on-budget': 'On Budget',\n    'warning': 'Watch Closely',\n    'over-budget': 'Over Budget'\n  }[burnStatus]\n\n  const StatusIcon = burnStatus === 'on-budget' ? TrendingDown : burnStatus === 'warning' ? Minus : TrendingUp\n\n  // Calculate projected total cost at completion\n  const burnPerProgress = progress > 0 ? totalBurn / (progress / 100) : 0\n  const projectedTotalCost = burnPerProgress\n\n  // Merge labor and materials/equipment by date for combined view\n  const combinedByDate = []\n  const dateMap = {}\n\n  laborByDate.forEach(day => {\n    if (!dateMap[day.date]) {\n      dateMap[day.date] = { date: day.date, labor: 0, materialsEquipment: 0, total: 0 }\n    }\n    dateMap[day.date].labor = day.cost || 0\n    dateMap[day.date].total += day.cost || 0\n  })\n\n  materialsEquipmentByDate.forEach(day => {\n    if (!dateMap[day.date]) {\n      dateMap[day.date] = { date: day.date, labor: 0, materialsEquipment: 0, total: 0 }\n    }\n    dateMap[day.date].materialsEquipment = day.cost || 0\n    dateMap[day.date].total += day.cost || 0\n  })\n\n  Object.values(dateMap)\n    .sort((a, b) => new Date(b.date) - new Date(a.date))\n    .slice(0, 10)\n    .forEach(d => combinedByDate.push(d))\n\n  // Max daily cost for bar sizing\n  const maxDailyCost = Math.max(...combinedByDate.map(d => d.total), 1)\n\n  return (\n    <div className=\"burn-rate-card\">\n      <div className=\"burn-rate-header\">\n        <div className=\"burn-rate-title\">\n          <Flame size={18} className=\"burn-icon\" />\n          <h3>Burn Rate</h3>\n        </div>\n        <div className={`burn-status ${burnStatus}`}>\n          <StatusIcon size={14} />\n          <span>{statusLabel}</span>\n        </div>\n      </div>\n\n      <div className=\"burn-rate-hero\">\n        <div className=\"burn-rate-main\">\n          <span className=\"burn-rate-value\">{formatCurrency(dailyBurn)}</span>\n          <span className=\"burn-rate-unit\">/day</span>\n        </div>\n        {daysWorked > 0 && (\n          <div className=\"burn-rate-context\">\n            Based on {daysWorked} work day{daysWorked !== 1 ? 's' : ''}\n          </div>\n        )}\n      </div>\n\n      <div className=\"burn-rate-summary\">\n        <div className=\"burn-summary-item\">\n          <span className=\"burn-summary-label\">Total Spent</span>\n          <span className=\"burn-summary-value\">{formatCurrency(totalBurn)}</span>\n        </div>\n        <div className=\"burn-summary-divider\"></div>\n        <div className=\"burn-summary-item\">\n          <span className=\"burn-summary-label\">Labor</span>\n          <span className=\"burn-summary-value\">{formatCurrency(laborCost)}</span>\n        </div>\n        <div className=\"burn-summary-divider\"></div>\n        <div className=\"burn-summary-item\">\n          <span className=\"burn-summary-label\">Materials</span>\n          <span className=\"burn-summary-value\">{formatCurrency(materialsEquipmentCost)}</span>\n        </div>\n      </div>\n\n      {progress > 0 && (\n        <div className=\"burn-projection\">\n          <span className=\"projection-label\">Projected at completion:</span>\n          <span className={`projection-value ${projectedTotalCost > contractValue * 0.7 ? 'warning' : ''}`}>\n            {formatCurrency(projectedTotalCost)}\n          </span>\n        </div>\n      )}\n\n      {combinedByDate.length > 0 && (\n        <button\n          className=\"burn-rate-expand\"\n          onClick={() => setExpanded(!expanded)}\n        >\n          {expanded ? <ChevronUp size={16} /> : <ChevronDown size={16} />}\n          <span>{expanded ? 'Hide' : 'View'} Daily Breakdown</span>\n        </button>\n      )}\n\n      {expanded && combinedByDate.length > 0 && (\n        <div className=\"burn-rate-details\">\n          <div className=\"burn-details-header\">\n            <span>Date</span>\n            <span>Labor</span>\n            <span>Materials</span>\n            <span>Total</span>\n          </div>\n          {combinedByDate.map(day => (\n            <div key={day.date} className=\"burn-details-row\">\n              <span className=\"burn-date\">{formatDate(day.date)}</span>\n              <span className=\"burn-labor\">{day.labor > 0 ? formatCurrency(day.labor) : '-'}</span>\n              <span className=\"burn-materials\">{day.materialsEquipment > 0 ? formatCurrency(day.materialsEquipment) : '-'}</span>\n              <span className=\"burn-total\">\n                <span className=\"burn-bar\" style={{ width: `${(day.total / maxDailyCost) * 100}%` }}></span>\n                <span className=\"burn-amount\">{formatCurrency(day.total)}</span>\n              </span>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  )\n}\n","// ============================================\n// Chart Configuration\n// ============================================\n// Centralized theme colors, animations, and styles\n// for all financial dashboard charts.\n// ============================================\n\n// Chart color palette - matches app theme\nexport const chartColors = {\n  // Financial lines\n  contract: '#3b82f6',     // Blue - contract ceiling\n  revenue: '#10b981',      // Green - earned revenue\n  costs: '#f59e0b',        // Amber - spending\n  profit: '#22c55e',       // Emerald - positive profit\n  loss: '#ef4444',         // Red - negative/loss\n\n  // Extra work\n  tmValue: '#8b5cf6',      // Purple - T&M ticket value\n  corValue: '#14b8a6',     // Teal - COR approved value\n\n  // Cost categories\n  labor: '#6366f1',        // Indigo\n  disposal: '#14b8a6',     // Teal\n  equipment: '#f97316',    // Orange\n  materials: '#a855f7',    // Purple\n  subcontractor: '#ec4899', // Pink\n  other: '#6b7280',        // Gray\n\n  // UI\n  grid: 'var(--border-color)',\n  text: 'var(--text-secondary)',\n  background: 'var(--bg-card)',\n}\n\n// Animation configuration\nexport const animationConfig = {\n  duration: 800,\n  easing: 'ease-out',\n}\n\n// Common tooltip styles\nexport const tooltipStyle = {\n  contentStyle: {\n    background: 'var(--bg-card)',\n    border: '1px solid var(--border-color)',\n    borderRadius: '8px',\n    boxShadow: '0 4px 12px rgba(0,0,0,0.15)',\n    padding: '12px 16px',\n  },\n  labelStyle: {\n    color: 'var(--text-primary)',\n    fontWeight: 600,\n    marginBottom: '8px',\n  },\n  itemStyle: {\n    color: 'var(--text-secondary)',\n    padding: '2px 0',\n  },\n}\n\n// Cost category configuration\nexport const costCategories = {\n  labor: {\n    label: 'Labor',\n    color: chartColors.labor,\n    icon: 'HardHat',\n  },\n  disposal: {\n    label: 'Disposal',\n    color: chartColors.disposal,\n    icon: 'Trash2',\n  },\n  equipment: {\n    label: 'Equipment',\n    color: chartColors.equipment,\n    icon: 'Truck',\n  },\n  materials: {\n    label: 'Materials',\n    color: chartColors.materials,\n    icon: 'Package',\n  },\n  subcontractor: {\n    label: 'Subcontractor',\n    color: chartColors.subcontractor,\n    icon: 'Users',\n  },\n  other: {\n    label: 'Other',\n    color: chartColors.other,\n    icon: 'MoreHorizontal',\n  },\n}\n\n// Time range options for charts\nexport const timeRanges = [\n  { id: '7d', label: '7D', days: 7 },\n  { id: '30d', label: '30D', days: 30 },\n  { id: '90d', label: '90D', days: 90 },\n  { id: 'all', label: 'All', days: null },\n]\n\n// Format currency for chart labels\nexport const formatChartCurrency = (value) => {\n  if (value >= 1000000) {\n    return `$${(value / 1000000).toFixed(1)}M`\n  }\n  if (value >= 1000) {\n    return `$${(value / 1000).toFixed(0)}K`\n  }\n  return `$${value.toFixed(0)}`\n}\n\n// Format date for chart axis\nexport const formatChartDate = (dateStr) => {\n  const date = new Date(dateStr)\n  return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })\n}\n\n// Gradient definitions for area charts\nexport const gradientDefs = {\n  revenue: {\n    id: 'revenueGradient',\n    color: chartColors.revenue,\n    startOpacity: 0.3,\n    endOpacity: 0,\n  },\n  costs: {\n    id: 'costsGradient',\n    color: chartColors.costs,\n    startOpacity: 0.3,\n    endOpacity: 0,\n  },\n  tmValue: {\n    id: 'tmValueGradient',\n    color: chartColors.tmValue,\n    startOpacity: 0.2,\n    endOpacity: 0,\n  },\n}\n","// ============================================\n// Chart Data Transformations\n// ============================================\n// Utilities to transform Dashboard.jsx data into\n// chart-friendly formats for Recharts.\n// ============================================\n\nimport { chartColors, costCategories } from '../components/charts/chartConfig'\n\n/**\n * Build cumulative time-series for the Financial Trend Chart\n * Merges labor, disposal, materials/equipment, T&M, and COR data by date\n * Uses actual area completion dates for revenue tracking\n *\n * @param {Object} projectData - Computed project data from Dashboard\n * @param {Object} project - Selected project\n * @param {Array} tmTickets - T&M tickets for the project\n * @param {Object} corStats - COR statistics\n * @param {Array} areas - Project areas with completion dates\n * @returns {Array} Chart-ready data points\n */\nexport function buildFinancialTimeSeries(projectData, project, tmTickets = [], corStats = null, areas = []) {\n  const contractValue = project?.contract_value || 0\n  const laborByDate = projectData?.laborByDate || []\n  const haulOffByDate = projectData?.haulOffByDate || []\n  const materialsEquipmentByDate = projectData?.materialsEquipmentByDate || []\n  const customCosts = projectData?.customCosts || []\n\n  // Collect all unique dates from all sources\n  const dateSet = new Set()\n\n  laborByDate.forEach(d => dateSet.add(d.date))\n  haulOffByDate.forEach(d => dateSet.add(d.date))\n  materialsEquipmentByDate.forEach(d => dateSet.add(d.date))\n  customCosts.forEach(c => {\n    if (c.cost_date) dateSet.add(c.cost_date)\n  })\n\n  // Add T&M ticket dates\n  tmTickets.forEach(t => {\n    if (t.work_date) dateSet.add(t.work_date)\n    if (t.ticket_date) dateSet.add(t.ticket_date)\n    if (t.created_at) dateSet.add(t.created_at.split('T')[0])\n  })\n\n  // Add area completion dates (for revenue tracking)\n  areas.forEach(area => {\n    if (area.status === 'done' && area.updated_at) {\n      dateSet.add(area.updated_at.split('T')[0])\n    }\n  })\n\n  // Sort dates chronologically\n  const sortedDates = [...dateSet].sort((a, b) => new Date(a) - new Date(b))\n\n  if (sortedDates.length === 0) {\n    return []\n  }\n\n  // Build revenue by date based on completed areas\n  // Each completed area contributes its weight/value to revenue on its completion date\n  const revenueByDate = {}\n  const totalWeight = areas.reduce((sum, a) => sum + (parseFloat(a.weight) || 0), 0)\n\n  areas.forEach(area => {\n    if (area.status === 'done' && area.updated_at) {\n      const completionDate = area.updated_at.split('T')[0]\n      const areaWeight = parseFloat(area.weight) || 0\n      // Calculate area's contribution to revenue\n      // If scheduled_value exists (SOV), use that; otherwise calculate from weight\n      const areaValue = area.scheduled_value\n        ? parseFloat(area.scheduled_value)\n        : (totalWeight > 0 ? (areaWeight / totalWeight) * contractValue : 0)\n\n      if (!revenueByDate[completionDate]) {\n        revenueByDate[completionDate] = 0\n      }\n      revenueByDate[completionDate] += areaValue\n    }\n  })\n\n  // Build cumulative data\n  let cumulativeCost = 0\n  let cumulativeTMValue = 0\n  let cumulativeCORValue = 0\n\n  // Pre-calculate T&M values by date\n  // Use the actual property names from the database: t_and_m_workers, t_and_m_items\n  const tmByDate = {}\n  tmTickets.forEach(ticket => {\n    const date = ticket.work_date || ticket.ticket_date || ticket.created_at?.split('T')[0]\n    if (!date) return\n\n    // Calculate ticket value (labor + materials + equipment)\n    let ticketValue = 0\n\n    // Labor value - handles both property name variations\n    const workers = ticket.t_and_m_workers || ticket.workers || []\n    if (Array.isArray(workers)) {\n      workers.forEach(w => {\n        // Handle both naming conventions: hours/regular_hours, overtime_hours\n        const regHours = parseFloat(w.hours) || parseFloat(w.regular_hours) || 0\n        const otHours = parseFloat(w.overtime_hours) || 0\n        // Use rates if available, otherwise default billing rates\n        const regRate = parseFloat(w.regular_rate) || parseFloat(w.rate) || 65\n        const otRate = parseFloat(w.overtime_rate) || regRate * 1.5\n        ticketValue += (regHours * regRate) + (otHours * otRate)\n      })\n    }\n\n    // Materials and equipment - handles both property name variations\n    const items = ticket.t_and_m_items || ticket.items || []\n    if (Array.isArray(items)) {\n      items.forEach(item => {\n        const qty = parseFloat(item.quantity) || 1\n        // Handle different cost property locations\n        const unitCost = parseFloat(item.unit_cost) ||\n                         parseFloat(item.materials_equipment?.cost_per_unit) || 0\n        ticketValue += qty * unitCost\n      })\n    }\n\n    if (!tmByDate[date]) {\n      tmByDate[date] = 0\n    }\n    tmByDate[date] += ticketValue\n  })\n\n  // Pre-calculate custom costs by date\n  const customByDate = {}\n  customCosts.forEach(cost => {\n    const date = cost.cost_date\n    if (!date) return\n    if (!customByDate[date]) {\n      customByDate[date] = 0\n    }\n    customByDate[date] += parseFloat(cost.amount) || 0\n  })\n\n  // Pre-calculate materials/equipment costs by date (for quick lookup)\n  const materialsEquipmentByDateMap = {}\n  materialsEquipmentByDate.forEach(d => {\n    if (d.date) {\n      materialsEquipmentByDateMap[d.date] = d.cost || 0\n    }\n  })\n\n  // Track cumulative revenue based on actual area completions\n  let cumulativeRevenue = 0\n\n  // Build the time series\n  const timeSeries = sortedDates.map((date) => {\n    // Find labor cost for this date\n    const laborDay = laborByDate.find(d => d.date === date)\n    const laborCost = laborDay?.cost || 0\n\n    // Find haul-off cost for this date\n    const haulOffDay = haulOffByDate.find(d => d.date === date)\n    const haulOffCost = haulOffDay?.cost || 0\n\n    // Materials/equipment cost for this date (from T&M tickets)\n    const materialsEquipmentCost = materialsEquipmentByDateMap[date] || 0\n\n    // Custom costs for this date\n    const customCost = customByDate[date] || 0\n\n    // Accumulate all costs (labor + materials/equipment + disposal + custom)\n    const dailyTotalCost = laborCost + materialsEquipmentCost + haulOffCost + customCost\n    cumulativeCost += dailyTotalCost\n\n    // Accumulate T&M billing value (what we charge client)\n    const tmDayValue = tmByDate[date] || 0\n    cumulativeTMValue += tmDayValue\n\n    // Accumulate revenue based on actual area completions\n    // Revenue increases only when areas are marked complete\n    const dailyRevenue = revenueByDate[date] || 0\n    cumulativeRevenue += dailyRevenue\n\n    // If we have area completion data, use actual revenue\n    // Otherwise fall back to billable (for projects without detailed tracking)\n    const hasAreaData = Object.keys(revenueByDate).length > 0\n    const revenue = hasAreaData\n      ? cumulativeRevenue\n      : (projectData?.billable || 0) // Fall back to current billable for projects without area dates\n\n    return {\n      date,\n      contract: contractValue,\n      revenue: Math.round(revenue),\n      costs: Math.round(cumulativeCost),\n      tmValue: Math.round(cumulativeTMValue),\n      corValue: Math.round(corStats?.total_approved_value || 0),\n      profit: Math.round(revenue - cumulativeCost),\n      // Daily values for tooltips\n      dailyLabor: Math.round(laborCost),\n      dailyRevenue: Math.round(dailyRevenue),\n      dailyMaterials: Math.round(materialsEquipmentCost),\n      dailyHaulOff: Math.round(haulOffCost),\n      dailyCustom: Math.round(customCost),\n      dailyTM: Math.round(tmDayValue),\n      dailyTotal: Math.round(dailyTotalCost),\n    }\n  })\n\n  return timeSeries\n}\n\n/**\n * Filter time series by date range\n *\n * @param {Array} data - Full time series data\n * @param {number|null} days - Number of days to include (null = all)\n * @returns {Array} Filtered data\n */\nexport function filterByTimeRange(data, days) {\n  if (!days || !data.length) return data\n\n  const now = new Date()\n  const cutoff = new Date()\n  cutoff.setDate(now.getDate() - days)\n\n  return data.filter(d => new Date(d.date) >= cutoff)\n}\n\n/**\n * Build cost distribution data for donut chart\n *\n * @param {number} laborCost - Total labor cost\n * @param {number} haulOffCost - Total disposal cost\n * @param {Array} customCosts - Array of custom cost entries\n * @returns {Array} Chart-ready segments\n */\nexport function buildCostDistribution(laborCost = 0, haulOffCost = 0, customCosts = []) {\n  const segments = []\n\n  // Add labor if present\n  if (laborCost > 0) {\n    segments.push({\n      name: 'Labor',\n      value: laborCost,\n      color: chartColors.labor,\n      category: 'labor',\n    })\n  }\n\n  // Add disposal if present\n  if (haulOffCost > 0) {\n    segments.push({\n      name: 'Disposal',\n      value: haulOffCost,\n      color: chartColors.disposal,\n      category: 'disposal',\n    })\n  }\n\n  // Group custom costs by category\n  const grouped = {}\n  customCosts.forEach(cost => {\n    const cat = cost.category || 'other'\n    if (!grouped[cat]) {\n      grouped[cat] = {\n        items: [],\n        total: 0,\n      }\n    }\n    grouped[cat].items.push(cost)\n    grouped[cat].total += parseFloat(cost.amount) || 0\n  })\n\n  // Add grouped custom costs\n  Object.entries(grouped).forEach(([category, data]) => {\n    if (data.total > 0) {\n      const catConfig = costCategories[category] || costCategories.other\n      segments.push({\n        name: catConfig.label,\n        value: data.total,\n        color: catConfig.color,\n        category,\n        items: data.items,\n      })\n    }\n  })\n\n  // Calculate percentages\n  const total = segments.reduce((sum, s) => sum + s.value, 0)\n  segments.forEach(s => {\n    s.percentage = total > 0 ? Math.round((s.value / total) * 100) : 0\n  })\n\n  // Sort by value descending\n  segments.sort((a, b) => b.value - a.value)\n\n  return segments\n}\n\n/**\n * Build COR funnel data\n *\n * @param {Object} corStats - COR statistics from database\n * @returns {Array} Funnel stages\n */\nexport function buildCORFunnel(corStats) {\n  if (!corStats) return []\n\n  return [\n    {\n      stage: 'Draft',\n      count: corStats.draft_count || 0,\n      value: 0, // Draft CORs typically don't have values yet\n      color: chartColors.other,\n    },\n    {\n      stage: 'Pending',\n      count: corStats.pending_count || 0,\n      value: corStats.total_pending_value || 0,\n      color: chartColors.costs,\n    },\n    {\n      stage: 'Approved',\n      count: corStats.approved_count || 0,\n      value: corStats.total_approved_value || 0,\n      color: chartColors.revenue,\n    },\n    {\n      stage: 'Billed',\n      count: corStats.billed_count || 0,\n      value: corStats.total_billed_value || 0,\n      color: chartColors.profit,\n    },\n  ]\n}\n\n/**\n * Build daily burn data for sparkline\n *\n * @param {Array} laborByDate - Daily labor costs\n * @param {Array} haulOffByDate - Daily haul-off costs\n * @param {number} limit - Max number of days to include\n * @returns {Array} Sparkline data points\n */\nexport function buildBurnSparkline(laborByDate = [], haulOffByDate = [], limit = 14) {\n  // Merge and sort by date\n  const dateMap = {}\n\n  laborByDate.forEach(d => {\n    if (!dateMap[d.date]) {\n      dateMap[d.date] = { date: d.date, labor: 0, haulOff: 0 }\n    }\n    dateMap[d.date].labor = d.cost || 0\n  })\n\n  haulOffByDate.forEach(d => {\n    if (!dateMap[d.date]) {\n      dateMap[d.date] = { date: d.date, labor: 0, haulOff: 0 }\n    }\n    dateMap[d.date].haulOff = d.cost || 0\n  })\n\n  // Convert to array and sort\n  const data = Object.values(dateMap)\n    .map(d => ({\n      date: d.date,\n      total: d.labor + d.haulOff,\n      labor: d.labor,\n      haulOff: d.haulOff,\n    }))\n    .sort((a, b) => new Date(a.date) - new Date(b.date))\n\n  // Return last N days\n  return data.slice(-limit)\n}\n\n/**\n * Calculate trend direction from time series\n *\n * @param {Array} data - Time series data\n * @param {string} key - Data key to analyze\n * @returns {Object} Trend info { direction, percentage }\n */\nexport function calculateTrend(data, key) {\n  if (!data || data.length < 2) {\n    return { direction: 'flat', percentage: 0 }\n  }\n\n  const recent = data.slice(-7)\n  if (recent.length < 2) {\n    return { direction: 'flat', percentage: 0 }\n  }\n\n  const first = recent[0][key] || 0\n  const last = recent[recent.length - 1][key] || 0\n\n  if (first === 0) {\n    return { direction: last > 0 ? 'up' : 'flat', percentage: 0 }\n  }\n\n  const change = ((last - first) / first) * 100\n\n  return {\n    direction: change > 5 ? 'up' : change < -5 ? 'down' : 'flat',\n    percentage: Math.abs(Math.round(change)),\n  }\n}\n","import { formatChartDate, chartColors } from './chartConfig'\n\n/**\n * Custom tooltip for financial charts\n * Displays detailed breakdown on hover\n */\nexport default function ChartTooltip({ active, payload, label }) {\n  if (!active || !payload || !payload.length) {\n    return null\n  }\n\n  // Format currency\n  const formatCurrency = (value) => {\n    if (value >= 1000000) {\n      return `$${(value / 1000000).toFixed(2)}M`\n    }\n    if (value >= 1000) {\n      return `$${(value / 1000).toFixed(1)}K`\n    }\n    return `$${value.toFixed(0)}`\n  }\n\n  // Get the data point\n  const data = payload[0]?.payload || {}\n\n  return (\n    <div className=\"chart-tooltip\">\n      <div className=\"chart-tooltip-date\">\n        {formatChartDate(label)}\n      </div>\n\n      <div className=\"chart-tooltip-rows\">\n        {/* Contract */}\n        {data.contract !== undefined && (\n          <div className=\"chart-tooltip-row\">\n            <span className=\"chart-tooltip-label\">\n              <span\n                className=\"chart-tooltip-dot\"\n                style={{ backgroundColor: chartColors.contract }}\n              />\n              Contract\n            </span>\n            <span className=\"chart-tooltip-value\">\n              {formatCurrency(data.contract)}\n            </span>\n          </div>\n        )}\n\n        {/* Revenue */}\n        {data.revenue !== undefined && (\n          <div className=\"chart-tooltip-row\">\n            <span className=\"chart-tooltip-label\">\n              <span\n                className=\"chart-tooltip-dot\"\n                style={{ backgroundColor: chartColors.revenue }}\n              />\n              Revenue\n            </span>\n            <span className=\"chart-tooltip-value\">\n              {formatCurrency(data.revenue)}\n            </span>\n          </div>\n        )}\n\n        {/* Costs */}\n        {data.costs !== undefined && (\n          <div className=\"chart-tooltip-row\">\n            <span className=\"chart-tooltip-label\">\n              <span\n                className=\"chart-tooltip-dot\"\n                style={{ backgroundColor: chartColors.costs }}\n              />\n              Costs\n            </span>\n            <span className=\"chart-tooltip-value\">\n              {formatCurrency(data.costs)}\n            </span>\n          </div>\n        )}\n\n        {/* T&M Value */}\n        {data.tmValue !== undefined && data.tmValue > 0 && (\n          <div className=\"chart-tooltip-row\">\n            <span className=\"chart-tooltip-label\">\n              <span\n                className=\"chart-tooltip-dot\"\n                style={{ backgroundColor: chartColors.tmValue }}\n              />\n              T&M Value\n            </span>\n            <span className=\"chart-tooltip-value\">\n              {formatCurrency(data.tmValue)}\n            </span>\n          </div>\n        )}\n\n        {/* COR Value */}\n        {data.corValue !== undefined && data.corValue > 0 && (\n          <div className=\"chart-tooltip-row\">\n            <span className=\"chart-tooltip-label\">\n              <span\n                className=\"chart-tooltip-dot\"\n                style={{ backgroundColor: chartColors.corValue }}\n              />\n              COR Approved\n            </span>\n            <span className=\"chart-tooltip-value\">\n              {formatCurrency(data.corValue)}\n            </span>\n          </div>\n        )}\n\n        {/* Profit/Loss */}\n        {data.profit !== undefined && (\n          <div className=\"chart-tooltip-row\">\n            <span className=\"chart-tooltip-label\">\n              <span\n                className=\"chart-tooltip-dot\"\n                style={{\n                  backgroundColor: data.profit >= 0\n                    ? chartColors.profit\n                    : chartColors.loss\n                }}\n              />\n              {data.profit >= 0 ? 'Profit' : 'Loss'}\n            </span>\n            <span\n              className=\"chart-tooltip-value\"\n              style={{\n                color: data.profit >= 0\n                  ? chartColors.profit\n                  : chartColors.loss\n              }}\n            >\n              {formatCurrency(Math.abs(data.profit))}\n            </span>\n          </div>\n        )}\n      </div>\n\n      {/* Daily breakdown if available */}\n      {(data.dailyRevenue > 0 || data.dailyLabor > 0 || data.dailyMaterials > 0 || data.dailyHaulOff > 0 || data.dailyTM > 0) && (\n        <div className=\"chart-tooltip-daily\">\n          <div className=\"chart-tooltip-daily-label\">Today's Activity</div>\n          {data.dailyRevenue > 0 && (\n            <div className=\"chart-tooltip-daily-row earned\">\n              <span style={{ color: chartColors.revenue }}>\n                Areas Completed: {formatCurrency(data.dailyRevenue)}\n              </span>\n            </div>\n          )}\n          {data.dailyLabor > 0 && (\n            <div className=\"chart-tooltip-daily-row\">\n              Labor: {formatCurrency(data.dailyLabor)}\n            </div>\n          )}\n          {data.dailyMaterials > 0 && (\n            <div className=\"chart-tooltip-daily-row\">\n              Materials: {formatCurrency(data.dailyMaterials)}\n            </div>\n          )}\n          {data.dailyHaulOff > 0 && (\n            <div className=\"chart-tooltip-daily-row\">\n              Disposal: {formatCurrency(data.dailyHaulOff)}\n            </div>\n          )}\n          {data.dailyTM > 0 && (\n            <div className=\"chart-tooltip-daily-row\">\n              T&M Added: {formatCurrency(data.dailyTM)}\n            </div>\n          )}\n          {data.dailyTotal > 0 && (\n            <div className=\"chart-tooltip-daily-row total\">\n              <strong>Day Costs: {formatCurrency(data.dailyTotal)}</strong>\n            </div>\n          )}\n        </div>\n      )}\n\n      <div className=\"chart-tooltip-hint\">\n        Click to see details\n      </div>\n    </div>\n  )\n}\n","import { useState, useMemo } from 'react'\nimport {\n  AreaChart,\n  Area,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  ResponsiveContainer,\n  Legend,\n  ReferenceLine,\n} from 'recharts'\nimport { TrendingUp, TrendingDown, Minus } from 'lucide-react'\nimport {\n  chartColors,\n  animationConfig,\n  timeRanges,\n  formatChartCurrency,\n  formatChartDate,\n  gradientDefs,\n} from './chartConfig'\nimport { buildFinancialTimeSeries, filterByTimeRange, calculateTrend } from '../../lib/chartDataTransforms'\nimport ChartTooltip from './ChartTooltip'\n\n/**\n * Financial Trend Chart\n * Multi-line area chart showing contract, revenue, costs, T&M, and COR values over time\n * Uses actual area completion dates for revenue tracking\n */\nexport default function FinancialTrendChart({\n  projectData,\n  project,\n  tmTickets = [],\n  corStats = null,\n  areas = [],\n  onDrillDown,\n}) {\n  const [timeRange, setTimeRange] = useState('30d')\n  const [hoveredLine, setHoveredLine] = useState(null)\n\n  // Build the time series data using actual area completions for revenue\n  const chartData = useMemo(() => {\n    const allData = buildFinancialTimeSeries(projectData, project, tmTickets, corStats, areas)\n    const selectedRange = timeRanges.find(r => r.id === timeRange)\n    return filterByTimeRange(allData, selectedRange?.days)\n  }, [projectData, project, tmTickets, corStats, areas, timeRange])\n\n  // Calculate trend indicators\n  const costsTrend = useMemo(() => calculateTrend(chartData, 'costs'), [chartData])\n  const revenueTrend = useMemo(() => calculateTrend(chartData, 'revenue'), [chartData])\n\n  // Handle click on data point\n  const handleClick = (data) => {\n    if (data?.activePayload?.[0]) {\n      const point = data.activePayload[0].payload\n      onDrillDown?.(point.date, point)\n    }\n  }\n\n  // Trend icon component\n  const TrendIcon = ({ trend }) => {\n    if (trend.direction === 'up') {\n      return <TrendingUp size={14} className=\"trend-icon up\" />\n    }\n    if (trend.direction === 'down') {\n      return <TrendingDown size={14} className=\"trend-icon down\" />\n    }\n    return <Minus size={14} className=\"trend-icon flat\" />\n  }\n\n  if (!chartData.length) {\n    return (\n      <div className=\"financial-trend-chart empty\">\n        <div className=\"chart-empty-state\">\n          <p>No financial data available yet.</p>\n          <span>Start tracking labor and costs to see trends.</span>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"financial-trend-chart\">\n      <div className=\"chart-header\">\n        <div className=\"chart-title-section\">\n          <h3>Financial Trend</h3>\n          <div className=\"chart-trend-indicators\">\n            <span className=\"trend-badge\">\n              <span style={{ color: chartColors.revenue }}>Revenue</span>\n              <TrendIcon trend={revenueTrend} />\n              {revenueTrend.percentage > 0 && (\n                <span className=\"trend-pct\">{revenueTrend.percentage}%</span>\n              )}\n            </span>\n            <span className=\"trend-badge\">\n              <span style={{ color: chartColors.costs }}>Costs</span>\n              <TrendIcon trend={costsTrend} />\n              {costsTrend.percentage > 0 && (\n                <span className=\"trend-pct\">{costsTrend.percentage}%</span>\n              )}\n            </span>\n          </div>\n        </div>\n\n        <div className=\"time-range-selector\">\n          {timeRanges.map(range => (\n            <button\n              key={range.id}\n              className={timeRange === range.id ? 'active' : ''}\n              onClick={() => setTimeRange(range.id)}\n            >\n              {range.label}\n            </button>\n          ))}\n        </div>\n      </div>\n\n      <div className=\"chart-container\">\n        <ResponsiveContainer width=\"100%\" height={300}>\n          <AreaChart\n            data={chartData}\n            onClick={handleClick}\n            margin={{ top: 10, right: 10, left: 0, bottom: 0 }}\n          >\n            {/* Gradient definitions */}\n            <defs>\n              {Object.values(gradientDefs).map(grad => (\n                <linearGradient\n                  key={grad.id}\n                  id={grad.id}\n                  x1=\"0\"\n                  y1=\"0\"\n                  x2=\"0\"\n                  y2=\"1\"\n                >\n                  <stop\n                    offset=\"5%\"\n                    stopColor={grad.color}\n                    stopOpacity={grad.startOpacity}\n                  />\n                  <stop\n                    offset=\"95%\"\n                    stopColor={grad.color}\n                    stopOpacity={grad.endOpacity}\n                  />\n                </linearGradient>\n              ))}\n            </defs>\n\n            <CartesianGrid\n              strokeDasharray=\"3 3\"\n              stroke=\"var(--border-color)\"\n              vertical={false}\n            />\n\n            <XAxis\n              dataKey=\"date\"\n              tickFormatter={formatChartDate}\n              stroke=\"var(--text-secondary)\"\n              tick={{ fontSize: 11 }}\n              tickLine={false}\n              axisLine={{ stroke: 'var(--border-color)' }}\n            />\n\n            <YAxis\n              tickFormatter={formatChartCurrency}\n              stroke=\"var(--text-secondary)\"\n              tick={{ fontSize: 11 }}\n              tickLine={false}\n              axisLine={false}\n              width={60}\n            />\n\n            <Tooltip content={<ChartTooltip />} />\n\n            <Legend\n              verticalAlign=\"top\"\n              height={36}\n              iconType=\"circle\"\n              iconSize={8}\n              formatter={(value) => (\n                <span style={{ color: 'var(--text-secondary)', fontSize: '12px' }}>\n                  {value}\n                </span>\n              )}\n            />\n\n            {/* Contract ceiling - dashed reference line */}\n            {chartData[0]?.contract > 0 && (\n              <ReferenceLine\n                y={chartData[0].contract}\n                stroke={chartColors.contract}\n                strokeDasharray=\"5 5\"\n                strokeWidth={2}\n                label={{\n                  value: 'Contract',\n                  position: 'right',\n                  fill: chartColors.contract,\n                  fontSize: 11,\n                }}\n              />\n            )}\n\n            {/* Revenue area */}\n            <Area\n              type=\"monotone\"\n              dataKey=\"revenue\"\n              name=\"Revenue\"\n              stroke={chartColors.revenue}\n              strokeWidth={2}\n              fill=\"url(#revenueGradient)\"\n              animationDuration={animationConfig.duration}\n              onMouseEnter={() => setHoveredLine('revenue')}\n              onMouseLeave={() => setHoveredLine(null)}\n              style={{\n                opacity: hoveredLine && hoveredLine !== 'revenue' ? 0.3 : 1,\n              }}\n            />\n\n            {/* Costs area */}\n            <Area\n              type=\"monotone\"\n              dataKey=\"costs\"\n              name=\"Costs\"\n              stroke={chartColors.costs}\n              strokeWidth={2}\n              fill=\"url(#costsGradient)\"\n              animationDuration={animationConfig.duration}\n              onMouseEnter={() => setHoveredLine('costs')}\n              onMouseLeave={() => setHoveredLine(null)}\n              style={{\n                opacity: hoveredLine && hoveredLine !== 'costs' ? 0.3 : 1,\n              }}\n            />\n\n            {/* T&M Value area */}\n            {chartData.some(d => d.tmValue > 0) && (\n              <Area\n                type=\"monotone\"\n                dataKey=\"tmValue\"\n                name=\"T&M Value\"\n                stroke={chartColors.tmValue}\n                strokeWidth={2}\n                fill=\"url(#tmValueGradient)\"\n                animationDuration={animationConfig.duration}\n                onMouseEnter={() => setHoveredLine('tmValue')}\n                onMouseLeave={() => setHoveredLine(null)}\n                style={{\n                  opacity: hoveredLine && hoveredLine !== 'tmValue' ? 0.3 : 1,\n                }}\n              />\n            )}\n\n            {/* COR Value line (no fill, just line) */}\n            {chartData.some(d => d.corValue > 0) && (\n              <Area\n                type=\"monotone\"\n                dataKey=\"corValue\"\n                name=\"COR Approved\"\n                stroke={chartColors.corValue}\n                strokeWidth={2}\n                strokeDasharray=\"4 2\"\n                fill=\"transparent\"\n                animationDuration={animationConfig.duration}\n                onMouseEnter={() => setHoveredLine('corValue')}\n                onMouseLeave={() => setHoveredLine(null)}\n                style={{\n                  opacity: hoveredLine && hoveredLine !== 'corValue' ? 0.3 : 1,\n                }}\n              />\n            )}\n          </AreaChart>\n        </ResponsiveContainer>\n      </div>\n\n      {/* Quick stats below chart */}\n      <div className=\"chart-quick-stats\">\n        <div className=\"quick-stat\">\n          <span className=\"stat-label\">Current Revenue</span>\n          <span className=\"stat-value\" style={{ color: chartColors.revenue }}>\n            {formatChartCurrency(chartData[chartData.length - 1]?.revenue || 0)}\n          </span>\n        </div>\n        <div className=\"quick-stat\">\n          <span className=\"stat-label\">Total Costs</span>\n          <span className=\"stat-value\" style={{ color: chartColors.costs }}>\n            {formatChartCurrency(chartData[chartData.length - 1]?.costs || 0)}\n          </span>\n        </div>\n        <div className=\"quick-stat\">\n          <span className=\"stat-label\">Margin</span>\n          <span\n            className=\"stat-value\"\n            style={{\n              color: (chartData[chartData.length - 1]?.profit || 0) >= 0\n                ? chartColors.profit\n                : chartColors.loss\n            }}\n          >\n            {(() => {\n              const last = chartData[chartData.length - 1]\n              if (!last || !last.revenue) return '0%'\n              const margin = ((last.revenue - last.costs) / last.revenue) * 100\n              return `${margin.toFixed(1)}%`\n            })()}\n          </span>\n        </div>\n        {chartData[chartData.length - 1]?.tmValue > 0 && (\n          <div className=\"quick-stat\">\n            <span className=\"stat-label\">T&M Pending</span>\n            <span className=\"stat-value\" style={{ color: chartColors.tmValue }}>\n              {formatChartCurrency(chartData[chartData.length - 1]?.tmValue || 0)}\n            </span>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n","import { useState, useMemo } from 'react'\nimport {\n  PieChart,\n  Pie,\n  Cell,\n  ResponsiveContainer,\n  Tooltip,\n  Legend,\n} from 'recharts'\nimport { animationConfig, formatChartCurrency } from './chartConfig'\nimport { buildCostDistribution } from '../../lib/chartDataTransforms'\n\n/**\n * Cost Distribution Donut Chart\n * Shows breakdown of costs by category with interactive segments\n */\nexport default function CostDonut({\n  laborCost = 0,\n  haulOffCost = 0,\n  customCosts = [],\n  onSegmentClick,\n}) {\n  const [activeIndex, setActiveIndex] = useState(null)\n\n  // Build the donut segments\n  const segments = useMemo(() => {\n    return buildCostDistribution(laborCost, haulOffCost, customCosts)\n  }, [laborCost, haulOffCost, customCosts])\n\n  // Calculate total\n  const totalCost = useMemo(() => {\n    return segments.reduce((sum, s) => sum + s.value, 0)\n  }, [segments])\n\n  // Handle segment hover\n  const handleMouseEnter = (_, index) => {\n    setActiveIndex(index)\n  }\n\n  const handleMouseLeave = () => {\n    setActiveIndex(null)\n  }\n\n  // Handle segment click\n  const handleClick = (data, index) => {\n    if (onSegmentClick) {\n      onSegmentClick(segments[index])\n    }\n  }\n\n  // Custom tooltip\n  const CustomTooltip = ({ active, payload }) => {\n    if (!active || !payload || !payload.length) {\n      return null\n    }\n\n    const data = payload[0].payload\n    return (\n      <div className=\"chart-tooltip donut-tooltip\">\n        <div className=\"chart-tooltip-row\">\n          <span className=\"chart-tooltip-label\">\n            <span\n              className=\"chart-tooltip-dot\"\n              style={{ backgroundColor: data.color }}\n            />\n            {data.name}\n          </span>\n          <span className=\"chart-tooltip-value\">\n            {formatChartCurrency(data.value)}\n          </span>\n        </div>\n        <div className=\"donut-tooltip-pct\">\n          {data.percentage}% of total costs\n        </div>\n        {data.items && data.items.length > 0 && (\n          <div className=\"donut-tooltip-items\">\n            <div className=\"donut-tooltip-items-label\">\n              {data.items.length} item{data.items.length > 1 ? 's' : ''}\n            </div>\n          </div>\n        )}\n        {onSegmentClick && (\n          <div className=\"chart-tooltip-hint\">\n            Click to view details\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  // Custom legend\n  const renderLegend = (props) => {\n    const { payload } = props\n    return (\n      <div className=\"donut-legend\">\n        {payload.map((entry, index) => (\n          <div\n            key={`legend-${index}`}\n            className={`donut-legend-item ${activeIndex === index ? 'active' : ''}`}\n            onMouseEnter={() => setActiveIndex(index)}\n            onMouseLeave={() => setActiveIndex(null)}\n            onClick={() => handleClick(null, index)}\n          >\n            <span\n              className=\"donut-legend-color\"\n              style={{ backgroundColor: entry.payload.color }}\n            />\n            <span className=\"donut-legend-name\">{entry.value}</span>\n            <span className=\"donut-legend-value\">\n              {formatChartCurrency(entry.payload.value)}\n            </span>\n          </div>\n        ))}\n      </div>\n    )\n  }\n\n  if (!segments.length || totalCost === 0) {\n    return (\n      <div className=\"cost-donut empty\">\n        <div className=\"chart-empty-state\">\n          <p>No cost data available.</p>\n          <span>Add labor, disposal, or custom costs to see breakdown.</span>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"cost-donut\">\n      <div className=\"donut-chart-container\">\n        <ResponsiveContainer width=\"100%\" height={200}>\n          <PieChart>\n            <Pie\n              data={segments}\n              cx=\"50%\"\n              cy=\"50%\"\n              innerRadius={50}\n              outerRadius={80}\n              paddingAngle={2}\n              dataKey=\"value\"\n              onMouseEnter={handleMouseEnter}\n              onMouseLeave={handleMouseLeave}\n              onClick={handleClick}\n              animationDuration={animationConfig.duration}\n              animationEasing=\"ease-out\"\n            >\n              {segments.map((entry, index) => (\n                <Cell\n                  key={`cell-${index}`}\n                  fill={entry.color}\n                  stroke=\"var(--card-bg)\"\n                  strokeWidth={2}\n                  style={{\n                    filter: activeIndex === index ? 'brightness(1.1)' : 'none',\n                    cursor: onSegmentClick ? 'pointer' : 'default',\n                    transform: activeIndex === index ? 'scale(1.05)' : 'scale(1)',\n                    transformOrigin: 'center',\n                    transition: 'all 0.2s ease',\n                  }}\n                />\n              ))}\n            </Pie>\n            <Tooltip content={<CustomTooltip />} />\n            <Legend content={renderLegend} />\n          </PieChart>\n        </ResponsiveContainer>\n\n        {/* Center label showing total */}\n        <div className=\"donut-center-label\">\n          <span className=\"donut-center-value\">\n            {formatChartCurrency(totalCost)}\n          </span>\n          <span className=\"donut-center-text\">Total</span>\n        </div>\n      </div>\n    </div>\n  )\n}\n","import { useState } from 'react'\nimport { ChevronDown, ChevronUp, Plus, HardHat, Truck, Wrench, Package, Users, MoreHorizontal, Trash2 } from 'lucide-react'\nimport { CostDonut } from './charts'\n\n// Helper to format currency\nconst formatCurrency = (amount) => {\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD',\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0\n  }).format(amount || 0)\n}\n\n// Category display info\nconst categoryInfo = {\n  labor: { label: 'Labor', Icon: HardHat, color: '#3b82f6' },\n  disposal: { label: 'Disposal', Icon: Truck, color: '#10b981' },\n  equipment: { label: 'Equipment', Icon: Wrench, color: '#f59e0b' },\n  materials: { label: 'Materials', Icon: Package, color: '#8b5cf6' },\n  subcontractor: { label: 'Subcontractor', Icon: Users, color: '#ec4899' },\n  other: { label: 'Other', Icon: MoreHorizontal, color: '#6b7280' }\n}\n\nexport default function CostContributorsCard({\n  laborCost = 0,\n  haulOffCost = 0,\n  customCosts = [],\n  onAddCost,\n  onDeleteCost\n}) {\n  const [showChart, setShowChart] = useState(true)\n  const [expandedCategory, setExpandedCategory] = useState(null)\n\n  // Build cost breakdown combining auto-tracked and custom costs\n  const costBreakdown = []\n\n  // Labor (auto-tracked from crew check-ins)\n  if (laborCost > 0) {\n    costBreakdown.push({\n      category: 'labor',\n      label: 'Labor',\n      amount: laborCost,\n      source: 'auto',\n      description: 'From crew check-ins'\n    })\n  }\n\n  // Disposal (auto-tracked from haul-offs)\n  if (haulOffCost > 0) {\n    costBreakdown.push({\n      category: 'disposal',\n      label: 'Disposal',\n      amount: haulOffCost,\n      source: 'auto',\n      description: 'From haul-off logs'\n    })\n  }\n\n  // Group custom costs by category\n  const customByCategory = {}\n  customCosts.forEach(cost => {\n    if (!customByCategory[cost.category]) {\n      customByCategory[cost.category] = {\n        category: cost.category,\n        items: [],\n        total: 0\n      }\n    }\n    customByCategory[cost.category].items.push(cost)\n    customByCategory[cost.category].total += parseFloat(cost.amount) || 0\n  })\n\n  // Add custom cost categories\n  Object.values(customByCategory).forEach(group => {\n    const info = categoryInfo[group.category] || categoryInfo.other\n    costBreakdown.push({\n      category: group.category,\n      label: info.label,\n      amount: group.total,\n      source: 'manual',\n      items: group.items\n    })\n  })\n\n  // Calculate total\n  const totalCost = costBreakdown.reduce((sum, cat) => sum + cat.amount, 0)\n\n  // Calculate percentages and sort by amount\n  costBreakdown.forEach(cat => {\n    cat.percentage = totalCost > 0 ? (cat.amount / totalCost) * 100 : 0\n  })\n  costBreakdown.sort((a, b) => b.amount - a.amount)\n\n  // Toggle category expansion\n  const toggleCategory = (category) => {\n    setExpandedCategory(expandedCategory === category ? null : category)\n  }\n\n  // Handle donut segment click\n  const handleSegmentClick = (segment) => {\n    if (segment.items && segment.items.length > 0) {\n      setShowChart(false)\n      setExpandedCategory(segment.category)\n    }\n  }\n\n  return (\n    <div className=\"cost-contributors-card\">\n      <div className=\"cost-contributors-header\">\n        <div className=\"cost-contributors-title\">\n          <h3>Cost Contributors</h3>\n          <span className=\"cost-total\">{formatCurrency(totalCost)}</span>\n        </div>\n        {costBreakdown.length > 0 && (\n          <div className=\"cost-view-toggle\">\n            <button\n              className={showChart ? 'active' : ''}\n              onClick={() => setShowChart(true)}\n            >\n              Chart\n            </button>\n            <button\n              className={!showChart ? 'active' : ''}\n              onClick={() => setShowChart(false)}\n            >\n              List\n            </button>\n          </div>\n        )}\n      </div>\n\n      {costBreakdown.length === 0 ? (\n        <div className=\"cost-empty\">\n          <p>No costs recorded yet</p>\n          <small>Costs will appear as crew checks in and haul-offs are logged</small>\n        </div>\n      ) : showChart ? (\n        <CostDonut\n          laborCost={laborCost}\n          haulOffCost={haulOffCost}\n          customCosts={customCosts}\n          onSegmentClick={handleSegmentClick}\n        />\n      ) : (\n        <div className=\"cost-breakdown\">\n          {costBreakdown.map(category => {\n            const info = categoryInfo[category.category] || categoryInfo.other\n            const Icon = info.Icon\n            const hasItems = category.items && category.items.length > 0\n            const isExpanded = expandedCategory === category.category\n\n            return (\n              <div key={category.category} className=\"cost-category\">\n                <div\n                  className={`cost-category-row ${hasItems ? 'expandable' : ''}`}\n                  onClick={() => hasItems && toggleCategory(category.category)}\n                >\n                  <div className=\"cost-category-bar-container\">\n                    <div\n                      className=\"cost-category-bar\"\n                      style={{\n                        width: `${Math.max(category.percentage, 2)}%`,\n                        backgroundColor: info.color\n                      }}\n                    ></div>\n                  </div>\n                  <div className=\"cost-category-info\">\n                    <div className=\"cost-category-label\">\n                      <Icon size={14} style={{ color: info.color }} />\n                      <span>{category.label}</span>\n                      {category.source === 'auto' && (\n                        <span className=\"cost-auto-badge\">Auto</span>\n                      )}\n                      {hasItems && (\n                        isExpanded ? <ChevronUp size={14} /> : <ChevronDown size={14} />\n                      )}\n                    </div>\n                    <div className=\"cost-category-values\">\n                      <span className=\"cost-amount\">{formatCurrency(category.amount)}</span>\n                      <span className=\"cost-percent\">{Math.round(category.percentage)}%</span>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Expanded items for manual costs */}\n                {isExpanded && hasItems && (\n                  <div className=\"cost-category-items\">\n                    {category.items.map(item => (\n                      <div key={item.id} className=\"cost-item\">\n                        <div className=\"cost-item-info\">\n                          <span className=\"cost-item-desc\">{item.description}</span>\n                          <span className=\"cost-item-date\">\n                            {new Date(item.cost_date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\n                          </span>\n                        </div>\n                        <div className=\"cost-item-actions\">\n                          <span className=\"cost-item-amount\">{formatCurrency(item.amount)}</span>\n                          {onDeleteCost && (\n                            <button\n                              className=\"cost-item-delete\"\n                              onClick={(e) => {\n                                e.stopPropagation()\n                                if (confirm('Delete this cost entry?')) {\n                                  onDeleteCost(item.id)\n                                }\n                              }}\n                            >\n                              <Trash2 size={14} />\n                            </button>\n                          )}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      )}\n\n      {onAddCost && (\n        <button className=\"cost-add-btn\" onClick={onAddCost}>\n          <Plus size={16} />\n          <span>Add Cost</span>\n        </button>\n      )}\n    </div>\n  )\n}\n","import { TrendingUp, TrendingDown, AlertCircle, CheckCircle } from 'lucide-react'\n\n// Helper to format currency\nconst formatCurrency = (amount) => {\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD',\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0\n  }).format(amount || 0)\n}\n\nexport default function ProfitabilityCard({\n  revenue,      // billable amount (earned based on progress)\n  totalCosts,   // all costs combined\n  contractValue, // total contract value\n  progress      // completion percentage\n}) {\n  // Current profit and margin\n  const currentProfit = revenue - totalCosts\n  const currentMargin = revenue > 0 ? (currentProfit / revenue) * 100 : 0\n\n  // Projected final values (extrapolate based on current progress)\n  const projectedRevenue = contractValue\n  const projectedCosts = progress > 0 ? (totalCosts / (progress / 100)) : totalCosts\n  const projectedProfit = projectedRevenue - projectedCosts\n  const projectedMargin = projectedRevenue > 0 ? (projectedProfit / projectedRevenue) * 100 : 0\n\n  // Determine status\n  const isHealthy = currentMargin >= 20\n  const isWarning = currentMargin >= 0 && currentMargin < 20\n  const isLoss = currentMargin < 0\n\n  const status = isHealthy ? 'healthy' : isWarning ? 'warning' : 'loss'\n  const statusLabel = isHealthy ? 'On Track' : isWarning ? 'Watch Margin' : 'Over Cost'\n  const StatusIcon = isHealthy ? CheckCircle : isWarning ? AlertCircle : TrendingDown\n\n  return (\n    <div className={`profitability-card ${status}`}>\n      <div className=\"profitability-header\">\n        <h3>Profitability</h3>\n        <div className={`profitability-status ${status}`}>\n          <StatusIcon size={14} />\n          <span>{statusLabel}</span>\n        </div>\n      </div>\n\n      <div className=\"profitability-metrics\">\n        {/* Current Margin */}\n        <div className=\"profit-metric\">\n          <div className=\"profit-metric-header\">\n            <span className=\"profit-metric-label\">Current Margin</span>\n            <span className={`profit-metric-value ${currentMargin < 0 ? 'negative' : ''}`}>\n              {Math.round(currentMargin)}%\n            </span>\n          </div>\n          <div className=\"profit-bar-container\">\n            <div\n              className={`profit-bar ${currentMargin < 0 ? 'negative' : currentMargin < 20 ? 'warning' : 'healthy'}`}\n              style={{ width: `${Math.min(Math.abs(currentMargin), 100)}%` }}\n            ></div>\n          </div>\n        </div>\n\n        {/* Projected Final Margin */}\n        {progress > 10 && (\n          <div className=\"profit-metric\">\n            <div className=\"profit-metric-header\">\n              <span className=\"profit-metric-label\">Projected Final</span>\n              <span className={`profit-metric-value ${projectedMargin < 0 ? 'negative' : ''}`}>\n                {Math.round(projectedMargin)}%\n              </span>\n            </div>\n            <div className=\"profit-bar-container\">\n              <div\n                className={`profit-bar ${projectedMargin < 0 ? 'negative' : projectedMargin < 20 ? 'warning' : 'healthy'}`}\n                style={{ width: `${Math.min(Math.abs(projectedMargin), 100)}%` }}\n              ></div>\n            </div>\n          </div>\n        )}\n      </div>\n\n      <div className=\"profitability-summary\">\n        <div className=\"profit-row\">\n          <span className=\"profit-label\">Revenue Earned</span>\n          <span className=\"profit-value\">{formatCurrency(revenue)}</span>\n        </div>\n        <div className=\"profit-row\">\n          <span className=\"profit-label\">Total Costs</span>\n          <span className=\"profit-value negative\">- {formatCurrency(totalCosts)}</span>\n        </div>\n        <div className=\"profit-row profit-total\">\n          <span className=\"profit-label\">Current Profit</span>\n          <span className={`profit-value ${currentProfit < 0 ? 'negative' : 'positive'}`}>\n            {currentProfit >= 0 ? '' : '-'}{formatCurrency(Math.abs(currentProfit))}\n          </span>\n        </div>\n      </div>\n\n      {progress > 10 && (\n        <div className=\"profitability-insight\">\n          {isHealthy && (\n            <p>\n              At {Math.round(progress)}% complete, you're at {formatCurrency(currentProfit)} profit.\n              {projectedProfit > 0 && ` Projected final profit: ${formatCurrency(projectedProfit)}`}\n            </p>\n          )}\n          {isWarning && (\n            <p>\n              Margins are thin. Consider reviewing costs or scope.\n              {projectedProfit < 0 && ` Trending toward ${formatCurrency(projectedProfit)} loss.`}\n            </p>\n          )}\n          {isLoss && (\n            <p>\n              Currently over cost by {formatCurrency(Math.abs(currentProfit))}.\n              Immediate review recommended.\n            </p>\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n","import { useState, useEffect } from 'react'\nimport { Truck, ChevronDown, ChevronUp } from 'lucide-react'\nimport { db } from '../lib/supabase'\n\nconst LOAD_TYPES = [\n  { value: 'concrete', label: 'Concrete', icon: '' },\n  { value: 'trash', label: 'Trash', icon: '' },\n  { value: 'metals', label: 'Metals', icon: '' },\n  { value: 'hazardous_waste', label: 'Hazardous', icon: '' }\n]\n\nconst getLoadTypeInfo = (type) => LOAD_TYPES.find(t => t.value === type) || { label: type, icon: '' }\n\nexport default function DisposalSummary({ project, period = 'week' }) {\n  const [loads, setLoads] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [expanded, setExpanded] = useState(false)\n\n  useEffect(() => {\n    if (project?.id) {\n      loadData()\n    }\n  }, [project?.id, period])\n\n  const loadData = async () => {\n    try {\n      setLoading(true)\n      const days = period === 'week' ? 7 : period === 'month' ? 30 : 14\n      const data = await db.getDisposalLoadsHistory(project.id, days)\n      setLoads(data || [])\n    } catch (err) {\n      console.error('Error loading disposal summary:', err)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  // Group loads by type for totals\n  const loadsByType = loads.reduce((acc, load) => {\n    const type = load.load_type\n    if (!acc[type]) {\n      acc[type] = 0\n    }\n    acc[type] += load.load_count\n    return acc\n  }, {})\n\n  // Group by date for breakdown\n  const loadsByDate = loads.reduce((acc, load) => {\n    const date = load.load_date || load.work_date\n    if (!acc[date]) {\n      acc[date] = { date, loads: [], total: 0 }\n    }\n    acc[date].loads.push(load)\n    acc[date].total += load.load_count\n    return acc\n  }, {})\n\n  const sortedDates = Object.values(loadsByDate)\n    .sort((a, b) => new Date(b.date) - new Date(a.date))\n    .slice(0, 7)\n\n  const totalLoads = loads.reduce((sum, l) => sum + l.load_count, 0)\n  const hasLoads = totalLoads > 0\n\n  if (loading) {\n    return (\n      <div className=\"disposal-summary-card\">\n        <div className=\"card-header\">\n          <div className=\"header-left\">\n            <Truck size={18} />\n            <span>Disposal Loads</span>\n          </div>\n        </div>\n        <div className=\"card-loading\">Loading...</div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"disposal-summary-card\">\n      <div className=\"card-header\">\n        <div className=\"header-left\">\n          <Truck size={18} />\n          <span>Disposal Loads</span>\n        </div>\n        <span className=\"period-badge\">\n          {period === 'week' ? 'Last 7 days' : period === 'month' ? 'Last 30 days' : 'Last 14 days'}\n        </span>\n      </div>\n\n      {!hasLoads ? (\n        <div className=\"disposal-empty-state\">\n          <Truck size={32} />\n          <p>No disposal loads recorded</p>\n          <span className=\"text-muted\">Loads will appear here when logged by field crews</span>\n        </div>\n      ) : (\n        <>\n          {/* Total */}\n          <div className=\"disposal-total\">\n            <span className=\"disposal-total-value\">{totalLoads}</span>\n            <span className=\"disposal-total-label\">Total Loads</span>\n          </div>\n\n          {/* By Type Breakdown */}\n          <div className=\"disposal-breakdown\">\n            {LOAD_TYPES.map(type => {\n              const count = loadsByType[type.value] || 0\n              if (count === 0) return null\n              const percentage = Math.round((count / totalLoads) * 100)\n\n              return (\n                <div key={type.value} className=\"disposal-type-row\">\n                  <div className=\"disposal-type-info\">\n                    <span className=\"disposal-type-icon\">{type.icon}</span>\n                    <span className=\"disposal-type-label\">{type.label}</span>\n                  </div>\n                  <div className=\"disposal-type-stats\">\n                    <span className=\"disposal-type-count\">{count}</span>\n                    <div className=\"disposal-type-bar\">\n                      <div\n                        className=\"disposal-type-bar-fill\"\n                        style={{ width: `${percentage}%` }}\n                      />\n                    </div>\n                  </div>\n                </div>\n              )\n            })}\n          </div>\n\n          {/* Daily Breakdown Toggle */}\n          {sortedDates.length > 0 && (\n            <button\n              className=\"disposal-expand-btn\"\n              onClick={() => setExpanded(!expanded)}\n            >\n              {expanded ? <ChevronUp size={16} /> : <ChevronDown size={16} />}\n              <span>{expanded ? 'Hide' : 'View'} Daily Breakdown</span>\n            </button>\n          )}\n\n          {/* Daily Breakdown */}\n          {expanded && sortedDates.length > 0 && (\n            <div className=\"disposal-daily-breakdown\">\n              {sortedDates.map(day => {\n                const formattedDate = new Date(day.date).toLocaleDateString('en-US', {\n                  weekday: 'short',\n                  month: 'short',\n                  day: 'numeric'\n                })\n\n                // Group by type for this day\n                const dayLoadsByType = day.loads.reduce((acc, load) => {\n                  if (!acc[load.load_type]) acc[load.load_type] = 0\n                  acc[load.load_type] += load.load_count\n                  return acc\n                }, {})\n\n                return (\n                  <div key={day.date} className=\"disposal-daily-row\">\n                    <div className=\"disposal-daily-header\">\n                      <span className=\"disposal-daily-date\">{formattedDate}</span>\n                      <span className=\"disposal-daily-total\">{day.total} loads</span>\n                    </div>\n                    <div className=\"disposal-daily-types\">\n                      {Object.entries(dayLoadsByType).map(([type, count]) => {\n                        const typeInfo = getLoadTypeInfo(type)\n                        return (\n                          <span key={type} className=\"disposal-daily-type\">\n                            {typeInfo.icon} {count}\n                          </span>\n                        )\n                      })}\n                    </div>\n                  </div>\n                )\n              })}\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  )\n}\n","import { useState, useEffect } from 'react'\nimport { db } from '../lib/supabase'\nimport { Users, UserPlus, UserMinus, ChevronDown, X } from 'lucide-react'\n\nconst PROJECT_ROLE_OPTIONS = [\n  'Project Manager',\n  'Superintendent',\n  'Foreman',\n  'Office Support',\n  'Engineer',\n  'Inspector',\n  'Team Member'\n]\n\nexport default function ProjectTeam({ project, company, user, isAdmin, onShowToast }) {\n  const [teamMembers, setTeamMembers] = useState([])\n  const [companyMembers, setCompanyMembers] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [showAddModal, setShowAddModal] = useState(false)\n  const [selectedUser, setSelectedUser] = useState('')\n  const [selectedRole, setSelectedRole] = useState('Team Member')\n  const [actionLoading, setActionLoading] = useState(null)\n\n  useEffect(() => {\n    if (project?.id) {\n      loadProjectTeam()\n    }\n  }, [project?.id])\n\n  useEffect(() => {\n    if (showAddModal && company?.id) {\n      loadCompanyMembers()\n    }\n  }, [showAddModal, company?.id])\n\n  const loadProjectTeam = async () => {\n    try {\n      setLoading(true)\n      const data = await db.getProjectTeam(project.id)\n      setTeamMembers(data)\n    } catch (error) {\n      console.error('Error loading project team:', error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const loadCompanyMembers = async () => {\n    try {\n      const data = await db.getCompanyMembers(company.id)\n      // Filter out users already on the project\n      const existingUserIds = teamMembers.map(tm => tm.users?.id)\n      const available = data.filter(m => !existingUserIds.includes(m.users?.id))\n      setCompanyMembers(available)\n    } catch (error) {\n      console.error('Error loading company members:', error)\n    }\n  }\n\n  const handleAddMember = async () => {\n    if (!selectedUser) {\n      onShowToast('Select a team member', 'error')\n      return\n    }\n\n    try {\n      setActionLoading('add')\n      await db.addProjectMember(project.id, selectedUser, selectedRole, user.id)\n      onShowToast('Team member added', 'success')\n      setShowAddModal(false)\n      setSelectedUser('')\n      setSelectedRole('Team Member')\n      loadProjectTeam()\n    } catch (error) {\n      console.error('Error adding team member:', error)\n      onShowToast('Error adding team member', 'error')\n    } finally {\n      setActionLoading(null)\n    }\n  }\n\n  const handleUpdateRole = async (member, newRole) => {\n    try {\n      setActionLoading(member.id)\n      await db.updateProjectMemberRole(project.id, member.users?.id, newRole)\n      onShowToast('Role updated', 'success')\n      loadProjectTeam()\n    } catch (error) {\n      console.error('Error updating role:', error)\n      onShowToast('Error updating role', 'error')\n    } finally {\n      setActionLoading(null)\n    }\n  }\n\n  const handleRemoveMember = async (member) => {\n    try {\n      setActionLoading(member.id)\n      await db.removeProjectMember(project.id, member.users?.id)\n      onShowToast('Team member removed', 'success')\n      loadProjectTeam()\n    } catch (error) {\n      console.error('Error removing team member:', error)\n      onShowToast('Error removing team member', 'error')\n    } finally {\n      setActionLoading(null)\n    }\n  }\n\n  if (loading) {\n    return (\n      <div className=\"project-team\">\n        <div className=\"project-team-header\">\n          <h3><Users size={18} /> Project Team</h3>\n        </div>\n        <div className=\"loading-small\">Loading...</div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"project-team\">\n      <div className=\"project-team-header\">\n        <h3><Users size={18} /> Project Team</h3>\n        {isAdmin && (\n          <button\n            className=\"btn btn-small btn-primary\"\n            onClick={() => setShowAddModal(true)}\n          >\n            <UserPlus size={14} /> Add\n          </button>\n        )}\n      </div>\n\n      {teamMembers.length === 0 ? (\n        <div className=\"project-team-empty\">\n          No team members assigned yet\n          {isAdmin && <p>Click \"Add\" to assign team members to this project</p>}\n        </div>\n      ) : (\n        <div className=\"project-team-list\">\n          {teamMembers.map(member => (\n            <div key={member.id} className=\"project-team-member\">\n              <div className=\"team-member-info\">\n                <div className=\"team-member-name\">{member.users?.name || 'Unknown'}</div>\n                <div className=\"team-member-email\">{member.users?.email}</div>\n              </div>\n              <div className=\"team-member-role\">\n                {isAdmin ? (\n                  <div className=\"role-selector compact\">\n                    <select\n                      value={member.project_role}\n                      onChange={(e) => handleUpdateRole(member, e.target.value)}\n                      disabled={actionLoading === member.id}\n                      className=\"role-select\"\n                    >\n                      {PROJECT_ROLE_OPTIONS.map(role => (\n                        <option key={role} value={role}>{role}</option>\n                      ))}\n                    </select>\n                    <ChevronDown size={12} className=\"role-select-icon\" />\n                  </div>\n                ) : (\n                  <span className=\"role-badge\">{member.project_role}</span>\n                )}\n              </div>\n              {isAdmin && (\n                <button\n                  className=\"btn-icon btn-danger-subtle\"\n                  onClick={() => handleRemoveMember(member)}\n                  disabled={actionLoading === member.id}\n                  title=\"Remove from project\"\n                >\n                  <UserMinus size={14} />\n                </button>\n              )}\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Add Member Modal */}\n      {showAddModal && (\n        <div className=\"modal-overlay\" onClick={() => setShowAddModal(false)}>\n          <div className=\"modal-content small\" onClick={e => e.stopPropagation()}>\n            <div className=\"modal-header\">\n              <h3>Add Team Member</h3>\n              <button className=\"modal-close\" onClick={() => setShowAddModal(false)}>\n                <X size={20} />\n              </button>\n            </div>\n            <div className=\"modal-body\">\n              <div className=\"form-group\">\n                <label>Select Team Member</label>\n                <select\n                  value={selectedUser}\n                  onChange={(e) => setSelectedUser(e.target.value)}\n                  className=\"form-select\"\n                >\n                  <option value=\"\">Choose a team member...</option>\n                  {companyMembers.map(member => (\n                    <option key={member.users?.id} value={member.users?.id}>\n                      {member.users?.name || member.users?.email}\n                    </option>\n                  ))}\n                </select>\n                {companyMembers.length === 0 && (\n                  <p className=\"form-hint\">All company members are already assigned to this project</p>\n                )}\n              </div>\n              <div className=\"form-group\">\n                <label>Project Role</label>\n                <select\n                  value={selectedRole}\n                  onChange={(e) => setSelectedRole(e.target.value)}\n                  className=\"form-select\"\n                >\n                  {PROJECT_ROLE_OPTIONS.map(role => (\n                    <option key={role} value={role}>{role}</option>\n                  ))}\n                </select>\n                <p className=\"form-hint\">This is for visibility only - it doesn't affect permissions</p>\n              </div>\n            </div>\n            <div className=\"modal-footer\">\n              <button\n                className=\"btn btn-secondary\"\n                onClick={() => setShowAddModal(false)}\n              >\n                Cancel\n              </button>\n              <button\n                className=\"btn btn-primary\"\n                onClick={handleAddMember}\n                disabled={!selectedUser || actionLoading === 'add'}\n              >\n                {actionLoading === 'add' ? 'Adding...' : 'Add to Project'}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n","import { memo } from 'react'\n\n/**\n * Skeleton - Loading placeholder component\n * Follows progressive disclosure principle - shows structure before content\n */\n\n// Base skeleton with shimmer animation\nexport const Skeleton = memo(function Skeleton({\n  width,\n  height,\n  borderRadius = '8px',\n  className = '',\n  variant = 'default' // 'default' | 'text' | 'circular' | 'rectangular'\n}) {\n  const getVariantStyles = () => {\n    switch (variant) {\n      case 'text':\n        return { height: '1em', borderRadius: '4px' }\n      case 'circular':\n        return { borderRadius: '50%' }\n      case 'rectangular':\n        return { borderRadius: '0' }\n      default:\n        return { borderRadius }\n    }\n  }\n\n  const variantStyles = getVariantStyles()\n\n  return (\n    <div\n      className={`skeleton ${className}`}\n      style={{\n        width: width || '100%',\n        height: height || variantStyles.height || '1rem',\n        borderRadius: variantStyles.borderRadius,\n      }}\n      aria-hidden=\"true\"\n    />\n  )\n})\n\n// Skeleton for metric cards (value + label)\nexport const MetricSkeleton = memo(function MetricSkeleton({ showProgress = false }) {\n  return (\n    <div className=\"metric-skeleton\">\n      <Skeleton width=\"60%\" height=\"0.75rem\" className=\"skeleton-label\" />\n      <Skeleton width=\"80%\" height=\"1.75rem\" className=\"skeleton-value\" />\n      {showProgress && (\n        <Skeleton width=\"100%\" height=\"6px\" className=\"skeleton-progress\" />\n      )}\n    </div>\n  )\n})\n\n// Skeleton for cards (header + content)\nexport const CardSkeleton = memo(function CardSkeleton({\n  lines = 3,\n  showHeader = true,\n  showAction = false\n}) {\n  return (\n    <div className=\"card-skeleton\" aria-busy=\"true\" aria-label=\"Loading content\">\n      {showHeader && (\n        <div className=\"card-skeleton-header\">\n          <Skeleton width=\"40%\" height=\"1.25rem\" />\n          {showAction && <Skeleton width=\"80px\" height=\"32px\" />}\n        </div>\n      )}\n      <div className=\"card-skeleton-body\">\n        {Array.from({ length: lines }).map((_, i) => (\n          <Skeleton\n            key={i}\n            width={`${100 - (i * 15)}%`}\n            height=\"1rem\"\n            className=\"skeleton-line\"\n          />\n        ))}\n      </div>\n    </div>\n  )\n})\n\n// Skeleton for list items\nexport const ListItemSkeleton = memo(function ListItemSkeleton({\n  count = 3,\n  showAvatar = false,\n  showAction = false\n}) {\n  return (\n    <div className=\"list-skeleton\" aria-busy=\"true\" aria-label=\"Loading list\">\n      {Array.from({ length: count }).map((_, i) => (\n        <div key={i} className=\"list-item-skeleton\">\n          {showAvatar && <Skeleton width=\"40px\" height=\"40px\" variant=\"circular\" />}\n          <div className=\"list-item-skeleton-content\">\n            <Skeleton width=\"60%\" height=\"1rem\" />\n            <Skeleton width=\"40%\" height=\"0.75rem\" />\n          </div>\n          {showAction && <Skeleton width=\"60px\" height=\"28px\" />}\n        </div>\n      ))}\n    </div>\n  )\n})\n\n// Skeleton for financial analysis row (3 cards)\nexport const FinancialRowSkeleton = memo(function FinancialRowSkeleton() {\n  return (\n    <div className=\"financial-row-skeleton\" aria-busy=\"true\" aria-label=\"Loading financial data\">\n      {[1, 2, 3].map(i => (\n        <div key={i} className=\"financial-card-skeleton\">\n          <div className=\"financial-card-skeleton-header\">\n            <Skeleton width=\"24px\" height=\"24px\" variant=\"circular\" />\n            <Skeleton width=\"60%\" height=\"1rem\" />\n          </div>\n          <Skeleton width=\"50%\" height=\"2rem\" className=\"skeleton-hero-value\" />\n          <div className=\"financial-card-skeleton-details\">\n            <Skeleton width=\"100%\" height=\"0.875rem\" />\n            <Skeleton width=\"80%\" height=\"0.875rem\" />\n          </div>\n        </div>\n      ))}\n    </div>\n  )\n})\n\n// Skeleton for chart placeholder\nexport const ChartSkeleton = memo(function ChartSkeleton({ height = '200px' }) {\n  return (\n    <div className=\"chart-skeleton\" style={{ height }} aria-busy=\"true\" aria-label=\"Loading chart\">\n      <div className=\"chart-skeleton-bars\">\n        {[40, 65, 45, 80, 55, 70, 50, 75, 60, 85].map((h, i) => (\n          <div\n            key={i}\n            className=\"chart-skeleton-bar\"\n            style={{ height: `${h}%` }}\n          />\n        ))}\n      </div>\n      <Skeleton width=\"100%\" height=\"1px\" className=\"chart-skeleton-axis\" />\n    </div>\n  )\n})\n\n// Skeleton for COR/Ticket items\nexport const TicketSkeleton = memo(function TicketSkeleton({ count = 3 }) {\n  return (\n    <div className=\"ticket-skeleton-list\" aria-busy=\"true\" aria-label=\"Loading tickets\">\n      {Array.from({ length: count }).map((_, i) => (\n        <div key={i} className=\"ticket-skeleton-item\">\n          <div className=\"ticket-skeleton-header\">\n            <Skeleton width=\"100px\" height=\"0.875rem\" />\n            <Skeleton width=\"80px\" height=\"24px\" borderRadius=\"12px\" />\n          </div>\n          <Skeleton width=\"90%\" height=\"1rem\" />\n          <div className=\"ticket-skeleton-footer\">\n            <Skeleton width=\"60px\" height=\"0.75rem\" />\n            <Skeleton width=\"60px\" height=\"0.75rem\" />\n            <Skeleton width=\"60px\" height=\"0.75rem\" />\n          </div>\n        </div>\n      ))}\n    </div>\n  )\n})\n\n// Skeleton for hero metrics row\nexport const HeroMetricsSkeleton = memo(function HeroMetricsSkeleton() {\n  return (\n    <div className=\"hero-metrics-skeleton\" aria-busy=\"true\" aria-label=\"Loading metrics\">\n      {[1, 2, 3, 4].map(i => (\n        <div key={i} className=\"hero-metric-skeleton\">\n          <Skeleton width=\"80px\" height=\"0.75rem\" className=\"skeleton-label\" />\n          <Skeleton width=\"120px\" height=\"1.75rem\" className=\"skeleton-value\" />\n          <Skeleton width=\"100%\" height=\"4px\" className=\"skeleton-bar\" />\n        </div>\n      ))}\n    </div>\n  )\n})\n\nexport default Skeleton\n","import { memo } from 'react'\nimport { AlertTriangle, RefreshCw, WifiOff } from 'lucide-react'\n\n/**\n * ErrorState - Reusable error display component for list/data components\n * Provides user-friendly error messages with retry functionality\n */\nexport const ErrorState = memo(function ErrorState({\n  title = 'Unable to load data',\n  message = 'Something went wrong. Please try again.',\n  error = null,\n  onRetry = null,\n  retryLabel = 'Try Again',\n  variant = 'default', // 'default' | 'inline' | 'compact'\n  icon: CustomIcon = null\n}) {\n  // Determine icon based on error type\n  const getIcon = () => {\n    if (CustomIcon) return CustomIcon\n    if (error?.message?.includes('network') || error?.message?.includes('offline')) {\n      return WifiOff\n    }\n    return AlertTriangle\n  }\n\n  const Icon = getIcon()\n\n  if (variant === 'compact') {\n    return (\n      <div className=\"error-state error-state-compact\" role=\"alert\">\n        <Icon size={16} className=\"error-state-icon\" aria-hidden=\"true\" />\n        <span className=\"error-state-message\">{message}</span>\n        {onRetry && (\n          <button\n            className=\"btn btn-ghost btn-small\"\n            onClick={onRetry}\n            aria-label={retryLabel}\n          >\n            <RefreshCw size={14} />\n          </button>\n        )}\n      </div>\n    )\n  }\n\n  if (variant === 'inline') {\n    return (\n      <div className=\"error-state error-state-inline\" role=\"alert\">\n        <div className=\"error-state-content\">\n          <Icon size={20} className=\"error-state-icon\" aria-hidden=\"true\" />\n          <div className=\"error-state-text\">\n            <span className=\"error-state-title\">{title}</span>\n            <span className=\"error-state-message\">{message}</span>\n          </div>\n        </div>\n        {onRetry && (\n          <button className=\"btn btn-secondary btn-small\" onClick={onRetry}>\n            <RefreshCw size={14} /> {retryLabel}\n          </button>\n        )}\n      </div>\n    )\n  }\n\n  // Default variant - centered with full details\n  return (\n    <div className=\"error-state\" role=\"alert\" aria-live=\"polite\">\n      <div className=\"error-state-icon-wrapper\">\n        <Icon size={32} className=\"error-state-icon\" aria-hidden=\"true\" />\n      </div>\n      <h4 className=\"error-state-title\">{title}</h4>\n      <p className=\"error-state-message\">{message}</p>\n\n      {/* Show error details in development */}\n      {import.meta.env.DEV && error && (\n        <details className=\"error-state-details\">\n          <summary>Error Details</summary>\n          <pre>{error.message || String(error)}</pre>\n        </details>\n      )}\n\n      {onRetry && (\n        <button className=\"btn btn-primary\" onClick={onRetry}>\n          <RefreshCw size={16} /> {retryLabel}\n        </button>\n      )}\n    </div>\n  )\n})\n\n/**\n * EmptyState - Reusable empty state component\n * Shows when a list/data is empty (no error, just no data)\n */\nexport const EmptyState = memo(function EmptyState({\n  title = 'No data yet',\n  message = 'Items will appear here once added.',\n  icon: Icon = null,\n  action = null,\n  actionLabel = 'Get Started',\n  onAction = null\n}) {\n  return (\n    <div className=\"empty-state\" role=\"status\">\n      {Icon && (\n        <div className=\"empty-state-icon-wrapper\">\n          <Icon size={32} className=\"empty-state-icon\" aria-hidden=\"true\" />\n        </div>\n      )}\n      <h4 className=\"empty-state-title\">{title}</h4>\n      <p className=\"empty-state-message\">{message}</p>\n      {onAction && (\n        <button className=\"btn btn-primary btn-small\" onClick={onAction}>\n          {actionLabel}\n        </button>\n      )}\n      {action && !onAction && action}\n    </div>\n  )\n})\n\nexport default ErrorState\n","import { memo } from 'react'\nimport { AlertCircle } from 'lucide-react'\n\n/**\n * FormField - Reusable form field wrapper with validation display\n * Provides consistent styling and error handling for form inputs\n */\nexport const FormField = memo(function FormField({\n  label,\n  error,\n  required = false,\n  hint,\n  children,\n  className = ''\n}) {\n  return (\n    <div className={`form-field ${error ? 'has-error' : ''} ${className}`}>\n      {label && (\n        <label className=\"form-field-label\">\n          {label}\n          {required && <span className=\"form-field-required\">*</span>}\n        </label>\n      )}\n      <div className=\"form-field-input\">\n        {children}\n      </div>\n      {error && (\n        <div className=\"form-field-error\" role=\"alert\">\n          <AlertCircle size={14} aria-hidden=\"true\" />\n          <span>{error}</span>\n        </div>\n      )}\n      {hint && !error && (\n        <div className=\"form-field-hint\">{hint}</div>\n      )}\n    </div>\n  )\n})\n\n/**\n * ValidatedInput - Input with built-in validation styling\n */\nexport const ValidatedInput = memo(function ValidatedInput({\n  type = 'text',\n  value,\n  onChange,\n  onBlur,\n  error,\n  placeholder,\n  disabled,\n  min,\n  max,\n  step,\n  pattern,\n  required,\n  autoComplete,\n  name,\n  id,\n  className = '',\n  'aria-label': ariaLabel,\n  'aria-describedby': ariaDescribedBy\n}) {\n  const inputId = id || name\n  const errorId = error ? `${inputId}-error` : undefined\n\n  return (\n    <>\n      <input\n        type={type}\n        id={inputId}\n        name={name}\n        value={value}\n        onChange={onChange}\n        onBlur={onBlur}\n        placeholder={placeholder}\n        disabled={disabled}\n        min={min}\n        max={max}\n        step={step}\n        pattern={pattern}\n        required={required}\n        autoComplete={autoComplete}\n        className={`validated-input ${error ? 'has-error' : ''} ${className}`}\n        aria-label={ariaLabel}\n        aria-invalid={!!error}\n        aria-describedby={error ? errorId : ariaDescribedBy}\n      />\n      {error && (\n        <div id={errorId} className=\"input-error-inline\" role=\"alert\">\n          <AlertCircle size={12} aria-hidden=\"true\" />\n          <span>{error}</span>\n        </div>\n      )}\n    </>\n  )\n})\n\n/**\n * ValidatedSelect - Select with built-in validation styling\n */\nexport const ValidatedSelect = memo(function ValidatedSelect({\n  value,\n  onChange,\n  onBlur,\n  error,\n  disabled,\n  required,\n  name,\n  id,\n  className = '',\n  children,\n  'aria-label': ariaLabel\n}) {\n  const selectId = id || name\n  const errorId = error ? `${selectId}-error` : undefined\n\n  return (\n    <>\n      <select\n        id={selectId}\n        name={name}\n        value={value}\n        onChange={onChange}\n        onBlur={onBlur}\n        disabled={disabled}\n        required={required}\n        className={`validated-select ${error ? 'has-error' : ''} ${className}`}\n        aria-label={ariaLabel}\n        aria-invalid={!!error}\n        aria-describedby={error ? errorId : undefined}\n      >\n        {children}\n      </select>\n      {error && (\n        <div id={errorId} className=\"input-error-inline\" role=\"alert\">\n          <AlertCircle size={12} aria-hidden=\"true\" />\n          <span>{error}</span>\n        </div>\n      )}\n    </>\n  )\n})\n\n/**\n * ValidatedTextarea - Textarea with built-in validation styling\n */\nexport const ValidatedTextarea = memo(function ValidatedTextarea({\n  value,\n  onChange,\n  onBlur,\n  error,\n  placeholder,\n  disabled,\n  required,\n  rows = 3,\n  maxLength,\n  name,\n  id,\n  className = '',\n  'aria-label': ariaLabel\n}) {\n  const textareaId = id || name\n  const errorId = error ? `${textareaId}-error` : undefined\n\n  return (\n    <>\n      <textarea\n        id={textareaId}\n        name={name}\n        value={value}\n        onChange={onChange}\n        onBlur={onBlur}\n        placeholder={placeholder}\n        disabled={disabled}\n        required={required}\n        rows={rows}\n        maxLength={maxLength}\n        className={`validated-textarea ${error ? 'has-error' : ''} ${className}`}\n        aria-label={ariaLabel}\n        aria-invalid={!!error}\n        aria-describedby={error ? errorId : undefined}\n      />\n      {maxLength && (\n        <div className=\"textarea-counter\">\n          {value?.length || 0} / {maxLength}\n        </div>\n      )}\n      {error && (\n        <div id={errorId} className=\"input-error-inline\" role=\"alert\">\n          <AlertCircle size={12} aria-hidden=\"true\" />\n          <span>{error}</span>\n        </div>\n      )}\n    </>\n  )\n})\n\nexport default FormField\n","import { memo, useEffect, useState, useRef } from 'react'\nimport { TrendingUp, TrendingDown, Minus, Check, AlertTriangle, Clock } from 'lucide-react'\n\n/**\n * Micro-Visualizations - Small, informative visual elements\n * Designed to replace mental calculation and clarify status at a glance\n */\n\n// Animated count badge with optional pulse for new items\nexport const CountBadge = memo(function CountBadge({\n  count,\n  label,\n  variant = 'default', // 'default' | 'primary' | 'success' | 'warning' | 'danger'\n  size = 'medium', // 'small' | 'medium' | 'large'\n  pulse = false,\n  icon: Icon\n}) {\n  const [prevCount, setPrevCount] = useState(count)\n  const [animating, setAnimating] = useState(false)\n\n  useEffect(() => {\n    if (count !== prevCount) {\n      setAnimating(true)\n      const timer = setTimeout(() => {\n        setAnimating(false)\n        setPrevCount(count)\n      }, 400)\n      return () => clearTimeout(timer)\n    }\n  }, [count, prevCount])\n\n  return (\n    <span\n      className={`count-badge count-badge-${variant} count-badge-${size} ${pulse ? 'badge-new' : ''} ${animating ? 'animate-count-up' : ''}`}\n      title={label}\n    >\n      {Icon && <Icon size={size === 'small' ? 12 : size === 'large' ? 18 : 14} />}\n      <span className=\"count-badge-value\">{count}</span>\n      {label && <span className=\"count-badge-label\">{label}</span>}\n    </span>\n  )\n})\n\n// Mini progress bar for inline usage\nexport const MiniProgress = memo(function MiniProgress({\n  value,\n  max = 100,\n  showLabel = false,\n  size = 'medium', // 'small' | 'medium' | 'large'\n  variant = 'default', // 'default' | 'success' | 'warning' | 'danger'\n  animated = true\n}) {\n  const percentage = Math.min(100, Math.max(0, (value / max) * 100))\n  const height = size === 'small' ? '4px' : size === 'large' ? '8px' : '6px'\n\n  // Auto-determine variant based on percentage if not specified\n  const autoVariant = variant === 'default'\n    ? percentage >= 80 ? 'danger' : percentage >= 60 ? 'warning' : 'success'\n    : variant\n\n  return (\n    <div className={`mini-progress mini-progress-${size}`}>\n      <div className=\"mini-progress-track\" style={{ height }}>\n        <div\n          className={`mini-progress-fill mini-progress-${autoVariant} ${animated ? 'progress-animate' : ''}`}\n          style={{ width: `${percentage}%` }}\n        />\n      </div>\n      {showLabel && (\n        <span className=\"mini-progress-label\">{Math.round(percentage)}%</span>\n      )}\n    </div>\n  )\n})\n\n// Trend indicator with direction and value\nexport const TrendIndicator = memo(function TrendIndicator({\n  value,\n  previousValue,\n  format = 'percent', // 'percent' | 'number' | 'currency'\n  inverted = false, // If true, down is good (e.g., costs)\n  showValue = true\n}) {\n  const diff = value - previousValue\n  const percentChange = previousValue !== 0 ? ((diff / previousValue) * 100) : 0\n\n  let direction = diff === 0 ? 'neutral' : diff > 0 ? 'up' : 'down'\n  let status = 'neutral'\n\n  if (diff !== 0) {\n    if (inverted) {\n      status = diff > 0 ? 'negative' : 'positive'\n    } else {\n      status = diff > 0 ? 'positive' : 'negative'\n    }\n  }\n\n  const Icon = direction === 'up' ? TrendingUp : direction === 'down' ? TrendingDown : Minus\n\n  const formatValue = () => {\n    const absChange = Math.abs(diff)\n    switch (format) {\n      case 'percent':\n        return `${Math.abs(percentChange).toFixed(1)}%`\n      case 'currency':\n        return new Intl.NumberFormat('en-US', {\n          style: 'currency',\n          currency: 'USD',\n          minimumFractionDigits: 0,\n          maximumFractionDigits: 0\n        }).format(absChange)\n      default:\n        return absChange.toLocaleString()\n    }\n  }\n\n  return (\n    <span className={`trend-indicator trend-${status}`}>\n      <Icon size={14} />\n      {showValue && <span className=\"trend-value\">{formatValue()}</span>}\n    </span>\n  )\n})\n\n// Status dot with optional label\nexport const StatusDot = memo(function StatusDot({\n  status = 'default', // 'default' | 'success' | 'warning' | 'danger' | 'info'\n  label,\n  size = 'medium', // 'small' | 'medium' | 'large'\n  pulse = false\n}) {\n  return (\n    <span className={`status-dot-container status-dot-${size}`}>\n      <span className={`status-dot status-dot-${status} ${pulse ? 'status-dot-pulse' : ''}`} />\n      {label && <span className=\"status-dot-label\">{label}</span>}\n    </span>\n  )\n})\n\n// Sparkline - mini line chart\nexport const Sparkline = memo(function Sparkline({\n  data = [],\n  width = 80,\n  height = 24,\n  strokeWidth = 2,\n  color = 'var(--accent-blue)',\n  showArea = true\n}) {\n  if (!data.length) return null\n\n  const max = Math.max(...data)\n  const min = Math.min(...data)\n  const range = max - min || 1\n\n  const points = data.map((value, index) => {\n    const x = (index / (data.length - 1)) * width\n    const y = height - ((value - min) / range) * (height - strokeWidth * 2) - strokeWidth\n    return `${x},${y}`\n  }).join(' ')\n\n  const areaPoints = `0,${height} ${points} ${width},${height}`\n\n  return (\n    <svg\n      width={width}\n      height={height}\n      className=\"sparkline\"\n      viewBox={`0 0 ${width} ${height}`}\n    >\n      {showArea && (\n        <polygon\n          points={areaPoints}\n          fill={color}\n          fillOpacity=\"0.15\"\n        />\n      )}\n      <polyline\n        points={points}\n        fill=\"none\"\n        stroke={color}\n        strokeWidth={strokeWidth}\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n      />\n    </svg>\n  )\n})\n\n// Quick stats row (e.g., \"3 workers  2.5 hrs  $450\")\nexport const QuickStats = memo(function QuickStats({ items = [] }) {\n  return (\n    <div className=\"quick-stats\">\n      {items.map((item, index) => (\n        <span key={index} className=\"quick-stat-item\">\n          {item.icon && <item.icon size={12} />}\n          <span className=\"quick-stat-value\">{item.value}</span>\n          {item.label && <span className=\"quick-stat-label\">{item.label}</span>}\n        </span>\n      ))}\n    </div>\n  )\n})\n\n// Status indicator with icon\nexport const StatusIndicator = memo(function StatusIndicator({\n  status, // 'success' | 'warning' | 'danger' | 'info' | 'pending'\n  label,\n  size = 'medium'\n}) {\n  const icons = {\n    success: Check,\n    warning: AlertTriangle,\n    danger: AlertTriangle,\n    info: Clock,\n    pending: Clock\n  }\n\n  const Icon = icons[status] || icons.info\n\n  return (\n    <span className={`status-indicator status-indicator-${status} status-indicator-${size}`}>\n      <Icon size={size === 'small' ? 12 : size === 'large' ? 18 : 14} />\n      {label && <span className=\"status-indicator-label\">{label}</span>}\n    </span>\n  )\n})\n\n// Metric delta (change from previous)\nexport const MetricDelta = memo(function MetricDelta({\n  current,\n  previous,\n  format = 'number', // 'number' | 'currency' | 'percent'\n  label,\n  inverted = false\n}) {\n  const delta = current - previous\n  const isPositive = inverted ? delta < 0 : delta > 0\n  const isNegative = inverted ? delta > 0 : delta < 0\n\n  const formatValue = (val) => {\n    switch (format) {\n      case 'currency':\n        return new Intl.NumberFormat('en-US', {\n          style: 'currency',\n          currency: 'USD',\n          minimumFractionDigits: 0\n        }).format(Math.abs(val))\n      case 'percent':\n        return `${Math.abs(val).toFixed(1)}%`\n      default:\n        return Math.abs(val).toLocaleString()\n    }\n  }\n\n  return (\n    <div className={`metric-delta ${isPositive ? 'positive' : isNegative ? 'negative' : 'neutral'}`}>\n      <span className=\"metric-delta-arrow\">\n        {delta > 0 ? '' : delta < 0 ? '' : ''}\n      </span>\n      <span className=\"metric-delta-value\">{formatValue(delta)}</span>\n      {label && <span className=\"metric-delta-label\">{label}</span>}\n    </div>\n  )\n})\n\n// Circular progress (donut style)\nexport const CircularProgress = memo(function CircularProgress({\n  value,\n  max = 100,\n  size = 40,\n  strokeWidth = 4,\n  showValue = true,\n  color = 'var(--accent-blue)'\n}) {\n  const percentage = Math.min(100, Math.max(0, (value / max) * 100))\n  const radius = (size - strokeWidth) / 2\n  const circumference = radius * 2 * Math.PI\n  const offset = circumference - (percentage / 100) * circumference\n\n  return (\n    <div className=\"circular-progress\" style={{ width: size, height: size }}>\n      <svg width={size} height={size} viewBox={`0 0 ${size} ${size}`}>\n        <circle\n          className=\"circular-progress-track\"\n          cx={size / 2}\n          cy={size / 2}\n          r={radius}\n          fill=\"none\"\n          strokeWidth={strokeWidth}\n        />\n        <circle\n          className=\"circular-progress-fill\"\n          cx={size / 2}\n          cy={size / 2}\n          r={radius}\n          fill=\"none\"\n          stroke={color}\n          strokeWidth={strokeWidth}\n          strokeDasharray={circumference}\n          strokeDashoffset={offset}\n          strokeLinecap=\"round\"\n          transform={`rotate(-90 ${size / 2} ${size / 2})`}\n          style={{ transition: 'stroke-dashoffset 0.5s ease' }}\n        />\n      </svg>\n      {showValue && (\n        <span className=\"circular-progress-value\">\n          {Math.round(percentage)}%\n        </span>\n      )}\n    </div>\n  )\n})\n\nexport default {\n  CountBadge,\n  MiniProgress,\n  TrendIndicator,\n  StatusDot,\n  Sparkline,\n  QuickStats,\n  StatusIndicator,\n  MetricDelta,\n  CircularProgress\n}\n","import { useEffect, useRef, useCallback, memo } from 'react'\nimport { X } from 'lucide-react'\n\n/**\n * Accessible Modal Component\n *\n * Features:\n * - Proper ARIA attributes (role=\"dialog\", aria-modal, aria-labelledby)\n * - Focus trap within modal\n * - Escape key to close\n * - Click outside to close\n * - Focus restoration on close\n *\n * Usage:\n *   <Modal\n *     isOpen={showModal}\n *     onClose={() => setShowModal(false)}\n *     title=\"Modal Title\"\n *     size=\"medium\"\n *   >\n *     <p>Modal content here</p>\n *   </Modal>\n */\nconst Modal = memo(function Modal({\n  isOpen,\n  onClose,\n  title,\n  children,\n  size = 'medium', // 'small' | 'medium' | 'large' | 'full'\n  className = '',\n  showCloseButton = true,\n  closeOnOverlayClick = true,\n  closeOnEscape = true,\n  footer,\n  ariaDescribedBy\n}) {\n  const modalRef = useRef(null)\n  const previousActiveElement = useRef(null)\n  const titleId = useRef(`modal-title-${Math.random().toString(36).substr(2, 9)}`)\n\n  // Store the previously focused element and focus the modal when it opens\n  useEffect(() => {\n    if (isOpen) {\n      previousActiveElement.current = document.activeElement\n      // Focus the modal container after a brief delay to ensure it's rendered\n      const timer = setTimeout(() => {\n        modalRef.current?.focus()\n      }, 10)\n      return () => clearTimeout(timer)\n    }\n  }, [isOpen])\n\n  // Restore focus when modal closes\n  useEffect(() => {\n    if (!isOpen && previousActiveElement.current) {\n      previousActiveElement.current.focus()\n    }\n  }, [isOpen])\n\n  // Handle escape key\n  useEffect(() => {\n    if (!isOpen || !closeOnEscape) return\n\n    const handleKeyDown = (e) => {\n      if (e.key === 'Escape') {\n        e.preventDefault()\n        onClose()\n      }\n    }\n\n    document.addEventListener('keydown', handleKeyDown)\n    return () => document.removeEventListener('keydown', handleKeyDown)\n  }, [isOpen, closeOnEscape, onClose])\n\n  // Prevent body scroll when modal is open\n  useEffect(() => {\n    if (isOpen) {\n      const originalOverflow = document.body.style.overflow\n      document.body.style.overflow = 'hidden'\n      return () => {\n        document.body.style.overflow = originalOverflow\n      }\n    }\n  }, [isOpen])\n\n  // Focus trap\n  const handleKeyDown = useCallback((e) => {\n    if (e.key !== 'Tab') return\n\n    const focusableElements = modalRef.current?.querySelectorAll(\n      'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n    )\n\n    if (!focusableElements || focusableElements.length === 0) return\n\n    const firstElement = focusableElements[0]\n    const lastElement = focusableElements[focusableElements.length - 1]\n\n    if (e.shiftKey) {\n      if (document.activeElement === firstElement) {\n        e.preventDefault()\n        lastElement.focus()\n      }\n    } else {\n      if (document.activeElement === lastElement) {\n        e.preventDefault()\n        firstElement.focus()\n      }\n    }\n  }, [])\n\n  const handleOverlayClick = (e) => {\n    if (closeOnOverlayClick && e.target === e.currentTarget) {\n      onClose()\n    }\n  }\n\n  if (!isOpen) return null\n\n  const sizeClasses = {\n    small: 'modal-small',\n    medium: 'modal-medium',\n    large: 'modal-large',\n    full: 'modal-full'\n  }\n\n  return (\n    <div\n      className=\"modal-overlay\"\n      onClick={handleOverlayClick}\n      role=\"presentation\"\n    >\n      <div\n        ref={modalRef}\n        className={`modal-content ${sizeClasses[size] || ''} ${className}`}\n        role=\"dialog\"\n        aria-modal=\"true\"\n        aria-labelledby={title ? titleId.current : undefined}\n        aria-describedby={ariaDescribedBy}\n        tabIndex={-1}\n        onKeyDown={handleKeyDown}\n        onClick={(e) => e.stopPropagation()}\n      >\n        {title && (\n          <div className=\"modal-header\">\n            <h2 id={titleId.current}>{title}</h2>\n            {showCloseButton && (\n              <button\n                className=\"close-btn\"\n                onClick={onClose}\n                aria-label=\"Close modal\"\n                type=\"button\"\n              >\n                <X size={20} />\n              </button>\n            )}\n          </div>\n        )}\n\n        <div className=\"modal-body\">\n          {children}\n        </div>\n\n        {footer && (\n          <div className=\"modal-footer\">\n            {footer}\n          </div>\n        )}\n      </div>\n    </div>\n  )\n})\n\nexport default Modal\n","import { memo, useMemo } from 'react'\nimport { DollarSign, TrendingUp, Receipt, PiggyBank } from 'lucide-react'\nimport { HeroMetricsSkeleton, MiniProgress, TrendIndicator } from './ui'\n\n/**\n * HeroMetrics - Top-level financial summary for project dashboard\n * Designed for instant comprehension of project financial health\n */\n\nconst formatCurrency = (amount) => {\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD',\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0\n  }).format(amount || 0)\n}\n\nconst MetricCard = memo(function MetricCard({\n  icon: Icon,\n  label,\n  value,\n  formattedValue,\n  subLabel,\n  progress,\n  progressLabel,\n  variant = 'default', // 'default' | 'success' | 'warning' | 'danger'\n  trend,\n  previousValue\n}) {\n  const variantColors = {\n    default: 'var(--accent-blue)',\n    success: 'var(--accent-green)',\n    warning: 'var(--accent-amber)',\n    danger: 'var(--accent-red)'\n  }\n\n  return (\n    <div className={`hero-metric-card hover-lift animate-fade-in-up`}>\n      <div className=\"hero-metric-header\">\n        <div className=\"hero-metric-icon\" style={{ color: variantColors[variant] }}>\n          <Icon size={18} />\n        </div>\n        <span className=\"hero-metric-label\">{label}</span>\n      </div>\n\n      <div className=\"hero-metric-value-row\">\n        <span className={`hero-metric-value hero-metric-${variant}`}>\n          {formattedValue}\n        </span>\n        {trend !== undefined && previousValue !== undefined && (\n          <TrendIndicator\n            value={value}\n            previousValue={previousValue}\n            format=\"currency\"\n            inverted={label.toLowerCase().includes('cost')}\n          />\n        )}\n      </div>\n\n      {subLabel && (\n        <span className=\"hero-metric-sublabel\">{subLabel}</span>\n      )}\n\n      {progress !== undefined && (\n        <div className=\"hero-metric-progress\">\n          <MiniProgress\n            value={progress}\n            max={100}\n            size=\"small\"\n            variant={variant}\n            showLabel\n          />\n          {progressLabel && (\n            <span className=\"hero-metric-progress-label\">{progressLabel}</span>\n          )}\n        </div>\n      )}\n    </div>\n  )\n})\n\nexport default memo(function HeroMetrics({\n  contractValue = 0,\n  earnedRevenue = 0,\n  totalCosts = 0,\n  profit = 0,\n  progress = 0,\n  corApprovedValue = 0,\n  loading = false,\n  previousData // Optional: for trend indicators\n}) {\n  // Calculate derived values\n  const revisedContract = contractValue + corApprovedValue\n  const profitMargin = earnedRevenue > 0 ? ((profit / earnedRevenue) * 100) : 0\n  const costRatio = earnedRevenue > 0 ? ((totalCosts / earnedRevenue) * 100) : 0\n  const revenueProgress = revisedContract > 0 ? ((earnedRevenue / revisedContract) * 100) : 0\n  const costProgress = revisedContract > 0 ? ((totalCosts / revisedContract) * 100) : 0\n\n  // Determine profit status\n  const profitVariant = useMemo(() => {\n    if (profitMargin >= 20) return 'success'\n    if (profitMargin >= 10) return 'warning'\n    if (profitMargin < 0) return 'danger'\n    return 'default'\n  }, [profitMargin])\n\n  // Determine cost status\n  const costVariant = useMemo(() => {\n    if (costRatio <= 60) return 'success'\n    if (costRatio <= 80) return 'warning'\n    return 'danger'\n  }, [costRatio])\n\n  if (loading) {\n    return <HeroMetricsSkeleton />\n  }\n\n  return (\n    <div className=\"hero-metrics stagger-children\">\n      {/* Contract Value */}\n      <MetricCard\n        icon={DollarSign}\n        label=\"Contract Value\"\n        value={revisedContract}\n        formattedValue={formatCurrency(revisedContract)}\n        subLabel={corApprovedValue > 0 ? `+${formatCurrency(corApprovedValue)} CORs` : null}\n        variant=\"default\"\n      />\n\n      {/* Earned Revenue */}\n      <MetricCard\n        icon={TrendingUp}\n        label=\"Earned Revenue\"\n        value={earnedRevenue}\n        formattedValue={formatCurrency(earnedRevenue)}\n        progress={revenueProgress}\n        progressLabel={`${Math.round(revenueProgress)}% of contract`}\n        variant=\"success\"\n        previousValue={previousData?.earnedRevenue}\n        trend={previousData ? earnedRevenue : undefined}\n      />\n\n      {/* Total Costs */}\n      <MetricCard\n        icon={Receipt}\n        label=\"Total Costs\"\n        value={totalCosts}\n        formattedValue={formatCurrency(totalCosts)}\n        progress={costProgress}\n        progressLabel={`${Math.round(costRatio)}% of revenue`}\n        variant={costVariant}\n        previousValue={previousData?.totalCosts}\n        trend={previousData ? totalCosts : undefined}\n      />\n\n      {/* Profit */}\n      <MetricCard\n        icon={PiggyBank}\n        label=\"Profit\"\n        value={profit}\n        formattedValue={formatCurrency(profit)}\n        subLabel={`${profitMargin >= 0 ? '+' : ''}${profitMargin.toFixed(1)}% margin`}\n        variant={profitVariant}\n        previousValue={previousData?.profit}\n        trend={previousData ? profit : undefined}\n      />\n    </div>\n  )\n})\n","import { memo } from 'react'\nimport { BarChart3, FileText, ClipboardList, Receipt, ChevronRight, ChevronLeft, PanelLeftOpen, X } from 'lucide-react'\nimport { CountBadge } from './ui'\n\n/**\n * FinancialsNav - Collapsible sidebar navigation for Financials tab\n *\n * Design principles:\n * - Workflow order: Overview  CORs  T&M (reflects natural process)\n * - Collapsible to maximize content real estate\n * - Clear visual hierarchy with active states\n * - Badges show pending items requiring attention\n */\n\nconst NAV_ITEMS = [\n  {\n    id: 'overview',\n    label: 'Overview',\n    shortLabel: 'Overview',\n    icon: BarChart3,\n    description: 'Metrics & trends',\n    step: null\n  },\n  {\n    id: 'cors',\n    label: 'Change Orders',\n    shortLabel: 'CORs',\n    icon: FileText,\n    description: 'CORs & approvals',\n    step: 1\n  },\n  {\n    id: 'tickets',\n    label: 'T&M Tickets',\n    shortLabel: 'Tickets',\n    icon: ClipboardList,\n    description: 'Field data',\n    step: 2\n  },\n  {\n    id: 'billing',\n    label: 'Billing',\n    shortLabel: 'Billing',\n    icon: Receipt,\n    description: 'Invoices & billing',\n    step: 3\n  }\n]\n\nexport default memo(function FinancialsNav({\n  activeSection = 'overview',\n  onSectionChange,\n  collapsed = false,\n  onToggleCollapse,\n  onMobileClose,\n  stats = {}\n}) {\n  const {\n    corCount = 0,\n    ticketCount = 0,\n    corPending = 0,\n    ticketPending = 0,\n    billableCount = 0,\n    invoiceCount = 0\n  } = stats\n\n  // Get badge config for each section\n  const getBadge = (itemId) => {\n    if (itemId === 'cors' && corCount > 0) {\n      return {\n        count: corCount,\n        variant: corPending > 0 ? 'warning' : 'default',\n        pending: corPending\n      }\n    }\n    if (itemId === 'tickets' && ticketCount > 0) {\n      return {\n        count: ticketCount,\n        variant: ticketPending > 0 ? 'warning' : 'default',\n        pending: ticketPending\n      }\n    }\n    if (itemId === 'billing' && billableCount > 0) {\n      return {\n        count: billableCount,\n        variant: 'success', // Green to indicate money ready to collect\n        pending: billableCount\n      }\n    }\n    return null\n  }\n\n  return (\n    <nav\n      className={`financials-nav ${collapsed ? 'collapsed' : ''}`}\n      aria-label=\"Financials sections\"\n    >\n      {/* Mobile Header with Close Button */}\n      {onMobileClose && (\n        <div className=\"financials-nav-mobile-header\">\n          <span className=\"financials-nav-mobile-title\">Financials</span>\n          <button\n            className=\"financials-nav-mobile-close\"\n            onClick={onMobileClose}\n            aria-label=\"Close menu\"\n          >\n            <X size={20} />\n          </button>\n        </div>\n      )}\n\n      {/* Collapse Toggle - hidden on mobile */}\n      <button\n        className=\"financials-nav-toggle\"\n        onClick={onToggleCollapse}\n        aria-label={collapsed ? 'Expand sidebar' : 'Collapse sidebar'}\n        title={collapsed ? 'Expand sidebar' : 'Collapse sidebar'}\n      >\n        {collapsed ? (\n          <PanelLeftOpen size={18} />\n        ) : (\n          <ChevronLeft size={18} />\n        )}\n        {!collapsed && <span>Collapse</span>}\n      </button>\n\n      {/* Navigation Items */}\n      <div className=\"financials-nav-items\">\n        {NAV_ITEMS.map((item, index) => {\n          const isActive = activeSection === item.id\n          const Icon = item.icon\n          const badge = getBadge(item.id)\n          const showConnector = index < NAV_ITEMS.length - 1 && item.step !== null\n\n          return (\n            <div key={item.id} className=\"financials-nav-item-wrapper\">\n              <button\n                className={`financials-nav-item ${isActive ? 'active' : ''}`}\n                onClick={() => onSectionChange?.(item.id)}\n                aria-current={isActive ? 'page' : undefined}\n                title={`${item.label}${badge ? ` (${badge.count})` : ''}`}\n              >\n                {/* Step indicator for workflow items - only in expanded mode */}\n                {item.step && !collapsed && (\n                  <span className=\"financials-nav-step\">{item.step}</span>\n                )}\n\n                {/* Icon with optional badge dot */}\n                <div className=\"financials-nav-icon\">\n                  <Icon size={collapsed ? 22 : 20} />\n                  {/* Badge dot for pending items */}\n                  {badge && badge.pending > 0 && (\n                    <span className=\"financials-nav-dot\" />\n                  )}\n                </div>\n\n                {/* Collapsed mode: show short label below icon */}\n                {collapsed && (\n                  <span className=\"financials-nav-short-label\">{item.shortLabel}</span>\n                )}\n\n                {/* Expanded mode: show full content */}\n                {!collapsed && (\n                  <>\n                    <div className=\"financials-nav-content\">\n                      <span className=\"financials-nav-label\">{item.label}</span>\n                      <span className=\"financials-nav-desc\">{item.description}</span>\n                    </div>\n\n                    {/* Badge */}\n                    {badge && (\n                      <CountBadge\n                        count={badge.count}\n                        size=\"small\"\n                        variant={badge.variant}\n                      />\n                    )}\n\n                    {/* Arrow */}\n                    <ChevronRight size={16} className=\"financials-nav-arrow\" />\n                  </>\n                )}\n              </button>\n\n              {/* Workflow connector line */}\n              {showConnector && !collapsed && (\n                <div className=\"financials-nav-connector\">\n                  <div className=\"connector-line\" />\n                </div>\n              )}\n            </div>\n          )\n        })}\n      </div>\n\n      {/* Toggle label when collapsed */}\n      {collapsed && (\n        <button\n          className=\"financials-nav-expand-btn\"\n          onClick={onToggleCollapse}\n          aria-label=\"Expand sidebar\"\n        >\n          <ChevronRight size={14} />\n          <span>Expand</span>\n        </button>\n      )}\n    </nav>\n  )\n})\n","import { memo, useEffect, useState, useRef } from 'react'\n\n/**\n * OverviewProgressGauge - Large circular progress indicator for project overview\n * Shows completion percentage with animated stroke and areas status\n */\nexport const OverviewProgressGauge = memo(function OverviewProgressGauge({\n  progress = 0,\n  areasComplete = 0,\n  totalAreas = 0,\n  areasWorking = 0,\n  size = 140,\n  strokeWidth = 10\n}) {\n  const [animatedProgress, setAnimatedProgress] = useState(0)\n  const animationRef = useRef(null)\n\n  // Animate progress on mount/change\n  useEffect(() => {\n    const startValue = animatedProgress\n    const endValue = Math.min(100, Math.max(0, progress))\n    const duration = 800\n    const startTime = performance.now()\n\n    const animate = (currentTime) => {\n      const elapsed = currentTime - startTime\n      const progressRatio = Math.min(elapsed / duration, 1)\n\n      // Ease out cubic\n      const eased = 1 - Math.pow(1 - progressRatio, 3)\n      const current = startValue + (endValue - startValue) * eased\n\n      setAnimatedProgress(current)\n\n      if (progressRatio < 1) {\n        animationRef.current = requestAnimationFrame(animate)\n      }\n    }\n\n    animationRef.current = requestAnimationFrame(animate)\n\n    return () => {\n      if (animationRef.current) {\n        cancelAnimationFrame(animationRef.current)\n      }\n    }\n  }, [progress])\n\n  const radius = (size - strokeWidth) / 2\n  const circumference = radius * 2 * Math.PI\n  const offset = circumference - (animatedProgress / 100) * circumference\n\n  // Color based on progress\n  const getProgressColor = () => {\n    if (animatedProgress >= 80) return 'var(--accent-green)'\n    if (animatedProgress >= 50) return 'var(--accent-blue)'\n    if (animatedProgress >= 25) return 'var(--accent-blue)'\n    return 'var(--text-muted)'\n  }\n\n  return (\n    <div className=\"overview-progress-gauge\">\n      <div className=\"progress-gauge-circle\" style={{ width: size, height: size }}>\n        <svg width={size} height={size} viewBox={`0 0 ${size} ${size}`}>\n          {/* Background track */}\n          <circle\n            className=\"gauge-track\"\n            cx={size / 2}\n            cy={size / 2}\n            r={radius}\n            fill=\"none\"\n            strokeWidth={strokeWidth}\n            stroke=\"var(--bg-tertiary)\"\n          />\n          {/* Progress arc */}\n          <circle\n            className=\"gauge-fill\"\n            cx={size / 2}\n            cy={size / 2}\n            r={radius}\n            fill=\"none\"\n            stroke={getProgressColor()}\n            strokeWidth={strokeWidth}\n            strokeDasharray={circumference}\n            strokeDashoffset={offset}\n            strokeLinecap=\"round\"\n            transform={`rotate(-90 ${size / 2} ${size / 2})`}\n            style={{ transition: 'stroke 0.3s ease' }}\n          />\n        </svg>\n        {/* Center content */}\n        <div className=\"gauge-center\">\n          <span className=\"gauge-value\">{Math.round(animatedProgress)}%</span>\n          <span className=\"gauge-label\">Complete</span>\n        </div>\n      </div>\n\n      {/* Areas status below */}\n      <div className=\"gauge-areas-status\">\n        <span className=\"areas-count\">\n          <strong>{areasComplete}</strong>/{totalAreas} Areas Done\n        </span>\n        {areasWorking > 0 && (\n          <span className=\"areas-active\">{areasWorking} active</span>\n        )}\n      </div>\n    </div>\n  )\n})\n\nexport default OverviewProgressGauge\n","import { memo, useEffect, useState, useRef } from 'react'\nimport { TrendingUp, TrendingDown, Minus } from 'lucide-react'\nimport { chartColors } from '../charts/chartConfig'\n\n/**\n * OverviewFinancialCard - Compact financial snapshot for project overview\n * Shows earned, costs, profit with mini cost breakdown bar\n */\nexport const OverviewFinancialCard = memo(function OverviewFinancialCard({\n  earnedRevenue = 0,\n  totalCosts = 0,\n  laborCost = 0,\n  disposalCost = 0,\n  equipmentCost = 0,\n  materialsCost = 0,\n  otherCost = 0,\n  contractValue = 0\n}) {\n  const profit = earnedRevenue - totalCosts\n  const margin = earnedRevenue > 0 ? (profit / earnedRevenue) * 100 : 0\n  const isPositive = profit >= 0\n\n  // Format currency\n  const formatCurrency = (value) => {\n    if (value >= 1000000) {\n      return `$${(value / 1000000).toFixed(1)}M`\n    }\n    if (value >= 1000) {\n      return `$${(value / 1000).toFixed(1)}K`\n    }\n    return `$${value.toFixed(0)}`\n  }\n\n  // Calculate cost breakdown percentages for the stacked bar\n  const costBreakdown = [\n    { key: 'labor', value: laborCost, color: chartColors.labor, label: 'Labor' },\n    { key: 'disposal', value: disposalCost, color: chartColors.disposal, label: 'Disposal' },\n    { key: 'equipment', value: equipmentCost, color: chartColors.equipment, label: 'Equipment' },\n    { key: 'materials', value: materialsCost, color: chartColors.materials, label: 'Materials' },\n    { key: 'other', value: otherCost, color: chartColors.other, label: 'Other' }\n  ].filter(item => item.value > 0)\n\n  const hasBreakdown = costBreakdown.length > 0 && totalCosts > 0\n\n  return (\n    <div className=\"overview-financial-card animate-fade-in-up\">\n      {/* Main metrics row */}\n      <div className=\"financial-metrics-row\">\n        {/* Earned */}\n        <div className=\"financial-metric\">\n          <span className=\"financial-metric-value green\">{formatCurrency(earnedRevenue)}</span>\n          <span className=\"financial-metric-label\">Earned</span>\n        </div>\n\n        {/* Costs */}\n        <div className=\"financial-metric\">\n          <span className=\"financial-metric-value amber\">{formatCurrency(totalCosts)}</span>\n          <span className=\"financial-metric-label\">Costs</span>\n        </div>\n\n        {/* Profit */}\n        <div className=\"financial-metric\">\n          <span className={`financial-metric-value ${isPositive ? 'green' : 'red'}`}>\n            {isPositive ? '' : '-'}{formatCurrency(Math.abs(profit))}\n          </span>\n          <span className=\"financial-metric-label\">\n            Profit\n            <span className={`margin-badge ${isPositive ? 'positive' : 'negative'}`}>\n              {margin >= 0 ? '+' : ''}{margin.toFixed(0)}%\n            </span>\n          </span>\n        </div>\n      </div>\n\n      {/* Cost breakdown bar */}\n      {hasBreakdown && (\n        <div className=\"cost-breakdown-section\">\n          <div className=\"cost-breakdown-bar\">\n            {costBreakdown.map((item, index) => {\n              const widthPercent = (item.value / totalCosts) * 100\n              return (\n                <div\n                  key={item.key}\n                  className=\"cost-segment\"\n                  style={{\n                    width: `${widthPercent}%`,\n                    backgroundColor: item.color,\n                    animationDelay: `${index * 100}ms`\n                  }}\n                  title={`${item.label}: ${formatCurrency(item.value)} (${widthPercent.toFixed(0)}%)`}\n                />\n              )\n            })}\n          </div>\n          <div className=\"cost-breakdown-legend\">\n            {costBreakdown.slice(0, 4).map(item => (\n              <span key={item.key} className=\"legend-item\">\n                <span className=\"legend-dot\" style={{ backgroundColor: item.color }} />\n                <span className=\"legend-label\">{item.label}</span>\n              </span>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  )\n})\n\nexport default OverviewFinancialCard\n","import { useState, useEffect, useRef, useCallback, useMemo, lazy, Suspense } from 'react'\nimport { db } from '../lib/supabase'\nimport { safeAsync } from '../lib/errorHandler'\nimport { formatCurrency, calculateProgress, calculateValueProgress, getOverallStatus, getOverallStatusLabel, formatStatus, calculateScheduleInsights, shouldAutoArchive } from '../lib/utils'\nimport { calculateRiskScore, generateSmartAlerts, calculateProjections } from '../lib/riskCalculations'\nimport { LayoutGrid, DollarSign, ClipboardList, HardHat, Truck, Info, Building2, Phone, MapPin, FileText, Menu, FolderOpen, Search } from 'lucide-react'\nimport UniversalSearch, { useUniversalSearch } from './UniversalSearch'\nimport { SmartAlerts } from './dashboard/SmartAlerts'\nimport { RiskScoreBadge } from './dashboard/RiskScoreGauge'\nimport { TrendIndicator } from './dashboard/TrendIndicator'\nimport { ProjectHealthBadge } from './dashboard/AccessibleStatusBadge'\nimport ManDayCosts from './ManDayCosts'\nimport ProgressBillingCard from './billing/ProgressBillingCard'\nimport ProjectEquipmentCard from './equipment/ProjectEquipmentCard'\nimport BurnRateCard from './BurnRateCard'\nimport CostContributorsCard from './CostContributorsCard'\nimport ProfitabilityCard from './ProfitabilityCard'\nimport DisposalSummary from './DisposalSummary'\nimport ProjectTeam from './ProjectTeam'\nimport HeroMetrics from './HeroMetrics'\nimport FinancialsNav from './FinancialsNav'\nimport { FinancialTrendChart } from './charts'\nimport { TicketSkeleton, ChartSkeleton } from './ui'\nimport { OverviewProgressGauge, OverviewFinancialCard } from './overview'\n\n// Lazy load modals and conditionally rendered heavy components\nconst TMList = lazy(() => import('./TMList'))\nconst ShareModal = lazy(() => import('./ShareModal'))\nconst InjuryReportsList = lazy(() => import('./InjuryReportsList'))\nconst NotificationSettings = lazy(() => import('./NotificationSettings'))\nconst DailyReportsList = lazy(() => import('./DailyReportsList'))\nconst CORList = lazy(() => import('./cor/CORList'))\nconst CORForm = lazy(() => import('./cor/CORForm'))\nconst CORDetail = lazy(() => import('./cor/CORDetail'))\nconst CORLogPreview = lazy(() => import('./cor/CORLogPreview'))\nconst CORLog = lazy(() => import('./cor/CORLog'))\nconst BillingCenter = lazy(() => import('./billing/BillingCenter'))\nconst DrawRequestModal = lazy(() => import('./billing/DrawRequestModal'))\nconst EquipmentModal = lazy(() => import('./equipment/EquipmentModal'))\nconst AddCostModal = lazy(() => import('./AddCostModal'))\nconst DocumentsTab = lazy(() => import('./documents/DocumentsTab'))\n\nexport default function Dashboard({ company, user, isAdmin, onShowToast, navigateToProjectId, onProjectNavigated }) {\n  const [projects, setProjects] = useState([])\n  const [projectsData, setProjectsData] = useState([]) // Enhanced data with areas/tickets\n  const [selectedProject, setSelectedProject] = useState(null)\n  const [areas, setAreas] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [editMode, setEditMode] = useState(false)\n  const [editData, setEditData] = useState(null)\n  const [saving, setSaving] = useState(false)\n  const [showShareModal, setShowShareModal] = useState(false)\n  const [showNotificationSettings, setShowNotificationSettings] = useState(false)\n  const [activeProjectTab, setActiveProjectTab] = useState('overview')\n  const [financialsSection, setFinancialsSection] = useState('overview') // 'overview' | 'cors' | 'tickets'\n  const [financialsSidebarCollapsed, setFinancialsSidebarCollapsed] = useState(true) // Start collapsed for more real estate\n  const [financialsSidebarMobileOpen, setFinancialsSidebarMobileOpen] = useState(false) // For mobile sidebar overlay\n  const [corListExpanded, setCORListExpanded] = useState(false) // Whether the full card list is shown below the log\n  const [corDisplayMode, setCORDisplayMode] = useState('list') // 'list' | 'log' - for layout expansion\n  const [tmViewMode, setTMViewMode] = useState('preview') // 'preview' | 'full'\n  const [dumpSites, setDumpSites] = useState([])\n  const [showCORForm, setShowCORForm] = useState(false)\n  const [editingCOR, setEditingCOR] = useState(null)\n  const [showCORDetail, setShowCORDetail] = useState(false)\n  const [viewingCOR, setViewingCOR] = useState(null)\n  const [corRefreshKey, setCORRefreshKey] = useState(0)\n  const [showAddCostModal, setShowAddCostModal] = useState(false)\n  const [savingCost, setSavingCost] = useState(false)\n  const [showEquipmentModal, setShowEquipmentModal] = useState(false)\n  const [editingEquipment, setEditingEquipment] = useState(null)\n  const [equipmentRefreshKey, setEquipmentRefreshKey] = useState(0)\n  const [showDrawRequestModal, setShowDrawRequestModal] = useState(false)\n  const [editingDrawRequest, setEditingDrawRequest] = useState(null)\n  const [drawRequestRefreshKey, setDrawRequestRefreshKey] = useState(0)\n\n  // Universal Search (Cmd+K)\n  const { isOpen: isSearchOpen, setIsOpen: setSearchOpen, close: closeSearch } = useUniversalSearch()\n\n  // Debounce ref to prevent cascading refreshes from multiple subscription callbacks\n  // When multiple real-time events fire rapidly, this coalesces them into a single refresh\n  const refreshTimeoutRef = useRef(null)\n  const pendingAreasRefreshRef = useRef(false)\n  const pendingCORRefreshRef = useRef(false)\n\n  // Cache for project details to avoid re-fetching when switching between projects\n  // Key: projectId, Value: { data: enhancedProjectData, timestamp: Date.now() }\n  const projectDetailsCacheRef = useRef(new Map())\n  const CACHE_TTL_MS = 5 * 60 * 1000 // 5 minute cache TTL\n\n  // Debounced refresh function that coalesces multiple rapid refresh requests\n  // This prevents 5+ loadProjects() calls when multiple subscriptions fire at once\n  const debouncedRefresh = useCallback((options = {}) => {\n    const { refreshAreas = false, refreshCOR = false, projectId = null } = options\n\n    // Track what needs refreshing\n    if (refreshAreas && projectId) pendingAreasRefreshRef.current = projectId\n    if (refreshCOR) pendingCORRefreshRef.current = true\n\n    // Clear any pending refresh\n    if (refreshTimeoutRef.current) {\n      clearTimeout(refreshTimeoutRef.current)\n    }\n\n    // Schedule a single refresh after debounce period (150ms)\n    // This is fast enough to feel \"live\" but prevents cascading calls\n    refreshTimeoutRef.current = setTimeout(async () => {\n      // Execute pending refreshes\n      if (pendingAreasRefreshRef.current) {\n        await loadAreas(pendingAreasRefreshRef.current)\n        pendingAreasRefreshRef.current = false\n      }\n      if (pendingCORRefreshRef.current) {\n        setCORRefreshKey(prev => prev + 1)\n        pendingCORRefreshRef.current = false\n      }\n      // Always refresh projects to update metrics\n      await loadProjects()\n    }, 150)\n  }, [])\n\n  // Cleanup debounce timeout on unmount\n  useEffect(() => {\n    return () => {\n      if (refreshTimeoutRef.current) {\n        clearTimeout(refreshTimeoutRef.current)\n      }\n    }\n  }, [])\n\n  // Initial load\n  useEffect(() => {\n    if (company?.id) {\n      loadProjects()\n      loadDumpSites()\n    }\n  }, [company?.id])\n\n  // Track project IDs for subscription stability (avoids re-subscribing on every projects array change)\n  const projectIdsRef = useRef([])\n  const projectIdsKey = projects.map(p => p.id).sort().join(',')\n\n  // Real-time subscription - runs after projects are loaded\n  useEffect(() => {\n    if (!company?.id || projects.length === 0) return\n\n    // Only update ref if project IDs actually changed\n    const currentIds = projects.map(p => p.id).sort()\n    projectIdsRef.current = currentIds\n\n    // Subscribe to company-wide activity to refresh metrics in real-time\n    // Uses debounced refresh to coalesce rapid updates from multiple sources\n    const subscription = db.subscribeToCompanyActivity?.(company.id, currentIds, {\n      onMessage: () => debouncedRefresh(),\n      onMaterialRequest: () => debouncedRefresh(),\n      onTMTicket: () => debouncedRefresh(),\n      onCrewCheckin: () => debouncedRefresh(), // Crew check-ins affect labor costs\n      onAreaUpdate: () => debouncedRefresh(), // Area updates affect progress\n      onCORChange: () => debouncedRefresh({ refreshCOR: true }), // COR changes\n      onInjuryReport: () => debouncedRefresh()\n    })\n\n    return () => {\n      if (subscription) {\n        db.unsubscribe?.(subscription)\n      }\n    }\n  }, [company?.id, projectIdsKey, debouncedRefresh])\n\n  // Prevent body scroll when mobile sidebar is open\n  useEffect(() => {\n    if (financialsSidebarMobileOpen) {\n      document.body.style.overflow = 'hidden'\n    } else {\n      document.body.style.overflow = ''\n    }\n\n    return () => {\n      document.body.style.overflow = ''\n    }\n  }, [financialsSidebarMobileOpen])\n\n  const loadDumpSites = async () => {\n    try {\n      const sites = await db.getDumpSites(company.id)\n      setDumpSites(sites || [])\n    } catch (error) {\n      console.error('Error loading dump sites:', error)\n    }\n  }\n\n  // Handle navigation from notifications\n  // Use a ref to prevent re-running this effect when projects data refreshes\n  const lastNavigatedIdRef = useRef(null)\n  useEffect(() => {\n    if (navigateToProjectId && navigateToProjectId !== lastNavigatedIdRef.current && projects.length > 0) {\n      const project = projects.find(p => p.id === navigateToProjectId)\n      if (project) {\n        lastNavigatedIdRef.current = navigateToProjectId\n        setSelectedProject(project)\n        onProjectNavigated?.() // Clear the navigation request\n      }\n    }\n  }, [navigateToProjectId, projects, onProjectNavigated])\n\n  useEffect(() => {\n    if (selectedProject) {\n      loadAreas(selectedProject.id)\n\n      // Subscribe to real-time updates for the selected project\n      // All callbacks use debouncedRefresh to prevent cascading refreshes\n      const subscriptions = []\n      const projectId = selectedProject.id\n\n      // Areas subscription - also refreshes areas list\n      const areasSub = db.subscribeToAreas?.(projectId, () => {\n        debouncedRefresh({ refreshAreas: true, projectId })\n      })\n      if (areasSub) subscriptions.push(areasSub)\n\n      // Daily reports subscription\n      const dailyReportsSub = db.subscribeToDailyReports?.(projectId, () => {\n        debouncedRefresh()\n      })\n      if (dailyReportsSub) subscriptions.push(dailyReportsSub)\n\n      // Crew checkins subscription (affects labor costs)\n      const checkinsSub = db.subscribeToCrewCheckins?.(projectId, () => {\n        debouncedRefresh()\n      })\n      if (checkinsSub) subscriptions.push(checkinsSub)\n\n      // Haul offs subscription\n      const haulOffsSub = db.subscribeToHaulOffs?.(projectId, () => {\n        debouncedRefresh()\n      })\n      if (haulOffsSub) subscriptions.push(haulOffsSub)\n\n      // CORs subscription - also refreshes COR list\n      const corsSub = db.subscribeToCORs?.(projectId, () => {\n        debouncedRefresh({ refreshCOR: true })\n      })\n      if (corsSub) subscriptions.push(corsSub)\n\n      return () => {\n        subscriptions.forEach(sub => db.unsubscribe?.(sub))\n      }\n    }\n  }, [selectedProject, debouncedRefresh])\n\n  // When navigating to tickets section, switch to full mode to show dashboard\n  useEffect(() => {\n    if (financialsSection === 'tickets') {\n      setTMViewMode('full')\n    }\n  }, [financialsSection])\n\n  // Load detailed data for a single project (on-demand, with caching)\n  // This replaces the previous N+1 pattern where ALL project details were loaded upfront\n  const loadProjectDetails = async (project, forceRefresh = false) => {\n    const cacheKey = project.id\n    const cached = projectDetailsCacheRef.current.get(cacheKey)\n\n    // Return cached data if valid and not forcing refresh\n    if (cached && !forceRefresh && (Date.now() - cached.timestamp) < CACHE_TTL_MS) {\n      return cached.data\n    }\n\n    try {\n      // Fetch detailed project data in parallel (9 queries for 1 project, not 9N)\n      const [\n        projectAreas,\n        tickets,\n        changeOrderData,\n        dailyReports,\n        injuryReports,\n        laborCosts,\n        haulOffCosts,\n        customCosts,\n        corStats\n      ] = await Promise.all([\n        safeAsync(() => db.getAreas(project.id), { fallback: [], context: { operation: 'getAreas', projectId: project.id } }),\n        safeAsync(() => db.getTMTickets(project.id), { fallback: [], context: { operation: 'getTMTickets', projectId: project.id } }),\n        safeAsync(() => db.getChangeOrderTotals(project.id), { fallback: null, context: { operation: 'getChangeOrderTotals', projectId: project.id } }),\n        safeAsync(() => db.getDailyReports(project.id, 100), { fallback: [], context: { operation: 'getDailyReports', projectId: project.id } }),\n        safeAsync(() => db.getInjuryReports(project.id), { fallback: [], context: { operation: 'getInjuryReports', projectId: project.id } }),\n        safeAsync(() => db.calculateManDayCosts(project.id, company?.id, project.work_type || 'demolition', project.job_type || 'standard'), { fallback: null, context: { operation: 'calculateManDayCosts', projectId: project.id } }),\n        safeAsync(() => db.calculateHaulOffCosts(project.id), { fallback: null, context: { operation: 'calculateHaulOffCosts', projectId: project.id } }),\n        safeAsync(() => db.getProjectCosts(project.id), { fallback: [], context: { operation: 'getProjectCosts', projectId: project.id } }),\n        safeAsync(() => db.getCORStats(project.id), { fallback: null, context: { operation: 'getCORStats', projectId: project.id } })\n      ])\n\n      // Calculate progress - use SOV values if available\n      const progressData = calculateValueProgress(projectAreas)\n      const progress = progressData.progress\n\n      // Calculate revised contract value\n      const changeOrderValue = changeOrderData?.totalApprovedValue || 0\n      const revisedContractValue = project.contract_value + changeOrderValue\n\n      // Billable calculation\n      const billable = progressData.isValueBased\n        ? progressData.earnedValue\n        : (progress / 100) * revisedContractValue\n      const pendingTickets = tickets.filter(t => t.status === 'pending').length\n\n      // Recent activity\n      const oneWeekAgo = new Date()\n      oneWeekAgo.setDate(oneWeekAgo.getDate() - 7)\n      const recentDailyReports = dailyReports.filter(r => new Date(r.report_date) >= oneWeekAgo).length\n\n      // Custom costs\n      const customCostTotal = customCosts.reduce((sum, c) => {\n        const amount = parseFloat(c.amount)\n        return sum + (isNaN(amount) ? 0 : amount)\n      }, 0)\n\n      // Materials/equipment costs from T&M\n      let materialsEquipmentCost = 0\n      const materialsEquipmentByDate = {}\n      tickets.forEach(ticket => {\n        const ticketDate = ticket.work_date || ticket.ticket_date || ticket.created_at?.split('T')[0]\n        const items = ticket.t_and_m_items || ticket.items || []\n        let ticketMaterialsCost = 0\n        items.forEach(item => {\n          const qty = parseFloat(item.quantity) || 1\n          const cost = parseFloat(item.unit_cost) || parseFloat(item.materials_equipment?.cost_per_unit) || 0\n          ticketMaterialsCost += qty * cost\n        })\n        if (ticketMaterialsCost > 0 && ticketDate) {\n          materialsEquipmentCost += ticketMaterialsCost\n          if (!materialsEquipmentByDate[ticketDate]) {\n            materialsEquipmentByDate[ticketDate] = { date: ticketDate, cost: 0 }\n          }\n          materialsEquipmentByDate[ticketDate].cost += ticketMaterialsCost\n        }\n      })\n      const materialsEquipmentByDateArray = Object.values(materialsEquipmentByDate)\n        .sort((a, b) => new Date(b.date) - new Date(a.date))\n\n      // Total costs\n      const laborCost = laborCosts?.totalCost || 0\n      const haulOffCost = haulOffCosts?.totalCost || 0\n      const allCostsTotal = laborCost + materialsEquipmentCost + customCostTotal\n\n      // Profit calculations\n      const currentProfit = billable - allCostsTotal\n      const profitMargin = billable > 0 ? (currentProfit / billable) * 100 : 0\n\n      // Burn rate\n      const laborDays = laborCosts?.byDate?.length || 0\n      const materialsDays = materialsEquipmentByDateArray.length\n      const totalBurnDays = Math.max(laborDays, materialsDays)\n      const totalBurn = laborCost + materialsEquipmentCost\n      const dailyBurn = totalBurnDays > 0 ? totalBurn / totalBurnDays : 0\n\n      // Schedule insights\n      const scheduleInsights = calculateScheduleInsights(\n        { ...project, progress },\n        laborCosts?.totalManDays || 0\n      )\n\n      const enhancedData = {\n        ...project,\n        areas: projectAreas,\n        progress,\n        billable,\n        changeOrderValue,\n        revisedContractValue,\n        changeOrderPending: changeOrderData?.pendingCount || 0,\n        totalTickets: tickets.length,\n        pendingTickets,\n        approvedTickets: tickets.filter(t => t.status === 'approved').length,\n        tmTickets: tickets,\n        dailyReportsCount: dailyReports.length,\n        recentDailyReports,\n        injuryReportsCount: injuryReports.length,\n        lastDailyReport: dailyReports[0]?.report_date || null,\n        isValueBased: progressData.isValueBased,\n        earnedValue: progressData.earnedValue,\n        totalSOVValue: progressData.totalValue,\n        laborCost,\n        laborDaysWorked: laborDays,\n        laborManDays: laborCosts?.totalManDays || 0,\n        laborByDate: laborCosts?.byDate || [],\n        dailyBurn,\n        materialsEquipmentCost,\n        materialsEquipmentByDate: materialsEquipmentByDateArray,\n        haulOffCost,\n        haulOffLoads: haulOffCosts?.totalLoads || 0,\n        haulOffDays: haulOffCosts?.daysWithHaulOff || 0,\n        haulOffByType: haulOffCosts?.byWasteType || {},\n        haulOffByDate: haulOffCosts?.byDate || [],\n        customCosts,\n        customCostTotal,\n        totalBurn,\n        totalBurnDays,\n        allCostsTotal,\n        currentProfit,\n        profitMargin,\n        corPendingValue: corStats?.total_pending_value || 0,\n        corPendingCount: corStats?.pending_count || 0,\n        corApprovedValue: corStats?.total_approved_value || 0,\n        corBilledValue: corStats?.total_billed_value || 0,\n        corTotalCount: corStats?.total_cors || 0,\n        corStats: corStats,\n        scheduleStatus: scheduleInsights.scheduleStatus,\n        scheduleVariance: scheduleInsights.scheduleVariance,\n        scheduleLabel: scheduleInsights.scheduleLabel,\n        laborStatus: scheduleInsights.laborStatus,\n        laborVariance: scheduleInsights.laborVariance,\n        laborLabel: scheduleInsights.laborLabel,\n        hasScheduleData: scheduleInsights.hasScheduleData,\n        hasLaborData: scheduleInsights.hasLaborData,\n        actualManDays: laborCosts?.totalManDays || 0,\n        hasError: false,\n        _detailsLoaded: true\n      }\n\n      // Cache the enhanced data\n      projectDetailsCacheRef.current.set(cacheKey, {\n        data: enhancedData,\n        timestamp: Date.now()\n      })\n\n      return enhancedData\n    } catch (error) {\n      console.error(`Error loading details for project ${project.id}:`, error)\n      return { ...project, hasError: true, _detailsLoaded: false }\n    }\n  }\n\n  // OPTIMIZED: Load projects with summary data only (1 query instead of 9N)\n  // Detailed data is loaded on-demand when a project is selected\n  const loadProjects = async () => {\n    try {\n      // Single optimized query for all project summaries\n      const data = await db.getProjectDashboardSummary(company?.id)\n      setProjects(data)\n\n      // Create lightweight enhanced data using ONLY summary metrics from the RPC\n      // This uses data already returned from getProjectDashboardSummary (no additional queries!)\n      // Detailed data is loaded on-demand via loadProjectDetails when a project is selected\n      const enhanced = data.map(project => {\n        // Check if we have cached detailed data for this project\n        const cached = projectDetailsCacheRef.current.get(project.id)\n        if (cached && (Date.now() - cached.timestamp) < CACHE_TTL_MS) {\n          // Use cached detailed data if still valid\n          return cached.data\n        }\n\n        // Use summary data from RPC (no additional queries needed)\n        // Progress is estimated from area counts in the summary\n        const totalAreas = project.areaCount || 0\n        const completedAreas = project.completedAreas || 0\n        const progress = totalAreas > 0 ? Math.round((completedAreas / totalAreas) * 100) : 0\n\n        return {\n          ...project,\n          // Basic metrics from summary (already loaded)\n          progress,\n          areas: [], // Loaded on-demand when project selected\n          totalTickets: project.ticketCount || 0,\n          pendingTickets: project.pendingTicketCount || 0,\n          approvedTickets: project.approvedTicketCount || 0,\n          dailyReportsCount: project.dailyReportsThisWeek || 0,\n          recentDailyReports: project.dailyReportsThisWeek || 0,\n          corTotalCount: project.corCount || 0,\n          // Placeholder values - loaded on-demand when selected\n          billable: 0,\n          changeOrderValue: 0,\n          revisedContractValue: project.contract_value || 0,\n          changeOrderPending: 0,\n          tmTickets: [],\n          injuryReportsCount: 0,\n          lastDailyReport: null,\n          isValueBased: false,\n          earnedValue: 0,\n          totalSOVValue: 0,\n          laborCost: 0,\n          laborDaysWorked: 0,\n          laborManDays: 0,\n          laborByDate: [],\n          dailyBurn: 0,\n          materialsEquipmentCost: 0,\n          materialsEquipmentByDate: [],\n          haulOffCost: 0,\n          haulOffLoads: 0,\n          haulOffDays: 0,\n          haulOffByType: {},\n          haulOffByDate: [],\n          customCosts: [],\n          customCostTotal: 0,\n          totalBurn: 0,\n          totalBurnDays: 0,\n          allCostsTotal: 0,\n          currentProfit: 0,\n          profitMargin: 0,\n          corPendingValue: 0,\n          corPendingCount: 0,\n          corApprovedValue: 0,\n          corBilledValue: 0,\n          corStats: null,\n          scheduleStatus: 'on_track',\n          scheduleVariance: 0,\n          scheduleLabel: 'On Track',\n          laborStatus: 'on_track',\n          laborVariance: 0,\n          laborLabel: null,\n          hasScheduleData: false,\n          hasLaborData: false,\n          actualManDays: 0,\n          hasError: false,\n          _detailsLoaded: false // Flag to indicate detailed data needs loading\n        }\n      })\n      setProjectsData(enhanced)\n    } catch (error) {\n      console.error('Error loading projects:', error)\n      onShowToast('Error loading projects', 'error')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const loadAreas = async (projectId) => {\n    try {\n      const data = await db.getAreas(projectId)\n      setAreas(data)\n    } catch (error) {\n      console.error('Error loading areas:', error)\n    }\n  }\n\n  const handleSelectProject = async (project) => {\n    // Set the project immediately for responsive UI\n    setSelectedProject(project)\n\n    // If detailed data hasn't been loaded yet, load it now (lazy loading)\n    if (!project._detailsLoaded) {\n      const detailedProject = await loadProjectDetails(project)\n\n      // Update projectsData with the detailed version\n      setProjectsData(prev => prev.map(p =>\n        p.id === project.id ? detailedProject : p\n      ))\n\n      // Update selectedProject with detailed data\n      setSelectedProject(detailedProject)\n    }\n  }\n\n  const handleBack = () => {\n    setSelectedProject(null)\n    setAreas([])\n    setEditMode(false)\n    setEditData(null)\n    setActiveProjectTab('overview')\n    loadProjects()\n  }\n\n  const handleEditClick = () => {\n    setEditData({\n      name: selectedProject.name,\n      job_number: selectedProject.job_number || '',\n      address: selectedProject.address || '',\n      general_contractor: selectedProject.general_contractor || '',\n      client_contact: selectedProject.client_contact || '',\n      client_phone: selectedProject.client_phone || '',\n      contract_value: selectedProject.contract_value,\n      work_type: selectedProject.work_type || 'demolition',\n      job_type: selectedProject.job_type || 'standard',\n      pin: selectedProject.pin || '',\n      default_dump_site_id: selectedProject.default_dump_site_id || '',\n      areas: areas.map(a => ({\n        id: a.id,\n        name: a.name,\n        weight: a.weight,\n        isNew: false\n      }))\n    })\n    setEditMode(true)\n  }\n\n  const handleCancelEdit = () => {\n    setEditMode(false)\n    setEditData(null)\n  }\n\n  const handleEditChange = (field, value) => {\n    setEditData(prev => ({ ...prev, [field]: value }))\n  }\n\n  const handleAreaEditChange = (index, field, value) => {\n    setEditData(prev => ({\n      ...prev,\n      areas: prev.areas.map((area, i) => \n        i === index ? { ...area, [field]: value } : area\n      )\n    }))\n  }\n\n  const handleAddArea = () => {\n    setEditData(prev => ({\n      ...prev,\n      areas: [...prev.areas, { id: null, name: '', weight: '', isNew: true }]\n    }))\n  }\n\n  const handleRemoveArea = (index) => {\n    if (editData.areas.length > 1) {\n      setEditData(prev => ({\n        ...prev,\n        areas: prev.areas.filter((_, i) => i !== index)\n      }))\n    }\n  }\n\n  const handleSaveEdit = async () => {\n    // Validation\n    if (!editData.name.trim()) {\n      onShowToast('Please enter a project name', 'error')\n      return\n    }\n\n    const contractVal = parseFloat(editData.contract_value)\n    if (!contractVal || contractVal <= 0) {\n      onShowToast('Please enter a valid contract value', 'error')\n      return\n    }\n\n    if (editData.pin && editData.pin.length !== 4) {\n      onShowToast('PIN must be 4 digits', 'error')\n      return\n    }\n\n    // Check PIN availability if changed\n    if (editData.pin && editData.pin !== selectedProject.pin) {\n      const pinAvailable = await db.isPinAvailable(editData.pin, selectedProject.id)\n      if (!pinAvailable) {\n        onShowToast('This PIN is already in use', 'error')\n        return\n      }\n    }\n\n    const validAreas = editData.areas.filter(a => a.name.trim() && parseFloat(a.weight) > 0)\n    if (validAreas.length === 0) {\n      onShowToast('Please add at least one area', 'error')\n      return\n    }\n\n    const totalWeight = validAreas.reduce((sum, a) => sum + parseFloat(a.weight), 0)\n    if (totalWeight !== 100) {\n      onShowToast('Area weights must total 100%', 'error')\n      return\n    }\n\n    setSaving(true)\n\n    try {\n      // Update project - include company.id for cross-tenant security\n      await db.updateProject(selectedProject.id, {\n        name: editData.name.trim(),\n        job_number: editData.job_number?.trim() || null,\n        address: editData.address?.trim() || null,\n        general_contractor: editData.general_contractor?.trim() || null,\n        client_contact: editData.client_contact?.trim() || null,\n        client_phone: editData.client_phone?.trim() || null,\n        contract_value: contractVal,\n        work_type: editData.work_type || 'demolition',\n        job_type: editData.job_type || 'standard',\n        pin: editData.pin || null,\n        default_dump_site_id: editData.default_dump_site_id || null\n      }, company?.id)\n\n      // Handle areas\n      const existingAreaIds = areas.map(a => a.id)\n      const editAreaIds = editData.areas.filter(a => a.id).map(a => a.id)\n\n      // Delete removed areas\n      for (const areaId of existingAreaIds) {\n        if (!editAreaIds.includes(areaId)) {\n          await db.deleteArea(areaId)\n        }\n      }\n\n      // Update or create areas\n      for (let i = 0; i < validAreas.length; i++) {\n        const area = validAreas[i]\n        if (area.id) {\n          // Update existing\n          await db.updateArea(area.id, {\n            name: area.name.trim(),\n            weight: parseFloat(area.weight),\n            sort_order: i\n          })\n        } else {\n          // Create new\n          await db.createArea({\n            project_id: selectedProject.id,\n            name: area.name.trim(),\n            weight: parseFloat(area.weight),\n            status: 'not_started',\n            sort_order: i\n          })\n        }\n      }\n\n      // Reload data\n      const updatedProject = await db.getProject(selectedProject.id)\n      setSelectedProject(updatedProject)\n      await loadAreas(selectedProject.id)\n      \n      setEditMode(false)\n      setEditData(null)\n      onShowToast('Project updated!', 'success')\n    } catch (error) {\n      console.error('Error saving project:', error?.message || error)\n      onShowToast(error?.message || 'Error saving changes', 'error')\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  const handleDeleteProject = async () => {\n    if (!confirm('Are you sure you want to delete this project? This cannot be undone.')) {\n      return\n    }\n\n    try {\n      await db.deleteProject(selectedProject.id)\n      onShowToast('Project deleted', 'success')\n      handleBack()\n    } catch (error) {\n      console.error('Error deleting project:', error)\n      onShowToast('Error deleting project', 'error')\n    }\n  }\n\n  // Memoize selected project data lookup to avoid repeated finds\n  // NOTE: All hooks must be before any conditional returns (React rules of hooks)\n  const projectData = useMemo(() => {\n    if (!selectedProject) return null\n    return projectsData.find(p => p.id === selectedProject.id)\n  }, [selectedProject, projectsData])\n\n  // Memoize progress calculations - these are expensive and only change when areas change\n  const progressCalculations = useMemo(() => {\n    if (!selectedProject) {\n      return { progress: 0, billable: 0, isValueBased: false, earnedValue: 0, totalSOVValue: 0, changeOrderValue: 0, revisedContractValue: 0 }\n    }\n\n    // Calculate progress - use SOV values if available\n    const progressData = calculateValueProgress(areas)\n    const progress = progressData.progress\n\n    // Get change order data from enhanced project data\n    const changeOrderValue = projectData?.changeOrderValue || 0\n    const revisedContractValue = selectedProject.contract_value + changeOrderValue\n\n    // Billable: use actual earned value from SOV if available\n    const billable = progressData.isValueBased\n      ? progressData.earnedValue\n      : (progress / 100) * revisedContractValue\n\n    return {\n      progress,\n      billable,\n      changeOrderValue,\n      revisedContractValue,\n      isValueBased: progressData.isValueBased,\n      earnedValue: progressData.earnedValue,\n      totalSOVValue: progressData.totalValue\n    }\n  }, [selectedProject, areas, projectData])\n\n  // Memoize portfolio-level metrics to avoid recalculating on every render\n  // These only change when projectsData changes (after data loads or real-time updates)\n  const portfolioMetrics = useMemo(() => {\n    const totalOriginalContract = projectsData.reduce((sum, p) => sum + (p.contract_value || 0), 0)\n    const totalChangeOrders = projectsData.reduce((sum, p) => sum + (p.changeOrderValue || 0), 0)\n    const totalPortfolioValue = totalOriginalContract + totalChangeOrders\n    const totalEarned = projectsData.reduce((sum, p) => sum + (p.billable || 0), 0)\n    const totalRemaining = totalPortfolioValue - totalEarned\n\n    // Weighted completion (by contract value, not simple average)\n    const weightedCompletion = totalPortfolioValue > 0\n      ? Math.round((totalEarned / totalPortfolioValue) * 100)\n      : 0\n\n    // Pending COR metrics (unapproved extra work value)\n    const totalPendingCORValue = projectsData.reduce((sum, p) => sum + (p.corPendingValue || 0), 0)\n    const totalPendingCORCount = projectsData.reduce((sum, p) => sum + (p.corPendingCount || 0), 0)\n\n    return {\n      totalOriginalContract,\n      totalChangeOrders,\n      totalPortfolioValue,\n      totalEarned,\n      totalRemaining,\n      weightedCompletion,\n      totalPendingCORValue,\n      totalPendingCORCount\n    }\n  }, [projectsData])\n\n  // Memoize project health breakdown separately (still derived from projectsData)\n  // Single pass through array instead of 5 separate filter operations\n  const projectHealth = useMemo(() => {\n    let complete = 0\n    let onTrack = 0\n    let atRisk = 0\n    let overBudget = 0\n    let withChangeOrders = 0\n\n    for (const p of projectsData) {\n      const contractVal = p.revisedContractValue || p.contract_value\n      if (p.progress >= 100) complete++\n      if (p.progress < 100 && p.billable <= contractVal * (p.progress / 100) * 1.1) onTrack++\n      if (p.billable > contractVal * 0.9 && p.progress < 90) atRisk++\n      if (p.billable > contractVal) overBudget++\n      if ((p.changeOrderValue || 0) > 0) withChangeOrders++\n    }\n\n    return {\n      projectsComplete: complete,\n      projectsOnTrack: onTrack,\n      projectsAtRisk: atRisk,\n      projectsOverBudget: overBudget,\n      projectsWithChangeOrders: withChangeOrders\n    }\n  }, [projectsData])\n\n  // Memoize schedule performance metrics\n  const scheduleMetrics = useMemo(() => {\n    let ahead = 0\n    let onTrack = 0\n    let behind = 0\n    let overLabor = 0\n    let underLabor = 0\n    let onTrackLabor = 0\n\n    for (const p of projectsData) {\n      if (p.hasScheduleData) {\n        if (p.scheduleStatus === 'ahead') ahead++\n        else if (p.scheduleStatus === 'behind') behind++\n        else onTrack++\n      }\n      if (p.hasLaborData) {\n        if (p.laborStatus === 'over') overLabor++\n        else if (p.laborStatus === 'under') underLabor++\n        else onTrackLabor++\n      }\n    }\n\n    return {\n      scheduleAhead: ahead,\n      scheduleOnTrack: onTrack,\n      scheduleBehind: behind,\n      laborOver: overLabor,\n      laborUnder: underLabor,\n      laborOnTrack: onTrackLabor,\n      hasAnyScheduleData: ahead + onTrack + behind > 0,\n      hasAnyLaborData: overLabor + underLabor + onTrackLabor > 0\n    }\n  }, [projectsData])\n\n  // Calculate risk scores and smart alerts for all projects\n  const riskAnalysis = useMemo(() => {\n    const projectRisks = projectsData.map(p => {\n      // Map project data to risk calculation format\n      const riskInput = {\n        id: p.id,\n        name: p.name,\n        totalCosts: p.totalCosts || 0,\n        earnedRevenue: p.billable || 0,\n        actualProgress: p.progress || 0,\n        expectedProgress: p.expectedProgress || p.progress, // Use actual if no planned\n        pendingCORValue: p.corPendingValue || 0,\n        contractValue: p.revisedContractValue || p.contract_value || 0,\n        lastReportDate: p.lastDailyReport,\n        recentInjuryCount: p.recentInjuryCount || 0,\n        startDate: p.start_date\n      }\n\n      const riskResult = calculateRiskScore(riskInput)\n      const alerts = generateSmartAlerts(riskResult, { ...riskInput, name: p.name })\n      const projections = calculateProjections(riskInput)\n\n      // Add project name to each alert\n      const alertsWithProject = alerts.map(a => ({\n        ...a,\n        projectName: p.name,\n        projectId: p.id\n      }))\n\n      return {\n        projectId: p.id,\n        projectName: p.name,\n        riskScore: riskResult.score,\n        riskStatus: riskResult.status,\n        riskLabel: riskResult.label,\n        factors: riskResult.factors,\n        alerts: alertsWithProject,\n        projections\n      }\n    })\n\n    // Aggregate all alerts across projects, sorted by priority\n    const allAlerts = projectRisks\n      .flatMap(p => p.alerts)\n      .sort((a, b) => {\n        const priority = { critical: 0, warning: 1, info: 2 }\n        return priority[a.type] - priority[b.type]\n      })\n\n    return {\n      projectRisks,\n      allAlerts,\n      criticalCount: allAlerts.filter(a => a.type === 'critical').length,\n      warningCount: allAlerts.filter(a => a.type === 'warning').length\n    }\n  }, [projectsData])\n\n  // Handler for alert actions\n  const handleAlertAction = useCallback(({ target, projectId, alert }) => {\n    const project = projects.find(p => p.id === projectId)\n    if (project) {\n      setSelectedProject(project)\n      // Navigate to appropriate tab based on action target\n      if (target === 'financials') {\n        setActiveProjectTab('financials')\n      } else if (target === 'reports') {\n        setActiveProjectTab('reports')\n      } else if (target === 'cors') {\n        setActiveProjectTab('financials')\n        setFinancialsSection('cors')\n      } else {\n        setActiveProjectTab('overview')\n      }\n    }\n  }, [projects])\n\n  // Auto-archive projects that have been complete for 30+ days\n  useEffect(() => {\n    const checkAutoArchive = async () => {\n      for (const project of projectsData) {\n        if (shouldAutoArchive(project, 30)) {\n          try {\n            await db.archiveProject(project.id)\n            onShowToast(`Project \"${project.name}\" has been auto-archived after 30 days of completion`, 'info')\n          } catch (error) {\n            console.error('Failed to auto-archive project:', error)\n          }\n        }\n      }\n    }\n\n    if (projectsData.length > 0) {\n      checkAutoArchive()\n    }\n  }, []) // Only run on mount\n\n  // Memoized callbacks for child components to prevent unnecessary re-renders\n  const handleAddEquipment = useCallback(() => {\n    setEditingEquipment(null)\n    setShowEquipmentModal(true)\n  }, [])\n\n  const handleEditEquipment = useCallback((item) => {\n    setEditingEquipment(item)\n    setShowEquipmentModal(true)\n  }, [])\n\n  const handleCreateDraw = useCallback(() => {\n    setEditingDrawRequest(null)\n    setShowDrawRequestModal(true)\n  }, [])\n\n  const handleViewDraw = useCallback((drawRequest) => {\n    setEditingDrawRequest(drawRequest)\n    setShowDrawRequestModal(true)\n  }, [])\n\n  const handleViewAllTickets = useCallback(() => {\n    setTMViewMode('full')\n  }, [])\n\n  const handleToggleFinancialsSidebar = useCallback(() => {\n    setFinancialsSidebarCollapsed(prev => !prev)\n  }, [])\n\n  const handleToggleMobileSidebar = useCallback(() => {\n    setFinancialsSidebarMobileOpen(prev => !prev)\n  }, [])\n\n  const handleCloseMobileSidebar = useCallback(() => {\n    setFinancialsSidebarMobileOpen(false)\n  }, [])\n\n  const handleToggleCORList = useCallback(() => {\n    setCORListExpanded(prev => !prev)\n  }, [])\n\n  const handleBackToTMPreview = useCallback(() => {\n    setTMViewMode('preview')\n  }, [])\n\n  const handleViewFullCORLog = useCallback(() => {\n    setCORDisplayMode('log')\n  }, [])\n\n  const handleCreateCOR = useCallback(() => {\n    setEditingCOR(null)\n    setShowCORForm(true)\n  }, [])\n\n  const handleViewCOR = useCallback((cor) => {\n    setViewingCOR(cor)\n    setShowCORDetail(true)\n  }, [])\n\n  const handleEditCOR = useCallback((cor) => {\n    setEditingCOR(cor)\n    setShowCORForm(true)\n  }, [])\n\n  const handleAddCost = useCallback(() => {\n    setShowAddCostModal(true)\n  }, [])\n\n  const handleDeleteCost = useCallback(async (costId) => {\n    try {\n      await db.deleteProjectCost(costId)\n      loadProjects()\n      onShowToast?.('Cost deleted', 'success')\n    } catch (err) {\n      onShowToast?.('Error deleting cost', 'error')\n    }\n  }, []) // onShowToast is stable (memoized in App.jsx)\n\n  // Memoize stats for FinancialsNav to prevent re-renders from inline object creation\n  const financialsNavStats = useMemo(() => ({\n    corCount: projectData?.corStats?.total || 0,\n    ticketCount: projectData?.totalTickets || 0,\n    corPending: projectData?.corStats?.pending || 0,\n    ticketPending: projectData?.pendingTickets || 0\n  }), [projectData?.corStats?.total, projectData?.totalTickets, projectData?.corStats?.pending, projectData?.pendingTickets])\n\n  // Destructure memoized values for cleaner usage below\n  const { totalOriginalContract, totalChangeOrders, totalPortfolioValue, totalEarned, totalRemaining, weightedCompletion, totalPendingCORValue, totalPendingCORCount } = portfolioMetrics\n  const { projectsComplete, projectsOnTrack, projectsAtRisk, projectsOverBudget, projectsWithChangeOrders } = projectHealth\n  const { scheduleAhead, scheduleOnTrack, scheduleBehind, laborOver, laborUnder, laborOnTrack, hasAnyScheduleData, hasAnyLaborData } = scheduleMetrics\n\n  if (loading) {\n    return (\n      <div className=\"loading\">\n        <div className=\"spinner\"></div>\n        Loading projects...\n      </div>\n    )\n  }\n\n  // Project Detail View\n  if (selectedProject) {\n    // Extract memoized values\n    const { progress, billable, changeOrderValue, revisedContractValue, isValueBased, earnedValue, totalSOVValue } = progressCalculations\n\n    // Edit Mode\n    if (editMode && editData) {\n      const totalWeight = editData.areas.reduce((sum, a) => sum + (parseFloat(a.weight) || 0), 0)\n\n      return (\n        <div>\n          <button className=\"btn btn-secondary btn-small\" onClick={handleCancelEdit} style={{ marginBottom: '1.5rem' }}>\n             Cancel\n          </button>\n\n          <h1>Edit Project</h1>\n          <p className=\"subtitle\">Update project details</p>\n\n          {/* Basic Info */}\n          <div className=\"card\">\n            <h3>Basic Info</h3>\n            <div className=\"form-row\">\n              <div className=\"form-group\" style={{ flex: 2 }}>\n                <label>Project Name *</label>\n                <input\n                  type=\"text\"\n                  value={editData.name}\n                  onChange={(e) => handleEditChange('name', e.target.value)}\n                  placeholder=\"e.g., Downtown Office Demolition\"\n                />\n              </div>\n              <div className=\"form-group\" style={{ flex: 1 }}>\n                <label>Job Number</label>\n                <input\n                  type=\"text\"\n                  value={editData.job_number}\n                  onChange={(e) => handleEditChange('job_number', e.target.value)}\n                  placeholder=\"e.g., 2024-001\"\n                />\n              </div>\n            </div>\n\n            <div className=\"form-group\">\n              <label>Project Address</label>\n              <input\n                type=\"text\"\n                value={editData.address}\n                onChange={(e) => handleEditChange('address', e.target.value)}\n                placeholder=\"123 Main St, City, State 12345\"\n              />\n            </div>\n          </div>\n\n          {/* Client & Contractor Info */}\n          <div className=\"card\">\n            <h3>Client & Contractor</h3>\n            <div className=\"form-group\">\n              <label>General Contractor</label>\n              <input\n                type=\"text\"\n                value={editData.general_contractor}\n                onChange={(e) => handleEditChange('general_contractor', e.target.value)}\n                placeholder=\"e.g., ABC Construction\"\n              />\n            </div>\n\n            <div className=\"form-row\">\n              <div className=\"form-group\">\n                <label>Client Contact</label>\n                <input\n                  type=\"text\"\n                  value={editData.client_contact}\n                  onChange={(e) => handleEditChange('client_contact', e.target.value)}\n                  placeholder=\"Contact name\"\n                />\n              </div>\n              <div className=\"form-group\">\n                <label>Client Phone</label>\n                <input\n                  type=\"tel\"\n                  value={editData.client_phone}\n                  onChange={(e) => handleEditChange('client_phone', e.target.value)}\n                  placeholder=\"(555) 123-4567\"\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* Financial & Project Settings */}\n          <div className=\"card\">\n            <h3>Financials & Settings</h3>\n            <div className=\"form-row\">\n              <div className=\"form-group\">\n                <label>Contract Value ($) *</label>\n                <input\n                  type=\"number\"\n                  value={editData.contract_value}\n                  onChange={(e) => handleEditChange('contract_value', e.target.value)}\n                  placeholder=\"0\"\n                />\n              </div>\n              <div className=\"form-group\">\n                <label>Foreman PIN</label>\n                <input\n                  type=\"text\"\n                  value={editData.pin}\n                  onChange={(e) => handleEditChange('pin', e.target.value.replace(/\\D/g, '').slice(0, 4))}\n                  placeholder=\"4 digits\"\n                  maxLength={4}\n                />\n                <span className=\"form-hint\">Used for field crew access</span>\n              </div>\n            </div>\n\n            <div className=\"form-row\">\n              <div className=\"form-group\">\n                <label>Work Type</label>\n                <select\n                  value={editData.work_type}\n                  onChange={(e) => handleEditChange('work_type', e.target.value)}\n                >\n                  <option value=\"demolition\">Demolition</option>\n                  <option value=\"environmental\">Environmental</option>\n                </select>\n                <span className=\"form-hint\">Affects labor rate calculations</span>\n              </div>\n              <div className=\"form-group\">\n                <label>Job Type</label>\n                <select\n                  value={editData.job_type}\n                  onChange={(e) => handleEditChange('job_type', e.target.value)}\n                >\n                  <option value=\"standard\">Standard</option>\n                  <option value=\"prevailing_wage\">Prevailing Wage</option>\n                </select>\n              </div>\n            </div>\n\n            <div className=\"form-group\">\n              <label>Default Dump Site</label>\n              <select\n                value={editData.default_dump_site_id}\n                onChange={(e) => handleEditChange('default_dump_site_id', e.target.value)}\n              >\n                <option value=\"\">-- Select Dump Site --</option>\n                {dumpSites.map(site => (\n                  <option key={site.id} value={site.id}>{site.name}</option>\n                ))}\n              </select>\n              <span className=\"form-hint\">Used for haul-off tracking and cost estimates</span>\n            </div>\n          </div>\n\n          <div className=\"card\">\n            <h3>Areas</h3>\n            <p style={{ color: 'var(--text-secondary)', fontSize: '0.9rem', marginBottom: '1rem' }}>\n              Weights must total 100%.\n            </p>\n\n            {editData.areas.map((area, index) => (\n              <div key={index} className=\"area-row\">\n                <input\n                  type=\"text\"\n                  placeholder=\"Area name\"\n                  value={area.name}\n                  onChange={(e) => handleAreaEditChange(index, 'name', e.target.value)}\n                />\n                <input\n                  type=\"number\"\n                  placeholder=\"%\"\n                  value={area.weight}\n                  onChange={(e) => handleAreaEditChange(index, 'weight', e.target.value)}\n                />\n                <button className=\"remove-btn\" onClick={() => handleRemoveArea(index)}>\n                  \n                </button>\n              </div>\n            ))}\n\n            <div className=\"weight-total\">\n              <span className=\"weight-total-label\">Total Weight:</span>\n              <span className={`weight-total-value ${totalWeight === 100 ? 'valid' : 'invalid'}`}>\n                {totalWeight}%\n              </span>\n            </div>\n\n            <button className=\"btn btn-secondary\" onClick={handleAddArea}>\n              + Add Area\n            </button>\n          </div>\n\n          <div style={{ display: 'flex', gap: '1rem', marginBottom: '1rem' }}>\n            <button \n              className=\"btn btn-primary\" \n              onClick={handleSaveEdit}\n              disabled={saving}\n              style={{ flex: 1 }}\n            >\n              {saving ? 'Saving...' : 'Save Changes'}\n            </button>\n          </div>\n\n          <button \n            className=\"btn btn-danger btn-full\" \n            onClick={handleDeleteProject}\n          >\n            Delete Project\n          </button>\n        </div>\n      )\n    }\n\n    // View Mode - Calculate additional metrics for context\n    const areasComplete = areas.filter(a => a.status === 'done').length\n    const areasWorking = areas.filter(a => a.status === 'working').length\n    const areasNotStarted = areas.filter(a => a.status === 'not_started').length\n    const percentBilled = revisedContractValue > 0\n      ? Math.round((billable / revisedContractValue) * 100)\n      : 0\n    const hasChangeOrders = changeOrderValue > 0\n\n    // Tab definitions with pending badges\n    const pendingCount = (projectData?.pendingTickets || 0) + (projectData?.changeOrderPending || 0)\n    const tabs = [\n      { id: 'overview', label: 'Overview', Icon: LayoutGrid },\n      { id: 'financials', label: 'Financials', Icon: DollarSign, badge: pendingCount },\n      { id: 'reports', label: 'Reports', Icon: ClipboardList },\n      { id: 'documents', label: 'Documents', Icon: FolderOpen },\n      { id: 'info', label: 'Info', Icon: Info }\n    ]\n\n    return (\n      <div className=\"project-view tabbed\">\n        {/* Sticky Header */}\n        <div className=\"pv-sticky-header\">\n          {/* Top Row - Back + Actions */}\n          <div className=\"pv-header-row\">\n            <button className=\"pv-back\" onClick={handleBack}>\n              <span></span>\n              <span>Back</span>\n            </button>\n            <div className=\"pv-actions\">\n              <button className=\"pv-action\" onClick={() => setShowShareModal(true)}>Share</button>\n              <button className=\"pv-action\" onClick={() => setShowNotificationSettings(true)}>Alerts</button>\n              <button className=\"pv-action\" onClick={handleEditClick}>Edit</button>\n            </div>\n          </div>\n\n          {/* Project Title */}\n          <div className=\"pv-header-title\">\n            <h1>{selectedProject.name}</h1>\n            {(selectedProject.job_number || selectedProject.work_type) && (\n              <span className=\"pv-header-meta\">\n                {selectedProject.job_number && `Job #${selectedProject.job_number}`}\n                {selectedProject.job_number && selectedProject.work_type && '  '}\n                {selectedProject.work_type}\n              </span>\n            )}\n          </div>\n\n          {/* Key Metrics Bar */}\n          <div className=\"pv-metrics-bar\">\n            <div className=\"pv-metric\">\n              <span className=\"pv-metric-value\">{progress}%</span>\n              <span className=\"pv-metric-label\">Complete</span>\n            </div>\n            <div className=\"pv-metric-divider\"></div>\n            <div className=\"pv-metric\">\n              <span className=\"pv-metric-value\">{formatCurrency(billable)}</span>\n              <span className=\"pv-metric-label\">Billed</span>\n            </div>\n            <div className=\"pv-metric-divider\"></div>\n            <div className=\"pv-metric\">\n              <span className=\"pv-metric-value highlight\">{formatCurrency(revisedContractValue - billable)}</span>\n              <span className=\"pv-metric-label\">Remaining</span>\n            </div>\n          </div>\n\n          {/* Tab Navigation */}\n          <div className=\"pv-tabs\">\n            {tabs.map(tab => (\n              <button\n                key={tab.id}\n                className={`pv-tab ${activeProjectTab === tab.id ? 'active' : ''} ${tab.badge > 0 ? 'has-badge' : ''}`}\n                onClick={() => setActiveProjectTab(tab.id)}\n              >\n                <tab.Icon size={16} className=\"pv-tab-icon\" />\n                <span className=\"pv-tab-label\">{tab.label}</span>\n                {tab.badge > 0 && (\n                  <span className=\"pv-tab-badge\">{tab.badge}</span>\n                )}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        {/* Tab Content */}\n        <div className=\"pv-tab-content\">\n          {/* OVERVIEW TAB */}\n          {activeProjectTab === 'overview' && (\n            <div className=\"pv-tab-panel overview-tab animate-fade-in\">\n              {/* Enhanced Hero - Progress Gauge + Financial Snapshot */}\n              <div className=\"overview-hero-split\">\n                <OverviewProgressGauge\n                  progress={progress}\n                  areasComplete={areasComplete}\n                  totalAreas={areas.length}\n                  areasWorking={areasWorking}\n                />\n                <OverviewFinancialCard\n                  earnedRevenue={billable}\n                  totalCosts={projectData?.allCostsTotal || 0}\n                  laborCost={projectData?.laborCost || 0}\n                  disposalCost={projectData?.haulOffCost || 0}\n                  equipmentCost={projectData?.materialsEquipmentCost || 0}\n                  materialsCost={0}\n                  otherCost={projectData?.customCostTotal || 0}\n                  contractValue={revisedContractValue}\n                />\n              </div>\n\n              {/* Action Items - What needs attention */}\n              {(projectData?.pendingTickets > 0 || projectData?.changeOrderPending > 0) && (\n                <div className=\"overview-attention-card\">\n                  <div className=\"attention-header\">\n                    <h3>Needs Attention</h3>\n                    <span className=\"attention-count\">\n                      {(projectData?.pendingTickets || 0) + (projectData?.changeOrderPending || 0)} items\n                    </span>\n                  </div>\n                  <div className=\"attention-items\">\n                    {projectData?.pendingTickets > 0 && (\n                      <div className=\"attention-item\" onClick={() => setActiveProjectTab('financials')}>\n                        <div className=\"attention-item-icon warning\">\n                          <ClipboardList size={16} />\n                        </div>\n                        <div className=\"attention-item-content\">\n                          <span className=\"attention-item-title\">{projectData.pendingTickets} T&M ticket{projectData.pendingTickets !== 1 ? 's' : ''} awaiting approval</span>\n                          <span className=\"attention-item-action\">Review in Financials</span>\n                        </div>\n                        <span className=\"attention-item-arrow\"></span>\n                      </div>\n                    )}\n                    {projectData?.changeOrderPending > 0 && (\n                      <div className=\"attention-item\" onClick={() => setActiveProjectTab('financials')}>\n                        <div className=\"attention-item-icon info\">\n                          <FileText size={16} />\n                        </div>\n                        <div className=\"attention-item-content\">\n                          <span className=\"attention-item-title\">{projectData.changeOrderPending} change order{projectData.changeOrderPending !== 1 ? 's' : ''} pending</span>\n                          <span className=\"attention-item-action\">Review in Financials</span>\n                        </div>\n                        <span className=\"attention-item-arrow\"></span>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n\n              {/* Work Areas */}\n              <div className=\"overview-section-card\">\n                <div className=\"section-card-header\">\n                  <h3>Work Areas</h3>\n                  <div className=\"section-card-badges\">\n                    {areasComplete > 0 && <span className=\"section-badge done\">{areasComplete} Complete</span>}\n                    {areasWorking > 0 && <span className=\"section-badge working\">{areasWorking} Active</span>}\n                    {areasNotStarted > 0 && <span className=\"section-badge pending\">{areasNotStarted} Pending</span>}\n                  </div>\n                </div>\n                <div className=\"work-areas-list stagger-areas\">\n                  {areas.map(area => (\n                    <div key={area.id} className={`work-area-item ${area.status}`}>\n                      <div className=\"work-area-status\">\n                        {area.status === 'done' && <span className=\"status-icon done\"></span>}\n                        {area.status === 'working' && <span className=\"status-icon working\"></span>}\n                        {area.status === 'not_started' && <span className=\"status-icon pending\"></span>}\n                      </div>\n                      <div className=\"work-area-info\">\n                        <span className=\"work-area-name\">{area.name}</span>\n                        <span className=\"work-area-weight\">\n                          {area.scheduled_value ? formatCurrency(area.scheduled_value) : `${area.weight}%`}\n                        </span>\n                      </div>\n                      <div className=\"work-area-bar\">\n                        <div\n                          className={`work-area-fill ${area.status}`}\n                          style={{ width: area.status === 'done' ? '100%' : area.status === 'working' ? '50%' : '0%' }}\n                        ></div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              {/* Quick Stats Row */}\n              <div className=\"overview-stats-row\">\n                <div className=\"quick-stat-card\" onClick={() => setActiveProjectTab('reports')}>\n                  <div className=\"quick-stat-icon\"><ClipboardList size={20} /></div>\n                  <div className=\"quick-stat-content\">\n                    <span className=\"quick-stat-value\">{projectData?.dailyReportsCount || 0}</span>\n                    <span className=\"quick-stat-label\">Daily Reports</span>\n                  </div>\n                  <span className=\"quick-stat-arrow\"></span>\n                </div>\n                <div className=\"quick-stat-card\" onClick={() => setActiveProjectTab('financials')}>\n                  <div className=\"quick-stat-icon\"><DollarSign size={20} /></div>\n                  <div className=\"quick-stat-content\">\n                    <span className=\"quick-stat-value\">{projectData?.totalTickets || 0}</span>\n                    <span className=\"quick-stat-label\">T&M Tickets</span>\n                  </div>\n                  <span className=\"quick-stat-arrow\"></span>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* FINANCIALS TAB */}\n          {activeProjectTab === 'financials' && (\n            <div className=\"pv-tab-panel financials-tab\">\n              {/* Key Metrics - Hero Section (Always visible) */}\n              <HeroMetrics\n                contractValue={selectedProject?.contract_value || 0}\n                earnedRevenue={billable}\n                totalCosts={projectData?.allCostsTotal || 0}\n                profit={projectData?.currentProfit || 0}\n                progress={progress}\n                corApprovedValue={changeOrderValue}\n                loading={!projectData}\n              />\n\n              {/* Split Layout with Collapsible Navigation */}\n              <div className={`financials-layout ${financialsSidebarCollapsed ? 'sidebar-collapsed' : ''}`}>\n                {/* Mobile Menu Toggle Button */}\n                <button\n                  className=\"financials-mobile-menu-toggle\"\n                  onClick={handleToggleMobileSidebar}\n                  aria-label=\"Open navigation menu\"\n                  title=\"Open navigation menu\"\n                >\n                  <Menu size={20} />\n                  <span>Menu</span>\n                </button>\n\n                {/* Mobile Overlay/Backdrop */}\n                {financialsSidebarMobileOpen && (\n                  <div\n                    className=\"financials-sidebar-overlay\"\n                    onClick={handleCloseMobileSidebar}\n                    aria-hidden=\"true\"\n                  />\n                )}\n\n                {/* Sidebar Navigation - Always visible, collapsible */}\n                <div className={`financials-sidebar ${financialsSidebarCollapsed ? 'collapsed' : ''} ${financialsSidebarMobileOpen ? 'mobile-open' : ''}`}>\n                  <FinancialsNav\n                    activeSection={financialsSection}\n                    onSectionChange={(section) => {\n                      setFinancialsSection(section)\n                      setFinancialsSidebarMobileOpen(false) // Close mobile sidebar when section changes\n                    }}\n                    collapsed={financialsSidebarCollapsed}\n                    onToggleCollapse={handleToggleFinancialsSidebar}\n                    onMobileClose={handleCloseMobileSidebar}\n                    stats={financialsNavStats}\n                  />\n                </div>\n\n                {/* Main Content Area */}\n                <div className=\"financials-main\">\n                  {/* OVERVIEW SECTION */}\n                  {financialsSection === 'overview' && (\n                    <div className=\"financials-overview animate-fade-in\">\n                      {/* Financial Trend Chart */}\n                      <FinancialTrendChart\n                        projectData={projectData}\n                        project={selectedProject}\n                        tmTickets={projectData?.tmTickets || []}\n                        corStats={projectData?.corStats}\n                        areas={areas}\n                      />\n\n                      {/* Burn Rate & Profitability Row */}\n                      <div className=\"financials-analysis-row stagger-children\">\n                        <BurnRateCard\n                          dailyBurn={projectData?.dailyBurn || 0}\n                          totalBurn={projectData?.totalBurn || 0}\n                          daysWorked={projectData?.totalBurnDays || 0}\n                          laborCost={projectData?.laborCost || 0}\n                          materialsEquipmentCost={projectData?.materialsEquipmentCost || 0}\n                          progress={progress}\n                          contractValue={revisedContractValue}\n                          laborByDate={projectData?.laborByDate || []}\n                          materialsEquipmentByDate={projectData?.materialsEquipmentByDate || []}\n                        />\n\n                        <ProfitabilityCard\n                          revenue={billable}\n                          totalCosts={projectData?.allCostsTotal || 0}\n                          contractValue={revisedContractValue}\n                          progress={progress}\n                        />\n                      </div>\n\n                      {/* Cost Contributors & Disposal Summary Side-by-Side */}\n                      <div className=\"cost-disposal-row\">\n                        <CostContributorsCard\n                          laborCost={projectData?.laborCost || 0}\n                          haulOffCost={projectData?.haulOffCost || 0}\n                          customCosts={projectData?.customCosts || []}\n                          onAddCost={handleAddCost}\n                          onDeleteCost={handleDeleteCost}\n                        />\n\n                        <DisposalSummary\n                          project={selectedProject}\n                          period=\"week\"\n                        />\n                      </div>\n\n                      {/* Equipment Tracking */}\n                      <ProjectEquipmentCard\n                        key={equipmentRefreshKey}\n                        project={selectedProject}\n                        onAddEquipment={handleAddEquipment}\n                        onEditEquipment={handleEditEquipment}\n                        onShowToast={onShowToast}\n                      />\n\n                      {/* Progress Billing / Draw Requests */}\n                      <ProgressBillingCard\n                        key={drawRequestRefreshKey}\n                        project={selectedProject}\n                        areas={areas}\n                        corStats={projectData?.corStats}\n                        onCreateDraw={handleCreateDraw}\n                        onViewDraw={handleViewDraw}\n                        onShowToast={onShowToast}\n                      />\n\n                      {/* Labor Details - Collapsible */}\n                      <details className=\"financials-details\">\n                        <summary className=\"financials-details-summary\">\n                          <HardHat size={16} />\n                          <span>Labor Details</span>\n                          <span className=\"financials-details-value\">{formatCurrency(projectData?.laborCost || 0)}</span>\n                        </summary>\n                        <div className=\"financials-details-content\">\n                          <ManDayCosts project={selectedProject} company={company} onShowToast={onShowToast} />\n                        </div>\n                      </details>\n                    </div>\n                  )}\n\n                  {/* CHANGE ORDERS SECTION */}\n                  {financialsSection === 'cors' && (\n                    <div className=\"financials-cors animate-fade-in\">\n                      {/* COR Log - Always visible first */}\n                      <div className=\"financials-section cor-section-primary\">\n                        <Suspense fallback={<TicketSkeleton />}>\n                          <CORLogPreview\n                            project={selectedProject}\n                            onShowToast={onShowToast}\n                            onToggleList={handleToggleCORList}\n                            showingList={corListExpanded}\n                            onViewFullLog={handleViewFullCORLog}\n                            onCreateCOR={handleCreateCOR}\n                          />\n                        </Suspense>\n                      </div>\n\n                      {/* Full COR Card List - Expands below the log when toggled */}\n                      {corListExpanded && (\n                        <div className=\"financials-section cor-section-list animate-fade-in\" style={{ marginTop: '1rem' }}>\n                          <Suspense fallback={<TicketSkeleton />}>\n                            <CORList\n                              project={selectedProject}\n                              company={company}\n                              areas={areas}\n                              refreshKey={corRefreshKey}\n                              onShowToast={onShowToast}\n                              previewMode={false}\n                              onViewAll={handleToggleCORList}\n                              onDisplayModeChange={setCORDisplayMode}\n                              onCreateCOR={handleCreateCOR}\n                              onViewCOR={handleViewCOR}\n                              onEditCOR={handleEditCOR}\n                            />\n                          </Suspense>\n                        </div>\n                      )}\n                    </div>\n                  )}\n\n                  {/* T&M TICKETS SECTION */}\n                  {financialsSection === 'tickets' && (\n                    <div className=\"financials-tickets animate-fade-in\">\n                      <div className=\"financials-section tm-section\">\n                        {tmViewMode === 'full' && (\n                          <button\n                            className=\"section-back-btn\"\n                            onClick={handleBackToTMPreview}\n                          >\n                             Back to summary\n                          </button>\n                        )}\n                        <Suspense fallback={<TicketSkeleton />}>\n                          <TMList\n                            project={selectedProject}\n                            company={company}\n                            onShowToast={onShowToast}\n                            compact={tmViewMode === 'preview'}\n                            previewMode={tmViewMode === 'preview'}\n                            onViewAll={handleViewAllTickets}\n                          />\n                        </Suspense>\n                      </div>\n                    </div>\n                  )}\n\n                  {/* BILLING SECTION */}\n                  {financialsSection === 'billing' && (\n                    <div className=\"financials-billing animate-fade-in\">\n                      <Suspense fallback={<TicketSkeleton />}>\n                        <BillingCenter\n                          project={selectedProject}\n                          company={company}\n                          user={user}\n                          onShowToast={onShowToast}\n                        />\n                      </Suspense>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* REPORTS TAB */}\n          {activeProjectTab === 'reports' && (\n            <div className=\"pv-tab-panel reports-tab\">\n              {/* Hero Metrics */}\n              <div className=\"reports-hero\">\n                <div className=\"reports-hero-grid\">\n                  {/* Total Reports */}\n                  <div className=\"reports-metric primary\">\n                    <div className=\"reports-metric-icon\">\n                      <ClipboardList size={24} />\n                    </div>\n                    <div className=\"reports-metric-content\">\n                      <div className=\"reports-metric-value\">{projectData?.dailyReportsCount || 0}</div>\n                      <div className=\"reports-metric-label\">Daily Reports</div>\n                    </div>\n                  </div>\n\n                  {/* This Week */}\n                  <div className=\"reports-metric\">\n                    <div className=\"reports-metric-value\">{projectData?.recentDailyReports || 0}</div>\n                    <div className=\"reports-metric-label\">This Week</div>\n                    <div className=\"reports-metric-bar\">\n                      <div\n                        className=\"reports-metric-fill\"\n                        style={{ width: `${Math.min((projectData?.recentDailyReports || 0) / 7 * 100, 100)}%` }}\n                      ></div>\n                    </div>\n                  </div>\n\n                  {/* Injury Reports */}\n                  <div className={`reports-metric ${(projectData?.injuryReportsCount || 0) > 0 ? 'warning' : 'success'}`}>\n                    <div className=\"reports-metric-value\">{projectData?.injuryReportsCount || 0}</div>\n                    <div className=\"reports-metric-label\">Injuries</div>\n                    <div className=\"reports-metric-status\">\n                      {(projectData?.injuryReportsCount || 0) === 0 ? 'No incidents' : 'Review required'}\n                    </div>\n                  </div>\n\n                  {/* Last Report */}\n                  <div className=\"reports-metric\">\n                    <div className=\"reports-metric-value small\">\n                      {projectData?.lastDailyReport\n                        ? new Date(projectData.lastDailyReport).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })\n                        : 'None'\n                      }\n                    </div>\n                    <div className=\"reports-metric-label\">Last Filed</div>\n                    {projectData?.lastDailyReport && (\n                      <div className=\"reports-metric-detail\">\n                        {Math.floor((new Date() - new Date(projectData.lastDailyReport)) / (1000 * 60 * 60 * 24))} days ago\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </div>\n\n              {/* Daily Reports Section */}\n              <div className=\"reports-section-card\">\n                <div className=\"reports-section-header\">\n                  <div className=\"reports-section-title\">\n                    <ClipboardList size={18} />\n                    <h3>Daily Reports</h3>\n                  </div>\n                  <span className=\"reports-section-count\">{projectData?.dailyReportsCount || 0} total</span>\n                </div>\n                <div className=\"reports-section-content\">\n                  <Suspense fallback={<TicketSkeleton />}>\n                    <DailyReportsList project={selectedProject} company={company} onShowToast={onShowToast} />\n                  </Suspense>\n                </div>\n              </div>\n\n              {/* Injury Reports Section */}\n              <div className={`reports-section-card ${(projectData?.injuryReportsCount || 0) > 0 ? 'has-warning' : ''}`}>\n                <div className=\"reports-section-header\">\n                  <div className=\"reports-section-title\">\n                    <span className={`reports-section-icon ${(projectData?.injuryReportsCount || 0) > 0 ? 'warning' : 'success'}`}>\n                      {(projectData?.injuryReportsCount || 0) > 0 ? '' : ''}\n                    </span>\n                    <h3>Safety & Injury Reports</h3>\n                  </div>\n                  <span className={`reports-section-badge ${(projectData?.injuryReportsCount || 0) > 0 ? 'warning' : 'success'}`}>\n                    {(projectData?.injuryReportsCount || 0) > 0\n                      ? `${projectData.injuryReportsCount} incident${projectData.injuryReportsCount !== 1 ? 's' : ''}`\n                      : 'No incidents'\n                    }\n                  </span>\n                </div>\n                <div className=\"reports-section-content\">\n                  <Suspense fallback={<TicketSkeleton />}>\n                    <InjuryReportsList\n                      project={selectedProject}\n                      companyId={company?.id || selectedProject?.company_id}\n                      company={company}\n                      user={user}\n                      onShowToast={onShowToast}\n                    />\n                  </Suspense>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* DOCUMENTS TAB */}\n          {activeProjectTab === 'documents' && (\n            <div className=\"pv-tab-panel documents-tab\">\n              <Suspense fallback={<TicketSkeleton />}>\n                <DocumentsTab\n                  project={selectedProject}\n                  companyId={company?.id || selectedProject?.company_id}\n                  onShowToast={onShowToast}\n                  userRole={user?.access_level || 'office'}\n                />\n              </Suspense>\n            </div>\n          )}\n\n          {/* INFO TAB */}\n          {activeProjectTab === 'info' && (\n            <div className=\"pv-tab-panel info-tab\">\n              {/* Hero Header */}\n              <div className=\"info-hero\">\n                <div className=\"info-hero-content\">\n                  <div className=\"info-hero-main\">\n                    <h2 className=\"info-hero-title\">{selectedProject.name}</h2>\n                    {selectedProject.job_number && (\n                      <span className=\"info-hero-job\">Job #{selectedProject.job_number}</span>\n                    )}\n                  </div>\n                  <button className=\"btn btn-primary btn-with-icon\" onClick={handleEditClick}>\n                    <span>Edit Project</span>\n                  </button>\n                </div>\n                {selectedProject.address && (\n                  <div className=\"info-hero-address\">\n                    <MapPin size={14} />\n                    <span>{selectedProject.address}</span>\n                  </div>\n                )}\n              </div>\n\n              {/* Quick Info Cards */}\n              <div className=\"info-quick-grid\">\n                {/* Work Type */}\n                <div className=\"info-quick-card\">\n                  <div className=\"info-quick-icon\">\n                    <HardHat size={20} />\n                  </div>\n                  <div className=\"info-quick-content\">\n                    <span className=\"info-quick-value\">\n                      {selectedProject.work_type === 'environmental' ? 'Environmental' : 'Demolition'}\n                    </span>\n                    <span className=\"info-quick-label\">Work Type</span>\n                  </div>\n                </div>\n\n                {/* Job Type */}\n                <div className=\"info-quick-card\">\n                  <div className=\"info-quick-icon\">\n                    <FileText size={20} />\n                  </div>\n                  <div className=\"info-quick-content\">\n                    <span className=\"info-quick-value\">\n                      {selectedProject.job_type === 'prevailing_wage' ? 'Prevailing Wage' : 'Standard'}\n                    </span>\n                    <span className=\"info-quick-label\">Job Type</span>\n                  </div>\n                </div>\n\n                {/* Contract Value */}\n                <div className=\"info-quick-card highlight\">\n                  <div className=\"info-quick-icon\">\n                    <DollarSign size={20} />\n                  </div>\n                  <div className=\"info-quick-content\">\n                    <span className=\"info-quick-value\">{formatCurrency(revisedContractValue)}</span>\n                    <span className=\"info-quick-label\">\n                      {changeOrderValue > 0 ? `Incl. +${formatCurrency(changeOrderValue)} COs` : 'Contract Value'}\n                    </span>\n                  </div>\n                </div>\n\n                {/* Foreman PIN */}\n                {selectedProject.pin && (\n                  <div className=\"info-quick-card\">\n                    <div className=\"info-quick-icon\">\n                      <span className=\"info-pin-icon\">#</span>\n                    </div>\n                    <div className=\"info-quick-content\">\n                      <span className=\"info-quick-value mono\">{selectedProject.pin}</span>\n                      <span className=\"info-quick-label\">Foreman PIN</span>\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              {/* Client & Contractor Card */}\n              <div className=\"info-section-card\">\n                <div className=\"info-section-header\">\n                  <Building2 size={18} />\n                  <h3>Client & Contractor</h3>\n                </div>\n                <div className=\"info-section-content\">\n                  {selectedProject.general_contractor ? (\n                    <div className=\"info-detail-row\">\n                      <span className=\"info-detail-label\">General Contractor</span>\n                      <span className=\"info-detail-value\">{selectedProject.general_contractor}</span>\n                    </div>\n                  ) : (\n                    <div className=\"info-detail-row empty\">\n                      <span className=\"info-detail-value\">No general contractor specified</span>\n                    </div>\n                  )}\n                  {selectedProject.client_contact && (\n                    <div className=\"info-detail-row\">\n                      <span className=\"info-detail-label\">Client Contact</span>\n                      <span className=\"info-detail-value\">{selectedProject.client_contact}</span>\n                    </div>\n                  )}\n                  {selectedProject.client_phone && (\n                    <div className=\"info-detail-row clickable\">\n                      <span className=\"info-detail-label\">\n                        <Phone size={14} />\n                        Phone\n                      </span>\n                      <a href={`tel:${selectedProject.client_phone}`} className=\"info-detail-value link\">\n                        {selectedProject.client_phone}\n                      </a>\n                    </div>\n                  )}\n                </div>\n              </div>\n\n              {/* Work Areas Card */}\n              <div className=\"info-section-card\">\n                <div className=\"info-section-header\">\n                  <LayoutGrid size={18} />\n                  <h3>Work Areas</h3>\n                  <div className=\"info-section-badges\">\n                    {areasComplete > 0 && <span className=\"info-badge done\">{areasComplete} Done</span>}\n                    {areasWorking > 0 && <span className=\"info-badge working\">{areasWorking} Active</span>}\n                    {areasNotStarted > 0 && <span className=\"info-badge pending\">{areasNotStarted} Pending</span>}\n                  </div>\n                </div>\n                <div className=\"info-areas-list\">\n                  {areas.map(area => (\n                    <div key={area.id} className={`info-area-item ${area.status}`}>\n                      <div className=\"info-area-status\">\n                        {area.status === 'done' && <span className=\"status-dot done\"></span>}\n                        {area.status === 'working' && <span className=\"status-dot working\"></span>}\n                        {area.status === 'not_started' && <span className=\"status-dot pending\"></span>}\n                      </div>\n                      <div className=\"info-area-details\">\n                        <span className=\"info-area-name\">{area.name}</span>\n                        <span className={`info-area-status-label ${area.status}`}>\n                          {area.status === 'done' ? 'Complete' : area.status === 'working' ? 'In Progress' : 'Not Started'}\n                        </span>\n                      </div>\n                      <span className=\"info-area-weight\">{area.weight}%</span>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              {/* Project Team */}\n              <ProjectTeam\n                project={selectedProject}\n                company={company}\n                user={user}\n                isAdmin={isAdmin}\n                onShowToast={onShowToast}\n              />\n\n              {/* Project Settings - Collapsible */}\n              <details className=\"info-details-section\">\n                <summary className=\"info-details-summary\">\n                  <Info size={16} />\n                  <span>Additional Settings</span>\n                </summary>\n                <div className=\"info-details-content\">\n                  <div className=\"info-detail-row\">\n                    <span className=\"info-detail-label\">Original Contract</span>\n                    <span className=\"info-detail-value\">{formatCurrency(selectedProject.contract_value)}</span>\n                  </div>\n                  {changeOrderValue > 0 && (\n                    <div className=\"info-detail-row\">\n                      <span className=\"info-detail-label\">Approved Change Orders</span>\n                      <span className=\"info-detail-value positive\">+{formatCurrency(changeOrderValue)}</span>\n                    </div>\n                  )}\n                  {selectedProject.default_dump_site_id && (\n                    <div className=\"info-detail-row\">\n                      <span className=\"info-detail-label\">Default Dump Site</span>\n                      <span className=\"info-detail-value\">\n                        {dumpSites.find(s => s.id === selectedProject.default_dump_site_id)?.name || 'Unknown'}\n                      </span>\n                    </div>\n                  )}\n                </div>\n              </details>\n            </div>\n          )}\n        </div>\n\n        {/* Share Modal */}\n        {showShareModal && (\n          <Suspense fallback={null}>\n            <ShareModal\n              project={selectedProject}\n              user={user}\n              onClose={() => setShowShareModal(false)}\n              onShareCreated={(share) => {\n                onShowToast('Share link created successfully!', 'success')\n              }}\n            />\n          </Suspense>\n        )}\n\n        {/* Notification Settings Modal */}\n        {showNotificationSettings && (\n          <div className=\"notification-settings-modal\">\n            <Suspense fallback={null}>\n              <NotificationSettings\n                project={selectedProject}\n                company={company}\n                onShowToast={onShowToast}\n                onClose={() => setShowNotificationSettings(false)}\n              />\n            </Suspense>\n          </div>\n        )}\n\n        {/* COR Form Modal */}\n        {showCORForm && (\n          <Suspense fallback={null}>\n            <CORForm\n              project={selectedProject}\n              company={company}\n              areas={areas}\n              existingCOR={editingCOR}\n              onClose={() => {\n                setShowCORForm(false)\n                setEditingCOR(null)\n              }}\n              onSaved={() => {\n                setShowCORForm(false)\n                setEditingCOR(null)\n                setCORRefreshKey(prev => prev + 1)\n              }}\n              onShowToast={onShowToast}\n            />\n          </Suspense>\n        )}\n\n        {/* COR Detail Modal */}\n        {showCORDetail && viewingCOR && (\n          <Suspense fallback={null}>\n            <CORDetail\n              cor={viewingCOR}\n              project={selectedProject}\n              company={company}\n              areas={areas}\n              onClose={() => {\n                setShowCORDetail(false)\n                setViewingCOR(null)\n              }}\n              onEdit={(cor) => {\n                setShowCORDetail(false)\n                setViewingCOR(null)\n                setEditingCOR(cor)\n                setShowCORForm(true)\n              }}\n              onShowToast={onShowToast}\n              onStatusChange={() => {\n                // Trigger a refresh of the COR list\n              }}\n            />\n          </Suspense>\n        )}\n\n        {/* COR Log Modal */}\n        {corDisplayMode === 'log' && selectedProject && (\n          <div className=\"cor-log-modal-overlay\" onClick={() => setCORDisplayMode('list')}>\n            <div className=\"cor-log-modal\" onClick={(e) => e.stopPropagation()}>\n              <div className=\"cor-log-modal-header\">\n                <h2>Change Order Log</h2>\n                <button\n                  className=\"cor-log-modal-close\"\n                  onClick={() => setCORDisplayMode('list')}\n                  title=\"Close\"\n                >\n                  \n                </button>\n              </div>\n              <div className=\"cor-log-modal-content\">\n                <Suspense fallback={<div style={{ padding: '2rem', textAlign: 'center' }}>Loading...</div>}>\n                  <CORLog project={selectedProject} company={company} onShowToast={onShowToast} />\n                </Suspense>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Add Cost Modal */}\n        {showAddCostModal && (\n          <Suspense fallback={null}>\n            <AddCostModal\n              onClose={() => setShowAddCostModal(false)}\n              saving={savingCost}\n              onSave={async (costData) => {\n                try {\n                  setSavingCost(true)\n                  await db.addProjectCost(selectedProject.id, company.id, costData)\n                  setShowAddCostModal(false)\n                  loadProjects()\n                  onShowToast('Cost added successfully', 'success')\n                } catch (err) {\n                  console.error('Error adding cost:', err)\n                  onShowToast('Error adding cost', 'error')\n                } finally {\n                  setSavingCost(false)\n                }\n              }}\n            />\n          </Suspense>\n        )}\n\n        {/* Equipment Modal */}\n        {showEquipmentModal && (\n          <Suspense fallback={null}>\n            <EquipmentModal\n              project={selectedProject}\n              company={company}\n              user={user}\n              editItem={editingEquipment}\n              onSave={() => {\n                setShowEquipmentModal(false)\n                setEditingEquipment(null)\n                setEquipmentRefreshKey(prev => prev + 1)\n                onShowToast(editingEquipment ? 'Equipment updated' : 'Equipment added', 'success')\n              }}\n              onClose={() => {\n                setShowEquipmentModal(false)\n                setEditingEquipment(null)\n              }}\n            />\n          </Suspense>\n        )}\n\n        {/* Draw Request Modal */}\n        {showDrawRequestModal && (\n          <Suspense fallback={null}>\n            <DrawRequestModal\n              project={selectedProject}\n              company={company}\n              areas={areas}\n              corStats={projectsData.find(p => p.id === selectedProject?.id)?.corStats}\n              editDrawRequest={editingDrawRequest}\n              onSave={() => {\n                setShowDrawRequestModal(false)\n                setEditingDrawRequest(null)\n                setDrawRequestRefreshKey(prev => prev + 1)\n                onShowToast(editingDrawRequest ? 'Draw request updated' : 'Draw request created', 'success')\n              }}\n              onClose={() => {\n                setShowDrawRequestModal(false)\n                setEditingDrawRequest(null)\n              }}\n            />\n          </Suspense>\n        )}\n      </div>\n    )\n  }\n\n  // Project List View - empty state\n  if (projects.length === 0) {\n    return (\n      <div className=\"empty-state\">\n        <ClipboardList size={48} className=\"empty-state-icon\" />\n        <h3>No Projects Yet</h3>\n        <p>Create your first project to get started</p>\n      </div>\n    )\n  }\n\n  // Portfolio overview - uses memoized values from above\n  return (\n    <div>\n      {/* Business Overview - High Level Portfolio Health */}\n      <div className=\"business-overview\">\n        <div className=\"bo-header\">\n          <h2 className=\"bo-title\">Portfolio Overview</h2>\n          <button className=\"search-trigger-btn\" onClick={() => setSearchOpen(true)}>\n            <Search size={16} />\n            <span>Search</span>\n            <span className=\"shortcut\">K</span>\n          </button>\n          <div className=\"bo-project-count\">{projects.length} Active Project{projects.length !== 1 ? 's' : ''}</div>\n        </div>\n\n        {/* Main Financial Bar */}\n        <div className=\"bo-financial\">\n          <div className=\"bo-progress-bar\">\n            <div\n              className=\"bo-progress-fill\"\n              style={{ width: `${Math.min(weightedCompletion, 100)}%` }}\n            ></div>\n          </div>\n          <div className=\"bo-financial-row\">\n            <div className=\"bo-metric primary\">\n              <span className=\"bo-metric-value\">{formatCurrency(totalEarned)}</span>\n              <span className=\"bo-metric-label\">Earned Revenue</span>\n            </div>\n            <div className=\"bo-metric-separator\">of</div>\n            <div className=\"bo-metric primary\">\n              <span className=\"bo-metric-value\">{formatCurrency(totalPortfolioValue)}</span>\n              <span className=\"bo-metric-label\">Total Portfolio</span>\n            </div>\n            <div className=\"bo-metric highlight\">\n              <span className=\"bo-metric-value\">{formatCurrency(totalRemaining)}</span>\n              <span className=\"bo-metric-label\">Remaining to Bill</span>\n            </div>\n          </div>\n\n          {/* Change Orders Summary - Only show if there are change orders */}\n          {totalChangeOrders > 0 && (\n            <div className=\"bo-change-orders\">\n              <div className=\"bo-co-item\">\n                <span className=\"bo-co-label\">Original Contracts</span>\n                <span className=\"bo-co-value\">{formatCurrency(totalOriginalContract)}</span>\n              </div>\n              <div className=\"bo-co-item bo-co-added\">\n                <span className=\"bo-co-label\">+ Change Orders ({projectsWithChangeOrders} project{projectsWithChangeOrders !== 1 ? 's' : ''})</span>\n                <span className=\"bo-co-value\">+{formatCurrency(totalChangeOrders)}</span>\n              </div>\n            </div>\n          )}\n\n          {/* Pending CORs - Unapproved extra work (not yet part of contract value) */}\n          {totalPendingCORCount > 0 && (\n            <div className=\"bo-pending-cors\">\n              <div className=\"bo-pending-cor-item\">\n                <span className=\"bo-pending-cor-icon\">!</span>\n                <span className=\"bo-pending-cor-label\">Pending CORs</span>\n                <span className=\"bo-pending-cor-value\">{formatCurrency(totalPendingCORValue)}</span>\n                <span className=\"bo-pending-cor-count\">({totalPendingCORCount} pending)</span>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Project Health Summary */}\n        <div className=\"bo-health\">\n          <div className=\"bo-health-title\">Project Health</div>\n          <div className=\"bo-health-pills\">\n            {projectsComplete > 0 && (\n              <div className=\"bo-pill complete\">\n                <span className=\"bo-pill-count\">{projectsComplete}</span>\n                <span className=\"bo-pill-label\">Complete</span>\n              </div>\n            )}\n            {projectsOnTrack > 0 && (\n              <div className=\"bo-pill on-track\">\n                <span className=\"bo-pill-count\">{projectsOnTrack}</span>\n                <span className=\"bo-pill-label\">On Track</span>\n              </div>\n            )}\n            {projectsAtRisk > 0 && (\n              <div className=\"bo-pill at-risk\">\n                <span className=\"bo-pill-count\">{projectsAtRisk}</span>\n                <span className=\"bo-pill-label\">At Risk</span>\n              </div>\n            )}\n            {projectsOverBudget > 0 && (\n              <div className=\"bo-pill over-budget\">\n                <span className=\"bo-pill-count\">{projectsOverBudget}</span>\n                <span className=\"bo-pill-label\">Over Budget</span>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Schedule Performance Summary */}\n        {hasAnyScheduleData && (\n          <div className=\"bo-schedule\">\n            <div className=\"bo-schedule-title\">Schedule Performance</div>\n            <div className=\"bo-schedule-pills\">\n              {scheduleAhead > 0 && (\n                <div className=\"bo-pill ahead\">\n                  <span className=\"bo-pill-count\">{scheduleAhead}</span>\n                  <span className=\"bo-pill-label\">Ahead</span>\n                </div>\n              )}\n              {scheduleOnTrack > 0 && (\n                <div className=\"bo-pill schedule-on-track\">\n                  <span className=\"bo-pill-count\">{scheduleOnTrack}</span>\n                  <span className=\"bo-pill-label\">On Track</span>\n                </div>\n              )}\n              {scheduleBehind > 0 && (\n                <div className=\"bo-pill behind\">\n                  <span className=\"bo-pill-count\">{scheduleBehind}</span>\n                  <span className=\"bo-pill-label\">Behind</span>\n                </div>\n              )}\n            </div>\n\n            {/* Labor Performance (if any projects have planned man-days) */}\n            {hasAnyLaborData && (\n              <div className=\"bo-labor-summary\">\n                <span className=\"bo-labor-label\">Man-Days:</span>\n                {laborUnder > 0 && (\n                  <span className=\"bo-labor-badge under\">{laborUnder} under</span>\n                )}\n                {laborOnTrack > 0 && (\n                  <span className=\"bo-labor-badge on-track\">{laborOnTrack} on track</span>\n                )}\n                {laborOver > 0 && (\n                  <span className=\"bo-labor-badge over\">{laborOver} over</span>\n                )}\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* Smart Alerts - Actionable insights requiring attention */}\n      {riskAnalysis.allAlerts.length > 0 && (\n        <div className=\"smart-alerts-section\" style={{ marginBottom: 'var(--space-lg, 1.5rem)' }}>\n          <div className=\"smart-alerts-header\" style={{\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'space-between',\n            marginBottom: 'var(--space-sm, 0.5rem)'\n          }}>\n            <h3 style={{\n              fontSize: 'var(--font-size-md, 1rem)',\n              fontWeight: 'var(--font-weight-semibold, 600)',\n              color: 'var(--text-primary)',\n              margin: 0\n            }}>\n              Needs Attention\n              {riskAnalysis.criticalCount > 0 && (\n                <span style={{\n                  marginLeft: '0.5rem',\n                  padding: '2px 8px',\n                  fontSize: '0.75rem',\n                  fontWeight: 600,\n                  borderRadius: '9999px',\n                  background: 'var(--status-danger-bg, #7f1d1d)',\n                  color: 'var(--status-danger, #dc2626)'\n                }}>\n                  {riskAnalysis.criticalCount} critical\n                </span>\n              )}\n            </h3>\n          </div>\n          <SmartAlerts\n            alerts={riskAnalysis.allAlerts}\n            onAction={handleAlertAction}\n            maxVisible={3}\n          />\n        </div>\n      )}\n\n      {/* Projects Header */}\n      <div className=\"dashboard-header\">\n        <h2>Projects</h2>\n        <span className=\"project-count\">{projects.length} active</span>\n      </div>\n\n      {/* Project Grid */}\n      <div className=\"project-list\">\n        {projectsData.map(project => {\n          const projectRisk = riskAnalysis.projectRisks.find(r => r.projectId === project.id)\n          return (\n            <EnhancedProjectCard\n              key={project.id}\n              project={project}\n              riskScore={projectRisk?.riskScore}\n              riskStatus={projectRisk?.riskStatus}\n              onClick={() => handleSelectProject(project)}\n            />\n          )\n        })}\n      </div>\n\n      {/* Universal Search Modal */}\n      <UniversalSearch\n        isOpen={isSearchOpen}\n        onClose={closeSearch}\n        companyId={company?.id}\n        onSelectProject={(project) => {\n          handleSelectProject(project)\n        }}\n        onSelectTicket={(ticket) => {\n          // Navigate to project and open T&M tab\n          const project = projects.find(p => p.id === ticket.project_id)\n          if (project) {\n            handleSelectProject(project)\n            setActiveProjectTab('financials')\n            setFinancialsSection('tickets')\n          }\n        }}\n        onSelectCOR={(cor) => {\n          // Navigate to project and open COR\n          const project = projects.find(p => p.id === cor.project_id)\n          if (project) {\n            handleSelectProject(project)\n            setActiveProjectTab('financials')\n            setFinancialsSection('cors')\n            setViewingCOR(cor)\n            setShowCORDetail(true)\n          }\n        }}\n        onShowToast={onShowToast}\n      />\n    </div>\n  )\n}\n\nfunction ProjectCard({ project, onClick }) {\n  const [areas, setAreas] = useState([])\n\n  useEffect(() => {\n    db.getAreas(project.id).then(setAreas)\n  }, [project.id])\n\n  const progress = calculateProgress(areas)\n  const status = getOverallStatus(areas)\n  const statusLabel = getOverallStatusLabel(areas)\n\n  return (\n    <div className=\"project-card\" onClick={onClick}>\n      <div className=\"project-card-header\">\n        <div>\n          <div className=\"project-card-name\">{project.name}</div>\n          <div className=\"project-card-value\">{formatCurrency(project.contract_value)}</div>\n        </div>\n        <span className={`status-badge ${status}`}>{statusLabel}</span>\n      </div>\n      <div className=\"project-card-progress\">\n        <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.9rem' }}>\n          <span style={{ color: 'var(--text-secondary)' }}>Progress</span>\n          <span style={{ fontWeight: 600 }}>{progress}%</span>\n        </div>\n        <div className=\"mini-progress-bar\">\n          <div className=\"mini-progress-fill\" style={{ width: `${progress}%` }}></div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\n// Enhanced Project Card with more details\nfunction EnhancedProjectCard({ project, riskScore, riskStatus, onClick }) {\n  const status = getOverallStatus(project.areas || [])\n  const statusLabel = getOverallStatusLabel(project.areas || [])\n  const profit = project.contract_value - project.billable\n  const isAtRisk = project.billable > project.contract_value * 0.9 && project.progress < 90\n\n  // Risk badge colors\n  const riskColors = {\n    healthy: { bg: 'var(--status-success-bg, #064e3b)', color: 'var(--status-success, #059669)' },\n    warning: { bg: 'var(--status-warning-bg, #78350f)', color: 'var(--status-warning, #d97706)' },\n    critical: { bg: 'var(--status-danger-bg, #7f1d1d)', color: 'var(--status-danger, #dc2626)' }\n  }\n  const riskStyle = riskColors[riskStatus] || riskColors.healthy\n\n  return (\n    <div className={`project-card enhanced ${isAtRisk ? 'at-risk' : ''}`} onClick={onClick}>\n      <div className=\"project-card-header\">\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n          {/* Risk Score Badge */}\n          {typeof riskScore === 'number' && (\n            <span\n              style={{\n                display: 'inline-flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                width: '32px',\n                height: '32px',\n                borderRadius: '50%',\n                fontSize: '0.75rem',\n                fontWeight: 700,\n                background: riskStyle.bg,\n                color: riskStyle.color\n              }}\n              title={`Risk Score: ${riskScore}`}\n              aria-label={`Risk score ${riskScore}, ${riskStatus}`}\n            >\n              {riskScore}\n            </span>\n          )}\n          <div>\n            <div className=\"project-card-name\">{project.name}</div>\n            <div className=\"project-card-value\">{formatCurrency(project.contract_value)}</div>\n          </div>\n        </div>\n        <span className={`status-badge ${status}`}>{statusLabel}</span>\n      </div>\n\n      {/* Stats Row */}\n      <div className=\"project-stats-row\">\n        <div className=\"project-stat\">\n          <span className=\"stat-value\">{project.progress}%</span>\n          <span className=\"stat-label\">Complete</span>\n        </div>\n        <div className=\"project-stat\">\n          <span className=\"stat-value\">{formatCurrency(project.billable)}</span>\n          <span className=\"stat-label\">Billable</span>\n        </div>\n        <div className=\"project-stat\">\n          <span className={`stat-value ${profit < 0 ? 'negative' : ''}`}>\n            {formatCurrency(Math.abs(profit))}\n          </span>\n          <span className=\"stat-label\">{profit >= 0 ? 'Remaining' : 'Over Budget'}</span>\n        </div>\n      </div>\n\n      {/* Progress Bar */}\n      <div className=\"mini-progress-bar\">\n        <div className=\"mini-progress-fill\" style={{ width: `${project.progress}%` }}></div>\n      </div>\n\n      {/* Badges Row */}\n      {(project.pendingTickets > 0 || project.totalTickets > 0) && (\n        <div className=\"project-badges\">\n          {project.pendingTickets > 0 && (\n            <span className=\"badge pending\">{project.pendingTickets} Pending T&M</span>\n          )}\n          {project.approvedTickets > 0 && (\n            <span className=\"badge approved\">{project.approvedTickets} Approved T&M</span>\n          )}\n        </div>\n      )}\n\n      {/* Schedule Badge */}\n      {project.hasScheduleData && (\n        <div className=\"project-schedule-badge\">\n          <span className={`schedule-indicator ${project.scheduleStatus}`}>\n            {project.scheduleLabel}\n          </span>\n          {project.hasLaborData && project.laborLabel && (\n            <span className={`labor-indicator ${project.laborStatus}`}>\n              {project.laborLabel}\n            </span>\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n\n\n"],"file":"Dashboard-Bf_Miu_5.js"}