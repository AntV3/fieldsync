import{aV as ye,aW as Ce,ar as x,as as e,aX as ke,aY as Fe,aZ as ce}from"./index-CbEMtBfa.js";import{r,A as je,D as T,aI as pe,e as De,m as fe,ag as q,F as le,K as U,_ as ze,ab as _e,c as ae,aJ as Se,L as M,J as we,d as Ee,I as Re,z as Me,y as Pe,i as Le,x as Ie,T as Ue,q as ne,aK as Ae,as as $e,ac as Oe,X as W,n as oe,h as de,aL as Be,a2 as Ve,N as Ge,O as Ke,v as He}from"./icons-CRX8gXS_.js";import"./react-DXGY7bZi.js";import"./pdf-aQqpMATS.js";import"./supabase-VuevzHjS.js";const Qe=i=>{if(!i)return"0 B";const h=["B","KB","MB","GB"];let t=i,d=0;for(;t>=1024&&d<h.length-1;)t/=1024,d++;return`${t.toFixed(t<10?1:0)} ${h[d]}`},ue=i=>i?new Date(i).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"}):"";function Xe({document:i,onBack:h,onUpdate:t,onShowToast:d,isOfficeOrAdmin:D}){const[n,A]=r.useState(i),[b,u]=r.useState([]),[P,z]=r.useState(!0),[_,k]=r.useState(!1),[g,y]=r.useState(""),[C,j]=r.useState(!1),S=ye.find(l=>l.id===n.category),F=Ce[n.visibility],w=n.approval_status==="pending",v=n.approval_status==="rejected",p=D;r.useEffect(()=>{m()},[n.id]);const m=async()=>{z(!0);try{const l=await x.getDocumentVersions(n.id);u(l)}catch(l){console.error("Error loading versions:",l)}finally{z(!1)}},f=async()=>{await x.logDocumentAccess(n.id,"downloaded");const l=`undefined/storage/v1/object/public/project-documents/${n.storage_path}`;window.open(l,"_blank")},$=async()=>{j(!0);try{await x.approveDocument(n.id),A(l=>({...l,approval_status:"approved"})),d?.("Document approved","success"),t?.()}catch(l){console.error("Error approving document:",l),d?.("Failed to approve document","error")}finally{j(!1)}},O=async()=>{if(!g.trim()){d?.("Please provide a reason for rejection","error");return}j(!0);try{await x.rejectDocument(n.id,g.trim()),A(l=>({...l,approval_status:"rejected",rejection_reason:g.trim()})),k(!1),y(""),d?.("Document rejected","success"),t?.()}catch(l){console.error("Error rejecting document:",l),d?.("Failed to reject document","error")}finally{j(!1)}},B=async()=>{if(confirm("Are you sure you want to archive this document?")){j(!0);try{await x.archiveDocument(n.id),d?.("Document archived","success"),h(),t?.()}catch(l){console.error("Error archiving document:",l),d?.("Failed to archive document","error")}finally{j(!1)}}};return e.jsxs("div",{className:"document-detail",children:[e.jsxs("div",{className:"document-detail-header",children:[e.jsxs("button",{className:"back-btn",onClick:h,children:[e.jsx(je,{size:20}),"Back"]}),e.jsxs("div",{className:"document-detail-actions",children:[e.jsxs("button",{className:"btn btn-secondary",onClick:f,children:[e.jsx(T,{size:18}),"Download"]}),D&&e.jsxs("button",{className:"btn btn-secondary btn-danger",onClick:B,disabled:C,children:[e.jsx(pe,{size:18}),"Archive"]})]})]}),e.jsxs("div",{className:"document-detail-content",children:[e.jsxs("div",{className:"document-detail-main",children:[e.jsxs("div",{className:"document-detail-title",children:[e.jsx("h2",{children:n.name}),n.version>1&&e.jsxs("span",{className:"version-badge",children:["v",n.version]})]}),(w||v)&&e.jsxs("div",{className:"document-detail-status",children:[w&&e.jsxs("div",{className:"status-banner pending",children:[e.jsx(De,{size:18}),e.jsx("span",{children:"Pending Approval"}),p&&e.jsxs("div",{className:"status-actions",children:[e.jsxs("button",{className:"btn btn-sm btn-success",onClick:$,disabled:C,children:[e.jsx(fe,{size:16}),"Approve"]}),e.jsxs("button",{className:"btn btn-sm btn-danger",onClick:()=>k(!0),disabled:C,children:[e.jsx(q,{size:16}),"Reject"]})]})]}),v&&e.jsxs("div",{className:"status-banner rejected",children:[e.jsx(q,{size:18}),e.jsxs("div",{className:"rejected-info",children:[e.jsx("span",{children:"Rejected"}),n.rejection_reason&&e.jsx("p",{className:"rejection-reason",children:n.rejection_reason})]})]})]}),e.jsxs("div",{className:"document-detail-meta",children:[e.jsxs("div",{className:"meta-item",children:[e.jsx(le,{size:16}),e.jsx("span",{children:n.file_name})]}),e.jsxs("div",{className:"meta-item",children:[e.jsx(U,{size:16}),e.jsx("span",{children:S?.label||n.category})]}),e.jsx("div",{className:"meta-item",children:e.jsx("span",{className:"meta-size",children:Qe(n.file_size_bytes)})}),e.jsxs("div",{className:"meta-item",children:[e.jsx(ze,{size:16}),e.jsx("span",{children:ue(n.uploaded_at)})]}),e.jsxs("div",{className:"meta-item",children:[e.jsx(_e,{size:16}),e.jsx("span",{children:n.uploaded_by_user?.email||"Unknown"})]}),e.jsxs("div",{className:"meta-item",children:[e.jsx(ae,{size:16}),e.jsx("span",{children:F?.label||n.visibility})]})]}),n.description&&e.jsxs("div",{className:"document-detail-description",children:[e.jsx("h3",{children:"Description"}),e.jsx("p",{children:n.description})]}),n.resource_type&&n.resource_id&&e.jsxs("div",{className:"document-detail-linked",children:[e.jsxs("h3",{children:[e.jsx(Se,{size:16}),"Linked To"]}),e.jsxs("p",{children:[n.resource_type==="cor"&&"Change Order Request",n.resource_type==="tm_ticket"&&"T&M Ticket",n.resource_type==="daily_report"&&"Daily Report"]})]})]}),e.jsxs("div",{className:"document-detail-sidebar",children:[e.jsx("h3",{children:"Version History"}),P?e.jsxs("div",{className:"versions-loading",children:[e.jsx(M,{size:20,className:"spinner"}),"Loading versions..."]}):b.length===0?e.jsx("p",{className:"versions-empty",children:"No version history"}):e.jsx("div",{className:"versions-list",children:b.map(l=>e.jsxs("div",{className:`version-item ${l.id===n.id?"current":""}`,children:[e.jsxs("div",{className:"version-info",children:[e.jsxs("span",{className:"version-number",children:["v",l.version,l.is_current&&e.jsx("span",{className:"current-badge",children:"Current"})]}),e.jsx("span",{className:"version-date",children:ue(l.uploaded_at)}),e.jsx("span",{className:"version-user",children:l.uploaded_by_user?.email})]}),e.jsx("button",{className:"version-download",onClick:async()=>{await x.logDocumentAccess(l.id,"downloaded"),window.open(`undefined/storage/v1/object/public/project-documents/${l.storage_path}`,"_blank")},title:"Download this version",children:e.jsx(T,{size:16})})]},l.id))}),D&&e.jsx("div",{className:"upload-version",children:e.jsx("p",{className:"upload-version-hint",children:'To upload a new version, use the main upload button and select "Replace existing document"'})})]})]}),_&&e.jsx("div",{className:"modal-overlay",onClick:()=>k(!1),children:e.jsxs("div",{className:"reject-modal",onClick:l=>l.stopPropagation(),children:[e.jsx("h3",{children:"Reject Document"}),e.jsx("p",{children:"Please provide a reason for rejection:"}),e.jsx("textarea",{value:g,onChange:l=>y(l.target.value),placeholder:"Enter reason...",rows:4}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>k(!1),children:"Cancel"}),e.jsxs("button",{className:"btn btn-danger",onClick:O,disabled:!g.trim()||C,children:[C?e.jsx(M,{size:16,className:"spinner"}):e.jsx(q,{size:16}),"Reject Document"]})]})]})})]})}const ee=[{id:"folder",label:"Folder",icon:U},{id:"plans",label:"Plans",icon:we},{id:"specs",label:"Specs",icon:le},{id:"permits",label:"Permits",icon:Ee},{id:"contracts",label:"Contracts",icon:Re},{id:"submittals",label:"Submittals",icon:Me},{id:"rfis",label:"RFIs",icon:Pe},{id:"photos",label:"Photos",icon:Le},{id:"reports",label:"Reports",icon:Ie},{id:"safety",label:"Safety",icon:Ue}],se=[{id:"blue",label:"Blue",hex:"#3b82f6"},{id:"green",label:"Green",hex:"#10b981"},{id:"yellow",label:"Yellow",hex:"#f59e0b"},{id:"red",label:"Red",hex:"#ef4444"},{id:"purple",label:"Purple",hex:"#8b5cf6"},{id:"pink",label:"Pink",hex:"#ec4899"},{id:"orange",label:"Orange",hex:"#f97316"},{id:"gray",label:"Gray",hex:"#6b7280"}];function Ye({projectId:i,companyId:h,folders:t,onFoldersChange:d,onClose:D,onShowToast:n}){const[A,b]=r.useState(!1),[u,P]=r.useState(null),[z,_]=r.useState(null),[k,g]=r.useState(!1),[y,C]=r.useState(""),[j,S]=r.useState("folder"),[F,w]=r.useState("blue"),[v,p]=r.useState(""),m=()=>{C(""),S("folder"),w("blue"),p(""),P(null)},f=()=>{m(),b(!0)},$=s=>{C(s.name),S(s.icon||"folder"),w(s.color||"blue"),p(s.description||""),P(s),b(!0)},O=async s=>{if(s.preventDefault(),!y.trim()){n?.("Please enter a folder name","error");return}g(!0);try{if(u)await x.updateFolder(u.id,{name:y.trim(),icon:j,color:F,description:v.trim()||null}),n?.("Folder updated","success");else{const N=Math.max(0,...t.map(L=>L.sort_order||0));await x.createFolder(h,i,{name:y.trim(),icon:j,color:F,description:v.trim()||null,sort_order:N+1}),n?.("Folder created","success")}b(!1),m(),d?.()}catch(N){console.error("Error saving folder:",N),N.message?.includes("duplicate key")||N.code==="23505"?n?.("A folder with this name already exists","error"):n?.("Failed to save folder","error")}finally{g(!1)}},B=async s=>{if(confirm(`Delete "${s.name}"? Documents in this folder will be moved to Unfiled.`)){_(s.id);try{await x.deleteFolder(s.id),n?.("Folder deleted","success"),d?.()}catch(N){console.error("Error deleting folder:",N),n?.("Failed to delete folder","error")}finally{_(null)}}},l=ee.find(s=>s.id===j),Q=se.find(s=>s.id===F);return e.jsxs("div",{className:"folder-manager",children:[e.jsxs("div",{className:"folder-manager-header",children:[e.jsx("h3",{children:"Manage Folders"}),e.jsxs("button",{className:"btn btn-primary btn-sm",onClick:f,children:[e.jsx(ne,{size:16}),"New Folder"]})]}),e.jsx("div",{className:"folder-manager-list",children:t.length===0?e.jsxs("div",{className:"folder-manager-empty",children:[e.jsx(U,{size:40}),e.jsx("p",{children:"No folders created yet"}),e.jsx("button",{className:"btn btn-secondary",onClick:f,children:"Create First Folder"})]}):t.map(s=>{const N=ee.find(E=>E.id===s.icon)?.icon||U,L=se.find(E=>E.id===s.color)?.hex||"#3b82f6";return e.jsxs("div",{className:"folder-manager-item",children:[e.jsx("div",{className:"folder-manager-item-drag",children:e.jsx(Ae,{size:16})}),e.jsx("div",{className:"folder-manager-item-icon",style:{backgroundColor:`${L}15`},children:e.jsx(N,{size:20,style:{color:L}})}),e.jsxs("div",{className:"folder-manager-item-info",children:[e.jsx("span",{className:"folder-manager-item-name",children:s.name}),e.jsxs("span",{className:"folder-manager-item-count",children:[s.document_count||0," documents"]})]}),e.jsxs("div",{className:"folder-manager-item-actions",children:[e.jsx("button",{className:"folder-action-btn",onClick:()=>$(s),title:"Edit folder",children:e.jsx($e,{size:16})}),e.jsx("button",{className:"folder-action-btn danger",onClick:()=>B(s),disabled:z===s.id,title:"Delete folder",children:z===s.id?e.jsx(M,{size:16,className:"spinner"}):e.jsx(Oe,{size:16})})]})]},s.id)})}),A&&e.jsx("div",{className:"modal-overlay",onClick:()=>b(!1),children:e.jsxs("div",{className:"folder-modal",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"folder-modal-header",children:[e.jsx("h3",{children:u?"Edit Folder":"Create Folder"}),e.jsx("button",{className:"modal-close",onClick:()=>b(!1),children:e.jsx(W,{size:20})})]}),e.jsxs("form",{onSubmit:O,children:[e.jsxs("div",{className:"folder-modal-content",children:[e.jsxs("div",{className:"folder-preview",children:[e.jsx("div",{className:"folder-preview-icon",style:{backgroundColor:`${Q?.hex}15`},children:l&&e.jsx(l.icon,{size:40,style:{color:Q?.hex}})}),e.jsx("span",{className:"folder-preview-name",children:y||"Folder Name"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"folder-name",children:"Folder Name *"}),e.jsx("input",{id:"folder-name",type:"text",value:y,onChange:s=>C(s.target.value),placeholder:"e.g., Site Plans, Safety Documents",autoFocus:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Icon"}),e.jsx("div",{className:"folder-icon-grid",children:ee.map(s=>e.jsx("button",{type:"button",className:`folder-icon-option ${j===s.id?"selected":""}`,onClick:()=>S(s.id),title:s.label,children:e.jsx(s.icon,{size:20})},s.id))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Color"}),e.jsx("div",{className:"folder-color-grid",children:se.map(s=>e.jsx("button",{type:"button",className:`folder-color-option ${F===s.id?"selected":""}`,onClick:()=>w(s.id),style:{backgroundColor:s.hex},title:s.label},s.id))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"folder-desc",children:"Description (optional)"}),e.jsx("input",{id:"folder-desc",type:"text",value:v,onChange:s=>p(s.target.value),placeholder:"Brief description of folder contents"})]})]}),e.jsxs("div",{className:"folder-modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>b(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:!y.trim()||k,children:k?e.jsxs(e.Fragment,{children:[e.jsx(M,{size:16,className:"spinner"}),"Saving..."]}):u?"Save Changes":"Create Folder"})]})]})]})})]})}const me=i=>i?.startsWith("image/")?Ge:i?.includes("spreadsheet")||i?.includes("excel")?Ke:i?.includes("pdf")?le:He,he=i=>{if(!i)return"0 B";const h=["B","KB","MB","GB"];let t=i,d=0;for(;t>=1024&&d<h.length-1;)t/=1024,d++;return`${t.toFixed(t<10?1:0)} ${h[d]}`},xe=i=>i?new Date(i).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"",J={blue:"#3b82f6",green:"#10b981",yellow:"#f59e0b",red:"#ef4444",purple:"#8b5cf6",pink:"#ec4899",gray:"#6b7280",orange:"#f97316"};function es({project:i,companyId:h,onShowToast:t,userRole:d}){const[D,n]=r.useState([]),[A,b]=r.useState(!0),[u,P]=r.useState(null),[z,_]=r.useState([]),[k,g]=r.useState(!1),[y,C]=r.useState(!1),[j,S]=r.useState(0),[F,w]=r.useState(0),[v,p]=r.useState(""),[m,f]=r.useState(null),[$,O]=r.useState(!1),[B,l]=r.useState(!1),[Q,s]=r.useState(!1),[N,L]=r.useState(null),[E,X]=r.useState(null),be=d==="office"||d==="administrator",ve=d==="foreman",Y=r.useRef(null),R=r.useCallback(async()=>{b(!0);try{const a=await x.getProjectFolders(i.id);n(a)}catch(a){console.error("Error loading folders:",a),t?.("Failed to load folders","error")}finally{b(!1)}},[i.id,t]);r.useEffect(()=>{R();const a=x.subscribeToDocumentFolders?.(i.id,()=>{R()}),c=x.subscribeToDocuments?.(i.id,()=>{R(),Y.current&&I(Y.current,!0)});return()=>{a?.unsubscribe?.(),c?.unsubscribe?.()}},[R,i.id]);const I=async(a,c=!1)=>{c&&(S(0),g(!0));try{const o=c?0:j,G=await x.getFolderDocuments(a.id,{page:o,limit:ke});_(c?G.documents:H=>[...H,...G.documents]),w(G.totalCount),C(G.hasMore)}catch(o){console.error("Error loading documents:",o),t?.("Failed to load documents","error")}finally{g(!1)}},Ne=a=>{P(a),Y.current=a,p(""),f(null),I(a,!0)},ge=()=>{P(null),Y.current=null,_([]),f(null),p("")},re=r.useCallback(async a=>{if(!a.trim()){f(null);return}O(!0);try{const c=await x.searchDocuments(i.id,a.trim());f(c)}catch(c){console.error("Error searching documents:",c)}finally{O(!1)}},[i.id]),K=r.useRef(null),ie=r.useCallback(a=>{p(a),K.current&&clearTimeout(K.current),K.current=setTimeout(()=>{re(a)},300)},[re]);r.useEffect(()=>()=>{K.current&&clearTimeout(K.current)},[]);const te=()=>{l(!1),X(null),R(),u&&I(u,!0),t?.("Document uploaded successfully","success")},V=async(a,c)=>{try{switch(a){case"view":L(c);break;case"download":await x.logDocumentAccess(c.id,"downloaded"),window.open(c.url||`undefined/storage/v1/object/public/project-documents/${c.storage_path}`,"_blank");break;case"archive":await x.archiveDocument(c.id),u&&I(u,!0),R(),t?.("Document archived","success");break;case"approve":await x.approveDocument(c.id),u&&I(u,!0),t?.("Document approved","success");break;default:break}}catch(o){console.error("Error performing action:",o),t?.("Action failed","error")}},Z=a=>{X(a),l(!0)};if(ve)return e.jsx(Fe,{projectId:i.id,companyId:h,onShowToast:t,allowUpload:!0});if(N)return e.jsx(Xe,{document:N,onBack:()=>L(null),onUpdate:()=>{u&&I(u,!0),R()},onShowToast:t,isOfficeOrAdmin:be});if(A)return e.jsx("div",{className:"docs-container",children:e.jsxs("div",{className:"docs-loading",children:[e.jsx(M,{size:24,className:"spinner"}),e.jsx("span",{children:"Loading documents..."})]})});if(u){const a=J[u.color]||J.blue,c=m!==null?m:z;return e.jsxs("div",{className:"docs-container",children:[e.jsxs("div",{className:"docs-folder-header",children:[e.jsxs("button",{className:"docs-back-btn",onClick:ge,children:[e.jsx(je,{size:18}),e.jsx("span",{children:"Back"})]}),e.jsxs("div",{className:"docs-folder-info",children:[e.jsx("div",{className:"docs-folder-icon",style:{backgroundColor:`${a}15`},children:e.jsx(U,{size:20,style:{color:a}})}),e.jsxs("div",{children:[e.jsx("h2",{className:"docs-folder-name",children:u.name}),e.jsxs("span",{className:"docs-folder-count",children:[F," files"]})]})]}),e.jsxs("button",{className:"docs-upload-btn",onClick:()=>Z(u),children:[e.jsx(oe,{size:18}),e.jsx("span",{children:"Upload"})]})]}),e.jsx("div",{className:"docs-search-wrapper",children:e.jsxs("div",{className:"docs-search",children:[e.jsx(de,{size:16}),e.jsx("input",{type:"text",placeholder:"Search in folder...",value:v,onChange:o=>ie(o.target.value)}),v&&e.jsx("button",{onClick:()=>{p(""),f(null)},children:e.jsx(W,{size:16})}),$&&e.jsx(M,{size:16,className:"spinner"})]})}),m!==null&&e.jsxs("div",{className:"docs-search-info",children:[e.jsxs("span",{children:[m.length," result",m.length!==1?"s":"",' for "',v,'"']}),e.jsx("button",{onClick:()=>{p(""),f(null)},children:"Clear"})]}),e.jsx("div",{className:"docs-list",children:k?e.jsxs("div",{className:"docs-loading",children:[e.jsx(M,{size:24,className:"spinner"}),e.jsx("span",{children:"Loading..."})]}):c.length===0?e.jsxs("div",{className:"docs-empty",children:[e.jsx(U,{size:48,style:{color:a,opacity:.3}}),e.jsx("h3",{children:m!==null?"No results":"Empty folder"}),e.jsx("p",{children:m!==null?"Try a different search term.":"Upload your first document."}),m===null&&e.jsxs("button",{className:"docs-empty-btn",onClick:()=>Z(u),children:[e.jsx(oe,{size:16}),"Upload Document"]})]}):e.jsxs(e.Fragment,{children:[c.map(o=>{const G=me(o.mime_type),H=o.approval_status==="pending";return e.jsxs("div",{className:`docs-item ${H?"pending":""}`,children:[e.jsx("div",{className:"docs-item-icon",children:e.jsx(G,{size:20})}),e.jsxs("div",{className:"docs-item-info",children:[e.jsxs("span",{className:"docs-item-name",children:[o.name,o.version>1&&e.jsxs("span",{className:"docs-item-version",children:["v",o.version]})]}),e.jsxs("span",{className:"docs-item-meta",children:[he(o.file_size_bytes)," · ",xe(o.uploaded_at)]})]}),H&&e.jsx("span",{className:"docs-badge pending",children:"Pending"}),e.jsxs("div",{className:"docs-item-actions",children:[e.jsx("button",{onClick:()=>V("view",o),title:"View",children:e.jsx(ae,{size:16})}),e.jsx("button",{onClick:()=>V("download",o),title:"Download",children:e.jsx(T,{size:16})}),H&&e.jsx("button",{className:"approve",onClick:()=>V("approve",o),title:"Approve",children:e.jsx(fe,{size:16})}),e.jsx("button",{className:"danger",onClick:()=>V("archive",o),title:"Archive",children:e.jsx(pe,{size:16})})]})]},o.id)}),y&&m===null&&e.jsxs("button",{className:"docs-load-more",onClick:()=>{S(o=>o+1),I(u,!1)},disabled:k,children:["Load More (",z.length," of ",F,")"]})]})}),B&&e.jsx(ce,{projectId:i.id,companyId:h,folderId:E?.id,folderName:E?.name,onClose:()=>{l(!1),X(null)},onUploadComplete:te,onShowToast:t})]})}return e.jsxs("div",{className:"docs-container",children:[e.jsxs("div",{className:"docs-header",children:[e.jsxs("div",{className:"docs-search",children:[e.jsx(de,{size:16}),e.jsx("input",{type:"text",placeholder:"Search documents...",value:v,onChange:a=>ie(a.target.value)}),v&&e.jsx("button",{onClick:()=>{p(""),f(null)},children:e.jsx(W,{size:16})}),$&&e.jsx(M,{size:16,className:"spinner"})]}),e.jsxs("button",{className:"docs-manage-btn",onClick:()=>s(!0),children:[e.jsx(Be,{size:18}),e.jsx("span",{children:"Manage"})]})]}),m!==null?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"docs-search-info",children:[e.jsxs("span",{children:[m.length," result",m.length!==1?"s":""]}),e.jsx("button",{onClick:()=>{p(""),f(null)},children:"Clear"})]}),e.jsx("div",{className:"docs-list",children:m.map(a=>{const c=me(a.mime_type);return e.jsxs("div",{className:"docs-item",children:[e.jsx("div",{className:"docs-item-icon",children:e.jsx(c,{size:20})}),e.jsxs("div",{className:"docs-item-info",children:[e.jsx("span",{className:"docs-item-name",children:a.name}),e.jsxs("span",{className:"docs-item-meta",children:[he(a.file_size_bytes)," · ",xe(a.uploaded_at)]})]}),e.jsxs("div",{className:"docs-item-actions",children:[e.jsx("button",{onClick:()=>V("view",a),children:e.jsx(ae,{size:16})}),e.jsx("button",{onClick:()=>V("download",a),children:e.jsx(T,{size:16})})]})]},a.id)})})]}):e.jsx("div",{className:"docs-grid",children:D.length===0?e.jsxs("div",{className:"docs-empty-state",children:[e.jsx(Ve,{size:56}),e.jsx("h3",{children:"No folders yet"}),e.jsx("p",{children:"Create folders to organize your documents"}),e.jsxs("button",{onClick:()=>s(!0),children:[e.jsx(ne,{size:18}),"Create Folder"]})]}):D.map(a=>{const c=J[a.color]||J.blue;return e.jsxs("div",{className:"docs-folder-card",onClick:()=>Ne(a),children:[e.jsx("div",{className:"docs-folder-card-icon",style:{backgroundColor:`${c}12`},children:e.jsx(U,{size:28,style:{color:c}})}),e.jsxs("div",{className:"docs-folder-card-content",children:[e.jsx("span",{className:"docs-folder-card-name",children:a.name}),e.jsxs("span",{className:"docs-folder-card-count",children:[a.document_count||0," ",a.document_count===1?"file":"files"]})]}),e.jsx("button",{className:"docs-folder-card-upload",onClick:o=>{o.stopPropagation(),Z(a)},title:"Upload",children:e.jsx(ne,{size:18})})]},a.id)})}),Q&&e.jsx("div",{className:"modal-overlay",onClick:()=>s(!1),children:e.jsxs("div",{className:"docs-manager-modal",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"docs-manager-header",children:[e.jsx("h2",{children:"Manage Folders"}),e.jsx("button",{onClick:()=>s(!1),children:e.jsx(W,{size:20})})]}),e.jsx(Ye,{projectId:i.id,companyId:h,folders:D,onFoldersChange:R,onClose:()=>s(!1),onShowToast:t})]})}),B&&e.jsx(ce,{projectId:i.id,companyId:h,folderId:E?.id,folderName:E?.name,onClose:()=>{l(!1),X(null)},onUploadComplete:te,onShowToast:t})]})}export{es as default};
//# sourceMappingURL=DocumentsTab-CVWzWn1Y.js.map
