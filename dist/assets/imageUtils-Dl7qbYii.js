const h=e=>{const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:[59,130,246]},l=(e,t=5e3,r=.85)=>new Promise(o=>{if(!e){o(null);return}const a=new Image;a.crossOrigin="anonymous";const i=setTimeout(()=>{a.src="",o(null)},t);a.onload=()=>{clearTimeout(i);try{const n=document.createElement("canvas");n.width=a.width,n.height=a.height,n.getContext("2d").drawImage(a,0,0);const c=n.toDataURL("image/jpeg",r);o(c)}catch{o(null)}},a.onerror=()=>{clearTimeout(i),o(null)},a.src=e}),w=async(e,t=5e3,r=.85)=>!e||e.length===0?[]:await Promise.all(e.map(a=>l(a,t,r)));async function p(e,t=1920,r=.8){return!e.type.startsWith("image/")||e.size<500*1024?e:new Promise(o=>{const a=document.createElement("canvas"),i=a.getContext("2d"),n=new Image;n.onload=()=>{let{width:s,height:c}=n;s>t&&(c=Math.round(c*t/s),s=t);const g=1920;c>g&&(s=Math.round(s*g/c),c=g),a.width=s,a.height=c,i.imageSmoothingEnabled=!0,i.imageSmoothingQuality="high",i.drawImage(n,0,0,s,c),a.toBlob(u=>{if(u){const m=e.name.replace(/\.[^/.]+$/,""),d=new File([u],`${m}.jpg`,{type:"image/jpeg",lastModified:Date.now()});o(d)}else o(e)},"image/jpeg",r),URL.revokeObjectURL(n.src)},n.onerror=()=>{URL.revokeObjectURL(n.src),o(e)},n.src=URL.createObjectURL(e)})}function I(e=5e3){return new Promise(t=>{if(!navigator.geolocation){t(null);return}navigator.geolocation.getCurrentPosition(r=>{t({latitude:r.coords.latitude,longitude:r.coords.longitude,accuracy:Math.round(r.coords.accuracy)})},()=>t(null),{enableHighAccuracy:!0,timeout:e,maximumAge:6e4})})}export{w as a,p as c,I as g,h,l};
